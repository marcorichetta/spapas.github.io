<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>/var/</title><link href="https://spapas.github.io/" rel="alternate"></link><link href="https://spapas.github.io/feeds/all.atom.xml" rel="self"></link><id>https://spapas.github.io/</id><updated>2020-03-27T14:20:00+02:00</updated><subtitle>Various programming stuff</subtitle><entry><title>Adding a latest-changes list to your WagtailÂ site</title><link href="https://spapas.github.io/2020/03/27/wagtail-add-latest-changes/" rel="alternate"></link><published>2020-03-27T14:20:00+02:00</published><updated>2020-03-27T14:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2020-03-27:/2020/03/27/wagtail-add-latest-changes/</id><summary type="html">&lt;p class="first last"&gt;How to add a list of the latest changes to your wagtail&amp;nbsp;site&lt;/p&gt;
</summary><content type="html">&lt;p&gt;I think that a very important tool for a new production &lt;a class="reference external" href="https://wagtail.io"&gt;Wagtail&lt;/a&gt; site is to have a list
where you&amp;#8217;ll be able to take a look at the latest changes. Most editors are not
experienced enough when using a new tool so it&amp;#8217;s easy to make bad quality edits. A
user could take a look at their changes and guide them if something&amp;#8217;s not up to good&amp;nbsp;standards.&lt;/p&gt;
&lt;p&gt;In this article I&amp;#8217;ll present a simple way to add a latest-changes list in your Wagtail site.
This is working excellent with Wagtail 2.8, I haven&amp;#8217;t tested it with other wagtail versions
so your milage may vary. In the meantime, I&amp;#8217;ll also introduce a bunch of concepts of Wagtail
I find&amp;nbsp;interesting.&lt;/p&gt;
&lt;div class="section" id="a-starter-project"&gt;
&lt;h2&gt;A starter&amp;nbsp;project&lt;/h2&gt;
&lt;p&gt;Let&amp;#8217;s create a simple wagtail-starter project (this is for windows you should be able to easily follow the same steps in Unix like&amp;nbsp;systems):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
C:\progr\py3&amp;gt;mkdir wagtail-starter
C:\progr\py3&amp;gt;cd wagtail-starter
C:\progr\py3\wagtail-starter&amp;gt;py -3 -m venv venv
C:\progr\py3\wagtail-starter&amp;gt;venv\Scripts\activate
(venv) C:\progr\py3\wagtail-starter&amp;gt;pip install wagtail
(venv) C:\progr\py3\wagtail-starter&amp;gt;wagtail.exe start wagtail_starter
(venv) C:\progr\py3\wagtail-starter&amp;gt;cd wagtail_starter
(venv) C:\progr\py3\wagtail-starter\wagtail_starter&amp;gt;python manage.py migrate
(venv) C:\progr\py3\wagtail-starter\wagtail_starter&amp;gt;python manage.py createsuperuser
(venv) C:\progr\py3\wagtail-starter\wagtail_starter&amp;gt;python manage.py runserver
&lt;/pre&gt;
&lt;p&gt;When you&amp;#8217;ve finished all the above you should be able to go to &lt;a class="reference external" href="http://127.0.0.1/"&gt;http://127.0.0.1/&lt;/a&gt; and see your homepage and then
visit &lt;a class="reference external" href="http://127.0.0.1/admin/"&gt;http://127.0.0.1/admin/&lt;/a&gt; and login with your superuser. What we&amp;#8217;d like to do is add a &amp;#8220;Latest changes&amp;#8221;
link in the &amp;#8220;Reports&amp;#8221; admin section like&amp;nbsp;this:&lt;/p&gt;
&lt;img alt="New menu" src="/images/latest-changes-template.png" style="width: 580px;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="implementing-the-latest-changes-menu"&gt;
&lt;h2&gt;Implementing the latest-changes&amp;nbsp;menu&lt;/h2&gt;
&lt;div class="section" id="start-with-a-new-app"&gt;
&lt;h3&gt;Start with a new&amp;nbsp;app&lt;/h3&gt;
&lt;p&gt;To start the menu implementation I recommend putting everything related to it in a separate django application
so you can easily re-use it to multiple sites. For this, let&amp;#8217;s create a new django app&amp;nbsp;using:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
(venv) C:\progr\py3\wagtail-starter\wagtail_starter&amp;gt;python manage.py startapp latest_changes
&lt;/pre&gt;
&lt;p&gt;And add &lt;tt class="docutils literal"&gt;'latest_changes'&lt;/tt&gt; to the list of our &lt;tt class="docutils literal"&gt;INSTALLED_APPS&lt;/tt&gt; at the file &lt;tt class="docutils literal"&gt;wagtail_starter\settings\base.py&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="add-the-view"&gt;
&lt;h3&gt;Add the&amp;nbsp;view&lt;/h3&gt;
&lt;p&gt;Let&amp;#8217;s add the code for the view that will display the latest changes page. Modify the latest_changes/views.py file like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
from django.shortcuts import render
from wagtail.admin.views.reports import ReportView
from wagtail.core.models import UserPagePermissionsProxy
from wagtail.core.models import Page


class LatestChangesView(ReportView):
    template_name = &amp;quot;reports/latest_changes.html&amp;quot;
    title = &amp;quot;Latest changes&amp;quot;
    header_icon = &amp;quot;date&amp;quot;

    def get_queryset(self):
        self.queryset = Page.objects.order_by(&amp;quot;-last_published_at&amp;quot;)
        return super().get_queryset()

    def dispatch(self, request, *args, **kwargs):
        if not UserPagePermissionsProxy(request.user).can_remove_locks():
            return permission_denied(request)
        return super().dispatch(request, *args, **kwargs)
&lt;/pre&gt;
&lt;p&gt;As you can see the above code adds a very small view that overrides &lt;tt class="docutils literal"&gt;ReportView&lt;/tt&gt; which is used
also by the locked pages view so most things are already implemented by that view. The only thing we do
here is to override the &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt; method to denote which pages we want to display and
the &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; to add some permission checks. Here we check that a user &lt;tt class="docutils literal"&gt;can_remove_locks&lt;/tt&gt; but we
could do other checks if needed. Finally, notice that we have overriden the template name which we&amp;#8217;ll
define in a&amp;nbsp;minute.&lt;/p&gt;
&lt;p&gt;To properly add that view in our urls.py we can use a wagtail hook named &lt;tt class="docutils literal"&gt;register_admin_py&lt;/tt&gt;. Wagtail hooks
are a great way to excend the wagtail admin; to use them, you have to generate a file name &lt;tt class="docutils literal"&gt;wagtail_hooks.py&lt;/tt&gt;
in one of your apps. This file will be auto-impoted by wagtail when your app is&amp;nbsp;started.&lt;/p&gt;
&lt;p&gt;Thus, in our case we&amp;#8217;ll add a &lt;tt class="docutils literal"&gt;wagtail_hooks.py&lt;/tt&gt; file in the &lt;tt class="docutils literal"&gt;latest_changes&lt;/tt&gt; app with the following&amp;nbsp;code:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
from django.http import HttpResponse
from django.conf.urls import url
from wagtail.core import hooks
from .views import LatestChangesView

&amp;#64;hooks.register('register_admin_urls')
def urlconf_time():
  return [
    url(r'^latest_changes/$', admin_view, name='latest_changes'),
  ]
&lt;/pre&gt;
&lt;p&gt;The above just hooks up the &lt;tt class="docutils literal"&gt;LatestChangesView&lt;/tt&gt; we defined before to the &lt;tt class="docutils literal"&gt;/admin/latest_changes/&lt;/tt&gt; url.&lt;/p&gt;
&lt;p&gt;If everything&amp;#8217;s ok till now you should be able to visit: &lt;a class="reference external" href="http://127.0.0.1:8000/admin/latest_changes/"&gt;http://127.0.0.1:8000/admin/latest_changes/&lt;/a&gt; and
get an error for a missing template - remember that we haven&amp;#8217;t yet defined &lt;tt class="docutils literal"&gt;utils/reports/latest_changes.html&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="add-the-template"&gt;
&lt;h3&gt;Add the&amp;nbsp;template&lt;/h3&gt;
&lt;p&gt;To add the template we&amp;#8217;ll need to create a folder named &lt;tt class="docutils literal"&gt;templates&lt;/tt&gt; under our &lt;tt class="docutils literal"&gt;latest_changes&lt;/tt&gt; app and then
add a &lt;tt class="docutils literal"&gt;reports&lt;/tt&gt; folder to it. Finally in that folder add a &lt;tt class="docutils literal"&gt;latest_changes.html&lt;/tt&gt;. So the full path of
the &lt;tt class="docutils literal"&gt;latest_changes.html&lt;/tt&gt; should be: &lt;tt class="docutils literal"&gt;wagtail_starter\latest_changes\templates\reports\latest_changes.html&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
{% extends 'wagtailadmin/reports/base_report.html' %}
{% load i18n %}
{% block listing %}
    {% include &amp;quot;reports/_list_latest.html&amp;quot; %}
{% endblock %}

{% block no_results %}
    &amp;lt;p&amp;gt;{% trans &amp;quot;No changes found.&amp;quot; %}&amp;lt;/p&amp;gt;
{% endblock %}
&lt;/pre&gt;
&lt;p&gt;I&amp;#8217;ve selected the &lt;tt class="docutils literal"&gt;reports&lt;/tt&gt; subfolder just to be compatible with what wagtail does, you can just put &lt;tt class="docutils literal"&gt;latest_changes.html&lt;/tt&gt;  directly
under &lt;tt class="docutils literal"&gt;templates&lt;/tt&gt;; don&amp;#8217;t forget to update the &lt;tt class="docutils literal"&gt;LatestChangesView&lt;/tt&gt; defined before though! The above page includes a
snippet named &lt;tt class="docutils literal"&gt;reports/_list_latest.html&amp;quot; thus you also need to add a ``_list_latest.html&lt;/tt&gt; file in the same folder with the
following&amp;nbsp;contents:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
{% extends &amp;quot;wagtailadmin/pages/listing/_list_explore.html&amp;quot; %}

{% load i18n wagtailadmin_tags %}

{% block post_parent_page_headers %}
&amp;lt;tr&amp;gt;
&amp;lt;th&amp;gt;Title&amp;lt;/th&amp;gt;
&amp;lt;th&amp;gt;Last update&amp;lt;/th&amp;gt;
&amp;lt;th&amp;gt;Kind&amp;lt;/th&amp;gt;
&amp;lt;th&amp;gt;Status&amp;lt;/th&amp;gt;
&amp;lt;th&amp;gt;Owner / last publish / last edit&amp;lt;/th&amp;gt;
&amp;lt;/tr&amp;gt;
{% endblock %}

{% block page_navigation %}
    &amp;lt;td&amp;gt;
        {{ page.owner }} / {{ page.live_revision.user }} / {{ page.get_latest_revision.user }}
    &amp;lt;/td&amp;gt;
{% endblock %}
&lt;/pre&gt;
&lt;p&gt;Please notice that my &lt;tt class="docutils literal"&gt;_list_latest.html&lt;/tt&gt; snippet extends the wagtail provided &lt;tt class="docutils literal"&gt;_list_explore.html&lt;/tt&gt; template and
overrides some things that can be overriden from that file. If you want to do more changes you&amp;#8217;ll need to copy over
everything and change things as you wish instead of&amp;nbsp;extending.&lt;/p&gt;
&lt;p&gt;Also, keep in mind that because you added a &lt;tt class="docutils literal"&gt;templates&lt;/tt&gt; folder you&amp;#8217;ll need to restart your django development&amp;nbsp;server.&lt;/p&gt;
&lt;p&gt;Finally, if everything is ok until now you should be able to visit &lt;a class="reference external" href="http://127.0.0.1:8000/admin/latest_changes/"&gt;http://127.0.0.1:8000/admin/latest_changes/&lt;/a&gt; and see
your view! It will say &amp;#8220;No changes found&amp;#8221; if you&amp;#8217;ve followed the steps here; just go to Pages - Home from the wagtail
menu and edit that page (just save it). Now visit &lt;a class="reference external" href="http://127.0.0.1:8000/admin/latest_changes/"&gt;http://127.0.0.1:8000/admin/latest_changes/&lt;/a&gt; again and behold! Your
own latest changes&amp;nbsp;view:&lt;/p&gt;
&lt;img alt="The view" src="/images/last_changes_view.png" style="width: 780px;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="displaying-our-menu-item"&gt;
&lt;h3&gt;Displaying our menu&amp;nbsp;item&lt;/h3&gt;
&lt;p&gt;The last piece of the puzzle missing is to actually display a menu item under the Reports menu of wagtail admin. For this
we are going to use our friends, the wagtail hooks. So, change the wagtail_hooks.py file like this (I&amp;#8217;m also including
the code from adding the&amp;nbsp;url):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
from django.http import HttpResponse
from django.conf.urls import url
from django.urls import reverse
from wagtail.admin.menu import MenuItem
from wagtail.core import hooks
from wagtail.core.models import UserPagePermissionsProxy
from .views import LatestChangesView

&amp;#64;hooks.register('register_admin_urls')
def urlconf_time():
    return [
      url(r'^latest_changes/$', LatestChangesView.as_view(), name='latest_changes'),
    ]


class LatestChangesPagesMenuItem(MenuItem):
    def is_shown(self, request):
        return UserPagePermissionsProxy(request.user).can_remove_locks()


&amp;#64;hooks.register(&amp;quot;register_reports_menu_item&amp;quot;)
def register_latest_changes_menu_item():
    return LatestChangesPagesMenuItem(
        &amp;quot;Latest changes&amp;quot;, reverse(&amp;quot;latest_changes&amp;quot;), classnames=&amp;quot;icon icon-date&amp;quot;, order=100,
    )
&lt;/pre&gt;
&lt;p&gt;The above code uses the &lt;tt class="docutils literal"&gt;register_reports_menu_item&lt;/tt&gt; which is a hook that can be used to add a child
specifically to the Reports menu item. Notice that it uses the &lt;tt class="docutils literal"&gt;LatestChangesPagesMenuItem&lt;/tt&gt; which
is a class that inherits from &lt;tt class="docutils literal"&gt;MenuItem&lt;/tt&gt;; the only thing that is overriden there is the &lt;tt class="docutils literal"&gt;is_shown&lt;/tt&gt;
method so it will have the same permissions as the &lt;tt class="docutils literal"&gt;LatestChangesView&lt;/tt&gt; we defined above so user
that will see the menu item will also have permissions to display the view. Here&amp;#8217;s the final menu&amp;nbsp;item:&lt;/p&gt;
&lt;img alt="The menu item" src="/images/latest_changes_menu.png" style="width: 380px;" /&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h3&gt;Conclusion&lt;/h3&gt;
&lt;p&gt;We&amp;#8217;ve seen the steps required to add a latest pages view to your wagtail admin site. I have to admit that
it is a little work however the nice thing is that this is all self-included in a single application. You can
just get tha application and copy over it to your wagtail site; after you add that application to INSTALLED_APPS
you should get the whole functionality without any more modifications to your project. To help you more
with this I&amp;#8217;ve included the whole code of this project in the &lt;a class="reference external" href="https://github.com/spapas/wagtail-latest-changes"&gt;https://github.com/spapas/wagtail-latest-changes&lt;/a&gt;&amp;nbsp;repository.&lt;/p&gt;
&lt;p&gt;You can either clone this repository to see the functionality or just copy over the &lt;tt class="docutils literal"&gt;latest_changes&lt;/tt&gt; folder to
your wagtail project to include the functionality directly (don&amp;#8217;t forget to fix the &lt;tt class="docutils literal"&gt;INSTALLED_APPS&lt;/tt&gt; setting)!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="wagtail"></category><category term="django"></category><category term="wagtail"></category></entry><entry><title>Quick and easy layout of django forms using django-crispy-forms andÂ django-widget-tweaks</title><link href="https://spapas.github.io/2020/03/18/django-crispy-form-quick-easy-layout/" rel="alternate"></link><published>2020-03-18T11:20:00+02:00</published><updated>2020-03-18T11:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2020-03-18:/2020/03/18/django-crispy-form-quick-easy-layout/</id><summary type="html">&lt;p class="first last"&gt;How to easily layout your django-crispy-forms&amp;nbsp;forms&lt;/p&gt;
</summary><content type="html">&lt;p&gt;One of the first problems you have when you want to create a traditional &lt;span class="caps"&gt;HTML&lt;/span&gt; django site (i.e
not an &lt;span class="caps"&gt;SPA&lt;/span&gt; one) is how to properly and beautifully layout your forms. In this small article I&amp;#8217;ll
talk about two very useful django packages that will help you have great layouts in your forms:
&lt;a class="reference external" href="https://github.com/django-crispy-forms/django-crispy-forms"&gt;django-crispy-forms&lt;/a&gt;  and &lt;a class="reference external" href="https://github.com/jazzband/django-widget-tweaks"&gt;django-widget-tweaks&lt;/a&gt;.&lt;/p&gt;
&lt;div class="section" id="django-crispy-forms"&gt;
&lt;h2&gt;django-crispy-forms&lt;/h2&gt;
&lt;p&gt;The django-crispy-forms django package is a great way to properly format your forms. If you don&amp;#8217;t
already use it I totally recommend to check it out; it&amp;#8217;s very useful and you&amp;#8217;ll definitely love it
if you are a heavy django forms user. It helps you properly layout your forms either implicitly or&amp;nbsp;explicitly.&lt;/p&gt;
&lt;p&gt;For explicitly laying out your forms you should add a &lt;tt class="docutils literal"&gt;FormHelper&lt;/tt&gt; to your django form class and
use the &lt;tt class="docutils literal"&gt;{% crispy %}&lt;/tt&gt; template tag. You can use this to explicitly define your form layout with
as much detail as you want since you have full control. I won&amp;#8217;t go into more details about this since it&amp;#8217;s
&lt;a class="reference external" href="https://django-crispy-forms.readthedocs.io/en/latest/crispy_tag_forms.html#crispy-tag-with-forms"&gt;explained thoroughly in the docs&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For implicitly laying out your forms, you will just use the &lt;tt class="docutils literal"&gt;|crispy&lt;/tt&gt; template filter. This gets a
normal django form (without any modifications) and converts it to a crispy form based on the &lt;a class="reference external" href="https://django-crispy-forms.readthedocs.io/en/latest/install.html#template-packs"&gt;template pack&lt;/a&gt;
you are using. This works great for many situations however sometimes you&amp;#8217;ll need to have more control
over this without going to the extra effort to add a complete layout to each of your forms using
the &lt;tt class="docutils literal"&gt;FormHelper&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;So how do you resolve this? Enter the &lt;tt class="docutils literal"&gt;|as_crispy_field&lt;/tt&gt; template filter. To use that filter you&amp;#8217;ll need
to add the &lt;tt class="docutils literal"&gt;{% load crispy_forms_tags %}&lt;/tt&gt; lines to your template and then you can pass any one of your
form&amp;#8217;s fields to it so it will be properly &amp;#8220;crispified&amp;#8221;! Let&amp;#8217;s see a quick example of adding the fields of
a form in a &lt;tt class="docutils literal"&gt;&amp;lt;div &lt;span class="pre"&gt;class='col-md-6'&amp;gt;&lt;/span&gt;&lt;/tt&gt; so they will be in two columns (using&amp;nbsp;bootstrap):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;lt;form class='form' method=&amp;quot;POST&amp;quot;&amp;gt;
    &amp;lt;div class='row'&amp;gt;
        {% for field in form %}
            &amp;lt;div class='col-md-6'&amp;gt;
              {{ field|as_crispy_field }}
            &amp;lt;/div&amp;gt;
        {% endfor %}
        {% csrf_token %}
    &amp;lt;/div&amp;gt;
    &amp;lt;input class='btn btn-primary' type='submit'&amp;gt;
&amp;lt;/form&amp;gt;
&lt;/pre&gt;
&lt;p&gt;So the above code enumerates all form fields and uses the &lt;tt class="docutils literal"&gt;|as_crispy_field&lt;/tt&gt; to properly add the
crispified information to it. If you want to re-use the above two column layout in multiple forms and
be more dry you can create a template snippet and &lt;tt class="docutils literal"&gt;{% include %}&lt;/tt&gt; it in the part of your code you
want the form to be&amp;nbsp;rendered.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-widget-tweaks"&gt;
&lt;h2&gt;django-widget-tweaks&lt;/h2&gt;
&lt;p&gt;Using the &lt;tt class="docutils literal"&gt;as_crispy_field&lt;/tt&gt; is excellent however sometimes you may need even more control
of your for fields, for example add an extra class (like &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;form-control-lg&lt;/span&gt;&lt;/tt&gt;) to your form controls.
The answer to this is the django-widget-tweaks package: It enables you to easily modify form
fields by adding classes, attributes etc to them from within your django&amp;nbsp;templates.&lt;/p&gt;
&lt;p&gt;To use it you need to add a &lt;tt class="docutils literal"&gt;{% load widget_tweaks %}&lt;/tt&gt; to your templates. Then you&amp;#8217;ll be
able to use the &lt;tt class="docutils literal"&gt;|add_class&lt;/tt&gt; form field to add a class to your form field. For example the
previous example can be modified like this to have smaller&amp;nbsp;controls:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;lt;form class='form' method=&amp;quot;POST&amp;quot;&amp;gt;
    &amp;lt;div class='row'&amp;gt;
        {% for field in form %}
            &amp;lt;div class='col-md-6'&amp;gt;
              {{ field|add_class:&amp;quot;form-control-sm&amp;quot;|as_crispy_field }}
            &amp;lt;/div&amp;gt;
        {% endfor %}
        {% csrf_token %}
    &amp;lt;/div&amp;gt;
    &amp;lt;input class='btn btn-primary' type='submit'&amp;gt;
&amp;lt;/form&amp;gt;
&lt;/pre&gt;
&lt;p&gt;Please notice that I use both &lt;tt class="docutils literal"&gt;add_class&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;as_crispy_fields&lt;/tt&gt; together; notice the
order, the &lt;tt class="docutils literal"&gt;add_class&lt;/tt&gt; needs to be &lt;em&gt;before&lt;/em&gt; the &lt;tt class="docutils literal"&gt;as_crispy_field&lt;/tt&gt; or you&amp;#8217;ll get an error. This
way the django form field will have the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;form-control-sm&lt;/span&gt;&lt;/tt&gt; class &lt;em&gt;and&lt;/em&gt; then be rendered as a
crispy&amp;nbsp;field.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s now suppose that you need to more control over your fields. For example you need to add a class
only to your select fields or even only to a particular field (depending on its name). To do that
you can use the &lt;tt class="docutils literal"&gt;name&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;field.widget.input_type&lt;/tt&gt; attributes of each for field. So, to make
select fields smaller and with a &lt;tt class="docutils literal"&gt;warning&lt;/tt&gt; background and fields that have a name of &lt;tt class="docutils literal"&gt;name&lt;/tt&gt;
or &lt;tt class="docutils literal"&gt;year&lt;/tt&gt; larger you can use something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;lt;form class='form' method=&amp;quot;POST&amp;quot;&amp;gt;
    &amp;lt;div class='row'&amp;gt;
        {% for field in form %}
          {% if field.name == 'name' or field.name == 'year' %}
              {{ field|add_class:&amp;quot;form-control-lg&amp;quot;|as_crispy_field }}
          {% elif field.field.widget.input_type == 'select' %}
              {{ field|add_class:&amp;quot;form-control-sm&amp;quot;|add_class:&amp;quot;bg-warning&amp;quot;|as_crispy_field }}
          {% else %}
              {{ field|as_crispy_field }}
          {% endif %}
        {% endfor %}
        {% csrf_token %}
    &amp;lt;/div&amp;gt;
    &amp;lt;input class='btn btn-primary' type='submit'&amp;gt;
&amp;lt;/form&amp;gt;
&lt;/pre&gt;
&lt;p&gt;Using the above techniques you should be able to quickly layout and format your form fields with
much control! If you need something more I recommend going the &lt;tt class="docutils literal"&gt;FormLayout&lt;/tt&gt; route I mentioned
in the&amp;nbsp;beginning.&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="forms"></category><category term="django-crispy-forms"></category><category term="django-widget-tweaks"></category></entry><entry><title>Declarative Ecto queryÂ sorting</title><link href="https://spapas.github.io/2019/10/17/declarative-ecto-query-sorting/" rel="alternate"></link><published>2019-10-17T12:20:00+03:00</published><updated>2019-10-17T12:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2019-10-17:/2019/10/17/declarative-ecto-query-sorting/</id><summary type="html">&lt;p class="first last"&gt;Being able to declare your Ecto query sorting even on fields spanning&amp;nbsp;joins&lt;/p&gt;
</summary><content type="html">&lt;p&gt;In a &lt;a class="reference external" href="https://spapas.github.io/2019/07/25/declarative-ecto-query-filters/"&gt;previous article&lt;/a&gt; I presented a method for declaring dynamic filters for your ecto queries.
Continuing this article, I&amp;#8217;ll present here a way to allow dynamic sorting for your queries using
fields that may even span&amp;nbsp;relations.&lt;/p&gt;
&lt;div class="section" id="what-will-it-do"&gt;
&lt;h2&gt;What will it&amp;nbsp;do&lt;/h2&gt;
&lt;p&gt;The solution is a couple of function that can be put inside the &lt;tt class="docutils literal"&gt;QueryFilterEx&lt;/tt&gt; I mentioned
in the &lt;a class="reference external" href="https://spapas.github.io/2019/07/25/declarative-ecto-query-filters/"&gt;previous article&lt;/a&gt;. Please make sure that you&amp;#8217;ve completely read and understand this
article before continuing&amp;nbsp;here.&lt;/p&gt;
&lt;p&gt;To use the dynamic sorting function you&amp;#8217;ll need to declare the fields that would allow sorting using
a simple array of strings. The sort fields should then be added as links to your phoenix page which
will then pass an &lt;tt class="docutils literal"&gt;order_by=field_name&lt;/tt&gt; query parameter to your&amp;nbsp;controller.&lt;/p&gt;
&lt;p&gt;The module has a very simple &lt;span class="caps"&gt;API&lt;/span&gt; consisting of a single&amp;nbsp;function:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;sort_by_params(query, params, allowed_sort_fields)&lt;/tt&gt;: Pass it the query, the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; request parameters you got from your form and the declared sort fields array to return you a sorted&amp;nbsp;query&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can find a sample of the technique presented in this article in my &lt;span class="caps"&gt;PHXCRD&lt;/span&gt; repository:
&lt;a class="reference external" href="https://github.com/spapas/phxcrd"&gt;https://github.com/spapas/phxcrd&lt;/a&gt;  for example in the &lt;tt class="docutils literal"&gt;user_controller&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;authority_controller&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="preparing-the-query"&gt;
&lt;h2&gt;Preparing the&amp;nbsp;query&lt;/h2&gt;
&lt;p&gt;In order to use dynamic sorting you&amp;#8217;ll need to properly &amp;#8220;prepare&amp;#8221; your Ecto query by &lt;em&gt;naming all your relations&lt;/em&gt;
as I&amp;#8217;ve already explained in the &lt;a class="reference external" href="https://spapas.github.io/2019/07/25/declarative-ecto-query-filters/"&gt;previous article&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="declaring-the-sort-fields"&gt;
&lt;h2&gt;Declaring the sort&amp;nbsp;fields&lt;/h2&gt;
&lt;p&gt;To declare the sort fields you&amp;#8217;ll just add an array of fields you&amp;#8217;ll want to allow sorting on. Each field
should have the form &lt;tt class="docutils literal"&gt;binding_name__field_name&lt;/tt&gt; where &lt;tt class="docutils literal"&gt;binding_name&lt;/tt&gt; is the name of the table
you&amp;#8217;ve declared in your
query and &lt;tt class="docutils literal"&gt;field_name&lt;/tt&gt; is the name of the field that the query will be sorted by. This is the way
that the sort
fields will also be declared in the phoenix html page. Django users will definitely remember the
&lt;tt class="docutils literal"&gt;model__field&lt;/tt&gt; convention.&lt;/p&gt;
&lt;p&gt;Declaring the sort fields here and using them again in the html page may seem reduntant, however
it is absolute necessary to declare a priori which fields are allowed because the sort http params
will be received
as strings and to be used in queries these strings will be converted to atoms. The number of atoms is
finite (there&amp;#8217;s an absolute limit of allowed atoms in an erlang program; if that limit is surpassed
your program will crash) so you can&amp;#8217;t allow the user to pass whatever he wants (so if the &lt;tt class="docutils literal"&gt;order_by&lt;/tt&gt;
parameter does not contain one of the fields you declare here then no strings will be converted to&amp;nbsp;atoms).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="integrating-with-a-controller"&gt;
&lt;h2&gt;Integrating with a&amp;nbsp;controller&lt;/h2&gt;
&lt;p&gt;As an example let&amp;#8217;s see how the dynamic sort fields will be integrated with the phxcrd user_controller.
The query I&amp;#8217;d like to filter on is the following (see that everything I&amp;#8217;ll need is named using &lt;tt class="docutils literal"&gt;:as&lt;/tt&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;authority_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;UserPermission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user_id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Permission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:permission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;permission_id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;preload&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;authority&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;permissions&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To declare the sort fields I like to create a module attribute ending with &lt;tt class="docutils literal"&gt;sort_fields&lt;/tt&gt;, something like
&lt;tt class="docutils literal"&gt;&amp;#64;user_sort_fields&lt;/tt&gt; for example. Here&amp;#8217;s the sort fields I&amp;#8217;m going to use for&amp;nbsp;user_controller:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;@user_sort_fields&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
  &lt;span class="s2"&gt;&amp;quot;user__username&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;user__name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;user__last_login&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So it will only allow the &lt;tt class="docutils literal"&gt;user.username&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;user.name&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;user.last_login&lt;/tt&gt; fields for sorting.
I could easily sort by &lt;tt class="docutils literal"&gt;authority.name&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;permission.name&lt;/tt&gt; in a similar&amp;nbsp;fashion.&lt;/p&gt;
&lt;p&gt;Finally, here&amp;#8217;s the full code of the index&amp;nbsp;controller:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;changeset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nc"&gt;QueryFilterEx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_changeset_from_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;@user_filters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
    &lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;authority_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;

      &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;UserPermission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user_id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Permission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:permission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;permission_id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;preload&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;authority&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;permissions&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;QueryFilterEx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;@user_filters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;QueryFilterEx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_by_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;@user_sort_fields&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Repo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

  &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;index.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;users&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that this is exactly the
same as the controller I discussed in the dynamic filters article with the addition of the
&lt;tt class="docutils literal"&gt;QueryFilterEx.sort_by_params(params, &amp;#64;user_sort_fields)&lt;/tt&gt; pipe to do the&amp;nbsp;sorting.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-template"&gt;
&lt;h2&gt;The&amp;nbsp;template&lt;/h2&gt;
&lt;p&gt;The template for the user index action is also the same with a couple of minor changes: Instead of
using a static header for the table title I will use a link that will change the sorting&amp;nbsp;order:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;thead&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= link gettext(&amp;quot;Username&amp;quot;), to: create_order_url(@conn, &amp;quot;user__username&amp;quot;) %&amp;gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= link gettext(&amp;quot;Name&amp;quot;), to: create_order_url(@conn, &amp;quot;user__name&amp;quot;) %&amp;gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;First name&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Last name&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Email&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Am / Am phxcrd&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Kind&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= link gettext(&amp;quot;Last login&amp;quot;), to: create_order_url(@conn, &amp;quot;user__last_login&amp;quot;) %&amp;gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Is enabled&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;thead&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that I just used the &lt;tt class="docutils literal"&gt;create_order_url&lt;/tt&gt; function passing it the &lt;tt class="docutils literal"&gt;&amp;#64;conn&lt;/tt&gt; and the
sort field. This &lt;tt class="docutils literal"&gt;create_order_url&lt;/tt&gt; function is implemented in a module I include in
all my views and will properly add an &lt;tt class="docutils literal"&gt;order_by=field&lt;/tt&gt; in the url (it will also add
an &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;order_by=-field&lt;/span&gt;&lt;/tt&gt; if the same header is clicked twice). I will explain it more
in the following&amp;nbsp;sections.&lt;/p&gt;
&lt;p&gt;Finally, please notice that if you use pagination and sorting you need to properly handle the &lt;tt class="docutils literal"&gt;order_by&lt;/tt&gt;
query parameter when creating the next-previous page links. Actually, there are three things
competing on their url parameter dominance; I&amp;#8217;d like to talk about that in the next&amp;nbsp;interlude.&lt;/p&gt;
&lt;div class="section" id="interlude-http-get-parameter-priority"&gt;
&lt;h3&gt;Interlude: &lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;GET&lt;/span&gt; parameter&amp;nbsp;priority&lt;/h3&gt;
&lt;p&gt;Now, in an index page you will probably have three things all of which will want to put parameters
to your urls to be&amp;nbsp;activated:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Query filtering; this will put a &lt;tt class="docutils literal"&gt;filter&lt;/tt&gt; query parameter to filter your query. Notice that because of how phoenix works (it allows maps in the query parameters) the filter can be a single query parameter but contain multiple filters (i.e the filter will be something like &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;%{&amp;quot;key1&amp;quot;&lt;/span&gt; =&amp;gt; &amp;quot;value1&amp;quot;, &amp;quot;key2&amp;quot; =&amp;gt; &amp;quot;value2&amp;quot;}&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Order by: This will put an &lt;tt class="docutils literal"&gt;order_by&lt;/tt&gt; query parameter to denote the field that the query will be&amp;nbsp;sorted&lt;/li&gt;
&lt;li&gt;Pagination: This will put an &lt;tt class="docutils literal"&gt;page&lt;/tt&gt; query parameter to denote the current&amp;nbsp;page&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I like to give them a priority in the order I&amp;#8217;ve listed them; when one of them is changed, it will
&lt;em&gt;clear&lt;/em&gt; the ones following it. So if the query filters are changed both the pagination and the order by
fields will be cleared, if the order by field is changed then only the pagination field will be cleared
but if the pagination field is changed both the query filters and the order by fields will be kept&amp;nbsp;there.&lt;/p&gt;
&lt;p&gt;I think that&amp;#8217;s the best way to do it from an &lt;span class="caps"&gt;UX&lt;/span&gt; point of view; try to think about it and you&amp;#8217;ll probably&amp;nbsp;agree.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="how-does-this-work"&gt;
&lt;h2&gt;How does this&amp;nbsp;work?&lt;/h2&gt;
&lt;p&gt;In this section I&amp;#8217;ll try to explain exactly how the dynamic sort fields&amp;nbsp;work.&lt;/p&gt;
&lt;p&gt;So I&amp;#8217;ll split this explanation in two parts: Explain &lt;tt class="docutils literal"&gt;create_order_url&lt;/tt&gt;
and then explain &lt;tt class="docutils literal"&gt;sort_by_params&lt;/tt&gt;.&lt;/p&gt;
&lt;div class="section" id="create-order-url"&gt;
&lt;h3&gt;&lt;tt class="docutils literal"&gt;create_order_url&lt;/tt&gt;&lt;/h3&gt;
&lt;p&gt;This function receives three parameters: The current &lt;tt class="docutils literal"&gt;&amp;#64;conn&lt;/tt&gt;, the name of a &lt;tt class="docutils literal"&gt;field&lt;/tt&gt; to
sort by and an optional list of query parameters that need to be kept while creating the
order by links. I&amp;#8217;ve put this function in a &lt;tt class="docutils literal"&gt;ViewHelpers&lt;/tt&gt; module that I am including to
all my views (by adding an &lt;tt class="docutils literal"&gt;import PhxcrdWeb.ViewHelpers&lt;/tt&gt; line to the &lt;tt class="docutils literal"&gt;PhxcrdWeb&lt;/tt&gt; module).&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s take a look at the&amp;nbsp;code:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;create_order_url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;allowed_keys&lt;/span&gt; &lt;span class="p"&gt;\\&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;filter&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="nc"&gt;Phoenix.Controller&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;current_url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;get_order_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;allowed_keys&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This doesn&amp;#8217;t do much, it just uses the phoenix&amp;#8217;s &lt;tt class="docutils literal"&gt;current_url&lt;/tt&gt; that generates a new
url to the current page, passing it a dictionary
of http get parameters that should be appended to the url that
are created through &lt;tt class="docutils literal"&gt;get_order_params&lt;/tt&gt;. Notice that there&amp;#8217;s an
&lt;tt class="docutils literal"&gt;allowed_keys&lt;/tt&gt; parameter that contains the query parameters that we need to keep after
the sorting (see the previous interlude).
By default I pass the &lt;tt class="docutils literal"&gt;filter&lt;/tt&gt; query parameter so if theres a filter (check
my previous article) it will keep it when sorting (but any pagination will be cleared;
if I sort by a new field I want to go to the first page there&amp;#8217;s no reason for me to keep
seeing the page I was on before changing the order&amp;nbsp;by).&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;get_order_params&lt;/tt&gt; receives the query parameters of the current connection (as a map),
the allowed keys I mentioned before and the actual name of the field to sort on. This method is a
little more&amp;nbsp;complex:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;defp&lt;/span&gt; &lt;span class="n"&gt;get_order_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;allowed_keys&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;order_key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;params&lt;/span&gt;
  &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;take&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;allowed_keys&lt;/span&gt; &lt;span class="o"&gt;++&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;order_by&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
  &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Enum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nc"&gt;String&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_atom&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
  &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="ss"&gt;:order_by&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;order_key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="ni"&gt;&amp;amp;1&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
      &lt;span class="s2"&gt;&amp;quot;-&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;order_key&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;order_key&lt;/span&gt;
      &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;order_key&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;order_key&lt;/span&gt;
      &lt;span class="bp"&gt;_&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;order_key&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It only keeps the parameters in the &lt;tt class="docutils literal"&gt;allowed_keys&lt;/tt&gt; list and the current &lt;tt class="docutils literal"&gt;order_by&lt;/tt&gt; parameter
(if there&amp;#8217;s one)  discarding everything else. It will then convert the keys of the map to atoms and
put them in a new map. Finally, it will update the &lt;tt class="docutils literal"&gt;order_by&lt;/tt&gt; field (if exists) either by
switching the &lt;tt class="docutils literal"&gt;-&lt;/tt&gt; in front of the field to declare asc/desc sorting or adding it for the field
that was clicked. Actually the logic of that &lt;tt class="docutils literal"&gt;Map.update&lt;/tt&gt; is the&amp;nbsp;following:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;If there&amp;#8217;s no &lt;tt class="docutils literal"&gt;:order_by&lt;/tt&gt; key then add it and assign the passed &lt;tt class="docutils literal"&gt;order_key&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;If the current value of &lt;tt class="docutils literal"&gt;:order_by&lt;/tt&gt; is equal to &lt;tt class="docutils literal"&gt;order_key&lt;/tt&gt; with or without a &lt;tt class="docutils literal"&gt;-&lt;/tt&gt; then toggle the &lt;tt class="docutils literal"&gt;-&lt;/tt&gt; (this happens when you click on a field that is already used for&amp;nbsp;sorting)&lt;/li&gt;
&lt;li&gt;If the current value of &lt;tt class="docutils literal"&gt;:order_by&lt;/tt&gt; is anything else (i.e not the same as the &lt;tt class="docutils literal"&gt;order_key&lt;/tt&gt;) then just change &lt;tt class="docutils literal"&gt;:order_by&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-orderKey&lt;/span&gt;&lt;/tt&gt; (this happens when there&amp;#8217;s sorting but you click on a different field, not the one used for the&amp;nbsp;sorting)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Notice that this juggling between map, list of keywords and then map again (using &lt;tt class="docutils literal"&gt;Enum.map&lt;/tt&gt; and then
&lt;tt class="docutils literal"&gt;Map.new&lt;/tt&gt; etc) is needed because
the query parameters are in a map with strings as keys form (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;%{&amp;quot;key&amp;quot;&lt;/span&gt; =&amp;gt; &amp;quot;value&amp;quot;}&lt;/tt&gt;) while
the &lt;tt class="docutils literal"&gt;current_url&lt;/tt&gt; function needs the query params in a map with atoms as keys form
(&lt;tt class="docutils literal"&gt;%{key: &amp;quot;value&amp;quot;}&lt;/tt&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="sort-by-params"&gt;
&lt;h3&gt;&lt;tt class="docutils literal"&gt;sort_by_params&lt;/tt&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;sort_by_params&lt;/tt&gt; method gets three parameters: The &lt;tt class="docutils literal"&gt;query&lt;/tt&gt; that will be sorted,
the existing http parameters map (so as to retrieve the &lt;tt class="docutils literal"&gt;order_by&lt;/tt&gt; value)
and the declared list of allowed sorting fields. Let&amp;#8217;s take a look at&amp;nbsp;it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;sort_by_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;order_by&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="n"&gt;allowed&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
  &lt;span class="ss"&gt;do&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;do_sort_by_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:asc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;allowed&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;sort_by_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;order_by&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="n"&gt;allowed&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
  &lt;span class="ss"&gt;do&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;do_sort_by_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:desc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;allowed&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;sort_by_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;_&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="ss"&gt;do&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This multi-legged function will only do something if there&amp;#8217;s an &lt;tt class="docutils literal"&gt;order_by&lt;/tt&gt; parameter in the http
parameters (else it will just return the query as is) and will call &lt;tt class="docutils literal"&gt;do_sort_by_params&lt;/tt&gt; passing
it the received query,
either &lt;tt class="docutils literal"&gt;:asc&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;:desc&lt;/tt&gt; (depending if there&amp;#8217;s a &lt;tt class="docutils literal"&gt;-&lt;/tt&gt; in front of the value) and the
received allowed fields&amp;nbsp;list.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;do_sort_by_params&lt;/tt&gt; makes sure that the passed parameter is in the allowed list
and if yes
it creates the atoms of the binding and field name (using &lt;tt class="docutils literal"&gt;String.to_atom&lt;/tt&gt;) and
does the actual sorting to the passed&amp;nbsp;query:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;defp&lt;/span&gt; &lt;span class="n"&gt;do_sort_by_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;allowed&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;allowed&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;String&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Enum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;String&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_atom&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;([{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt; &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;ord&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)}])&lt;/span&gt;
  &lt;span class="k"&gt;else&lt;/span&gt;
    &lt;span class="n"&gt;qs&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The line &lt;tt class="docutils literal"&gt;qs |&amp;gt; &lt;span class="pre"&gt;order_by([{^binding,&lt;/span&gt; &lt;span class="pre"&gt;t}],&lt;/span&gt; &lt;span class="pre"&gt;[{^ord,&lt;/span&gt; field(t, &lt;span class="pre"&gt;^name)}])&lt;/span&gt;&lt;/tt&gt; may seem a little
complex but it has been thoroughly explained in the previous&amp;nbsp;article.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;By using the methods described here you can easily add a dynamic sorting to your queries
through fields that may span relations just by creating a bunch of http &lt;span class="caps"&gt;GET&lt;/span&gt; links
and passing them an &lt;tt class="docutils literal"&gt;order_by&lt;/tt&gt; query&amp;nbsp;parameter.&lt;/p&gt;
&lt;/div&gt;
</content><category term="elixir"></category><category term="elixir"></category><category term="phoenix"></category><category term="ecto"></category><category term="queries"></category><category term="declarative"></category></entry><entry><title>How to properly handle an HTMLÂ form</title><link href="https://spapas.github.io/2019/10/03/html-form-submit-php/" rel="alternate"></link><published>2019-10-03T14:20:00+03:00</published><updated>2019-10-03T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2019-10-03:/2019/10/03/html-form-submit-php/</id><summary type="html">&lt;p class="first last"&gt;An introductory tutorial on how to properly handle a form. &lt;span class="caps"&gt;PHP&lt;/span&gt; is used for pedagogical&amp;nbsp;reasons.&lt;/p&gt;
</summary><content type="html">&lt;p&gt;One of the simplest things somebody would like to do in a web application is to display a form to the user and then handle the data the application
received from the form. This is a very common task however there are many loose ends and things that a new developer can do wrong. Recently, I tried
to explain this to somebody however I couldn&amp;#8217;t find a tutorial containing all the information I think it is important. So I decided to write it&amp;nbsp;here.&lt;/p&gt;
&lt;p&gt;To make it very easy to test it and understand it I decided to use &lt;span class="caps"&gt;PHP&lt;/span&gt; to handle the form submission. I must confess that I don&amp;#8217;t like &lt;span class="caps"&gt;PHP&lt;/span&gt; and I never
use it in production apps (unless I need to support an existing one). However, for such simple tasks and examples &lt;span class="caps"&gt;PHP&lt;/span&gt; is probably the easiest thing for
a new developer to understand: Just create a &lt;tt class="docutils literal"&gt;.php&lt;/tt&gt; file and put it in a folder in your apache &lt;tt class="docutils literal"&gt;htdocs&lt;/tt&gt;; there now you can test the&amp;nbsp;behavior!&lt;/p&gt;
&lt;p&gt;This tutorial will be as comprehensive as possible and will try to explain all things that I feel that need explaining. However I won&amp;#8217;t go into details
about &lt;span class="caps"&gt;HTML&lt;/span&gt; or &lt;span class="caps"&gt;PHP&lt;/span&gt; syntax; you&amp;#8217;ll need to know some things about them to understand what&amp;#8217;s going on here; after all the important thing is to understand
the big picture so you can re-implement them in your case (or understand why your web framework does what it&amp;nbsp;does).&lt;/p&gt;
&lt;div class="section" id="a-quick-http-primer"&gt;
&lt;h2&gt;A quick &lt;span class="caps"&gt;HTTP&lt;/span&gt;&amp;nbsp;primer&lt;/h2&gt;
&lt;p&gt;So, what happens during a form display and submission? To properly understand that you need to know what an &lt;span class="caps"&gt;HTTP&lt;/span&gt; request is. An &lt;span class="caps"&gt;HTTP&lt;/span&gt; request is the way
the browser &amp;#8220;requests&amp;#8221; a &lt;span class="caps"&gt;URL&lt;/span&gt; from a web server. This is thoroughly explained in the &lt;span class="caps"&gt;HTTP&lt;/span&gt; protocol however, for our purposes here it should suffice to say
that an &lt;span class="caps"&gt;HTTP&lt;/span&gt; request is a text message that is send from the browser/&lt;span class="caps"&gt;HTTP&lt;/span&gt; Client to the &lt;span class="caps"&gt;HTTP&lt;/span&gt;/web server. This message should have the following&amp;nbsp;format:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
METHOD PATH HTTP/VERSION
Header 1: Value 1
Header 2: Value 2

Request data
&lt;/pre&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;METHOD&lt;/span&gt;&lt;/tt&gt; can be one of various methods supported in the &lt;span class="caps"&gt;HTTP&lt;/span&gt; protocol like &lt;cite&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;, &lt;span class="caps"&gt;POST&lt;/span&gt;, &lt;span class="caps"&gt;PUT&lt;/span&gt;, &lt;span class="caps"&gt;OPTIONS&lt;/span&gt;&lt;/cite&gt; etc however the most popular and the ones we&amp;#8217;ll talk about here
are &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;PATH&lt;/span&gt;&lt;/tt&gt; is the actual url of the &amp;#8220;page&amp;#8221; you want to view without the server part. So if you are visiting &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;http://www.example.com/path/to/page.html&lt;/span&gt;&lt;/tt&gt;
the path parameter will have a value of &lt;tt class="docutils literal"&gt;/path/to/page.html&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;HTTP&lt;/span&gt;/&lt;span class="caps"&gt;VERSION&lt;/span&gt;&lt;/tt&gt; will contain the version of &lt;span class="caps"&gt;HTTP&lt;/span&gt; the client uses; usually it is something like
&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;HTTP&lt;/span&gt;/1.1&lt;/tt&gt;. Finally, after that first line there&amp;#8217;s a bunch of optional headers with various extra information the client wants to pass to the
server (for example what encoding it supports, what&amp;#8217;s the host it connects to&amp;nbsp;etc).&lt;/p&gt;
&lt;p&gt;Additionally, in case
of a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; request the headers are followed by a blank line which in turn is followed by a chunk of &amp;#8220;data&amp;#8221; that the client passes to the&amp;nbsp;server.&lt;/p&gt;
&lt;p&gt;The server will then response back with a text message similar to this (&lt;span class="caps"&gt;HTTP&lt;/span&gt;&amp;nbsp;Response):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
HTTP/VERSION STATUS
Header 1: Value 1
Header 2: Value 2

Response data
&lt;/pre&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;HTTP&lt;/span&gt;/&lt;span class="caps"&gt;VERSION&lt;/span&gt;&lt;/tt&gt; will also be something like &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;HTTP&lt;/span&gt;/1.1&lt;/tt&gt; while the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;STATUS&lt;/span&gt;&lt;/tt&gt; will be the status of the response. This status
is a 3-digit numeric value followed by a textual description of the
status. There are &lt;a class="reference external" href="https://httpstatuses.com/"&gt;various statuses that you can receive&lt;/a&gt;, however the statuses can be grouped by the number they start with like&amp;nbsp;this:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;1xx: Information; rarely&amp;nbsp;used&lt;/li&gt;
&lt;li&gt;2xx: Success; status 200 is the most common&amp;nbsp;one&lt;/li&gt;
&lt;li&gt;3xx: Redirection (browser must visit another page); either permanent or&amp;nbsp;temporary&lt;/li&gt;
&lt;li&gt;4xx: Client error; 404 is page not found (also access denied errors will be&amp;nbsp;40x)&lt;/li&gt;
&lt;li&gt;5xx: Server error; something fishy happened to the server while&amp;nbsp;responding&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In this article we&amp;#8217;ll mainly talk about 2xx and 3xx: A &lt;tt class="docutils literal"&gt;200 &lt;span class="caps"&gt;OK&lt;/span&gt;&lt;/tt&gt; answer is the most common one, it means that the &lt;span class="caps"&gt;HTTP&lt;/span&gt; request was
completed successfully. A &lt;tt class="docutils literal"&gt;302 &lt;span class="caps"&gt;FOUND&lt;/span&gt;&lt;/tt&gt; request means that the browser should display a &amp;#8220;different&amp;#8221; path; that path will be provided in
a &lt;tt class="docutils literal"&gt;Location: path&lt;/tt&gt; header. When the browser receives a redirect it will do another &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; request to retrieve the redirect to&amp;nbsp;page.&lt;/p&gt;
&lt;p&gt;Notice that the Headers and Data parts of the server reply may also be optional like for the client however they usually exist
(especially with a 200 response; without the data the client won&amp;#8217;t have anything to&amp;nbsp;display).&lt;/p&gt;
&lt;p&gt;So when a browser &amp;#8220;requests&amp;#8221; a page it will send an &lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; to the path. This happens all the time when we visit(click) links or entering
urls to our browser. However, when we submit an &lt;span class="caps"&gt;HTML&lt;/span&gt; form the situation is a little more&amp;nbsp;complex.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="form-methods"&gt;
&lt;h2&gt;Form&amp;nbsp;methods&lt;/h2&gt;
&lt;p&gt;An html form is a &lt;tt class="docutils literal"&gt;&amp;lt;form&amp;gt;&lt;/tt&gt; tag that contains a bunch of &lt;tt class="docutils literal"&gt;&amp;lt;input&amp;gt;&lt;/tt&gt; elements each one of which should have &lt;em&gt;at least&lt;/em&gt; a name property.
One of the inputs will usually be is a submit&amp;nbsp;button.&lt;/p&gt;
&lt;p&gt;Also, the form tag has two important&amp;nbsp;attributes:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;action&lt;/tt&gt;: Defines the url where the post will be submitted to; it can be omitted to submit the form to the current&amp;nbsp;path&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;method&lt;/tt&gt;: Will be either &lt;span class="caps"&gt;GET&lt;/span&gt; or &lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Thus, a sample form is something&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;form&lt;/span&gt; &lt;span class="na"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;GET&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;action&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;form.php&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;input&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;text&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;input1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;input&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;text&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;input2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;input&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;submit&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;form&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So what are the differences between a &lt;tt class="docutils literal"&gt;&amp;lt;form &lt;span class="pre"&gt;method='&lt;span class="caps"&gt;GET&lt;/span&gt;'&amp;gt;&lt;/span&gt;&lt;/tt&gt; and a &lt;tt class="docutils literal"&gt;&amp;lt;form &lt;span class="pre"&gt;method='&lt;span class="caps"&gt;POST&lt;/span&gt;'&amp;gt;&lt;/span&gt;&lt;/tt&gt;?&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Submitting an &lt;span class="caps"&gt;HTML&lt;/span&gt; form will translate to either an &lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;GET&lt;/span&gt; request or an &lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;POST&lt;/span&gt; request to the server depending on the method&amp;nbsp;attribute&lt;/li&gt;
&lt;li&gt;The data of a &lt;span class="caps"&gt;GET&lt;/span&gt; form will be encoded in the &lt;span class="caps"&gt;PATH&lt;/span&gt; of the &lt;span class="caps"&gt;HTTP&lt;/span&gt; request while the data of the &lt;span class="caps"&gt;POST&lt;/span&gt; form will be in the corresponding data part of the &lt;span class="caps"&gt;HTTP&lt;/span&gt;&amp;nbsp;Request&lt;/li&gt;
&lt;li&gt;A form that is submitted with &lt;span class="caps"&gt;GET&lt;/span&gt; should be idempotent i.e it should &lt;em&gt;not&lt;/em&gt; modify anything in the server; a form that is submitted with &lt;span class="caps"&gt;POST&lt;/span&gt; should modify something the&amp;nbsp;server&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, the form we defined previously (that has a &lt;span class="caps"&gt;GET&lt;/span&gt; method) will issue the following &lt;span class="caps"&gt;HTTP&lt;/span&gt; request (if we fill the values value1 and value2 to the&amp;nbsp;inputs):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
GET /form.php?input1=value1&amp;amp;input2=value2 HTTP/1.1
&lt;/pre&gt;
&lt;p&gt;One the other hand if the form had a &lt;span class="caps"&gt;POST&lt;/span&gt; method the &lt;span class="caps"&gt;HTTP&lt;/span&gt; request would be like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
POST /form.php HTTP/1.1

input1=value1&amp;amp;input2=value2
&lt;/pre&gt;
&lt;p&gt;Notice that in the first case the data is in the &lt;span class="caps"&gt;PATH&lt;/span&gt; in the 1st line of the request while in the second case it is passed in the data section.
Also, in both cases the encoded data of the form is similar to &lt;tt class="docutils literal"&gt;input1=value1&amp;amp;input2=value2&lt;/tt&gt;: it is a list of &lt;tt class="docutils literal"&gt;key=value&lt;/tt&gt; pairs seperated
with &lt;tt class="docutils literal"&gt;&amp;amp;&lt;/tt&gt; where the &lt;tt class="docutils literal"&gt;name&lt;/tt&gt; attribute of each &lt;tt class="docutils literal"&gt;input&lt;/tt&gt; is used as the&amp;nbsp;key.&lt;/p&gt;
&lt;p&gt;Concerning the idempotency of the action; this is not something that the &lt;span class="caps"&gt;HTTP&lt;/span&gt; protocol can enforce but it relies on the developer to implement it.
When a form will not change anything to the server then it should be implemented as a method=&lt;span class="caps"&gt;GET&lt;/span&gt;. For example when you have a form with a search
box that just returns some results. On the other hand, when a form does change things for example when you create a new item in an application
then it should be implemented as a method=&lt;span class="caps"&gt;POST&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The browser has a different behavior after a &lt;span class="caps"&gt;GET&lt;/span&gt; vs after a &lt;span class="caps"&gt;POST&lt;/span&gt; because it expects that when you do a &lt;span class="caps"&gt;GET&lt;/span&gt; request then it won&amp;#8217;t matter if that
request is repeated many times. One the other hand, the browser will try to prevent you from submitting a request many times (because something is
changed in the server so the user must do it intentionally by for example pressing a button to submit the&amp;nbsp;form).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="proper-form-handling"&gt;
&lt;h2&gt;Proper form&amp;nbsp;handling&lt;/h2&gt;
&lt;p&gt;So, following the previous section we can now explain how to handle a form&amp;nbsp;properly:&lt;/p&gt;
&lt;p&gt;For a &lt;span class="caps"&gt;GET&lt;/span&gt; form we don&amp;#8217;t have to do anything fancy; we just retrieve the parameter values and we display the data these parameters correspond to
just like if we displayed any other&amp;nbsp;page.&lt;/p&gt;
&lt;p&gt;For a &lt;span class="caps"&gt;POST&lt;/span&gt; form however we need to be extra careful as to avoid re-duplication of data and have a good user experience: When a &lt;span class="caps"&gt;POST&lt;/span&gt; form is
submitted we need first to make sure that the submitted parameters are valid (for example there are no missing required fields). If the form is not
valid then we will return a status 200 &lt;span class="caps"&gt;OK&lt;/span&gt; explaining to the user what went wrong; we usually return the same page containing the initial form with
the fields that had errors&amp;nbsp;marked.&lt;/p&gt;
&lt;p&gt;On the other hand, if the form &lt;em&gt;was valid&lt;/em&gt; we need to do the actual action that the form corresponds to; for example insert something to the database.
After this is finished we should return a &lt;em&gt;redirect&lt;/em&gt; (302) to either a different or even the same page. This will result to the browsing doing a
&lt;span class="caps"&gt;GET&lt;/span&gt; request to the page we redirect to so there would be no danger of the user refreshing the page and resubmitting the form. We should &lt;em&gt;not&lt;/em&gt;
return a 200 &lt;span class="caps"&gt;OK&lt;/span&gt; after a &lt;span class="caps"&gt;POST&lt;/span&gt; request because then the user would be able to press F5 to duplicate the previous &lt;span class="caps"&gt;POST&lt;/span&gt; request (and re-insert the&amp;nbsp;data).&lt;/p&gt;
&lt;p&gt;One extra thing that we need to consider is how should we inform the user that his action was successful after the form submission and
redirection? As we said, we can&amp;#8217;t return a 200 &lt;span class="caps"&gt;OK&lt;/span&gt; message so we can&amp;#8217;t really &amp;#8220;create&amp;#8221; the response, we instead need to redirect to another page.
A common practice for this is to use a &amp;#8220;flash&amp;#8221; message; this is offered by many web frameworks through specific functions
but can be easily implemented. I&amp;#8217;ll explain how in the next&amp;nbsp;section.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="implementing-flash-messages"&gt;
&lt;h2&gt;Implementing flash&amp;nbsp;messages&lt;/h2&gt;
&lt;p&gt;Before talking about the flash message I&amp;#8217;d like to quickly explain what&amp;#8217;s a cookie and a browser session in &lt;span class="caps"&gt;HTTP&lt;/span&gt;, because
the flash message builds upon these&amp;nbsp;concepts:&lt;/p&gt;
&lt;p&gt;A cookie is a way for the server to tell the client to store some information to be re-used later. What happens is that
the server returns an &lt;span class="caps"&gt;HTTP&lt;/span&gt; header line similar to &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;Set-Cookie:&lt;/span&gt; &lt;span class="pre"&gt;cookie-name=cookie-value&lt;/span&gt;&lt;/tt&gt;. When the client receives that
header line it will pass an &lt;span class="caps"&gt;HTTP&lt;/span&gt; header line similar to &lt;tt class="docutils literal"&gt;Cookie:&amp;nbsp; &lt;span class="pre"&gt;cookie-name=cookie-value&lt;/span&gt;&lt;/tt&gt; to all future requests
so the server will know which value it had send to the client (there are various options for expiring cookies etc but they
are not important here). This may seem like a primitive solution however because &lt;span class="caps"&gt;HTTP&lt;/span&gt; is a stateless protocol
that&amp;#8217;s the only way for the server to store information about a client. If you disable cookies completely in a browser
then there won&amp;#8217;t be a way for the server to remember you, for example you won&amp;#8217;t be able to login&amp;nbsp;anywhere!&lt;/p&gt;
&lt;p&gt;A session is a better way to store info about the client that builds upon the cookies. What happens is that when a client visits
a site for the first time (so it has no cookies for that particular site) the server will send back a cookie named &lt;tt class="docutils literal"&gt;session_id&lt;/tt&gt; (or something like
that) containing a very big random number. The server will save this session id number in a persistent storage (for example in a
database or a text file) and will correlate that number with information for that particular client. When the client sends back that
&lt;tt class="docutils literal"&gt;session_id&lt;/tt&gt; cookie the server will fetch the correlated info for that particular client from the persistent storage (and may
update them etc). This way the server can store whatever info it wants about a particular client. The server usually keeps a
a dictionary (map) of key-values for each&amp;nbsp;session.&lt;/p&gt;
&lt;p&gt;Now, a flash message is some information (message) that should be displayed to the user &lt;em&gt;once&lt;/em&gt;. For example a message like
&amp;#8220;Your form has been&amp;nbsp;submitted!&amp;#8221;.&lt;/p&gt;
&lt;p&gt;A simple way to implement this is to add a &lt;tt class="docutils literal"&gt;message&lt;/tt&gt;
attribute to the session when you want to display the flash message. The next page that is displayed (irrelevantly if there&amp;#8217;s a redirect involved)
will check to see if there&amp;#8217;s a &lt;tt class="docutils literal"&gt;message&lt;/tt&gt; attribute to the session; if yes it will display the actual message and remove the &lt;tt class="docutils literal"&gt;message&lt;/tt&gt; attribute
from the session (so it won&amp;#8217;t be displayed&amp;nbsp;again).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="implementing-the-form-submission"&gt;
&lt;h2&gt;Implementing the form&amp;nbsp;submission&lt;/h2&gt;
&lt;p&gt;Following the above guidelines I&amp;#8217;ll present here a typical, production-ready form submission for &lt;span class="caps"&gt;PHP&lt;/span&gt;. Some choices I&amp;#8217;ve&amp;nbsp;made:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;I am going to implement a &lt;span class="caps"&gt;POST&lt;/span&gt; form since a &lt;span class="caps"&gt;GET&lt;/span&gt; form doesn&amp;#8217;t need any special&amp;nbsp;handling&lt;/li&gt;
&lt;li&gt;The form handler will be the same &lt;span class="caps"&gt;PHP&lt;/span&gt; page as the one displaying the form. This is a usual thing to do, you check the &lt;span class="caps"&gt;HTTP&lt;/span&gt; method and either display the form as-is (if it is &lt;span class="caps"&gt;GET&lt;/span&gt;) or handle the submission (if it is &lt;span class="caps"&gt;POST&lt;/span&gt;)&lt;/li&gt;
&lt;li&gt;When the form is submitted successfully redirect to the same page and display a flash&amp;nbsp;message&lt;/li&gt;
&lt;li&gt;Check for valid input and display the error&amp;nbsp;message&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So without further ado here&amp;#8217;s the complete php code that will submit your form; store it in a file named &lt;tt class="docutils literal"&gt;test.php&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;&amp;lt;!DOCTYPE HTML&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;html&amp;gt;&lt;/span&gt;

&lt;span class="x"&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;  &amp;lt;meta charset=&amp;quot;UTF-8&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;  &amp;lt;meta name=&amp;quot;viewport&amp;quot; content=&amp;quot;width=device-width, initial-scale=1.0&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;  &amp;lt;meta http-equiv=&amp;quot;X-UA-Compatible&amp;quot; content=&amp;quot;ie=edge&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;  &amp;lt;title&amp;gt;TEST FORM&amp;lt;/title&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;  &amp;lt;link href=&amp;quot;https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css&amp;quot; rel=&amp;quot;stylesheet&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;

&lt;span class="x"&gt;&amp;lt;body class=&amp;quot;bg-gray-100&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;  &amp;lt;div class=&amp;quot;px-8 py-8 w-1/2 m-auto&amp;quot;&amp;gt;&lt;/span&gt;

&lt;span class="x"&gt;    &lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;?php&lt;/span&gt;
    &lt;span class="nb"&gt;session_start&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_SESSION&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;??&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;echo&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;lt;div class=&amp;quot;rounded bg-green-300 px-2 py-2&amp;quot;&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="nv"&gt;$_SESSION&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;/div&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="nb"&gt;unset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_SESSION&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nv"&gt;$nameErr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$wsErr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$comment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nv"&gt;$formValid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_SERVER&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;REQUEST_METHOD&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;POST&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_POST&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nv"&gt;$nameErr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Name is required&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nv"&gt;$formValid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nv"&gt;$name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$_POST&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;

      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;empty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$_POST&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;comment&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nv"&gt;$comment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nv"&gt;$comment&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$_POST&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;comment&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;

      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;$formValid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;rand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
          &lt;span class="nv"&gt;$_SESSION&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Success! You have submitted the values: &amp;lt;b&amp;gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nv"&gt;$name&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; / &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nv"&gt;$comment&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;/b&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
          &lt;span class="nb"&gt;header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Location: ./test.php&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
          &lt;span class="k"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
          &lt;span class="nv"&gt;$wsErr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Error while trying to submit the form!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="cp"&gt;?&amp;gt;&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;    &amp;lt;h1 class=&amp;quot;text-4xl font-bold text-indigo-500&amp;quot;&amp;gt;Test a PHP form!&amp;lt;/h1&amp;gt;&lt;/span&gt;

&lt;span class="x"&gt;    &amp;lt;form class=&amp;#39;border border-blue-800 rounded p-2&amp;#39; method=&amp;quot;POST&amp;quot;&amp;gt;&lt;/span&gt;

&lt;span class="x"&gt;      &lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;?&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$wsErr&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;div class=&amp;#39;text-red-600 py-3&amp;#39;&amp;gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="nv"&gt;$wsErr&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;/div&amp;gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="cp"&gt;?&amp;gt;&lt;/span&gt;&lt;span class="x"&gt;&lt;/span&gt;

&lt;span class="x"&gt;      &amp;lt;div class=&amp;quot;p-1&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;        &amp;lt;label for=&amp;quot;name&amp;quot;&amp;gt;Name:&amp;lt;/label&amp;gt; &amp;lt;input class=&amp;quot;border border-blue-800 rounded&amp;quot; id=&amp;quot;name&amp;quot; type=&amp;quot;text&amp;quot; name=&amp;quot;name&amp;quot; value=&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;?&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$name&lt;/span&gt; &lt;span class="cp"&gt;?&amp;gt;&lt;/span&gt;&lt;span class="x"&gt;&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;        &amp;lt;span class=&amp;quot;text-red-600&amp;quot;&amp;gt;* &lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;?&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$nameErr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="cp"&gt;?&amp;gt;&lt;/span&gt;&lt;span class="x"&gt;&amp;lt;/span&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;      &amp;lt;/div&amp;gt;&lt;/span&gt;

&lt;span class="x"&gt;      &amp;lt;div class=&amp;quot;p-1&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;        &amp;lt;label for=&amp;quot;comment&amp;quot;&amp;gt;Comment:&amp;lt;/label&amp;gt; &amp;lt;textarea class=&amp;quot;border border-blue-800 rounded&amp;quot; id=&amp;quot;comment&amp;quot; name=&amp;quot;comment&amp;quot; rows=&amp;quot;5&amp;quot; cols=&amp;quot;40&amp;quot;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;?&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nv"&gt;$comment&lt;/span&gt; &lt;span class="cp"&gt;?&amp;gt;&lt;/span&gt;&lt;span class="x"&gt;&amp;lt;/textarea&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;      &amp;lt;/div&amp;gt;&lt;/span&gt;

&lt;span class="x"&gt;      &amp;lt;input class=&amp;quot;rounded px-2 my-4 py-2 bg-blue-800 text-gray-100&amp;quot; type=&amp;quot;submit&amp;quot; name=&amp;quot;submit&amp;quot; value=&amp;quot;Save&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;    &amp;lt;/form&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;  &amp;lt;/div&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class="x"&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So how is that working? As we can see there&amp;#8217;s the php code first and the html is following (with some sprinkles of php). The &lt;span class="caps"&gt;HTML&lt;/span&gt; code is rather simple: It will
display a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; form with two inputs named &lt;tt class="docutils literal"&gt;name&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;comment&lt;/tt&gt;. Notice that we pass the &lt;tt class="docutils literal"&gt;$name&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;$comment&lt;/tt&gt; php variables as their values.
It also has a submit button and will display the &lt;tt class="docutils literal"&gt;$wsErr&lt;/tt&gt; variable if it is not null (which means that there was an error while submitting the data). The &lt;span class="caps"&gt;PHP&lt;/span&gt;
code now first starts the session (i.e it passes the &lt;tt class="docutils literal"&gt;session_id&lt;/tt&gt; cookie to the client if such a cookie does not exist) checks to see if there&amp;#8217;s a
&lt;tt class="docutils literal"&gt;message&lt;/tt&gt; attribute to the session. If such a message exists it will display it in a rounded green panel and remove that from the session (so it won&amp;#8217;t be displayed
again next&amp;nbsp;time):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;session_start();&lt;/span&gt;
&lt;span class="x"&gt;if ($_SESSION[&amp;#39;message&amp;#39;] ?? &amp;#39;&amp;#39;) {&lt;/span&gt;
&lt;span class="x"&gt;  echo &amp;#39;&amp;lt;div class=&amp;quot;rounded bg-green-300 px-2 py-2&amp;quot;&amp;gt;&amp;#39;.$_SESSION[&amp;#39;message&amp;#39;].&amp;#39;&amp;lt;/div&amp;gt;&amp;#39;;&lt;/span&gt;
&lt;span class="x"&gt;  unset($_SESSION[&amp;#39;message&amp;#39;]);&lt;/span&gt;
&lt;span class="x"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;After that there are some variable initializations and we check if the &lt;span class="caps"&gt;HTTP&lt;/span&gt; request is &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; (if the request is &lt;span class="caps"&gt;GET&lt;/span&gt; we&amp;#8217;ll just disply the &lt;span class="caps"&gt;HTML&lt;/span&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;if ($_SERVER[&amp;quot;REQUEST_METHOD&amp;quot;] == &amp;quot;POST&amp;quot;) {&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For each of the inputs we check if they are empty or not and assign their values to the corresponding php variable. If the name is empty then we&amp;#8217;ll
set &lt;tt class="docutils literal"&gt;$formValid = false;&lt;/tt&gt; and add an error message since this field is required. Then, if &lt;tt class="docutils literal"&gt;$formValid&lt;/tt&gt; is not false we can do the actual action
(for example write to the database). I&amp;#8217;ve simulated that using a coin-toss with rand (so there&amp;#8217;s a 50% possibility that the action will fail). If
the action &amp;#8220;failed&amp;#8221; then nothing happened in the database so we should return the same page with the &lt;tt class="docutils literal"&gt;wsErr&lt;/tt&gt; variable containing the&amp;nbsp;error.&lt;/p&gt;
&lt;p&gt;However if the action is successful that means that the data has been inserted to the database so we&amp;#8217;ll need to set the flash message and do
the redirect (the name of the page containing the form is &lt;tt class="docutils literal"&gt;/test.php&lt;/tt&gt; so we&amp;#8217;ll redirect to&amp;nbsp;it):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;$_SESSION[&amp;#39;message&amp;#39;] = &amp;quot;Success! You have submitted the values: &amp;lt;b&amp;gt;&amp;quot; . $name . &amp;quot; / &amp;quot; . $comment . &amp;quot;&amp;lt;/b&amp;gt;&amp;quot;;&lt;/span&gt;
&lt;span class="x"&gt;header(&amp;#39;Location: ./test.php&amp;#39;);&lt;/span&gt;
&lt;span class="x"&gt;exit();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The two commands above (&lt;tt class="docutils literal"&gt;header&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;exit&lt;/tt&gt;) will do the actual redirect in php. Since the session contains the &lt;tt class="docutils literal"&gt;message&lt;/tt&gt; it will
be displayed after the redirect has&amp;nbsp;finished!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;So following the above tutorial, here&amp;#8217;s what you should absolutely do to submit an &lt;span class="caps"&gt;HTML&lt;/span&gt;&amp;nbsp;form:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Use &lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;POST&lt;/span&gt; if the form is going to change data on the server; use &lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;GET&lt;/span&gt; otherwise (mainly for search/filter&amp;nbsp;forms)&lt;/li&gt;
&lt;li&gt;When using &lt;span class="caps"&gt;POST&lt;/span&gt;: Redirect when the form is valid and the action on the server has finished successfully; never return a 200 &lt;span class="caps"&gt;OK&lt;/span&gt; status when you&amp;#8217;ve changed things in the server&amp;nbsp;(database)&lt;/li&gt;
&lt;li&gt;Use flash messages to pass information to the user after a&amp;nbsp;redirect&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</content><category term="html"></category><category term="html"></category><category term="form"></category><category term="php"></category></entry><entry><title>Declarative Ecto queryÂ filters</title><link href="https://spapas.github.io/2019/07/25/declarative-ecto-query-filters/" rel="alternate"></link><published>2019-07-25T14:20:00+03:00</published><updated>2019-07-25T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2019-07-25:/2019/07/25/declarative-ecto-query-filters/</id><summary type="html">&lt;p class="first last"&gt;Being able to declare your Ecto query filter even on fields spanning&amp;nbsp;joins&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Continuing my Elixir &lt;a class="reference external" href="https://spapas.github.io/2019/06/04/phoenix-form-select2-ajax/"&gt;journey&lt;/a&gt; I&amp;#8217;d like to discuss here a method to implement one of my
&lt;a class="reference external" href="https://spapas.github.io/2017/10/11/essential-django-packages/"&gt;favorite Django features&lt;/a&gt;: Declarative query filters. This functionality is not a core Django
feature but it is offered
through the excellent &lt;a class="reference external" href="https://github.com/carltongibson/django-filter/:"&gt;django-filter&lt;/a&gt; package: Using this, you can create a &lt;tt class="docutils literal"&gt;Filter&lt;/tt&gt; class which defines
which fields are to be used for filtering the queryset and how each field will be queried (i.e using
things like exact, like, year of date&amp;nbsp;etc).&lt;/p&gt;
&lt;p&gt;This is a functionality I am greatly missing in Elixir/phoenix
so I&amp;#8217;ve tried implementing it on my own. Of course, django-filter has various other capabilities that
result from the implicit generation of things that Django offers like automatically creating the html
for the declared fields, automatically declare the fields based on their types etc but such things are
not supported by phoenix in any case so I won&amp;#8217;t be trying in them&amp;nbsp;here.&lt;/p&gt;
&lt;p&gt;During my research I&amp;#8217;ve seen a bunch of blog posts or packages about this thing however they didn&amp;#8217;t
properly support joins (i.e you could only filter on fields on a specific schema) or needed too much
work to filter on joins (i.e define different filters for each part of the join). In the solution
I&amp;#8217;ll present here you&amp;#8217;ll just define a filter for the specific query you need to filter no matter how
many joins it has (just like in&amp;nbsp;django-filters).&lt;/p&gt;
&lt;div class="section" id="what-will-it-do"&gt;
&lt;h2&gt;What will it&amp;nbsp;do&lt;/h2&gt;
&lt;p&gt;The solution is more or less a self contained Elixir module named &lt;tt class="docutils literal"&gt;QueryFilterEx&lt;/tt&gt; that can be used
to declaratively filter your queries.
To use that you&amp;#8217;ll need to declare your filters using
a simple array of maps. The filters should then be added in your form using a different input
for each filter; then your queryset will be filtered with all the values you&amp;#8217;ve added to the
inputs using &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;AND&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The module has a very simple &lt;span class="caps"&gt;API&lt;/span&gt; consisting of three&amp;nbsp;functions:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;get_changeset_from_params(params, filters)&lt;/tt&gt;: Pass it the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; request parameters you got from your form and the declared filters array to return you a proper changeset (which you can then use to build your form in your&amp;nbsp;html)&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;make_filter_changeset(filters, params)&lt;/tt&gt;: This function actually generates the changeset using the filters and a &lt;tt class="docutils literal"&gt;Map&lt;/tt&gt; of &lt;tt class="docutils literal"&gt;filter_name: value&lt;/tt&gt; pairs (it is actually used by &lt;tt class="docutils literal"&gt;get_changeset_from_params&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;filter(query, changeset, filters)&lt;/tt&gt;: Filter the &lt;tt class="docutils literal"&gt;query&lt;/tt&gt; using the previously created &lt;tt class="docutils literal"&gt;changeset&lt;/tt&gt; and the declared filters&amp;nbsp;array&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You can find a sample of the technique presented in this article in my &lt;span class="caps"&gt;PHXCRD&lt;/span&gt; repository:
&lt;a class="reference external" href="https://github.com/spapas/phxcrd"&gt;https://github.com/spapas/phxcrd&lt;/a&gt;  for example in the &lt;tt class="docutils literal"&gt;user_controller&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;authority_controller&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="preparing-the-query"&gt;
&lt;h2&gt;Preparing the&amp;nbsp;query&lt;/h2&gt;
&lt;p&gt;In order to use the &lt;tt class="docutils literal"&gt;QueryFilterEx&lt;/tt&gt; module you&amp;#8217;ll need to properly &amp;#8220;prepare&amp;#8221; your Ecto query. By preparing
I don&amp;#8217;t mean a big deal just the fact that you&amp;#8217;ll need to &lt;em&gt;name all your relations&lt;/em&gt;  (or at least name all
the relations you&amp;#8217;re going to use for filtering). This is very simple to do, for example for the following&amp;nbsp;query:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ak&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;AuthorityKind&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;authority_kind_id&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
  &lt;span class="ss"&gt;preload&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;authority_kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ak&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;you can name the relations by adding two &lt;tt class="docutils literal"&gt;as:&lt;/tt&gt; atoms like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ak&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;AuthorityKind&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:authority_kind&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;authority_kind_id&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
  &lt;span class="ss"&gt;preload&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;authority_kind&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ak&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So after each &lt;cite&gt;join:&lt;/cite&gt; you&amp;#8217;ll add a name for your joined relation (and also add a name for your initial
relation). Please notice that you can use any name you want for these (not related to the schema&amp;nbsp;names).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="declaring-the-filters"&gt;
&lt;h2&gt;Declaring the&amp;nbsp;filters&lt;/h2&gt;
&lt;p&gt;To declare the filters you&amp;#8217;ll just add an array of simple Elixir maps. Each map must have the following&amp;nbsp;fields:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;:name&lt;/tt&gt; This is the name of the specific filter; it is mainly used in conjunction with the queryset and the form fields to set initial values&amp;nbsp;etc&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;:type&lt;/tt&gt; This is the type of the specific filter; it should be a proper Ecto type like &lt;tt class="docutils literal"&gt;:string&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;:date&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;:integer&lt;/tt&gt; etc. This is needed to properly cast the values and catch&amp;nbsp;errors&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;:binding&lt;/tt&gt; This is the name of the relation this filter concerns which you defined in your query using &lt;tt class="docutils literal"&gt;:as&lt;/tt&gt; (discussed in previous&amp;nbsp;section)&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;:field_name&lt;/tt&gt; This is the actual name of the field you want to filter&amp;nbsp;on&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;:method&lt;/tt&gt; How to filter on this field; I&amp;#8217;ve defined a couple of methods I needed but you can implement anything you&amp;nbsp;want&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The methods I&amp;#8217;ve implemented are the&amp;nbsp;following:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;:eq&lt;/tt&gt; Equality&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;:ilike&lt;/tt&gt; Field value starts with the input - ignore&amp;nbsp;case&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;:icontains&lt;/tt&gt; Field value contains the input - ignore&amp;nbsp;case&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;:year&lt;/tt&gt; Field is a date or datetime an its year is the same as the&amp;nbsp;value&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;:date&lt;/tt&gt; Field is a datetime and its date part is equal to the&amp;nbsp;value&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Anything else will just be compared using &lt;tt class="docutils literal"&gt;=&lt;/tt&gt; (same as &lt;tt class="docutils literal"&gt;:eq&lt;/tt&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="integrating-it-with-a-controller"&gt;
&lt;h2&gt;Integrating it with a&amp;nbsp;controller&lt;/h2&gt;
&lt;p&gt;As an example let&amp;#8217;s see how &lt;tt class="docutils literal"&gt;QueryFilterEx&lt;/tt&gt; is integrated it with the phxcrd user_controller.
The query I&amp;#8217;d like to filter on is the following (see that everything I&amp;#8217;ll need is named using &lt;tt class="docutils literal"&gt;:as&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;authority_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;UserPermission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user_id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Permission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:permission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;permission_id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="ss"&gt;preload&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;authority&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;permissions&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To declare the filters I like to create a module attribute ending with &lt;tt class="docutils literal"&gt;filters&lt;/tt&gt;, something like
&lt;tt class="docutils literal"&gt;&amp;#64;user_filters&lt;/tt&gt; for example. Here&amp;#8217;s the filters I&amp;#8217;m going to use for&amp;nbsp;user_controller:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="na"&gt;@user_filters&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
  &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="ss"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;method&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:ilike&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="ss"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:authority_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;method&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:icontains&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="ss"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:permission_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:permission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;method&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:ilike&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="ss"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:last_login_date&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;type&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:date&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:last_login&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;method&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:date&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So it will check if the &lt;tt class="docutils literal"&gt;user.username&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;permission.name&lt;/tt&gt; start with the passed value,
&lt;tt class="docutils literal"&gt;authority.name&lt;/tt&gt; contains the passed value and if the &lt;tt class="docutils literal"&gt;user.login_date&lt;/tt&gt; (which is a datetime)
is the same as the passed date&amp;nbsp;value.&lt;/p&gt;
&lt;p&gt;Finally, here&amp;#8217;s the full code of the index&amp;nbsp;controller:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;changeset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nc"&gt;QueryFilterEx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_changeset_from_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;@user_filters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
    &lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;authority_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;

      &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;UserPermission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user_id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;left_join&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Permission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:permission&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;on&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;up&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;permission_id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;preload&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;authority&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;permissions&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;QueryFilterEx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="na"&gt;@user_filters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Repo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

  &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;index.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;users&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;users&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It is very simple, it just uses the &lt;tt class="docutils literal"&gt;get_changeset_from_params&lt;/tt&gt; method I discussed before to
generate the changeset and then uses it to filter the query. Also please notice that it passes
the changeset to the template to be properly rendered in the filter&amp;nbsp;form.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-template"&gt;
&lt;h2&gt;The&amp;nbsp;template&lt;/h2&gt;
&lt;p&gt;The template for the user index action is the&amp;nbsp;following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= form_for @changeset, AdminRoutes.user_path(@conn, :index), [method: :get, class: &amp;quot;filter-form&amp;quot;, as: :filter],  fn f -&amp;gt; %&amp;gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= label f, :username, gettext &amp;quot;Username&amp;quot; %&amp;gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= text_input f, :username  %&amp;gt;

  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= label f, :authority_name, gettext &amp;quot;Authority name&amp;quot; %&amp;gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= text_input f, :authority_name  %&amp;gt;

  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= label f, :permission_name, gettext &amp;quot;Permission name&amp;quot; %&amp;gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= text_input f, :permission_name  %&amp;gt;

  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= label f, :last_login_date, gettext &amp;quot;Last login date&amp;quot; %&amp;gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= text_input f, :last_login_date  %&amp;gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= error_tag f, :last_login_date %&amp;gt;

  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= submit gettext(&amp;quot;Filter&amp;quot;), class: &amp;quot;ml-5&amp;quot; %&amp;gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= link gettext(&amp;quot;Reset&amp;quot;), to: AdminRoutes.user_path(@conn, :index), class: &amp;quot;button button-outline ml-2&amp;quot; %&amp;gt;
&lt;span class="err"&gt;&amp;lt;&lt;/span&gt;% end %&amp;gt;
&lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= for user &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="na"&gt;users&lt;/span&gt; &lt;span class="na"&gt;do&lt;/span&gt; &lt;span class="err"&gt;%&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;&amp;lt;!-- display the user info --&amp;gt;&lt;/span&gt;
&lt;span class="err"&gt;&amp;lt;&lt;/span&gt;% end %&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that it gets the &lt;tt class="docutils literal"&gt;&amp;#64;changeset&lt;/tt&gt; and uses it to properly fill the initial values and display
error messages. For this case I&amp;#8217;ve only added an error_tag for the &lt;tt class="docutils literal"&gt;:last_login_date&lt;/tt&gt; field,
the others since are strings do not really need it since they will accept all&amp;nbsp;values.&lt;/p&gt;
&lt;p&gt;Also, the form method  form must be &lt;tt class="docutils literal"&gt;:get&lt;/tt&gt; since we only filter (not change anything) and I&amp;#8217;ve passed
the &lt;tt class="docutils literal"&gt;as: :filter&lt;/tt&gt; option to the &lt;tt class="docutils literal"&gt;form_for&lt;/tt&gt; to collect the parameters under the &lt;tt class="docutils literal"&gt;filter&lt;/tt&gt; server side
parameter (this can be anything you want and can be optionally be
passed to &lt;tt class="docutils literal"&gt;QueryFilterEx.get_changeset_from_params&lt;/tt&gt; to know which parameter the filters are collected&amp;nbsp;on).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="how-does-this-work"&gt;
&lt;h2&gt;How does this&amp;nbsp;work?&lt;/h2&gt;
&lt;p&gt;In this section I&amp;#8217;ll try to explain exactly how the &lt;tt class="docutils literal"&gt;QueryFilterEx&lt;/tt&gt; module works. Before continuing
I want to thank the people at the &lt;a class="reference external" href="https://elixirforum.com/"&gt;Elixir forum&lt;/a&gt; and #elixir-lang Freenode &lt;span class="caps"&gt;IRC&lt;/span&gt; chat
that helped me with understanding how to be able to &lt;a class="reference external" href="https://elixirforum.com/t/create-dynamic-bindings-for-where-clause/23797/7"&gt;create dynamic bindings&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So I&amp;#8217;ll split this explanation in two parts: Explain &lt;tt class="docutils literal"&gt;QueryFilterEx.get_changeset_from_params&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;make_filter_changeset&lt;/tt&gt; (easy) and
then explain &lt;tt class="docutils literal"&gt;QueryFilterEx.filter&lt;/tt&gt; (more&amp;nbsp;difficult).&lt;/p&gt;
&lt;div class="section" id="queryfilterex-get-changeset-from-params-and-make-filter-changeset"&gt;
&lt;h3&gt;&lt;tt class="docutils literal"&gt;QueryFilterEx.get_changeset_from_params&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;make_filter_changeset&lt;/tt&gt;&lt;/h3&gt;
&lt;p&gt;This function generates a changeset using the &lt;span class="caps"&gt;GET&lt;/span&gt; request parameters and the list of declared filters. The
create changeset is a &lt;a class="reference external" href="https://hexdocs.pm/ecto/Ecto.Changeset.html#module-schemaless-changesets"&gt;schemaless one&lt;/a&gt; since it may contains fields of various schemas (or fields that
are not even exist on a schema). To generate it it uses the &lt;a class="reference external" href="https://hexdocs.pm/ecto/Ecto.Changeset.html#cast/4"&gt;cast/4&lt;/a&gt; function passing it a &lt;tt class="docutils literal"&gt;{data, types}&lt;/tt&gt;
first parameter to generate the schemaless changeset. It has two public methods: &lt;tt class="docutils literal"&gt;get_changeset_from_params&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;make_filter_changeset&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;get_changeset_from_params&lt;/tt&gt; is the one we&amp;#8217;ve used to integrate
with the controller and is used to retrieve the filter parameters from the request
parameters based on the collect parameter of the form we mentioned before (the &lt;tt class="docutils literal"&gt;as: :filter&lt;/tt&gt;). If such
parameters are found they will be passed to &lt;tt class="docutils literal"&gt;make_filter_changeset&lt;/tt&gt; (or else it will pass an empty
struct). Notice that the &lt;tt class="docutils literal"&gt;filter_name&lt;/tt&gt; by default is &lt;tt class="docutils literal"&gt;&amp;quot;filter&amp;quot;&lt;/tt&gt; but you can change it to anything
you&amp;nbsp;want.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;get_changeset_from_params&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filters&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filter_name&lt;/span&gt; &lt;span class="p"&gt;\\&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;filter&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;filter_name&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;filter_params&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;
      &lt;span class="n"&gt;filters&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;make_filter_changeset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filter_params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="bp"&gt;_&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;
      &lt;span class="n"&gt;filters&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;make_filter_changeset&lt;/span&gt;&lt;span class="p"&gt;(%{})&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;make_filter_changeset&lt;/tt&gt; is the function that actually creates the schemaless changeset. To do that
it uses two private functions that operate on the passed filters array: &lt;tt class="docutils literal"&gt;make_filter_keys&lt;/tt&gt;
to extract the &lt;tt class="docutils literal"&gt;:name&lt;/tt&gt; field of each key filter and the &lt;tt class="docutils literal"&gt;make_filter_types&lt;/tt&gt; to generate a
&lt;tt class="docutils literal"&gt;Map&lt;/tt&gt; of &lt;tt class="docutils literal"&gt;%{name: :type}&lt;/tt&gt; as needed by the &lt;tt class="docutils literal"&gt;types&lt;/tt&gt; of the &lt;tt class="docutils literal"&gt;{data, types}&lt;/tt&gt; tuple passed
to &lt;tt class="docutils literal"&gt;cast&lt;/tt&gt; (the &lt;tt class="docutils literal"&gt;data&lt;/tt&gt; is just an empty &lt;tt class="docutils literal"&gt;Map&lt;/tt&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;defp&lt;/span&gt; &lt;span class="n"&gt;make_filter_keys&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;filters&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Enum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="ni"&gt;&amp;amp;1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="kd"&gt;defp&lt;/span&gt; &lt;span class="n"&gt;make_filter_types&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;filters&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Enum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="ni"&gt;&amp;amp;1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ni"&gt;&amp;amp;1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;make_filter_changeset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filters&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;%{}&lt;/span&gt;
  &lt;span class="n"&gt;types&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;filters&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;make_filter_types&lt;/span&gt;

  &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;types&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Ecto.Changeset&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cast&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filters&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;make_filter_keys&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;merge&lt;/span&gt;&lt;span class="p"&gt;(%{&lt;/span&gt;&lt;span class="ss"&gt;action&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:insert&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One interesting thing here is the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;Map.merge(%{action:&lt;/span&gt; :insert})&lt;/tt&gt; that is piped to the
generated changeset. This is needed to actually display the validation errors, if there&amp;#8217;s
no action to the changeset (and there won&amp;#8217;t be since we aren&amp;#8217;t going do any updates to the database
with this changeset) then the casting errors won&amp;#8217;t be&amp;nbsp;displayed.&lt;/p&gt;
&lt;p&gt;Please notice that although I use the &lt;tt class="docutils literal"&gt;get_changeset_from_params&lt;/tt&gt; in my controller the important
function here is the &lt;tt class="docutils literal"&gt;make_filter_changeset&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;get_changeset_from_params&lt;/tt&gt; is mainly used to
retrieve the filter-related &lt;span class="caps"&gt;GET&lt;/span&gt; query parameter; however to use &lt;tt class="docutils literal"&gt;QueryFilterEx&lt;/tt&gt; you can just
create (however you want) a &lt;tt class="docutils literal"&gt;Map&lt;/tt&gt; of &lt;tt class="docutils literal"&gt;filter_name: value&lt;/tt&gt; pairs  and pass it to
&lt;tt class="docutils literal"&gt;make_filter_changeset&lt;/tt&gt; to get the&amp;nbsp;changeset.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="queryfilterex-filter"&gt;
&lt;h3&gt;&lt;tt class="docutils literal"&gt;QueryFilterEx.filter&lt;/tt&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;filter&lt;/tt&gt; method gets three parameters. The &lt;tt class="docutils literal"&gt;query&lt;/tt&gt;, the &lt;tt class="docutils literal"&gt;changeset&lt;/tt&gt; (that was created with
&lt;tt class="docutils literal"&gt;make_filter_changeset&lt;/tt&gt;) and the declared &lt;tt class="docutils literal"&gt;filters&lt;/tt&gt;. This function will then check all declared &lt;tt class="docutils literal"&gt;filters&lt;/tt&gt;
one by one and see if the &lt;tt class="docutils literal"&gt;changeset&lt;/tt&gt; contains a change for this filter (i.e if the field has a value).
If yes it will append a &lt;a class="reference external" href="https://hexdocs.pm/ecto/Ecto.Query.html#where/3"&gt;where/3&lt;/a&gt; to the query based on the passed value of the &lt;tt class="docutils literal"&gt;changeset&lt;/tt&gt; and the
declared filter &lt;tt class="docutils literal"&gt;:method&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;To do that it just uses &lt;tt class="docutils literal"&gt;Enum.reduce&lt;/tt&gt; starting with the initial query as an accumulator and
reducing on all the declared &lt;tt class="docutils literal"&gt;filters&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;changes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetch!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:changes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;filters&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Enum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reduce&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;creat_where_clauses_reducer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;changes&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="kd"&gt;defp&lt;/span&gt; &lt;span class="n"&gt;creat_where_clauses_reducer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;changes&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="ss"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;method&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="n"&gt;acc&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;
    &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;changes&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
      &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="ss"&gt;:ok&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;
        &lt;span class="n"&gt;acc&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;creat_where_clause&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="bp"&gt;_&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;
        &lt;span class="n"&gt;acc&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that the &lt;tt class="docutils literal"&gt;creat_where_clauses_reducer&lt;/tt&gt; function returns a function (the reducer) that
&lt;tt class="docutils literal"&gt;reduce&lt;/tt&gt; will use. This function checks to see if the current changes of the &lt;tt class="docutils literal"&gt;changeset&lt;/tt&gt; contain
the &lt;tt class="docutils literal"&gt;filter_name:&lt;/tt&gt;. If yes it will pass the following values to the &lt;tt class="docutils literal"&gt;creat_where_clause&lt;/tt&gt; function:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;The accumulated query (&lt;tt class="docutils literal"&gt;acc&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;The &lt;tt class="docutils literal"&gt;field_name:&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;:binding&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;:method&lt;/tt&gt; values of the current&amp;nbsp;filter&lt;/li&gt;
&lt;li&gt;The value of the changes of the &lt;tt class="docutils literal"&gt;changeset&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If the current &lt;tt class="docutils literal"&gt;filter_name&lt;/tt&gt; is not contained in the changes then it just returns the accumulated query as it&amp;nbsp;is.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s now take a look at the &lt;tt class="docutils literal"&gt;creat_where_clause&lt;/tt&gt; function:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;defp&lt;/span&gt; &lt;span class="n"&gt;creat_where_clause&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;acc&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="ss"&gt;:eq&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;acc&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt;
      &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="ss"&gt;:ilike&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;acc&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt;
      &lt;span class="n"&gt;ilike&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;#{&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;%&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="ss"&gt;:icontains&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;acc&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt;
      &lt;span class="n"&gt;ilike&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;%&lt;/span&gt;&lt;span class="si"&gt;#{&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;%&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="ss"&gt;:year&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;acc&lt;/span&gt;  &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt;
      &lt;span class="n"&gt;fragment&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;extract (year from ?) = ?&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="ss"&gt;:date&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;acc&lt;/span&gt;  &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt;
      &lt;span class="n"&gt;fragment&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;? &amp;gt;= cast(? as date) and ? &amp;lt; (cast(? as date) + &amp;#39;1 day&amp;#39;::interval&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="bp"&gt;_&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;acc&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
      &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt;
      &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This function is just a simple &lt;tt class="docutils literal"&gt;case&lt;/tt&gt; that pipes the accumulated query to a different &lt;tt class="docutils literal"&gt;where&lt;/tt&gt; clause
depending on the &lt;tt class="docutils literal"&gt;method:&lt;/tt&gt;. Let&amp;#8217;s take a closer look at what happens when &lt;tt class="docutils literal"&gt;:method == :eq&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;acc&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
  &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt;
  &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This may seem a little confusing so let&amp;#8217;s take a look at a simple &lt;tt class="docutils literal"&gt;where&lt;/tt&gt; first:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;root&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Repo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Nothing fancy here, now let&amp;#8217;s add a named&amp;nbsp;query:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="ss"&gt;user&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;root&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Repo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that now we can declare that &lt;tt class="docutils literal"&gt;u&lt;/tt&gt; is an alias for the &lt;tt class="docutils literal"&gt;users&lt;/tt&gt; named binding. What if
we used the tuples syntax for the &lt;tt class="docutils literal"&gt;user: u&lt;/tt&gt; instead of the keyword&amp;nbsp;one:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;([{&lt;/span&gt;&lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;root&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Repo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Yes this still works. What if we wanted to use a variable for the binding name in the&amp;nbsp;where?&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;
&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;([{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;root&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Repo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I think it starts to make sense now, let&amp;#8217;s finally use a variable for the field name&amp;nbsp;also:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;
&lt;span class="n"&gt;field_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="ss"&gt;:name&lt;/span&gt;
&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;as&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;([{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;root&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Repo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So this is exactly how this&amp;nbsp;works!&lt;/p&gt;
&lt;p&gt;Beyond the &lt;tt class="docutils literal"&gt;:eq&lt;/tt&gt; I&amp;#8217;ve got the definitions for the other methods I described there, the most
complex one is probably the &lt;tt class="docutils literal"&gt;:date&lt;/tt&gt; which is something&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
  &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt;
  &lt;span class="n"&gt;fragment&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;? &amp;gt;= cast(? as date) and ? &amp;lt; (cast(? as date) + &amp;#39;1 day&amp;#39;::interval&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;What this does is that it generates the following &lt;span class="caps"&gt;SQL&lt;/span&gt;&amp;nbsp;fragment:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;=&lt;/span&gt; &lt;span class="k"&gt;cast&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nb"&gt;date&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;AND&lt;/span&gt; &lt;span class="n"&gt;field_name&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;cast&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nb"&gt;date&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1 day&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="nb"&gt;interval&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can add your own methods by adding more clauses to the case of the &lt;tt class="docutils literal"&gt;creat_where_clause&lt;/tt&gt; function
and following a similar&amp;nbsp;pattern.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;By using the &lt;tt class="docutils literal"&gt;QueryFilterEx&lt;/tt&gt; module presented here you can very quickly declare the fields you want
to filter on and the method you want to use for each field no matter if these fields are in the same
schema or are accessed through joins. You can easily extend the functionality of the module by adding
your own methods. The only extra thing you need to do is to just add names to your&amp;nbsp;queries.&lt;/p&gt;
&lt;/div&gt;
</content><category term="elixir"></category><category term="elixir"></category><category term="phoenix"></category><category term="ecto"></category><category term="queries"></category><category term="declarative"></category></entry><entry><title>Phoenix forms integration with select2 andÂ ajax</title><link href="https://spapas.github.io/2019/06/04/phoenix-form-select2-ajax/" rel="alternate"></link><published>2019-06-04T14:20:00+03:00</published><updated>2019-06-04T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2019-06-04:/2019/06/04/phoenix-form-select2-ajax/</id><summary type="html">&lt;p class="first last"&gt;How to create a proper ajax-autocomplete solution for your foreign key fields with Phoenix Forms and&amp;nbsp;select2&lt;/p&gt;
</summary><content type="html">&lt;p&gt;During the past months I&amp;#8217;ve tried to implement a project using &lt;a class="reference external" href="https://elixir-lang.org/"&gt;Elixir&lt;/a&gt; and the &lt;a class="reference external" href="https://phoenixframework.org/"&gt;Phoenix framework&lt;/a&gt;. Old
visitors of my blog will probably remember that I mainly use Django for back-end development but I decided to
also give Phoenix a&amp;nbsp;try.&lt;/p&gt;
&lt;p&gt;My first impressions are positive but I don&amp;#8217;t want to go into detail in this post; I&amp;#8217;ll try to add a more
extensive post comparing Elixir / Phoenix with Python / Django&amp;nbsp;someday.&lt;/p&gt;
&lt;p&gt;The problem that this particular post will try to explain is how to properly integrate a jQuery &lt;a class="reference external" href="https://select2.org/"&gt;select2&lt;/a&gt;
dropdown ajax with autocomplete search to your &lt;a class="reference external" href="https://hexdocs.pm/phoenix_html/Phoenix.HTML.Form.html"&gt;Phonix Forms&lt;/a&gt;. This seems like a very common problem however I
couldn&amp;#8217;t find a proper solution anywhere in the internet. It seems that most people using Phoenix prefer to
implement their autocompletes using &lt;span class="caps"&gt;SPA&lt;/span&gt; like functionality (react etc). Also I found &lt;a class="reference external" href="https://github.com/nico-amsterdam/phoenix_form_awesomplete"&gt;this project&lt;/a&gt; that
seems to be working, however it does not use select2 and I really didn&amp;#8217;t like to mess with a different
&lt;span class="caps"&gt;JS&lt;/span&gt; library for reasons that should be too obvious to most&amp;nbsp;people.&lt;/p&gt;
&lt;p&gt;So here we&amp;#8217;ll implement a simple solution for allowing your foreign key value to be autocompleted through ajax
using select2. The specific example is that you have a User that belongs to an Authority i.e user has a field
named &lt;cite&gt;authority_id&lt;/cite&gt; which is a foreign key to authority. We&amp;#8217;ll add a functionality to the user edit form to
select the authority using&amp;nbsp;ajax-autocomplete.&lt;/p&gt;
&lt;p&gt;Please notice that you can find a working version of this tutorial in my Phoenix Crud template project:
&lt;a class="reference external" href="https://github.com/spapas/phxcrd"&gt;https://github.com/spapas/phxcrd&lt;/a&gt;. This project contains various other functionality that I need but you should be
able to test the user - authority integration by following the instructions&amp;nbsp;there.&lt;/p&gt;
&lt;div class="section" id="the-schemas"&gt;
&lt;h2&gt;The&amp;nbsp;schemas&lt;/h2&gt;
&lt;p&gt;For this tutorial, we&amp;#8217;ll use two schemas: A &lt;tt class="docutils literal"&gt;User&lt;/tt&gt; and an &lt;tt class="docutils literal"&gt;Authority&lt;/tt&gt;. Each &lt;tt class="docutils literal"&gt;User&lt;/tt&gt; belongs to an &lt;tt class="docutils literal"&gt;Authority&lt;/tt&gt;
(thus will have a foreign key to &lt;tt class="docutils literal"&gt;Authority&lt;/tt&gt;; that&amp;#8217;s what we want to set using the ajax select2). Here are
the ecto schemas for these&amp;nbsp;entities:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;defmodule&lt;/span&gt; &lt;span class="nc"&gt;Phxcrd.Auth.Authority&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="kn"&gt;use&lt;/span&gt; &lt;span class="nc"&gt;Ecto.Schema&lt;/span&gt;

  &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nc"&gt;Ecto.Changeset&lt;/span&gt;
  &lt;span class="kn"&gt;alias&lt;/span&gt; &lt;span class="nc"&gt;Phxcrd.Auth.User&lt;/span&gt;

  &lt;span class="n"&gt;schema&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;authorities&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="ss"&gt;:name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:string&lt;/span&gt;
    &lt;span class="n"&gt;has_many&lt;/span&gt; &lt;span class="ss"&gt;:users&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;on_replace&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="ss"&gt;:nilify&lt;/span&gt;
    &lt;span class="n"&gt;timestamps&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;

  &lt;span class="na"&gt;@doc&lt;/span&gt; &lt;span class="no"&gt;false&lt;/span&gt;
  &lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="n"&gt;authority&lt;/span&gt;
    &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cast&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;:name&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;validate_required&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="ss"&gt;:name&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="ss"&gt;message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;The field is required&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;unique_constraint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;:name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;The name already exists!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;

  &lt;span class="kn"&gt;use&lt;/span&gt; &lt;span class="nc"&gt;Accessible&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;defmodule&lt;/span&gt; &lt;span class="nc"&gt;Phxcrd.Auth.User&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="kn"&gt;use&lt;/span&gt; &lt;span class="nc"&gt;Ecto.Schema&lt;/span&gt;

  &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nc"&gt;Ecto.Changeset&lt;/span&gt;
  &lt;span class="kn"&gt;alias&lt;/span&gt; &lt;span class="nc"&gt;Phxcrd.Auth.Authority&lt;/span&gt;

  &lt;span class="n"&gt;schema&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;users&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="ss"&gt;:email&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:string&lt;/span&gt;
    &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="ss"&gt;:username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:string&lt;/span&gt;
    &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="ss"&gt;:password_hash&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:string&lt;/span&gt;
    &lt;span class="n"&gt;field&lt;/span&gt; &lt;span class="ss"&gt;:password&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;virtual&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="no"&gt;true&lt;/span&gt;

    &lt;span class="n"&gt;belongs_to&lt;/span&gt; &lt;span class="ss"&gt;:authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nc"&gt;Authority&lt;/span&gt;

    &lt;span class="n"&gt;timestamps&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;

  &lt;span class="na"&gt;@doc&lt;/span&gt; &lt;span class="no"&gt;false&lt;/span&gt;
  &lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="n"&gt;user&lt;/span&gt;
    &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cast&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="ss"&gt;:username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:email&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:authority_id&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;validate_required&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="ss"&gt;:username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:email&lt;/span&gt; &lt;span class="p"&gt;])&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;

  &lt;span class="kn"&gt;use&lt;/span&gt; &lt;span class="nc"&gt;Accessible&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that both these entities are contained in the &lt;tt class="docutils literal"&gt;Auth&lt;/tt&gt; context and were created using
&lt;tt class="docutils literal"&gt;mix phx.gen.html&lt;/tt&gt;; I won&amp;#8217;t include the migrations&amp;nbsp;here.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-search-api"&gt;
&lt;h2&gt;The search &lt;span class="caps"&gt;API&lt;/span&gt;&lt;/h2&gt;
&lt;p&gt;Let&amp;#8217;s now take a look at the search api for &lt;tt class="docutils literal"&gt;Authority&lt;/tt&gt;. I&amp;#8217;ve added an &lt;tt class="docutils literal"&gt;ApiController&lt;/tt&gt;  which contains
the following&amp;nbsp;function:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;search_authorities&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;q&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="n"&gt;authorities&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;
      &lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nc"&gt;Authority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="ss"&gt;where&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ilike&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;%&lt;/span&gt;&lt;span class="si"&gt;#{&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;%&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;limit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Repo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;authorities.json&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;authorities&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;authorities&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that this retrieves a &lt;cite&gt;q&lt;/cite&gt; parameter and makes an &lt;cite&gt;ilike&lt;/cite&gt; query to &lt;cite&gt;Authority.name&lt;/cite&gt;. It then
passes the results to the view for rendering. Here&amp;#8217;s the corresponding function for &lt;cite&gt;ApiView&lt;/cite&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;authorities.json&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="ss"&gt;authorities&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;authorities&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="ss"&gt;results&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nc"&gt;Enum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authorities&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;authority_json&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;

  &lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;authority_json&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="p"&gt;%{&lt;/span&gt;
      &lt;span class="ss"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="ss"&gt;text&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that select2 wants its results in a &lt;span class="caps"&gt;JSON&lt;/span&gt; struct with the following form &lt;tt class="docutils literal"&gt;{results: [{id: 1, name: &amp;quot;Authority &lt;span class="pre"&gt;1&amp;quot;}]}&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;To add this controller action to my routes I&amp;#8217;ve added this to &lt;tt class="docutils literal"&gt;router.ex&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;scope&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/api&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nc"&gt;PhxcrdWeb&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="n"&gt;pipe_through&lt;/span&gt; &lt;span class="ss"&gt;:api&lt;/span&gt;

    &lt;span class="n"&gt;get&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/search_authorities&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nc"&gt;ApiController&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:search_authorities&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Thus if you visit &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;http://127.0.0.1/search_authorities?q=A&lt;/span&gt;&lt;/tt&gt; you should retrieve authorities containing &lt;tt class="docutils literal"&gt;A&lt;/tt&gt; in their&amp;nbsp;name.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-controller"&gt;
&lt;h2&gt;The&amp;nbsp;controller&lt;/h2&gt;
&lt;p&gt;Concenring the &lt;tt class="docutils literal"&gt;UserController&lt;/tt&gt; I&amp;#8217;ve added the following methods to it for creating and updating&amp;nbsp;users:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;changeset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nc"&gt;Auth&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;change_user&lt;/span&gt;&lt;span class="p"&gt;(%&lt;/span&gt;&lt;span class="nc"&gt;User&lt;/span&gt;&lt;span class="p"&gt;{})&lt;/span&gt;
  &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;new.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;user&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;user_params&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nc"&gt;Auth&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create_user&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user_params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="ss"&gt;:ok&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;
      &lt;span class="n"&gt;conn&lt;/span&gt;
      &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;put_flash&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;:info&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;#{&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; created!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;redirect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;to&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nc"&gt;Routes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user_path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:show&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="ss"&gt;:error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;
      &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;new.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;edit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;id&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nc"&gt;Auth&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_user!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;changeset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nc"&gt;Auth&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;change_user&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;edit.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;user&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;

&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;%{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;id&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;user&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;user_params&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nc"&gt;Auth&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_user!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="n"&gt;user_params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;merge&lt;/span&gt;&lt;span class="p"&gt;(%{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;authority_id&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="no"&gt;nil&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="n"&gt;user_params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="nc"&gt;Auth&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update_user&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user_params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="ss"&gt;:ok&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;
      &lt;span class="n"&gt;conn&lt;/span&gt;
      &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;put_flash&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;:info&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;User updated successfully.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;redirect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ss"&gt;to&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nc"&gt;Routes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user_path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:show&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="ss"&gt;:error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;%&lt;/span&gt;&lt;span class="nc"&gt;Ecto.Changeset&lt;/span&gt;&lt;span class="p"&gt;{}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;
      &lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;edit.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;user&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Most of these are more or less the default things that &lt;tt class="docutils literal"&gt;mix phx.gen.html&lt;/tt&gt; creates.
One thing that may seem a strange here is the &lt;tt class="docutils literal"&gt;user_params = &lt;span class="pre"&gt;Map.merge(%{&amp;quot;authority_id&amp;quot;&lt;/span&gt; =&amp;gt; nil}, user_params)&lt;/tt&gt;
line of &lt;tt class="docutils literal"&gt;update&lt;/tt&gt;. What happens here is that I want to be able to clear the authority of a user (I&amp;#8217;ll
explain how in the next sections). If I do
that then the &lt;tt class="docutils literal"&gt;user_params&lt;/tt&gt; that is passed to &lt;tt class="docutils literal"&gt;update&lt;/tt&gt; will &lt;em&gt;not&lt;/em&gt; contain an &lt;tt class="docutils literal"&gt;authority_id&lt;/tt&gt; key thus
the &lt;tt class="docutils literal"&gt;authority_id&lt;/tt&gt; won&amp;#8217;t be changed at all (so even though I cleared it, it will keep its previous value after
I save it). To fix that I set a default value of &lt;tt class="docutils literal"&gt;nil&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;authority_id&lt;/tt&gt;; if the user has actually selected
an authority from the form this will be overriden when merging the two maps. So the resulting &lt;tt class="docutils literal"&gt;user_params&lt;/tt&gt; will
&lt;em&gt;always&lt;/em&gt; contain an &lt;tt class="docutils literal"&gt;authority_id&lt;/tt&gt; key, either set to nil or to the selected&amp;nbsp;authority.&lt;/p&gt;
&lt;p&gt;Beyond that I wont&amp;#8217; go into detail explaining the above functions,  but if something seems strange feel free to ask. I
also won&amp;#8217;t explain the &lt;tt class="docutils literal"&gt;Auth.*&lt;/tt&gt; functions; all these are created by phoenix in the context&amp;nbsp;module.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-view"&gt;
&lt;h2&gt;The&amp;nbsp;view&lt;/h2&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;UserView&lt;/tt&gt; module contains a simple but very important&amp;nbsp;function:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;get_select_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;changes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
    &lt;span class="no"&gt;nil&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;z&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;z&lt;/span&gt;
  &lt;span class="k"&gt;end&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This functions gets two parameters: The changeset and the name of the attribute (&lt;tt class="docutils literal"&gt;:authority_id&lt;/tt&gt; in our case). What
it does is to first check if this attribute is contained in the changeset.changes; if yes it will return that value. If
it isn&amp;#8217;t contained in the changeset.changes then it will return the value of changeset.data for that&amp;nbsp;attribute.&lt;/p&gt;
&lt;p&gt;This is a little complex but let&amp;#8217;s try to understand its logic: When you start editing a &lt;tt class="docutils literal"&gt;User&lt;/tt&gt; you want to display
the current authority of that instance. However, when you submit an edited user and retrieve an errored form (for example
because you forgot to fill the username) you want to display the authority that &lt;em&gt;was submitted&lt;/em&gt; in the form. So the
&lt;tt class="docutils literal"&gt;changeset.changes&lt;/tt&gt; contains the changes that were submitted just before while the &lt;tt class="docutils literal"&gt;changeset.data&lt;/tt&gt; contain the
initial value of the&amp;nbsp;struct.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update 02/07/2019:&lt;/strong&gt; Please notice that instead of using the
&lt;tt class="docutils literal"&gt;get_select_value&lt;/tt&gt; I presented before you can use the
&lt;tt class="docutils literal"&gt;Ecto.Changeset.get_field&lt;/tt&gt; function that does exactly this! So
&lt;tt class="docutils literal"&gt;get_select_value&lt;/tt&gt; could be defined like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;def&lt;/span&gt; &lt;span class="n"&gt;get_select_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;changeset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="n"&gt;changeset&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Ecto.Changeset&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="the-form-template"&gt;
&lt;h2&gt;The form&amp;nbsp;template&lt;/h2&gt;
&lt;p&gt;Both the &lt;tt class="docutils literal"&gt;:new&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;:edit&lt;/tt&gt; actions include a common form.html.eex&amp;nbsp;template:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= form_for @changeset, @action, fn f -&amp;gt; %&amp;gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= if @changeset.action do %&amp;gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;alert alert-danger&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;&lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= gettext(&amp;quot;Problems while saving&amp;quot;) %&amp;gt;&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;% end %&amp;gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;row&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;column&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= label f, :username %&amp;gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= text_input f, :username %&amp;gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= error_tag f, :username %&amp;gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;column&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= label f, :email %&amp;gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= text_input f, :email %&amp;gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= error_tag f, :email %&amp;gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;row&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;column&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= label f, :authority %&amp;gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= select(f,
        :authority_id, [
          (with sv when not is_nil(sv) &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;-&lt;/span&gt; &lt;span class="na"&gt;get_select_value&lt;/span&gt;&lt;span class="err"&gt;(@&lt;/span&gt;&lt;span class="na"&gt;changeset&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt; &lt;span class="na"&gt;:authority_id&lt;/span&gt;&lt;span class="err"&gt;),&lt;/span&gt;
                                     &lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;&lt;span class="na"&gt;-&lt;/span&gt; &lt;span class="na"&gt;Phxcrd&lt;/span&gt;&lt;span class="err"&gt;.&lt;/span&gt;&lt;span class="na"&gt;Auth&lt;/span&gt;&lt;span class="err"&gt;.&lt;/span&gt;&lt;span class="na"&gt;get_authority&lt;/span&gt;&lt;span class="err"&gt;!(&lt;/span&gt;&lt;span class="na"&gt;sv&lt;/span&gt;&lt;span class="err"&gt;),&lt;/span&gt; &lt;span class="na"&gt;do:&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="err"&gt;.&lt;/span&gt;&lt;span class="na"&gt;name&lt;/span&gt;&lt;span class="err"&gt;,&lt;/span&gt; &lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="err"&gt;.&lt;/span&gt;&lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="err"&gt;})&lt;/span&gt;
        &lt;span class="err"&gt;],&lt;/span&gt;
        &lt;span class="na"&gt;style:&lt;/span&gt; &lt;span class="err"&gt;&amp;quot;&lt;/span&gt;&lt;span class="na"&gt;width:&lt;/span&gt; &lt;span class="na"&gt;100&lt;/span&gt;&lt;span class="err"&gt;%&amp;quot;)&lt;/span&gt;
        &lt;span class="err"&gt;%&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= error_tag f, :authority_id %&amp;gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;%= submit gettext(&amp;quot;Save&amp;quot;) %&amp;gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="err"&gt;&amp;lt;&lt;/span&gt;% end %&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is a custom Phoenix form but it has the following addition which is more or less the meat of this article
(along with the &lt;tt class="docutils literal"&gt;get_select_value&lt;/tt&gt; function I explained&amp;nbsp;before):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:authority_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;with&lt;/span&gt; &lt;span class="n"&gt;sv&lt;/span&gt; &lt;span class="ow"&gt;when&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;is_nil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="n"&gt;get_select_value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="na"&gt;@changeset&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:authority_id&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                                   &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;-&lt;/span&gt; &lt;span class="nc"&gt;Phxcrd.Auth&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_authority!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sv&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="ss"&gt;do&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
      &lt;span class="p"&gt;],&lt;/span&gt;
      &lt;span class="ss"&gt;style&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;width: 100%&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So this will create an html select element which will contain a single value (the array in the third
parameter of &lt;tt class="docutils literal"&gt;select&lt;/tt&gt;): The authority of that object or the authority that the user had submitted
in the form. For this it uses &lt;tt class="docutils literal"&gt;get_select_value&lt;/tt&gt; to retrieve the :authority_id and if it&amp;#8217;s not nil
it passes it to &lt;tt class="docutils literal"&gt;get_authority!&lt;/tt&gt; to retrieve the actual authority and return a tuple with its name and&amp;nbsp;id.&lt;/p&gt;
&lt;p&gt;By default when you create a &lt;tt class="docutils literal"&gt;select&lt;/tt&gt; element you&amp;#8217;ll pass an array of all options in the third
parameter, for&amp;nbsp;example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ss"&gt;:authority_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nc"&gt;Phxcrd.Auth&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;list_authorities&lt;/span&gt; &lt;span class="o"&gt;|&amp;gt;&lt;/span&gt; &lt;span class="nc"&gt;Enum&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="ni"&gt;&amp;amp;1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ni"&gt;&amp;amp;1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Of course this beats the purpose of using ajax since all options will be&amp;nbsp;rendered.&lt;/p&gt;
&lt;p&gt;The final step is to add the required custom javascript to convert that select to&amp;nbsp;select2-with-ajax:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#user_authority_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;select2&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
      &lt;span class="nx"&gt;allowClear&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="nx"&gt;placeholder&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Select authority&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="nx"&gt;ajax&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;lt;%= Routes.api_path(@conn, :search_authorities) %&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;dataType&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;json&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;delay&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;minimumInputLength&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;span class="caps"&gt;JS&lt;/span&gt; very rather simple; the &lt;tt class="docutils literal"&gt;allowClear&lt;/tt&gt; option will display an &lt;tt class="docutils literal"&gt;x&lt;/tt&gt; so that you can clear the
selected authority while the ajax url will be that of the &lt;tt class="docutils literal"&gt;:search_authorities&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Although this article may seem a little long, as I&amp;#8217;ve already mentioned the most important thing
to keep is how to properly set the value that should be displayed in your &lt;tt class="docutils literal"&gt;select2&lt;/tt&gt; widget. Beyond
that everything is a walk in the park by following the&amp;nbsp;docs.&lt;/p&gt;
&lt;/div&gt;
</content><category term="elixir"></category><category term="elixir"></category><category term="phoenix"></category><category term="select2"></category><category term="autocompelte"></category><category term="ajax"></category></entry><entry><title>How to create a custom filtered adapter inÂ Android</title><link href="https://spapas.github.io/2019/04/05/android-custom-filter-adapter/" rel="alternate"></link><published>2019-04-05T12:20:00+03:00</published><updated>2019-04-05T12:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2019-04-05:/2019/04/05/android-custom-filter-adapter/</id><summary type="html">&lt;p class="first last"&gt;How to create a custom filtered adapter in Android; we&amp;#8217;ll be using Kotlin for&amp;nbsp;this.&lt;/p&gt;
</summary><content type="html">&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Android offers a nice component named &lt;a class="reference external" href="https://developer.android.com/reference/android/widget/AutoCompleteTextView"&gt;AutoCompleteTextView&lt;/a&gt; that can be used to auto-fill a text box from a list of values.
In its simplest form, you just create an array adapter passing it a list of objects (that have a proper &lt;tt class="docutils literal"&gt;toString()&lt;/tt&gt; method).
Then you type some characters to the textbox and by default it will filter the results searching
in the &lt;em&gt;beginning of the backing object&amp;#8217;s toString() result&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;However there are times that you don&amp;#8217;t want to look at the beginning of the string (because you want to look at the middle of the string) or
you don&amp;#8217;t want to just to search in toString() method of the object or you want to do some more fancy things in object output. For this
you must override the &lt;tt class="docutils literal"&gt;ArrayAdapter&lt;/tt&gt; and add a custom &lt;tt class="docutils literal"&gt;Filter&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Unfurtunately this isn&amp;#8217;t as straightforward as I&amp;#8217;d like and I couldn&amp;#8217;t find a quick and easy tutorial on how it can be&amp;nbsp;done.&lt;/p&gt;
&lt;p&gt;So here goes nothing: In the following I&amp;#8217;ll show you a very simple android application that will have &lt;em&gt;the minimum viable&lt;/em&gt; custom filtered
adapter implementation. You can find the whole project in github: &lt;a class="reference external" href="https://github.com/spapas/CustomFilteredAdapeter"&gt;https://github.com/spapas/CustomFilteredAdapeter&lt;/a&gt; but I am going to discuss
everything here&amp;nbsp;also.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-application"&gt;
&lt;h2&gt;The&amp;nbsp;application&lt;/h2&gt;
&lt;p&gt;Just create a new project with an empty activity from Android Studio. Use kotlin as the&amp;nbsp;language.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-layout"&gt;
&lt;h2&gt;The&amp;nbsp;layout&lt;/h2&gt;
&lt;p&gt;I&amp;#8217;ll keep it as simple as&amp;nbsp;possible:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;?xml version=&amp;quot;1.0&amp;quot; encoding=&amp;quot;utf-8&amp;quot;?&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;LinearLayout&lt;/span&gt;
        &lt;span class="na"&gt;xmlns:android=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://schemas.android.com/apk/res/android&amp;quot;&lt;/span&gt;
        &lt;span class="na"&gt;xmlns:tools=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://schemas.android.com/tools&amp;quot;&lt;/span&gt;
        &lt;span class="na"&gt;android:orientation=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;vertical&amp;quot;&lt;/span&gt;
        &lt;span class="na"&gt;android:layout_width=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;android:layout_height=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt;
        &lt;span class="na"&gt;tools:context=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;.MainActivity&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;TextView&lt;/span&gt;
            &lt;span class="na"&gt;android:layout_width=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;android:layout_height=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;wrap_content&amp;quot;&lt;/span&gt;
            &lt;span class="na"&gt;android:text=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Hello World!&amp;quot;&lt;/span&gt;
            &lt;span class="na"&gt;android:textSize=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;32sp&amp;quot;&lt;/span&gt;
            &lt;span class="na"&gt;android:textAlignment=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;center&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="nt"&gt;&amp;lt;AutoCompleteTextView&lt;/span&gt;
            &lt;span class="na"&gt;android:layout_marginTop=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;32dip&amp;quot;&lt;/span&gt;
            &lt;span class="na"&gt;android:layout_width=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;match_parent&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;android:layout_height=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;wrap_content&amp;quot;&lt;/span&gt;
            &lt;span class="na"&gt;android:id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;@+id/autoCompleteTextView&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/LinearLayout&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You should just care about the &lt;tt class="docutils literal"&gt;AutoCompleteTextView&lt;/tt&gt; with an id of &lt;tt class="docutils literal"&gt;autoCompleteTextView&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-backing-data-object"&gt;
&lt;h2&gt;The backing data&amp;nbsp;object&lt;/h2&gt;
&lt;p&gt;I&amp;#8217;ll use a simple PoiDao Kotlin data class for&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;data&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;city&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;category_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I&amp;#8217;d like to be able to search to both name, city and category_name of each object. To create a list of the pois to be used to the adapter I can do something&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;poisArray&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;listOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Taco Bell&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Athens&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Restaurant&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;McDonalds&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Athens&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Restaurant&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;KFC&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Piraeus&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Restaurant&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Shell&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Lamia&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Gas Station&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;BP&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Thessaloniki&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;Gas Station&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="the-custom-adapter"&gt;
&lt;h2&gt;The custom&amp;nbsp;adapter&lt;/h2&gt;
&lt;p&gt;This will be an &lt;tt class="docutils literal"&gt;ArrayAdapter&amp;lt;PoiDao&amp;gt;&lt;/tt&gt; implementing also the &lt;tt class="docutils literal"&gt;Filterable&lt;/tt&gt; interface:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;inner&lt;/span&gt; &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PoiAdapter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;@LayoutRes&lt;/span&gt; &lt;span class="k"&gt;private&lt;/span&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;layoutResource&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;private&lt;/span&gt; &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;allPois&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;):&lt;/span&gt;
    &lt;span class="n"&gt;ArrayAdapter&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;layoutResource&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;allPois&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;Filterable&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;private&lt;/span&gt; &lt;span class="k"&gt;var&lt;/span&gt; &lt;span class="py"&gt;mPois&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;allPois&lt;/span&gt;

    &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;fun&lt;/span&gt; &lt;span class="nf"&gt;getCount&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt; &lt;span class="n"&gt;Int&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mPois&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;fun&lt;/span&gt; &lt;span class="nf"&gt;getItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Int&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;?&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mPois&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;fun&lt;/span&gt; &lt;span class="nf"&gt;getItemId&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Int&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt; &lt;span class="n"&gt;Long&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// Or just return p0&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;mPois&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p0&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toLong&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;fun&lt;/span&gt; &lt;span class="nf"&gt;getView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;position&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Int&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;convertView&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;View&lt;/span&gt;&lt;span class="p"&gt;?,&lt;/span&gt; &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ViewGroup&lt;/span&gt;&lt;span class="p"&gt;?):&lt;/span&gt; &lt;span class="n"&gt;View&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;view&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;TextView&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;convertView&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;TextView&lt;/span&gt;&lt;span class="p"&gt;?&lt;/span&gt; &lt;span class="o"&gt;?:&lt;/span&gt; &lt;span class="n"&gt;LayoutInflater&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;inflate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;layoutResource&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;false&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;TextView&lt;/span&gt;
        &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;${mPois[position].name} ${mPois[position].city} (${mPois[position].category_name})&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;fun&lt;/span&gt; &lt;span class="nf"&gt;getFilter&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt; &lt;span class="n"&gt;Filter&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// See next section&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You&amp;#8217;ll see that we add an instance variable named &lt;tt class="docutils literal"&gt;mPois&lt;/tt&gt; that gets initialized in the start with &lt;tt class="docutils literal"&gt;allPois&lt;/tt&gt; (which is the initial list of all pois that is passed to the adapter). The mPois
will contain the &lt;em&gt;filtered&lt;/em&gt; results. Then,
for &lt;tt class="docutils literal"&gt;getCount&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;getItem&lt;/tt&gt; we return the corresponding valeus from &lt;tt class="docutils literal"&gt;mPois&lt;/tt&gt;; the &lt;tt class="docutils literal"&gt;getItemId&lt;/tt&gt; is used when you have an sqlite backed adapter but I&amp;#8217;m including it here for&amp;nbsp;completeness.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;getView&lt;/tt&gt; will create the specific line for each item in the dropdown. As you&amp;#8217;ll see the layout that is passed must have a &lt;tt class="docutils literal"&gt;text&lt;/tt&gt; child which is set based on some of the attributes of
the corresponding poi for each position. Notice that we can use whatever view layout we want for our dropdown result line (this is the &lt;tt class="docutils literal"&gt;layoutResource&lt;/tt&gt; parameter) but we need to configure
it (i.e bind it with the values of the backing object) here&amp;nbsp;properly.&lt;/p&gt;
&lt;p&gt;Finally we create a custom instance of the &lt;tt class="docutils literal"&gt;Filter&lt;/tt&gt;, explained in the next&amp;nbsp;section.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-custom-filter"&gt;
&lt;h2&gt;The custom&amp;nbsp;filter&lt;/h2&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;getFilter&lt;/tt&gt; creates an object instance of a Filter and returns&amp;nbsp;it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;fun&lt;/span&gt; &lt;span class="nf"&gt;getFilter&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt; &lt;span class="n"&gt;Filter&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;object&lt;/span&gt; &lt;span class="err"&gt;: &lt;/span&gt;&lt;span class="nc"&gt;Filter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;fun&lt;/span&gt; &lt;span class="nf"&gt;publishResults&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;charSequence&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;CharSequence&lt;/span&gt;&lt;span class="p"&gt;?,&lt;/span&gt; &lt;span class="n"&gt;filterResults&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Filter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FilterResults&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="n"&gt;mPois&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;filterResults&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;List&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="n"&gt;notifyDataSetChanged&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;fun&lt;/span&gt; &lt;span class="nf"&gt;performFiltering&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;charSequence&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;CharSequence&lt;/span&gt;&lt;span class="p"&gt;?):&lt;/span&gt; &lt;span class="n"&gt;Filter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FilterResults&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;queryString&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;charSequence&lt;/span&gt;&lt;span class="o"&gt;?.&lt;/span&gt;&lt;span class="n"&gt;toString&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?.&lt;/span&gt;&lt;span class="n"&gt;toLowerCase&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

            &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;filterResults&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Filter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FilterResults&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="n"&gt;filterResults&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;queryString&lt;/span&gt;&lt;span class="p"&gt;==&lt;/span&gt;&lt;span class="k"&gt;null&lt;/span&gt; &lt;span class="p"&gt;||&lt;/span&gt; &lt;span class="n"&gt;queryString&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isEmpty&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
                &lt;span class="n"&gt;allPois&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;
                &lt;span class="n"&gt;allPois&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toLowerCase&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;contains&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;queryString&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;||&lt;/span&gt;
                    &lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;city&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toLowerCase&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;contains&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;queryString&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;||&lt;/span&gt;
                    &lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;category_name&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;toLowerCase&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;contains&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;queryString&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;filterResults&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This object instance overrides two methods of &lt;tt class="docutils literal"&gt;Filter&lt;/tt&gt;: &lt;tt class="docutils literal"&gt;performFiltering&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;publishResults&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;performFiltering&lt;/tt&gt; is where the actual filtering is done;
it should return a &lt;tt class="docutils literal"&gt;FilterResults&lt;/tt&gt; object containing a &lt;tt class="docutils literal"&gt;values&lt;/tt&gt; attribute with the filtered values. In this method
we retrieve the &lt;tt class="docutils literal"&gt;charSequence&lt;/tt&gt; parameter and converit it to lowercase. Then, if this parameter is not empty we filter the corresponding elements of &lt;tt class="docutils literal"&gt;allPois&lt;/tt&gt;
(i.e name, city and category_name in our case) using contains. If the query parameter is empty then we just return all pois. Warning java developers; here the if
is used as an expression (i.e its result will be assigned to &lt;tt class="docutils literal"&gt;filterResults.values&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;After the performFiltering has finished, the &lt;tt class="docutils literal"&gt;publishResults&lt;/tt&gt; method is called. This method retrieves the filtered results in its &lt;tt class="docutils literal"&gt;filterResults&lt;/tt&gt; parameter. Thus it sets
&lt;tt class="docutils literal"&gt;mPois&lt;/tt&gt; of the custom adapter is set to the result of the filter operation and calls &lt;tt class="docutils literal"&gt;notifyDataSetChanged&lt;/tt&gt; to display the&amp;nbsp;results.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-the-custom-adapter"&gt;
&lt;h2&gt;Using the custom&amp;nbsp;adapter&lt;/h2&gt;
&lt;p&gt;To use the custom adapter you can do something like this in your activity&amp;#8217;s&amp;nbsp;onCreate:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;override&lt;/span&gt; &lt;span class="k"&gt;fun&lt;/span&gt; &lt;span class="nf"&gt;onCreate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;savedInstanceState&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Bundle&lt;/span&gt;&lt;span class="p"&gt;?)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;super&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;onCreate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;savedInstanceState&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;setContentView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;activity_main&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;poisArray&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;listOf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="c1"&gt;// See previous sections&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;adapter&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PoiAdapter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;android&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;layout&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;simple_list_item_1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;poisArray&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;autoCompleteTextView&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setAdapter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;adapter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;autoCompleteTextView&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;threshold&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="m"&gt;3&lt;/span&gt;

    &lt;span class="n"&gt;autoCompleteTextView&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setOnItemClickListener&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;position&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="p"&gt;-&amp;gt;&lt;/span&gt;
        &lt;span class="k"&gt;val&lt;/span&gt; &lt;span class="py"&gt;selectedPoi&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;adapter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;position&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;PoiDao&lt;/span&gt;&lt;span class="p"&gt;?&lt;/span&gt;
        &lt;span class="n"&gt;autoCompleteTextView&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;selectedPoi&lt;/span&gt;&lt;span class="o"&gt;?.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We create the PoiAdapter passing it the poisArray and &lt;tt class="docutils literal"&gt;android.R.layout.simple_list_item_1&lt;/tt&gt; as the layout. That layout just contains a textview named text. As we&amp;#8217;ve already
discussed you can pass something more complex here. The &lt;tt class="docutils literal"&gt;thresold&lt;/tt&gt; defined the number of characters that the user that needs to enter to do the filtering (default is&amp;nbsp;2).&lt;/p&gt;
&lt;p&gt;Please notice that when the user clicks (selects) on an item of the dropdown we set the contents of the textview (or else it will just use the object&amp;#8217;s toString() method to set&amp;nbsp;it).&lt;/p&gt;
&lt;/div&gt;
</content><category term="android"></category><category term="android"></category><category term="kotlin"></category><category term="adapter"></category><category term="filter"></category></entry><entry><title>Fixing your Django async job - databaseÂ integration</title><link href="https://spapas.github.io/2019/02/25/django-fix-async-db/" rel="alternate"></link><published>2019-02-25T15:20:00+02:00</published><updated>2019-02-25T15:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2019-02-25:/2019/02/25/django-fix-async-db/</id><summary type="html">&lt;p class="first last"&gt;How to properly fix the errors you get when integrating async jobs (rq, celery etc) with your database in&amp;nbsp;Djang&lt;/p&gt;
</summary><content type="html">&lt;p&gt;I&amp;#8217;ve already written
&lt;a class="reference external" href="https://spapas.github.io/2015/01/27/async-tasks-with-django-rq/"&gt;two&lt;/a&gt;
&lt;a class="reference external" href="https://spapas.github.io/2015/09/01/django-rq-redux/"&gt;articles&lt;/a&gt;
about django-rq and implementing asynchronous tasks in Django. However I&amp;#8217;ve found out
that there&amp;#8217;s a very important thing missing from them: How to properly integrate
your asynchronous tasks with your Django database. This is very important because
if it is not done right you will start experiencing strange errors about missing
database objects or duplicate keys. The most troublesome thing about these errors is
that they are not consistent. Your app may work fine but for some reason you&amp;#8217;ll see some
of your asynchronous tasks fail with these errors. When you re-queue the async jobs everything will
be&amp;nbsp;ok.&lt;/p&gt;
&lt;p&gt;Of course this behavior (code that runs &lt;em&gt;sometimes&lt;/em&gt;) smells of a race condition but its not easy to debug
it if you don&amp;#8217;t know the full&amp;nbsp;story.&lt;/p&gt;
&lt;p&gt;In the following I will describe the cause of this error and how you can fix it. As a companion
to this article I&amp;#8217;ve implemented a small project that can be used to test the error and the
fix: &lt;a class="reference external" href="https://github.com/spapas/async-job-db-fix"&gt;https://github.com/spapas/async-job-db-fix&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Notice that although this article is written for django-rq it should also help people that have
the same problems with other async job systems (like celery or&amp;nbsp;django-q).&lt;/p&gt;
&lt;div class="section" id="description-of-the-project"&gt;
&lt;h2&gt;Description of the&amp;nbsp;project&lt;/h2&gt;
&lt;p&gt;The project is very simple, you can just add a url and it will retrieve its content asynchronously and
report its length. For the models, it just has a &lt;tt class="docutils literal"&gt;Task&lt;/tt&gt; model which is used to provide information about
what we want to the asynchronous task to do and retrieve the&amp;nbsp;result:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Task&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;created_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;auto_now_add&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;url_length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PositiveIntegerField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;null&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;job_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;null&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;null&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It also has a home view that can be used to start new asynchronous tasks by creating a &lt;tt class="docutils literal"&gt;Task&lt;/tt&gt; object
with the url we got and passing it to the asynchronous&amp;nbsp;task:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic.edit&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;FormView&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.forms&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TaskForm&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.tasks&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_url_length&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;transaction&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TasksHomeFormView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;FormView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;form_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TaskForm&lt;/span&gt;
    &lt;span class="n"&gt;template_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;tasks_home.html&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        &lt;span class="n"&gt;get_url_length&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TasksHomeFormView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TasksHomeFormView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tasks&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-created_on&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And finally the asynchronous job itself that retrieves the task from the database,
requests its url and saves its&amp;nbsp;length:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rq&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_current_job&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django_rq&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;job&lt;/span&gt;

&lt;span class="nd"&gt;@job&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_url_length&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task_id&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;jb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_current_job&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;task_id&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url_length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;job_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;jb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_id&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above should be fairly obvious: The user visits the homepage and enters a url at the input. When he presses submit
the view will create a new &lt;tt class="docutils literal"&gt;Task&lt;/tt&gt; object with the url that the user entered and fire-off the &lt;tt class="docutils literal"&gt;get_url_length&lt;/tt&gt; asynchronous job passing the
task id of the task that was just created. It will then return immediately without waiting for the asynchronous job to complete. The user will
need to refresh to see the result of his job; this is the usual behavior with async&amp;nbsp;jobs.&lt;/p&gt;
&lt;p&gt;The asynchronous job on the other hand will retrieve the task whose id got as a parameter from the database, do the work it needs to do
and update the result when it is&amp;nbsp;finished.&lt;/p&gt;
&lt;p&gt;Unfortunately, the above simple setup will &lt;em&gt;probably&lt;/em&gt; behave erratically by randomly throwing database related&amp;nbsp;errors!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="cause-of-the-problem"&gt;
&lt;h2&gt;Cause of the&amp;nbsp;problem&lt;/h2&gt;
&lt;p&gt;In the previous section I said &lt;em&gt;probably&lt;/em&gt; because the erratic behavior is caused by a specific setting of your Django project; the &lt;tt class="docutils literal"&gt;ATOMIC_REQUESTS&lt;/tt&gt;.
This setting can be set on your database connection and if it is &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;TRUE&lt;/span&gt;&lt;/tt&gt; then each request will be &lt;em&gt;atomic&lt;/em&gt;. This means that each request will be tied with
a database transaction i.e a transaction will be started when your request starts and commited only when your requests finishes; if for some reason your
request throws an error then the transaction will be rolled back. An example of this setting&amp;nbsp;is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;DATABASES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;ENGINE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django.db.backends.sqlite3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;NAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BASE_DIR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;db.sqlite3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;ATOMIC_REQUESTS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, in my opinion, &lt;tt class="docutils literal"&gt;ATOMIC_REQUESTS&lt;/tt&gt; is a great thing to have because it makes everything much easier. I always set it to &lt;tt class="docutils literal"&gt;True&lt;/tt&gt; to my projects because
I don&amp;#8217;t need to actually think about transactions and requests; I know that if there&amp;#8217;s a problem in a request the whole transaction will be rolle back and no
garbage will be left in the database. If on the other hand for some reason a request does not need to be tied to a transaction I just set it off
for this specific transaction (using &lt;cite&gt;transaction.non_atomic_requests_&lt;/cite&gt;). Please notice that by default the &lt;tt class="docutils literal"&gt;ATOMIC_REQUESTS&lt;/tt&gt; has a &lt;tt class="docutils literal"&gt;False&lt;/tt&gt; value which means that
the database will be in autocommit mode meaning that every command will be executed&amp;nbsp;immediately.&lt;/p&gt;
&lt;p&gt;So although the &lt;tt class="docutils literal"&gt;ATOMIC_REQUESTS&lt;/tt&gt; is great, it is actually the reason that there are problems with asynchronous tasks. Why? Let&amp;#8217;s take a closer look at what the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; of the view&amp;nbsp;does:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;#1&lt;/span&gt;
    &lt;span class="n"&gt;get_url_length&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#2&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TasksHomeFormView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#3&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It creates the task in #1, fires off the asynchronous task in #2 and continues the execution of the view processing in #3. The important thing to understand
here is that the transaction will be commited &lt;em&gt;only after #3&lt;/em&gt; is finished. This means that there&amp;#8217;s a possibility that the asynchronous task will be started
before #3 is finished thus it won&amp;#8217;t find the task because the task will &lt;em&gt;not&lt;/em&gt; be created yet(!) This is a little counter-intuitive but you must remember
that the async task is run by a worker which is a different process than your application server; the worker may be able to start before the transaction is&amp;nbsp;commited.&lt;/p&gt;
&lt;p&gt;If you want to actually see the problem &lt;em&gt;every time&lt;/em&gt; you can add a small delay between the start of the async task and the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;get_url_length&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TasksHomeFormView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will make the view more slow so the asynchronous worker will always have time to start executing the task (and get the not found error). Also notice
that if you had &lt;tt class="docutils literal"&gt;ATOMIC_REQUESTS: False&lt;/tt&gt; the above code would work fine because the task would be created immediately (auto-commited) and the async job would be able to find&amp;nbsp;it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-solution"&gt;
&lt;h2&gt;The&amp;nbsp;solution&lt;/h2&gt;
&lt;p&gt;So how is this problem solved? Well it&amp;#8217;s not that difficult now that you know what&amp;#8217;s causing&amp;nbsp;it!&lt;/p&gt;
&lt;p&gt;One solution would be to set &lt;tt class="docutils literal"&gt;ATOMIC_REQUESTS&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;False&lt;/tt&gt; but that would make all database commands auto-commit so you&amp;#8217;ll lose
request-transaction-tieing. Another solution would be to set &lt;tt class="docutils literal"&gt;ATOMIC_REQUESTS&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;True&lt;/tt&gt; and disable atomic requests for the specific view that starts the
asynchronous job using &lt;cite&gt;transaction.non_atomic_requests_&lt;/cite&gt;. This is a viable solution however I don&amp;#8217;t like it because I&amp;#8217;d lose the comfort of transaction per request
for this specific request and I would need to add my own transaction&amp;nbsp;handling.&lt;/p&gt;
&lt;p&gt;A third solution is to avoid messing with the database in your view and create the task object in the async job. Any parameters you want to pass to the async job would be
passed directly to the async function. This may work fine in some cases but I find it more safe to create the task in the database before starting the async job so that
I have better control and error handling. This way even if there&amp;#8217;s an error in my worker and for some reason the async job never starts or it breaks before being able to
handle the database, I will have the task object in the database because it will have been created in the&amp;nbsp;view.&lt;/p&gt;
&lt;p&gt;Is there anything better? Isn&amp;#8217;t there a way to start the executing the async job &lt;em&gt;after&lt;/em&gt; the transaction of the
view is commited? Actually yes, there is! For this, &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.1/topics/db/transactions/#django.db.transaction.on_commit"&gt;transaction.on_commit&lt;/a&gt; comes to the rescue! This function
receives a callback that will be called after the transaction is commited! Thus, to properly fix you project, you should
change the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; method like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;transaction&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;on_commit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;get_url_length&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TasksHomeFormView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that I need to use &lt;tt class="docutils literal"&gt;lambda&lt;/tt&gt; to create a callback function that will call &lt;tt class="docutils literal"&gt;get_url_length.delay(task.id)&lt;/tt&gt; when the transaction is commited. Now
even though I have the delay there the async job will start after the transaction is commited, ie after the view handler is finished (after the 1 second&amp;nbsp;delay).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;From the above you should be able to understand why sometimes you have problems when your async jobs use the database. To fix it you have various
options but at least for me, the best solution is to start your async jobs &lt;em&gt;after&lt;/em&gt; the transaction is commited using &lt;tt class="docutils literal"&gt;transaction.on_commit&lt;/tt&gt;. Just
change each &lt;tt class="docutils literal"&gt;async.job.delay(parameters)&lt;/tt&gt; call to &lt;tt class="docutils literal"&gt;transaction.on_commit(lambda: async.job.delay(parameters))&lt;/tt&gt; and you will be&amp;nbsp;fine!&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="async"></category><category term="tasks"></category><category term="django-rq"></category><category term="rq"></category></entry><entry><title>Use du to find out the disk usage of each directory inÂ unix</title><link href="https://spapas.github.io/2018/11/12/du-disk-usage/" rel="alternate"></link><published>2018-11-12T14:20:00+02:00</published><updated>2018-11-12T14:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2018-11-12:/2018/11/12/du-disk-usage/</id><summary type="html">&lt;p class="first last"&gt;How to use the du utility to find out the disk usage of each directory in&amp;nbsp;unix&lt;/p&gt;
</summary><content type="html">&lt;p&gt;One usual problem I have when dealing with production servers is that their
disks get filled.  This results in various warnings and errors and should be fixed
immediately. The first step to resolve this issue is to actually find out where is that
hard disk space is&amp;nbsp;used!&lt;/p&gt;
&lt;p&gt;For this you can use the &lt;cite&gt;du&lt;/cite&gt; unix tool with some parameters. The problem is that &lt;cite&gt;du&lt;/cite&gt;
has various parameters (not needed for the task at hand) and the various
places I search for contain other info not related to this specific&amp;nbsp;task.&lt;/p&gt;
&lt;p&gt;Thus I&amp;#8217;ve decided to write this small blog post to help people struggling with
this and also to help &lt;em&gt;me&lt;/em&gt; avoid googling for it by searching in pages that
also contain other &lt;tt class="docutils literal"&gt;du&lt;/tt&gt; recipies and also avoid the trial and error that this
would&amp;nbsp;require.&lt;/p&gt;
&lt;p&gt;So to print out the disk usage summary for a directory go to that directory
and run &lt;tt class="docutils literal"&gt;du &lt;span class="pre"&gt;-h&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; *&lt;/tt&gt;; you need to have access to the child subdirectories
so probably it&amp;#8217;s better to try this as root (unless you go to your home dir
for&amp;nbsp;example).&lt;/p&gt;
&lt;p&gt;Here&amp;#8217;s a sample&amp;nbsp;usage:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
[root&amp;#64;server1 /]# cd /
[root&amp;#64;server1 /]# du -h -s *
7.2M    bin
55M     boot
164K    dev
35M     etc
41G     home
236M    lib
25M     lib64
20K     lost+found
8.0K    media
155G    mnt
0       proc
1.6G    root
12M     sbin
8.0K    srv
427M    tmp
3.2G    usr
8.9G    var
&lt;/pre&gt;
&lt;p&gt;The parameters are -h to print human readable sizes (G, M etc) and -s to
print a summary usage of &lt;em&gt;each&lt;/em&gt; parameter. Since this will output the
summary for each parameter I finally pass &lt;tt class="docutils literal"&gt;*&lt;/tt&gt; to be changed to all files/dirs
in that directory. If I used &lt;tt class="docutils literal"&gt;du &lt;span class="pre"&gt;-h&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; /tmp&lt;/tt&gt; instead I&amp;#8217;d get the total usage only for
the &lt;tt class="docutils literal"&gt;/tmp&lt;/tt&gt; directory.&lt;/p&gt;
&lt;p&gt;Another trick that may help you quickly find out the offending directories is to
append the &lt;tt class="docutils literal"&gt;| grep G&lt;/tt&gt; pipe command (i.e run &lt;tt class="docutils literal"&gt;du &lt;span class="pre"&gt;-h&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; * | grep G&lt;/tt&gt;) which will
filter out only the entries containing a &lt;tt class="docutils literal"&gt;G&lt;/tt&gt; (i.e only print the folders having
more than 1 &lt;span class="caps"&gt;GB&lt;/span&gt; size). Yeh I know that this will also print entries that have
also a G in their name but since there aren&amp;#8217;t many directores that have
G in their name you should be&amp;nbsp;ok.&lt;/p&gt;
&lt;p&gt;If you run the above from &lt;tt class="docutils literal"&gt;/&lt;/tt&gt; so that &lt;tt class="docutils literal"&gt;/proc&lt;/tt&gt; is included you may
get a bunch of &lt;tt class="docutils literal"&gt;du: cannot access 'proc/nnn/task/nnn/fd/4': No such file or directory&lt;/tt&gt;
errors; just add the &lt;tt class="docutils literal"&gt;2&amp;gt; /dev/null&lt;/tt&gt; pipe redirect to redirect the stderr output
to &lt;tt class="docutils literal"&gt;/dev/null&lt;/tt&gt;, i.e run &lt;tt class="docutils literal"&gt;du &lt;span class="pre"&gt;-h&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; * 2&amp;gt; /dev/null&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Finally, please notice that if there are &lt;em&gt;lots&lt;/em&gt; of files in your directory you&amp;#8217;ll get
a lot of output entries (since the &lt;cite&gt;*&lt;/cite&gt; will match both files and directories).
In this case you can use &lt;tt class="docutils literal"&gt;echo */&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;ls &lt;span class="pre"&gt;-d&lt;/span&gt; */&lt;/tt&gt; to list only the directories;
append that command inside a ` pair or &lt;tt class="docutils literal"&gt;$()&lt;/tt&gt; (to substitute for the command
output) instead of the &lt;tt class="docutils literal"&gt;*&lt;/tt&gt; to only get the sizes of the
directories, i.e run &lt;tt class="docutils literal"&gt;du &lt;span class="pre"&gt;-h&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; $(echo */)&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;du &lt;span class="pre"&gt;-h&lt;/span&gt; &lt;span class="pre"&gt;-s&lt;/span&gt; `echo */`&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;One thing that you must be aware of is that this command may take &lt;em&gt;a long time&lt;/em&gt;
especially if you have lots of small files somewhere. Just let it run and it
should finish after some time. If it takes too long time try to exclude any
mounted network
directories (either with &lt;span class="caps"&gt;SMB&lt;/span&gt; or &lt;span class="caps"&gt;NFS&lt;/span&gt;) since these will take extra long&amp;nbsp;time.&lt;/p&gt;
&lt;p&gt;Also, if you awant a nice interactive output
using ncurses you can download and compile the &lt;a class="reference external" href="https://dev.yorhel.nl/ncdu"&gt;ncdu tool&lt;/a&gt; (NCurses Disk&amp;nbsp;Usage).&lt;/p&gt;
</content><category term="unix"></category><category term="du"></category><category term="unix"></category><category term="linux"></category><category term="disk-usage"></category></entry><entry><title>Adding a delay to Django HTTPÂ responses</title><link href="https://spapas.github.io/2018/05/08/django-reponse-add-delay/" rel="alternate"></link><published>2018-05-08T23:20:00+03:00</published><updated>2018-05-08T23:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2018-05-08:/2018/05/08/django-reponse-add-delay/</id><summary type="html">&lt;p class="first last"&gt;How add a delay to your Django &lt;span class="caps"&gt;HTTP&lt;/span&gt; responses using a middleware or a &lt;span class="caps"&gt;CBV&lt;/span&gt;&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Sometimes you&amp;#8217;d like to make your Django views more slow by adding a fake delay. This may
sound controversial (why would somebody want to make some of his views slower) however it is a real requirement,
at least when developing an&amp;nbsp;application.&lt;/p&gt;
&lt;p&gt;For example, you may be using a &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; and you want to implement a spinner while your form is loading. However, usually when
developing your responses will load so soon that you won&amp;#8217;t be able to admire your spinner in all its glory! Also, when you
submit a &lt;span class="caps"&gt;POST&lt;/span&gt; form (i.e a form that changes your data), it is advisable to disable your submit button so that when your users
double click it the form won&amp;#8217;t be submitted two times (it may seem strange to some people but this is a very common error that
has bitten me many times; there are many users that think that they need to double click the buttons; thus I always disable
my submit buttons after somebody clicks them); in this case you also need to make your response a little slower to make sure
that the button is actually&amp;nbsp;disabled!&lt;/p&gt;
&lt;p&gt;I will propose two methods for adding this delay to your responses. One that will affect all (or most) your views using
a &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/topics/http/middleware/"&gt;middleware&lt;/a&gt; and another that you can add to any &lt;span class="caps"&gt;CBV&lt;/span&gt; you want using a mixin; please see my previous &lt;a class="reference external" href="https://spapas.github.io/2018/03/19/comprehensive-django-cbv-guide/"&gt;&lt;span class="caps"&gt;CBV&lt;/span&gt; guide&lt;/a&gt; for more on
Django CBVs and mixins. For the middleware solution we&amp;#8217;ll also take a quick look at what is the Django middleware mechanism and
how it can be used to add&amp;nbsp;functionality.&lt;/p&gt;
&lt;div class="section" id="using-middleware"&gt;
&lt;h2&gt;Using&amp;nbsp;middleware&lt;/h2&gt;
&lt;p&gt;The Django &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/topics/http/middleware/"&gt;middleware&lt;/a&gt; is a mechanism for adding your own code to the Django request / response cycle. I&amp;#8217;ll try to explain
this a bit; Django is waiting for an &lt;span class="caps"&gt;HTTP&lt;/span&gt; Request (i.e &lt;span class="caps"&gt;GET&lt;/span&gt; a url with these headers and these query parameters), it will
parse this &lt;span class="caps"&gt;HTTP&lt;/span&gt; Request and prepare an &lt;span class="caps"&gt;HTTP&lt;/span&gt; Response (i.e some headers and a Payload). Your view will be the main actor for
retrieving the &lt;span class="caps"&gt;HTTP&lt;/span&gt; response and returning the &lt;span class="caps"&gt;HTTP&lt;/span&gt; request. However, using this middleware mechanism Django allows you to
enable other actors (the middleware) that will universally modify the &lt;span class="caps"&gt;HTTP&lt;/span&gt; request before passing it to your view and will also
modify the view&amp;#8217;s &lt;span class="caps"&gt;HTTP&lt;/span&gt; respone before sending it back to the&amp;nbsp;client.&lt;/p&gt;
&lt;p&gt;Actually, a list of middleware called &amp;#8230; &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;MIDDLEWARE&lt;/span&gt;&lt;/tt&gt; is &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/topics/http/middleware/#activating-middleware"&gt;defined by default&lt;/a&gt; in the &lt;tt class="docutils literal"&gt;settings.py&lt;/tt&gt; of all new Django
projects; these are used to add various capabilities
that are universally needed, for example session support, various security enablers, django message support and others. You
can easily attach your own middleware to that list to add extra functionality. Notice that the order of the middleware in the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;MIDDLEWARE&lt;/span&gt;&lt;/tt&gt;
list actually matters. Middleware later in the list will be executed after the ones previous in the list; we&amp;#8217;ll see some consequences of this&amp;nbsp;later.&lt;/p&gt;
&lt;p&gt;Now the time has come to take a quick look at how to implement a middleware, &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/topics/http/middleware/#writing-your-own-middleware"&gt;taken from the Django docs&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SimpleMiddleware&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_response&lt;/span&gt;
        &lt;span class="c1"&gt;# One-time configuration and initialization.&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__call__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c1"&gt;# Code to be executed for each request before&lt;/span&gt;
        &lt;span class="c1"&gt;# the view (and later middleware) are called.&lt;/span&gt;

        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;# Code to be executed for each request/response after&lt;/span&gt;
        &lt;span class="c1"&gt;# the view is called.&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Actually you can implement the middleware as a nested function however I prefer the classy version. The comments should be really enlightening:
When your project is started the constructor (&lt;tt class="docutils literal"&gt;__init__&lt;/tt&gt;) will be called once, for example if you want to read a configuration setting from the database
then you should do it in the &lt;tt class="docutils literal"&gt;__init__&lt;/tt&gt; to avoid calling the database everytime your middleware is executed (i.e for &lt;em&gt;every&lt;/em&gt; request). The &lt;tt class="docutils literal"&gt;__call__&lt;/tt&gt; is
a special method that gets translated to calling this class instance as a function, i.e if you do something&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;sm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SimpleMiddleware&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;sm&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then &lt;tt class="docutils literal"&gt;sm()&lt;/tt&gt; will execute the &lt;tt class="docutils literal"&gt;__call__&lt;/tt&gt;; there are various similar &lt;a class="reference external" href="http://www.diveintopython3.net/special-method-names.html"&gt;python special methods&lt;/a&gt;, for example &lt;tt class="docutils literal"&gt;__len__&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;__eq__&lt;/tt&gt; etc&lt;/p&gt;
&lt;p&gt;Now, as you can see the &lt;tt class="docutils literal"&gt;__call__&lt;/tt&gt; special method has four&amp;nbsp;parts:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Code that is executed &lt;em&gt;before&lt;/em&gt; the &lt;tt class="docutils literal"&gt;self.get_response()&lt;/tt&gt; method is called; here you should modify the request object. Middleware will reach this point in the order they are&amp;nbsp;listed.&lt;/li&gt;
&lt;li&gt;The actual call to &lt;tt class="docutils literal"&gt;self.get_response()&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Code that is executed &lt;em&gt;after&lt;/em&gt; the &lt;tt class="docutils literal"&gt;self.get_response()&lt;/tt&gt; method is called; here you should modify the response object. Middleware will reach this point in the reverse order they are&amp;nbsp;listed.&lt;/li&gt;
&lt;li&gt;Returning the response to be used by the next&amp;nbsp;middleware&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Notice that &lt;tt class="docutils literal"&gt;get_response&lt;/tt&gt; will call the next middleware; while the &lt;tt class="docutils literal"&gt;get_response&lt;/tt&gt; for the last middleware will actually call the view. Then
the view will return a response which could be modified (if needed) by the middlewares in the opposite order of their definition&amp;nbsp;list.&lt;/p&gt;
&lt;p&gt;As an example, let&amp;#8217;s define two simple&amp;nbsp;middlewares:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;M1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_response&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__call__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;M1 before response&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;M1 after response&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;M2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_response&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__call__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;M2 before response&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;M2 after response&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When you define &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;MIDDLEWARE&lt;/span&gt; = ['M1', 'M2']&lt;/tt&gt; you&amp;#8217;ll see the&amp;nbsp;following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Got the request&lt;/span&gt;
&lt;span class="n"&gt;M1&lt;/span&gt; &lt;span class="n"&gt;before&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;span class="n"&gt;M2&lt;/span&gt; &lt;span class="n"&gt;before&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;span class="c1"&gt;# The view is rendered to the response now&lt;/span&gt;
&lt;span class="n"&gt;M2&lt;/span&gt; &lt;span class="n"&gt;after&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;span class="n"&gt;M1&lt;/span&gt; &lt;span class="n"&gt;after&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;span class="c1"&gt;# Return the response&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Please notice a middleware may not call &lt;tt class="docutils literal"&gt;self.get_response&lt;/tt&gt; to continue the chain but return directly a response (for example a 403 Forbiden&amp;nbsp;response).&lt;/p&gt;
&lt;p&gt;After this quick introduction to how middleware works, let&amp;#8217;s take a look at a skeleton for the time-delay&amp;nbsp;middleware:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TimeDelayMiddleware&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_response&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__call__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is really simple, I&amp;#8217;ve just added an extra line to the previous middleware. This line adds a one-second delay to all responses. I&amp;#8217;ve
added it before &lt;tt class="docutils literal"&gt;self.get_response&lt;/tt&gt; - because this delay does not depend on anything, I could have added it after &lt;tt class="docutils literal"&gt;self.get_response&lt;/tt&gt;
without changes in the behavior. Also, the order of this middleware in the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;MIDDLEWARE&lt;/span&gt;&lt;/tt&gt; list doesn&amp;#8217;t matter since it doesn&amp;#8217;t depend on
other middleware (it just needs to run to add the&amp;nbsp;delay).&lt;/p&gt;
&lt;p&gt;This middleware may have a little more functionality, for example to configure the delay from the settings or add the delay only for
specific urls (by checking the &lt;tt class="docutils literal"&gt;request.path&lt;/tt&gt;).
Here&amp;#8217;s how these extra features could be&amp;nbsp;implemented:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TimeDelayMiddleware&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_response&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;REQUEST_TIME_DELAY&lt;/span&gt;


    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__call__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/api/&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above will add the delay only to requests whose path contains &lt;tt class="docutils literal"&gt;'/api'&lt;/tt&gt;. Another case is if you want to
only add the delay for &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; requests by checking that &lt;tt class="docutils literal"&gt;request.method == '&lt;span class="caps"&gt;POST&lt;/span&gt;'&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Now, to install this middleware, you can configure your &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;MIDDLEWARE&lt;/span&gt;&lt;/tt&gt; like this in your &lt;tt class="docutils literal"&gt;settings.py&lt;/tt&gt;
(let&amp;#8217;s say that you have an application named &lt;tt class="docutils literal"&gt;core&lt;/tt&gt; containing a module named &lt;tt class="docutils literal"&gt;middleware&lt;/tt&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;MIDDLEWARE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.middleware.security.SecurityMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.sessions.middleware.SessionMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.middleware.common.CommonMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.middleware.csrf.CsrfViewMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.auth.middleware.AuthenticationMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.messages.middleware.MessageMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.middleware.clickjacking.XFrameOptionsMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;

    &lt;span class="s1"&gt;&amp;#39;core.middleware.TimeDelayMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The other middleware are the default ones in Django. One more thing to consider is that if
you have a single settings.py this middleware will be called; one way to override the delay
is to check for settings.&lt;span class="caps"&gt;DEBUG&lt;/span&gt; and only call &lt;tt class="docutils literal"&gt;time.sleep&lt;/tt&gt; when &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DEBUG&lt;/span&gt; == True&lt;/tt&gt;. However,
the proper way to do it is to have different settings for your development and production
environments and add the &lt;tt class="docutils literal"&gt;TimeDelayMiddleware&lt;/tt&gt; only to your development &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;MIDDLEWARE&lt;/span&gt;&lt;/tt&gt; list.
Having different settings for each development is a &lt;a class="reference external" href="https://medium.com/&amp;#64;ayarshabeer/django-best-practice-settings-file-for-multiple-environments-6d71c6966ee2"&gt;common practice in Django&lt;/a&gt; and I totally
recommend to use&amp;nbsp;it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-cbvs"&gt;
&lt;h2&gt;Using&amp;nbsp;CBVs&lt;/h2&gt;
&lt;p&gt;Another method to add a delay to the execution of a view is to implement a TimeDelayMixin and inherit
your Class Based View from it. As we&amp;#8217;ve seen in the &lt;a class="reference external" href="https://spapas.github.io/2018/03/19/comprehensive-django-cbv-guide/"&gt;&lt;span class="caps"&gt;CBV&lt;/span&gt; guide&lt;/a&gt;, the &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; method is the one
that is always called when your &lt;span class="caps"&gt;CBV&lt;/span&gt; is rendered, thus your &lt;tt class="docutils literal"&gt;TimeDelayMixin&lt;/tt&gt; could be implemented like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TimeDelayMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is very simple (and you can use similar techniques as described for the middleware above to configure
the delay time or add the delay only when &lt;tt class="docutils literal"&gt;settings.&lt;span class="caps"&gt;DEBUG&lt;/span&gt; == True&lt;/tt&gt; etc) - to actually use it, just inherit your
view from this mixin,&amp;nbsp;f.e:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DelayedSampleListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TimeDelayMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Sample&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now whenever you call your &lt;tt class="docutils literal"&gt;DelayedSampleListView&lt;/tt&gt; you&amp;#8217;ll see it after the configured&amp;nbsp;delay!&lt;/p&gt;
&lt;p&gt;What is really interesting is that the &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; method actually exists (and has the same functionality) also
in Django Rest Framework CBVs, thus using the same mixin you can add the delay not only your normal CBVs but
also your &lt;span class="caps"&gt;DRF&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt;&amp;nbsp;views!&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="python"></category><category term="django"></category><category term="cbv"></category><category term="middleware"></category><category term="class-based-views"></category></entry><entry><title>Easy immutable objects inÂ Javascript</title><link href="https://spapas.github.io/2018/04/05/easy-immutable-objects/" rel="alternate"></link><published>2018-04-05T12:20:00+03:00</published><updated>2018-04-05T12:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2018-04-05:/2018/04/05/easy-immutable-objects/</id><summary type="html">&lt;p class="first last"&gt;How to avoid mutations in your objects and a poor man&amp;#8217;s&amp;nbsp;lens!&lt;/p&gt;
</summary><content type="html">&lt;p&gt;With the rise of &lt;a class="reference external" href="https://redux.js.org"&gt;Redux&lt;/a&gt; and other similar Javascript frameworks (e.g &lt;a class="reference external" href="https://hyperapp.js.org"&gt;Hyperapp&lt;/a&gt;) that
try to be a little more &lt;em&gt;functional&lt;/em&gt; (functional as in functional programming), a
new problem was introduced to Javascript programmers (at least to those that weren&amp;#8217;t
familair with functional programming): How to keep their application&amp;#8217;s
state&amp;nbsp;&amp;#8220;immutable&amp;#8221;.&lt;/p&gt;
&lt;p&gt;Immutable means that the state should be an object that does not change (mutates) - instead
of changing it, Redux needs the state object to be &lt;a class="reference external" href="https://redux.js.org/basics/reducers"&gt;created from the beginning&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So when something happens in your application you need to discard
the existing state object and create a new one from scratch by modifying and copying the previous state values.
This is easy
in most toy-apps that are used when introducing the concept, for example if your state is &lt;tt class="docutils literal"&gt;{counter: 0}&lt;/tt&gt;
then you could just define the reducer for the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ADD&lt;/span&gt;&lt;/tt&gt; action (i.e when the user clicks the &lt;tt class="docutils literal"&gt;+&lt;/tt&gt; button) like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;reducer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;counter&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ADD&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;counter&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;counter&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Unfortunately, your application will definitely have a much more complex state than&amp;nbsp;this!&lt;/p&gt;
&lt;p&gt;In the following, I&amp;#8217;ll do a quick introduction on how to keep your state objects immutable
using modern Javascript techniques, I&amp;#8217;ll present how complex it is to modify non-trivial
immutable objects and finally I&amp;#8217;ll give you a quick recipe for modifying your non-trivial
immutable objects. If you want to play with the concepts I&amp;#8217;ll introduce you can do it at a
&lt;a class="reference external" href="https://repl.it/&amp;#64;spapas/JS-Drill-Down-objectarray-immutable"&gt;playground I&amp;#8217;ve created on repl.it&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Please keep in mind that this article has been written for &lt;span class="caps"&gt;ES6&lt;/span&gt; - take a look at my
&lt;a class="reference external" href="https://spapas.github.io/2015/11/16/using-browserify-es6/"&gt;browserify with &lt;span class="caps"&gt;ES6&lt;/span&gt;&lt;/a&gt; article to see how you can also use it in your projects with&amp;nbsp;Browserify.&lt;/p&gt;
&lt;p&gt;Also, if you&amp;#8217;d like to see a non-toy React + Redux application or you&amp;#8217;d like a gentle
introduction to the concepts I talked about (state, reducers, actions etc)
you can follow along my &lt;a class="reference external" href="https://spapas.github.io/2016/03/02/react-redux-tutorial/"&gt;React Redux tutorial&lt;/a&gt;. This is a rather old article
(considering how quickly the Javascript framework state change) but the basic concepts
introduced there are true&amp;nbsp;today.&lt;/p&gt;
&lt;div class="section" id="immutable-objects"&gt;
&lt;h2&gt;Immutable&amp;nbsp;objects&lt;/h2&gt;
&lt;p&gt;Let&amp;#8217;s start our descent into avoiding mutations by supposing that you had
something a little more complex than the initial example, for example your state was like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;counter&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;John&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;36&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you continued the same example then your &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ADD&lt;/span&gt;&lt;/tt&gt; reducer would need to return something like&amp;nbsp;this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;counter&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;counter&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;age&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This gets difficult and error prone very soon - and what happens if you later need to add another attribute to your&amp;nbsp;state?&lt;/p&gt;
&lt;p&gt;The correct way to implement this would be to enumerate all properties of state except &amp;#8216;counter&amp;#8217;, copy them to a new
object, and then assign counter+1 to the new object&amp;#8217;s counter attribute. You could implement this by hand however,
thankfully, there&amp;#8217;s the &lt;a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign"&gt;Object.assign&lt;/a&gt; method! This method will copy all attributes from a list of objects
to an object which will return as a result and is defined like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;sources&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;target&lt;/tt&gt; parameter is the object that will retrieve all attributes from &lt;tt class="docutils literal"&gt;sources&lt;/tt&gt; (which is a variadic argument - you can
have as many sources as you want - even 0; in this case the target will be returned). For a quick example,&amp;nbsp;running:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;o&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;oo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;o&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;oo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;o&lt;/span&gt;&lt;span class="o"&gt;===&lt;/span&gt;&lt;span class="nx"&gt;oo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;will return &lt;tt class="docutils literal"&gt;{ a: 1, b: 2, c: 3 } true&lt;/tt&gt; i.e the attributes &amp;#8216;b&amp;#8217; and &amp;#8216;c&amp;#8217; were copied to &lt;tt class="docutils literal"&gt;o&lt;/tt&gt; and it was assigned to &lt;tt class="docutils literal"&gt;oo&lt;/tt&gt; &amp;#8212; notice
that o and oo are the same object (thus &lt;tt class="docutils literal"&gt;o&lt;/tt&gt; is modified now). Also, notice that the the attributes of objects to the right
have priority over the attributes of the objects to the left (&lt;tt class="docutils literal"&gt;'c': 1&lt;/tt&gt; was overriden by &lt;tt class="docutils literal"&gt;'c': 3&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;As you should have guessed by now, you should never pass the
state as the &lt;tt class="docutils literal"&gt;target&lt;/tt&gt; but instead you should create a new object, thus the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ADD&lt;/span&gt;&lt;/tt&gt; reducer should return the&amp;nbsp;following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;counter&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;counter&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This means that it will create a new object which will copy all current attributes of state and increase the existing
&lt;tt class="docutils literal"&gt;counter&lt;/tt&gt; attribute.&lt;/p&gt;
&lt;p&gt;I&amp;#8217;d like to also add here that instead of using the &lt;tt class="docutils literal"&gt;Object.assign&lt;/tt&gt; method you could use the &lt;a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_syntax"&gt;spread syntax&lt;/a&gt;
to more or less do the same. The spread syntax on an object takes this object&amp;#8217;s attributes and outputs them as key-value
dictionary pairs (for them to be used to initialize other objects). Thus, you can use the spread syntax to create an new object that has the same attributes
of another object like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;newState&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="c1"&gt;// which is similar to&lt;/span&gt;
&lt;span class="nx"&gt;newState&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Of course you usually need to override some attributes, which can be passed directly to the newly created object,
for example for the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ADD&lt;/span&gt;&lt;/tt&gt; reducer:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;counter&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;counter&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Like &lt;tt class="docutils literal"&gt;Object.assign&lt;/tt&gt;, you can have as many sources as you want in your spread syntax thus nothing stops you from using &lt;tt class="docutils literal"&gt;...&lt;/tt&gt; multiple times to copy the attributes of multiple objects
for example you could define &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ADD&lt;/span&gt;&lt;/tt&gt; like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;counter&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;counter&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The order is similar to Object.assign, i.e the attributes that follow will override the previous&amp;nbsp;ones.&lt;/p&gt;
&lt;p&gt;One final comment is that both &lt;tt class="docutils literal"&gt;Object.assign&lt;/tt&gt; and copying objects with the spread syntax will do a &amp;#8220;shallow&amp;#8221;
copy i.e it will copy only the outer object, not the objects its keys refer to. An example of this behavior is that
if you run the&amp;nbsp;following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;val&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;val2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;
&lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;val2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;val&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;33&lt;/span&gt;
&lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;you&amp;#8217;ll&amp;nbsp;get:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;33&lt;/span&gt; &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="nx"&gt;val2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;33&lt;/span&gt; &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="nx"&gt;val2&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;i.e &lt;tt class="docutils literal"&gt;x&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;y&lt;/tt&gt; got a different &lt;tt class="docutils literal"&gt;val2&lt;/tt&gt; attribute since they not the same object, however both &lt;tt class="docutils literal"&gt;x&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;y&lt;/tt&gt;
have a reference to the &lt;em&gt;same&lt;/em&gt; &lt;tt class="docutils literal"&gt;a&lt;/tt&gt; thus when it&amp;#8217;s &lt;tt class="docutils literal"&gt;val&lt;/tt&gt; attribute was changed this change appears to both &lt;tt class="docutils literal"&gt;x&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;y&lt;/tt&gt;!&lt;/p&gt;
&lt;p&gt;What the above means is that if you have a state object containing
other objects (or arrays) you will also need to copy these children
objects to keep your state immutable. We&amp;#8217;ll see examples on this&amp;nbsp;later.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="immutable-arrays"&gt;
&lt;h2&gt;Immutable&amp;nbsp;arrays&lt;/h2&gt;
&lt;p&gt;One thing we haven&amp;#8217;t talked about yet is what happens if there&amp;#8217;s an array in the state, for example your state is
&lt;tt class="docutils literal"&gt;let &lt;span class="pre"&gt;state=[]&lt;/span&gt;&lt;/tt&gt; and you have and &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;APPEND&lt;/span&gt;&lt;/tt&gt; reducer that puts something in the end of that array. The naive (and wrong)
way to do it is to call &lt;tt class="docutils literal"&gt;push&lt;/tt&gt; directly to the state - this will mutate your state and is not be&amp;nbsp;allowed!&lt;/p&gt;
&lt;p&gt;You need to copy the array elements and the tool for this job is &lt;a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/slice"&gt;Array.slice&lt;/a&gt;. This methods takes two optional arguments (&lt;tt class="docutils literal"&gt;begin&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;end&lt;/tt&gt;) that define the range of elements that will be copied; if you call it without arguments then it will copy
the whole array. Using slice, your &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;APPEND&lt;/span&gt;&lt;/tt&gt; reducer can be like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;newState&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="nx"&gt;newState&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;new element&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;newState&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Also, you could use the &lt;cite&gt;Array.concat&lt;/cite&gt; method which will return a new array by copying all the elements of its&amp;nbsp;arguments&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;new element&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will append &lt;tt class="docutils literal"&gt;new element&lt;/tt&gt; to a new object that will have the elements of state (it won&amp;#8217;t modify the
existing state) and is easier if you have this exact requirement. The advantage of slice is that you can
use it to add/remove/modify elements from any place in the original array. For example, here&amp;#8217;s how you can
add an element after the first element of an&amp;nbsp;array:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;c&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;second&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now &lt;tt class="docutils literal"&gt;y&lt;/tt&gt; will be equal to &lt;tt class="docutils literal"&gt;[ 'a', 'second', 'b', 'c' ]&lt;/tt&gt;. So the above will get the first (0-th) element from the &lt;tt class="docutils literal"&gt;x&lt;/tt&gt;
array and concat it with another element (&lt;tt class="docutils literal"&gt;second&lt;/tt&gt;) and the remaining elements of &lt;tt class="docutils literal"&gt;x&lt;/tt&gt;. Remember that &lt;tt class="docutils literal"&gt;x&lt;/tt&gt; is not
modifyied since &lt;tt class="docutils literal"&gt;concat&lt;/tt&gt; will create a new&amp;nbsp;array.&lt;/p&gt;
&lt;p&gt;In a similar fashion to objects, instead of using concat it is much easier to use the spread syntax. The spread syntax for
an array will output its elements one after the other for them to be used by other arrays. Thus, continuing from the
previous example, &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;[...x]&lt;/span&gt;&lt;/tt&gt; will return a new array with the elements of &lt;tt class="docutils literal"&gt;x&lt;/tt&gt; (so it is similar to &lt;tt class="docutils literal"&gt;x.slice()&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;x.concat()&lt;/tt&gt;),
thus to re-generate the previous example you&amp;#8217;ll do something&amp;nbsp;like&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[...&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;second&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;All three of concat, slice or the spread syntax will do a shallow copy (similar to how Object.assign works) so the same
conclusions from the previous section are true here: If you have arrays inside other arrays (or objects) you&amp;#8217;ll need to copy the inner
arrays&amp;nbsp;recursively.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="more-complex-cases"&gt;
&lt;h2&gt;More complex&amp;nbsp;cases&lt;/h2&gt;
&lt;p&gt;We&amp;#8217;ll now take a look at some more complex cases and see how quickly it gets difficult because of the shallow copying.
Let&amp;#8217;s suppose that our state is the&amp;nbsp;following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;first_name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;John&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;last_name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Doe&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;address&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="s1"&gt;&amp;#39;city&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Athens&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="s1"&gt;&amp;#39;country&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Greece&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="s1"&gt;&amp;#39;zip&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;12345&amp;#39;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and we want to assign a &lt;tt class="docutils literal"&gt;group&lt;/tt&gt; attribute to the state. This can be easily done with &lt;tt class="docutils literal"&gt;assign&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;groups&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;group1&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;}]&lt;/span&gt;

&lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="s1"&gt;&amp;#39;groups&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;groups&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;or&amp;nbsp;spread:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;groups&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;groups&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that instead of &lt;tt class="docutils literal"&gt;'groups': groups&lt;/tt&gt; I could have used the &lt;a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Object_initializer#Syntax"&gt;shorthand syntax&lt;/a&gt; and written only &lt;tt class="docutils literal"&gt;groups&lt;/tt&gt; and it would still work
(i.e &lt;tt class="docutils literal"&gt;state = &lt;span class="pre"&gt;{...state,&lt;/span&gt; groups}&lt;/tt&gt; is the same). In all cases, the resulting state will&amp;nbsp;be:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;first_name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;John&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;last_name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Doe&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;address&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="s1"&gt;&amp;#39;city&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Athens&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="s1"&gt;&amp;#39;country&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Greece&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="s1"&gt;&amp;#39;zip&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;12345&amp;#39;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="s1"&gt;&amp;#39;groups&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;group1&amp;#39;&lt;/span&gt;
  &lt;span class="p"&gt;}]&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;From now on I&amp;#8217;ll only use the spread syntax which is more&amp;nbsp;compact.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s try to change the user&amp;#8217;s name. This is not as easy as the first example because we need&amp;nbsp;to:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Create a new copy of the &lt;tt class="docutils literal"&gt;user&lt;/tt&gt; object with the new first&amp;nbsp;name&lt;/li&gt;
&lt;li&gt;Create a new copy of the &lt;tt class="docutils literal"&gt;state&lt;/tt&gt; object with the new user object created&amp;nbsp;above&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This can be done in two steps like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;first_name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Jack&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;user&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;or in one step like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;first_name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Jack&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The single step assignment is the combination of the two step described above. It is a little more complex
but it saves typing and is prefered because it allows the reducer function to have a single expression. Now
let&amp;#8217;s try to modify the user&amp;#8217;s zip code. We&amp;#8217;ll do it in three steps&amp;nbsp;first:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;address&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;address&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zip&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;54321&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="nx"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="nx"&gt;address&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;user&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And now in&amp;nbsp;one:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;address&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;address&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zip&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;54321&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, as can be seen in the above examples, modifying (without mutating) a compex state object
is not very easy - it needs much thinking and is too error prone! This will be even more
apparent when we also get the array modifications into the equation, for example by adding another
two&amp;nbsp;groups:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;groups&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;groups&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;group2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;group3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above copies the existing state and assigns to it a new &lt;tt class="docutils literal"&gt;groups&lt;/tt&gt; object by copying
the existing groups and appending two more groups to that array! The state now will&amp;nbsp;be:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;user&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;first_name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Jack&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;last_name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Doe&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;address&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;city&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Athens&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;country&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Greece&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;zip&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;54321&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="nx"&gt;groups&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;group1&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;group2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;group3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As a final examply, how can we add the missing &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; attribute to the first group?
Following the above&amp;nbsp;techniques:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;groups&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;groups&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;groups&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One more time what the above&amp;nbsp;does?&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Creates a new object and copies all existing properties of state to&amp;nbsp;it&lt;/li&gt;
&lt;li&gt;Creates a new array which assigns it to the new state&amp;#8217;s &lt;tt class="docutils literal"&gt;groups&lt;/tt&gt; attribute&lt;/li&gt;
&lt;li&gt;For the first element of that array it copies all attributes of the first element of state[&amp;#8216;groups&amp;#8217;] and assings it an &lt;tt class="docutils literal"&gt;id=1&lt;/tt&gt; attribute&lt;/li&gt;
&lt;li&gt;For the remaining elements of that array it copies all elements of state[&amp;#8216;groups] after the first&amp;nbsp;one&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now think what would happen if we had an even more complex state with 3 or 4 nested&amp;nbsp;levels!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="immutability-s-little-helpers"&gt;
&lt;h2&gt;Immutability&amp;#8217;s little&amp;nbsp;helpers&lt;/h2&gt;
&lt;p&gt;As you&amp;#8217;ve seen from the previous examples, using immutable objects is not as easy as seems from
the toy examples. Actually, drilling down into complex immutable
objects and returning new ones that have
some values changed  is a well-known problem in the functional world and has already a solution
called &amp;#8220;lenses&amp;#8221;. This is a funny name but it more or less means that you use a magnifying lens to look at
exactly the value you want and modify or retrieve it. The problem with lenses is that although they solve
the problem I mention is that if you want to use them you&amp;#8217;ll need to dive deep into functional
programming and also you&amp;#8217;ll need to include an extra library to your project (even if you only
want this specific&amp;nbsp;capability).&lt;/p&gt;
&lt;p&gt;For completeness, here&amp;#8217;s the &lt;a class="reference external" href="http://ramdajs.com/docs/#lens"&gt;the docs on lens&lt;/a&gt; from &lt;a class="reference external" href="http://ramdajs.com"&gt;Ramda&lt;/a&gt; which is a well known Javascript functional library.
This needs you to understand what is &lt;tt class="docutils literal"&gt;prop&lt;/tt&gt;, what is &lt;tt class="docutils literal"&gt;assoc&lt;/tt&gt; and then how to use the lens with &lt;tt class="docutils literal"&gt;view&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;set&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;over&lt;/tt&gt;. For me, these are way too much things to remember for such a specific thing. Also, notice
that the minified version of Ramda is around 45 kb which is not small. Yes, if I wanted
to fully use Ramda or a similar library I&amp;#8217;d be delighted to use all these techniques and include it as a
dependency - however most people prefer to stick with more familiar (and more procedural)&amp;nbsp;concepts.&lt;/p&gt;
&lt;p&gt;The helpers I&amp;#8217;m going to present here are more or less a poor man&amp;#8217;s lens, i.e you will be able to use the basic
functionality of a lens&amp;nbsp;but&amp;#8230;&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;without the peculiar syntax&amp;nbsp;and&lt;/li&gt;
&lt;li&gt;without the need to learn more functional concepts than what you&amp;#8217;ll want&amp;nbsp;and&lt;/li&gt;
&lt;li&gt;without the need to include any more external&amp;nbsp;dependencies&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Pretty good deal,&amp;nbsp;no?&lt;/p&gt;
&lt;p&gt;In any case, a lens has two parts, a get and a set. The get will be used to drill down and retrieve a value from a
complex object while the set will be used to drill down and assign a value to a complex object. The set does not
modify the object but returns a new one. The get lens is not really needed since you can easily drill down to an
object using the good old index syntax but I&amp;#8217;ll include it here for&amp;nbsp;completenes.&lt;/p&gt;
&lt;p&gt;We&amp;#8217;ll start with the get which seems easier. For this, I&amp;#8217;ll just create a function that will take an object and
a path inside that object as parameter and retrieve the value at that path. The path could be either a string of the form
&amp;#8216;a.0.c.d&amp;#8217; or an array [&amp;#8216;a&amp;#8217;, &amp;#8216;0&amp;#8217;, &amp;#8216;c&amp;#8217;, &amp;#8216;d&amp;#8217;] - for numerical indeces we&amp;#8217;ll consider an array at that&amp;nbsp;point.&lt;/p&gt;
&lt;p&gt;Thus, for the object &lt;tt class="docutils literal"&gt;{'a': &lt;span class="pre"&gt;[{'b':&lt;/span&gt; {'c': {'d': 32} &lt;span class="pre"&gt;}}]}&lt;/span&gt;&lt;/tt&gt; when the lens getter is called with either
&lt;tt class="docutils literal"&gt;'a.0.b.c'&lt;/tt&gt; or [&amp;#8216;a&amp;#8217;, 0, &amp;#8216;b&amp;#8217;, &amp;#8216;c&amp;#8217;] as the path, it should return &lt;tt class="docutils literal"&gt;{'d': 32}&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;To implement the get helper I will use a functional concept, &lt;tt class="docutils literal"&gt;reduce&lt;/tt&gt;. I&amp;#8217;ve already explained this concept
in my &lt;a class="reference external" href="https://spapas.github.io/2016/03/02/react-redux-tutorial/#interlude-so-what-s-a-reducer"&gt;previous react-redux tutorial&lt;/a&gt; so I urge you to read that article for more info. Using reduce we
can apply one by one accumulatively the members of the path to the initial object and the result will be
the value of that path. Here&amp;#8217;s the implementation of &lt;tt class="docutils literal"&gt;pget&lt;/tt&gt; (from property&amp;nbsp;get):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;objgetter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;accumulator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;currentValue&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;accumulator&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;currentValue&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;pget&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;  &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;typeof&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;string&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt; &lt;span class="k"&gt;instanceof&lt;/span&gt; &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;path&lt;/span&gt;
&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;reduce&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;objgetter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I have defined an objgetter reducer function that gets an accumulated object and the current
value of the path and just returns the &lt;tt class="docutils literal"&gt;currentValue&lt;/tt&gt; index of that accumulated object. Finally,
for the get lens (named &lt;tt class="docutils literal"&gt;pget&lt;/tt&gt;) I just check to see if the path is a string or an array (if it&amp;#8217;s
a string I split it on dots) and then I &amp;#8220;reduce&amp;#8221; the path using the objgetter defined above and
starting by the original object as the initial value. To understand how it is working, let&amp;#8217;s try calling it
for an&amp;nbsp;object:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;s1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;d&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;}}]}&lt;/span&gt;
&lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;pget&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;s1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above &lt;tt class="docutils literal"&gt;pget&lt;/tt&gt; will call &lt;tt class="docutils literal"&gt;reduce&lt;/tt&gt; on the passed array using the defined &lt;tt class="docutils literal"&gt;objgetter&lt;/tt&gt; above
as the reducer function and &lt;tt class="docutils literal"&gt;s1&lt;/tt&gt; as the original object. So, the reducer function will be called with
the following values each&amp;nbsp;time:&lt;/p&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="68%" /&gt;
&lt;col width="32%" /&gt;
&lt;/colgroup&gt;
&lt;thead valign="bottom"&gt;
&lt;tr&gt;&lt;th class="head"&gt;accumulator&lt;/th&gt;
&lt;th class="head"&gt;currentvalue&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;&lt;tt class="docutils literal"&gt;s1&lt;/tt&gt;&lt;/td&gt;
&lt;td&gt;&lt;tt class="docutils literal"&gt;'a'&lt;/tt&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;s1['a']&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;
&lt;td&gt;&lt;tt class="docutils literal"&gt;0&lt;/tt&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;s1['a'][0]&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;
&lt;td&gt;&lt;tt class="docutils literal"&gt;'b'&lt;/tt&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;s1['a'][0]['b']&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;
&lt;td&gt;&lt;tt class="docutils literal"&gt;'c'&lt;/tt&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;s1['a'][0]['b']['c']&lt;/span&gt;&lt;/tt&gt;&lt;/td&gt;
&lt;td&gt;&amp;nbsp;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Thus the result will be exactly what we wanted &lt;tt class="docutils literal"&gt;{'d' :32}&lt;/tt&gt;. An interesting thing is that it&amp;#8217;s working
fine without the need to differentiate between arrays and objects because of how index access &lt;tt class="docutils literal"&gt;[]&lt;/tt&gt; works.&lt;/p&gt;
&lt;p&gt;Continuing for the set lens (which will be more difficult), I&amp;#8217;ll first represent a simple version that
works only with objects and an array path but displays the main idea of how this will work: It uses recursion i.e it will call itself to gradually build the new object. Here&amp;#8217;s how it is&amp;nbsp;implemented:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;pset0&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

  &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;remaining&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;pset0&lt;/span&gt;&lt;span class="p"&gt;(...[&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;]],&lt;/span&gt; &lt;span class="nx"&gt;remaining&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As already explained, I have assumed that the path is an array of indeces and that the &lt;tt class="docutils literal"&gt;obj&lt;/tt&gt; is a complex object
(no arrays in it please); the function returns a new object with the old object&amp;#8217;s value at the path be replaced
with &lt;tt class="docutils literal"&gt;val&lt;/tt&gt;. This function checks to see if the path has only one element, if yes it will assign the value to that
attribute of the object it retrieve. If not, it will call itself recursively by skipping the current index and assign the return value to the
current index of the curent object. Let&amp;#8217;s see how it works for the following&amp;nbsp;call:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;s2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;a0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;b0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;c0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;pset0&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;s2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="7%" /&gt;
&lt;col width="34%" /&gt;
&lt;col width="59%" /&gt;
&lt;/colgroup&gt;
&lt;thead valign="bottom"&gt;
&lt;tr&gt;&lt;th class="head"&gt;# Call&lt;/th&gt;
&lt;th class="head"&gt;Call parameters&lt;/th&gt;
&lt;th class="head"&gt;Return&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;pset0(s2, [&amp;#8216;a&amp;#8217;, &amp;#8216;b&amp;#8217;, &amp;#8216;c&amp;#8217;], 4)&lt;/td&gt;
&lt;td&gt;{&amp;#8230;s2, [&amp;#8216;b&amp;#8217;]: pset0(s2[&amp;#8216;a&amp;#8217;], [&amp;#8216;b&amp;#8217;, &amp;#8216;c&amp;#8217;], 4) }&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;pset0(s2[&amp;#8216;a&amp;#8217;], [&amp;#8216;b&amp;#8217;, &amp;#8216;c&amp;#8217;], 4)&lt;/td&gt;
&lt;td&gt;{&amp;#8230;s2[&amp;#8216;a&amp;#8217;], [&amp;#8216;c&amp;#8217;]: pset0(s2[&amp;#8216;a&amp;#8217;][&amp;#8216;b&amp;#8217;], [&amp;#8216;c&amp;#8217;], 4) }&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;pset0(s2[&amp;#8216;a&amp;#8217;][&amp;#8216;b&amp;#8217;], [&amp;#8216;c&amp;#8217;], 4)&lt;/td&gt;
&lt;td&gt;{&amp;#8230;s2[&amp;#8216;a&amp;#8217;][&amp;#8216;b&amp;#8217;], [&amp;#8216;c&amp;#8217;]: 4}&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Thus, the first time it will be called it will return a new object with the attributes of &lt;tt class="docutils literal"&gt;s2&lt;/tt&gt;
but overriding its &lt;tt class="docutils literal"&gt;'b'&lt;/tt&gt; index with the return of the second call. The second call will return
a new object with the attributes of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;s2['a']&lt;/span&gt;&lt;/tt&gt; but override it&amp;#8217;s &lt;tt class="docutils literal"&gt;'c'&lt;/tt&gt; index with the return
of the third call. Finally, the 3rd call will return an object with the attributes of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;s2['a']['b']&lt;/span&gt;&lt;/tt&gt;
and setting the &lt;tt class="docutils literal"&gt;'c'&lt;/tt&gt; index to &lt;tt class="docutils literal"&gt;4&lt;/tt&gt;. The result will be as expected equal&amp;nbsp;to:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;a0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;b0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;b&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;c0&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="p"&gt;}}}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now that we&amp;#8217;ve understood the logic we can extend the above function with the following&amp;nbsp;extras:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;support for arrays in the object using numerical&amp;nbsp;indeces&lt;/li&gt;
&lt;li&gt;support for array (&lt;tt class="docutils literal"&gt;['a', 'b']&lt;/tt&gt;) or string path (&lt;tt class="docutils literal"&gt;'a.b'&lt;/tt&gt;)&amp;nbsp;parameter&lt;/li&gt;
&lt;li&gt;support for a direct value to set on the path or a function that will be applied on that&amp;nbsp;value&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here&amp;#8217;s the resulting set&amp;nbsp;lens:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;pset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;parts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;typeof&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;string&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt; &lt;span class="k"&gt;instanceof&lt;/span&gt; &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;path&lt;/span&gt;
  &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;cset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;cidx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;newval&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;typeof&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;function&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;newval&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;cidx&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Array&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;isArray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;cidx&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="nx"&gt;newval&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cidx&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;cidx&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;newval&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;pidx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;parts&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;parts&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;cset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;pidx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;remaining&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;parts&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;cset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;pidx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;pset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;obj&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;pidx&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="nx"&gt;remaining&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It may seem a little complex but I think it&amp;#8217;s easy to be understood: The parts in the beginning
will just check to see if the path is an array or a string and split the string to its parts.
The &lt;tt class="docutils literal"&gt;cset&lt;/tt&gt; function that follows is a local function that is used to make the copy of the object
or array and set the new value. Here&amp;#8217;s how it is working: It will first check to see if the &lt;tt class="docutils literal"&gt;val&lt;/tt&gt;
parameter is a function or a not. If it is a function it will apply this function to the object&amp;#8217;s index
to get the &lt;tt class="docutils literal"&gt;newvalue&lt;/tt&gt; else it will just use &lt;tt class="docutils literal"&gt;val&lt;/tt&gt; as the &lt;tt class="docutils literal"&gt;newvalue&lt;/tt&gt;. After that it checks if the
object it got is an array or not. If it is an array it will do the slice trick we saw before to copy
the elements of the array except the &lt;tt class="docutils literal"&gt;newval&lt;/tt&gt; which will put it at the index (notice that the index
at that point must be numerical but that&amp;#8217;s up to you to assert). If the current &lt;tt class="docutils literal"&gt;obj&lt;/tt&gt; is not an array
then it must be an object thus it uses the spread syntax to copy the object&amp;#8217;s attributes and reassign
the current index to &lt;tt class="docutils literal"&gt;newval&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The last part of &lt;tt class="docutils literal"&gt;pset&lt;/tt&gt; is similar to the &lt;tt class="docutils literal"&gt;pset0&lt;/tt&gt; it just uses &lt;tt class="docutils literal"&gt;cset&lt;/tt&gt; to do the new object/array
generation instead of doing it in place like &lt;tt class="docutils literal"&gt;pset0&lt;/tt&gt; - as already explained, &lt;tt class="docutils literal"&gt;pset&lt;/tt&gt; is called recursively
until only one element remains on the path in which case the &lt;tt class="docutils literal"&gt;newval&lt;/tt&gt; will be assigned to the current index of
the current &lt;tt class="docutils literal"&gt;obj&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s try to use &lt;tt class="docutils literal"&gt;pset&lt;/tt&gt; for the following rather complex&amp;nbsp;state:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;state2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="s1"&gt;&amp;#39;users&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;results&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
      &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Sera&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;groups&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;g1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;g2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;g3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]},&lt;/span&gt;
      &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;John&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;groups&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;g1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;g2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;g3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]},&lt;/span&gt;
      &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Joe&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;groups&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[]}&lt;/span&gt;
    &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;pagination&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="s1"&gt;&amp;#39;total&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="s1"&gt;&amp;#39;perpage&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="s1"&gt;&amp;#39;number&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="s1"&gt;&amp;#39;groups&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;results&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;total&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let&amp;#8217;s call it three times one after the other to change various&amp;nbsp;attributes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;new_state2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;pset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="nx"&gt;pset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="nx"&gt;pset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="nx"&gt;pset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;users.results.2.groups.0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;aa&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;users.results.0.name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;toUpperCase&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;users.total&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;users.results.1.name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Jack&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And here&amp;#8217;s the&amp;nbsp;result:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;users&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;results&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[{&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;SERA&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;groups&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;g1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;g2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;g3&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Jack&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;groups&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;g1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;g2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;g3&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Joe&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;groups&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;aa&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="p"&gt;}],&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;pagination&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;total&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;101&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;perpage&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;number&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;groups&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;results&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[],&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;total&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This should be self&amp;nbsp;explanatory.&lt;/p&gt;
&lt;p&gt;I&amp;#8217;ve published the above immutable little helpers as an npm package: &lt;a class="reference external" href="https://www.npmjs.com/package/poor-man-lens"&gt;https://www.npmjs.com/package/poor-man-lens&lt;/a&gt; (yes I
decided to use the poor man lens name instead of the immutable little helpers) - they are too simple and could be easily
copied and pasted to your project but I&amp;#8217;ve seen even smaller npm packages and I wanted to try to see if it is easy to
publish a package to npm (answer: it is very easy - easier than python&amp;#8217;s pip). Also there&amp;#8217;s a github repository for
these utils in case somebody wants to contribute anything or look at the source: &lt;a class="reference external" href="https://github.com/spapas/poor-man-lens"&gt;https://github.com/spapas/poor-man-lens&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Notice that this package has been written in &lt;span class="caps"&gt;ES5&lt;/span&gt; (and actually has a polyfil for Object.assign) thus you should probably
be able to use it anywhere you want, even directly from the browser by directly including the &lt;tt class="docutils literal"&gt;pml.js&lt;/tt&gt; file.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Using the above techniques you should be able to easily keep your state objects immutable. For simple cases you
can stick to the spread syntax or Object.assign / Array.slice but for more complex cases you may want to consider
either copying directly the pset and pget utils I explained above or just using the &lt;a class="reference external" href="https://www.npmjs.com/package/poor-man-lens"&gt;poor-man-lens npm package&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
</content><category term="javascript"></category><category term="javascript"></category><category term="react"></category><category term="redux"></category><category term="hyperapp"></category><category term="immutable"></category><category term="es6"></category></entry><entry><title>A comprehensive Django CBVÂ guide</title><link href="https://spapas.github.io/2018/03/19/comprehensive-django-cbv-guide/" rel="alternate"></link><published>2018-03-19T12:20:00+02:00</published><updated>2018-03-19T12:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2018-03-19:/2018/03/19/comprehensive-django-cbv-guide/</id><summary type="html">&lt;p class="first last"&gt;A comprehensive guide to Django CBVs - from neophyte to more&amp;nbsp;advanced&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-gentle-introduction-to-cbvs" id="id1"&gt;A gentle introduction to CBVs&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#hand-made-cbvs" id="id2"&gt;Hand-made&amp;nbsp;CBVs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#is-this-really-dry" id="id3"&gt;Is this really &lt;span class="caps"&gt;DRY&lt;/span&gt;&amp;nbsp;?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#re-using-view-functionality" id="id4"&gt;Re-using view&amp;nbsp;functionality&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#interlude-an-mro-primer" id="id5"&gt;Interlude: An &lt;span class="caps"&gt;MRO&lt;/span&gt;&amp;nbsp;primer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-mixins-for-code-reuse" id="id6"&gt;Using mixins for&amp;nbsp;code-reuse&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-super-situation" id="id7"&gt;The super&amp;nbsp;situation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-super-in-our-hierarchy" id="id8"&gt;Using super in our&amp;nbsp;hierarchy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#testing-all-this" id="id9"&gt;Testing all&amp;nbsp;this&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-high-level-overview-of-cbvs" id="id10"&gt;A high level overview of CBVs&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#taking-a-look-at-the-view" id="id11"&gt;Taking a look at the&amp;nbsp;View&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#redirectview-and-templateview" id="id12"&gt;RedirectView and&amp;nbsp;TemplateView&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-formview" id="id13"&gt;The&amp;nbsp;FormView&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-listview-and-detailview" id="id14"&gt;The ListView and&amp;nbsp;DetailView&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-createview" id="id15"&gt;The&amp;nbsp;CreateView&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-updateview-and-deleteview" id="id16"&gt;The UpdateView and&amp;nbsp;DeleteView&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#access-control-mixins" id="id17"&gt;Access control&amp;nbsp;mixins&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#some-other-cbvs" id="id18"&gt;Some other&amp;nbsp;CBVs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#real-world-use-cases" id="id19"&gt;Real world use cases&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#do-something-when-a-valid-form-is-submitted" id="id20"&gt;Do something when a valid form is&amp;nbsp;submitted&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#change-the-queryset-of-the-cbv" id="id21"&gt;Change the queryset of the &lt;span class="caps"&gt;CBV&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#allow-each-user-to-list-view-edit-delete-only-his-own-items" id="id22"&gt;Allow each user to list/view/edit/delete only his own&amp;nbsp;items&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#configure-the-form-s-initial-values-from-get-parameters" id="id23"&gt;Configure the form&amp;#8217;s initial values from &lt;span class="caps"&gt;GET&lt;/span&gt;&amp;nbsp;parameters&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#pass-extra-kwargs-to-the-formview-form" id="id24"&gt;Pass extra kwargs to the FormView&amp;nbsp;form&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#add-values-to-the-context" id="id25"&gt;Add values to the&amp;nbsp;context&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#add-a-simple-filter-to-a-listview" id="id26"&gt;Add a simple filter to a&amp;nbsp;ListView&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#support-for-success-messages" id="id27"&gt;Support for success&amp;nbsp;messages&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#implement-a-quick-moderation" id="id28"&gt;Implement a quick&amp;nbsp;moderation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#allow-access-to-a-view-if-a-user-has-one-out-of-a-group-of-permissions" id="id29"&gt;Allow access to a view if a user has one out of a group of&amp;nbsp;permissions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#disable-a-view-based-on-some-condition" id="id30"&gt;Disable a view based on some&amp;nbsp;condition&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#output-non-html-views" id="id31"&gt;Output non-html&amp;nbsp;views&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#use-one-templateview-for-multiple-html-templates" id="id32"&gt;Use one TemplateView for multiple html&amp;nbsp;templates&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#implement-a-partial-ajax-view" id="id33"&gt;Implement a partial Ajax&amp;nbsp;view&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#add-a-dynamic-filter-and-or-table-to-the-context" id="id34"&gt;Add a dynamic filter and/or table to the&amp;nbsp;context&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#configure-forms-for-your-views" id="id35"&gt;Configure forms for your&amp;nbsp;views&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#display-a-different-form-for-create-and-update" id="id36"&gt;Display a different form for Create and&amp;nbsp;Update&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#only-allow-specific-http-methods-for-a-view" id="id37"&gt;Only allow specific &lt;span class="caps"&gt;HTTP&lt;/span&gt; methods for a&amp;nbsp;view&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#create-an-umbrella-view-for-multiple-models" id="id38"&gt;Create an umbrella View for multiple&amp;nbsp;models&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-heavy-cbv-user-project" id="id39"&gt;A heavy &lt;span class="caps"&gt;CBV&lt;/span&gt; user&amp;nbsp;project&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id40"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;Class Based Views (&lt;span class="caps"&gt;CBV&lt;/span&gt;) is one of my favourite things about Django. During my
first Django projects (using Django 1.4 around 6 years ago) I was mainly using
functional views &amp;#8212; that&amp;#8217;s what the tutorial recommended then anyway. However,
slowly in my next projects I started reducing the amount of functional views
and embracing CBVs, slowly understanding their usage and usefulness. Right now,
I more or less only use CBVs for my views; even if sometimes it seems more work
to use a &lt;span class="caps"&gt;CBV&lt;/span&gt; instead of a functional one I know that sometime in the future I&amp;#8217;d
be glad that I did it since I&amp;#8217;ll want to re-use some view functionality and
CBVs are more or less the only way to have &lt;span class="caps"&gt;DRY&lt;/span&gt; views in&amp;nbsp;Django.&lt;/p&gt;
&lt;p&gt;I&amp;#8217;ve heard various rants about them, mainly that they are too complex and difficult to
understand and use, however I believe that they are not really difficult when
you start from the basics. Even if it is a little work to become comfortable with
the &lt;span class="caps"&gt;CBV&lt;/span&gt; logic, when they are used properly they will greatly improve your Django experience
so it is definitely worth&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;Notice
that to properly understand CBVs you must have a good understanding of how
Python&amp;#8217;s (multiple) inheritance and &lt;span class="caps"&gt;MRO&lt;/span&gt; work. Yes, this is a rather complex and
confusing thing but I&amp;#8217;ll try to also explain this as good as I can to the first chapter
of this article so if you follow along you shouldn&amp;#8217;t have any&amp;nbsp;problems.&lt;/p&gt;
&lt;p&gt;This guide has four&amp;nbsp;parts:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A gentle introduction to how CBVs are working and to the the problems that do solve. For this we&amp;#8217;ll implement
our own simple Custom Class Based View variant and take a look at python&amp;#8217;s inheritance&amp;nbsp;model.&lt;/li&gt;
&lt;li&gt;A high level overview of the real Django CBVs using &lt;a class="reference external" href="http://ccbv.co.uk`"&gt;&lt;span class="caps"&gt;CBV&lt;/span&gt; inspector&lt;/a&gt; as our&amp;nbsp;guide.&lt;/li&gt;
&lt;li&gt;A number of use cases where CBVs can be used to elegantly solve real world&amp;nbsp;problems&lt;/li&gt;
&lt;li&gt;Describing the usage of some of the previous use cases to a real Django&amp;nbsp;application&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I&amp;#8217;ve implemented an accompanying project to this article which you can find at &lt;a class="reference external" href="https://github.com/spapas/cbv-tutorial"&gt;https://github.com/spapas/cbv-tutorial&lt;/a&gt;.
This project has two separate parts. One that is the implementation of the Custom Class Based View variant
to see how it is working and the other is the application that contains the usage of the various &lt;span class="caps"&gt;CBV&lt;/span&gt; use&amp;nbsp;cases.&lt;/p&gt;
&lt;div class="section" id="a-gentle-introduction-to-cbvs"&gt;
&lt;h2&gt;A gentle introduction to&amp;nbsp;CBVs&lt;/h2&gt;
&lt;p&gt;In this part of the guide we&amp;#8217;ll do a gentle introduction to how CBVs work by implementing
our own class based views variant - along with it we&amp;#8217;ll introduce and try to understand
some concepts of  python (multiple) inheritance and how it applies to&amp;nbsp;CBVs.&lt;/p&gt;
&lt;p&gt;Before continuing, let&amp;#8217;s talk about the concept of the &amp;#8220;view&amp;#8221; in Django:
Django is considered an &lt;span class="caps"&gt;MVT&lt;/span&gt; (Model View Template) framework - the View as
conceived by Django is not the same as the &lt;span class="caps"&gt;MVC&lt;/span&gt;-View. A Django View is more or
less a way to define the data that the Template (which is cloased to the &lt;span class="caps"&gt;MVC&lt;/span&gt;-View)
will display, so the Django View (with the help of the Django Framework) is similar
to the &lt;span class="caps"&gt;MVC&lt;/span&gt;-Controller.&lt;/p&gt;
&lt;p&gt;In any case, traditionally a view in Django is a normal python function that takes a single parameter,
the &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.11/ref/request-response/#django.http.HttpRequest"&gt;request&lt;/a&gt; object and must return a &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.11/ref/request-response/#django.http.HttpResponse"&gt;response&lt;/a&gt; object (notice that if the
view uses request parameters for example the id of an object to be edited
they will also be passed to the function). The responsibility of the
view function is to properly parse the request parameters and construct the
response object - as can be understood there is a lot of work that need to be
done for each view (for example check if the method is &lt;span class="caps"&gt;GET&lt;/span&gt; or &lt;span class="caps"&gt;POST&lt;/span&gt;, if the user
has access to that page, retrieve objects from the database, crate a context dict
and pass it to the template to be rendered&amp;nbsp;etc).&lt;/p&gt;
&lt;p&gt;Now, since functional views are simple python functions it is &lt;em&gt;not&lt;/em&gt; easy to override,
reuse or extend their behaviour. There are more or less two methods for this: Use function
decorators or pass extra parameters when adding the view to your urls. I&amp;#8217;d like
to point out here that there&amp;#8217;s a third method for code-reuse: Extracting
functionality to common and re-usable functions or classes that will be called from the
functional views but this is not something specific to Django views but a general
concept of good programming style which you should follow&amp;nbsp;anyway.&lt;/p&gt;
&lt;p&gt;The first one uses &lt;a class="reference external" href="https://wiki.python.org/moin/PythonDecorators"&gt;python decorators&lt;/a&gt; to create a functional view that wraps the
initial one. The new view is called before the initial one, adds some functionality
(for example check if the current user has access, modify request parameters etc),
calls the initial one which will return a response object, modify the response if needed
and then return that. This is how &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/topics/auth/default/#the-login-required-decorator"&gt;login_required&lt;/a&gt; works. Notice that by using
decorators you can change things before and after the original view runs but
you can&amp;#8217;t do anything about the way the original view&amp;nbsp;works.&lt;/p&gt;
&lt;p&gt;For the second one (adding extra view parameters) you must
write your function view in a way which allows it to be reused, for example instead
of hard-coding the template name allow it to be passed as a parameter or instead
of using a specific form class for a form make it configurable through a parameter. Then,
when you add this function to your urls you will pass different parameters
depending on how you want to configure your view. Using this method you can
override the original function behaviour however there&amp;#8217;s a limit to the number of
parameters you can allow your function views to have and notice that these
function views cannot be further overridden. The &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/topics/auth/default/#django.contrib.auth.views.login"&gt;login&lt;/a&gt; authentication view (which
is now deprecated in favour of a &lt;span class="caps"&gt;CBV&lt;/span&gt; one)
is using this technique, for example you can pass it
the template name that will be used, a custom authentication form&amp;nbsp;etc.&lt;/p&gt;
&lt;p&gt;It should be obvious that both these methods have severe limitations and do not allow you to be as &lt;span class="caps"&gt;DRY&lt;/span&gt; as
you should be. When using the wrapped views you can&amp;#8217;t actually
change the functionality of the original view (since that original function needs
to be called) but only do things before and after calling it. Also, using the
parameters will lead to spaghetti code with multiple if / else conditions in order
to take into account the various cases that may arise. All the above lead to
very reduced re-usability and DRYness of functional views - usually the best thing
you can do is to gather the common things in external normal python functions (not view functions) that could be
re-used from other functional views as already&amp;nbsp;discussed.&lt;/p&gt;
&lt;p&gt;Class based views solve the above problem of non-&lt;span class="caps"&gt;DRY&lt;/span&gt;-ness by using the well known
concept of &lt;span class="caps"&gt;OO&lt;/span&gt; inheritance: The view is defined from a class which has methods
for implementing the view functionality - you inherit from that class and override
the parts you want so the inherited class based view will use the overridden methods instead
of the original ones. You can also create re-usable classes (mixins) that offer a specific
functionality to your class based view by implementing some of the methods of the
original class. Each one of your class based views can inherit its functionality from
multiple mixins thus allowing you to define a single class for each thing you need
and re-using it everywhere. Notice of course that this is possible only if the
CBVs are &lt;em&gt;properly implemented&lt;/em&gt; to allow overriding their functionality. We&amp;#8217;ll see
how this is possible in the next&amp;nbsp;section.&lt;/p&gt;
&lt;div class="section" id="hand-made-cbvs"&gt;
&lt;h3&gt;Hand-made&amp;nbsp;CBVs&lt;/h3&gt;
&lt;p&gt;To make things more clear we&amp;#8217;ll start implementing our own class based views hierarchy. Here&amp;#8217;s
a rather naive first&amp;nbsp;try:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CustomClassView&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;kwargs&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
            &lt;span class="nb"&gt;setattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;            &amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                &amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                    &amp;lt;h1&amp;gt;{header}&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                    {body}&lt;/span&gt;
&lt;span class="s2"&gt;                &amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;            &amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;br /&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
            &lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nd"&gt;@classmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;instance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This class can be used to render a simple &lt;span class="caps"&gt;HTML&lt;/span&gt; template with a custom header and
a list of items in the body (named &lt;tt class="docutils literal"&gt;context&lt;/tt&gt;). There are two things to notice here: The &lt;tt class="docutils literal"&gt;__init__&lt;/tt&gt; method (which
will be called as the object&amp;#8217;s constructor) will assign all the keyword arguments (&lt;tt class="docutils literal"&gt;kwargs&lt;/tt&gt;) it receives
as instance attributes (for example &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;CustomClassView(header='hello')&lt;/span&gt;&lt;/tt&gt; will create
an instance with &lt;tt class="docutils literal"&gt;'hello'&lt;/tt&gt; as its &lt;tt class="docutils literal"&gt;header&lt;/tt&gt; attribute). The &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; is a class method
(i.e it can be called directly on the &lt;em&gt;class&lt;/em&gt; without the need to instantiate an object
for example you can call &lt;tt class="docutils literal"&gt;CustomClassView.as_view()&lt;/tt&gt; ) that
defines and returns a traditional functional view (named &lt;tt class="docutils literal"&gt;view&lt;/tt&gt;) that will be used to
actually serve the view. The returned
functional view is very simple - it just instantiates a new instance (object)
of &lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt; passing
the &lt;tt class="docutils literal"&gt;kwargs&lt;/tt&gt; it got in the constructor and then returns a normal &lt;tt class="docutils literal"&gt;HttpResponse&lt;/tt&gt; with
the instance&amp;#8217;s &lt;tt class="docutils literal"&gt;render()&lt;/tt&gt; result. This &lt;tt class="docutils literal"&gt;render()&lt;/tt&gt; method will just output some html
using the instance&amp;#8217;s header and context to fill&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;Notice that the instance of the &lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt; inside the &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; class method
is not created using
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;CustomClassView(**kwargs)&lt;/span&gt;&lt;/tt&gt; but using &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;cls(**kwargs)&lt;/span&gt;&lt;/tt&gt; - &lt;tt class="docutils literal"&gt;cls&lt;/tt&gt; is the name of the
class that &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; was called on and is actually passed as a parameter for
class methods (in a similar manner to how &lt;tt class="docutils literal"&gt;self&lt;/tt&gt; is passed to instance methods).
This is important to instantiate an object instance of the proper&amp;nbsp;class.&lt;/p&gt;
&lt;p&gt;For example, if you created a class that inherited from &lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt;
and called its &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; method then when you use the &lt;tt class="docutils literal"&gt;cls&lt;/tt&gt; parameter to instantiate
the object it will correctly create an object of the &lt;em&gt;inherited&lt;/em&gt; class and not the &lt;em&gt;base&lt;/em&gt; one
(if on the other hand you had used &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;CustomClassView(**kwargs)&lt;/span&gt;&lt;/tt&gt; to instantiate the instance
then the &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; method of the inheriting classes would instantiate instances of
&lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt; so inheritance wouldn&amp;#8217;t really&amp;nbsp;work!).&lt;/p&gt;
&lt;p&gt;To add the above class method in your urls, just use its &lt;tt class="docutils literal"&gt;as_view()&lt;/tt&gt; as you&amp;#8217;d
normally use a functional&amp;nbsp;view:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf.urls&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt;

&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^ccv-empty/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CustomClassView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ccv-empty&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="c1"&gt;# ... other urls&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This doesn&amp;#8217;t actually render anything since both header and context are empty on
the created instance &amp;#8212; remember that &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; returns a functional view that
instantiates a &lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt; objet and returns an &lt;tt class="docutils literal"&gt;HttpResponse&lt;/tt&gt; filling it
with the object&amp;#8217;s &lt;tt class="docutils literal"&gt;render()&lt;/tt&gt; reuslts. To add some output we can either
create another class that inherits from &lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt; or
initialize the attributes from the constructor of the class (using the kwargs functionality described&amp;nbsp;above).&lt;/p&gt;
&lt;p&gt;The inherited class can just override the values of the&amp;nbsp;attributes:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;InheritsCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;CustomClassView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Hi&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;test2&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And then just add the inherited class to your urls as&amp;nbsp;before:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^ccv-inherits/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;InheritsCustomClassView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ccv-inherits&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;as_view()&lt;/tt&gt; method will create an instance of &lt;tt class="docutils literal"&gt;InheritsCustomClassView&lt;/tt&gt; that has
the values configured in the class as attributes and return
its &lt;tt class="docutils literal"&gt;render()&lt;/tt&gt; output as&amp;nbsp;response.&lt;/p&gt;
&lt;p&gt;The other way to configure the attributes of the class is to
pass them to the &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; class method (which in turn will pass them to the instances
constructor which will set the attributes in the instance). Here&amp;#8217;s an&amp;nbsp;example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^ccv-with-values/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CustomClassView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Hello&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hello&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;world&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;footer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Bye&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ccv-with-values&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above will create a &lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt; instance with the provided values as its&amp;nbsp;attributes.&lt;/p&gt;
&lt;p&gt;Although this method of configuration is used in normal django CBVs (for example
setting the &lt;tt class="docutils literal"&gt;template_name&lt;/tt&gt; in a &lt;tt class="docutils literal"&gt;TemplateView&lt;/tt&gt;) I recommend you avoid using it because passing parameters
to the &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; method pollutes the urls.py with configuration
that (at least in my opinion) should &lt;em&gt;not&lt;/em&gt; be there (and there&amp;#8217;s no reason to have to take a look at both
your urls.py and your views.py to understand the behavior of your views) and also, even for very simple views I know that after some time I&amp;#8217;ll need
to add some functionality that cannot be implemented by passing the parameters so I prefer to bite the
bullet and define all my views as inherited classes so it will be easy for me to further customize them later (we&amp;#8217;ll
see how this is done in a second). Thus, even if you&amp;nbsp;have&lt;/p&gt;
&lt;p&gt;In any case, I won&amp;#8217;t discuss passing parameters to the &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; method any more,
so from now on any class based views I define will be added to urls py using &lt;tt class="docutils literal"&gt;ClassName.as_view()&lt;/tt&gt; without any
parameters to the &lt;tt class="docutils literal"&gt;as_view()&lt;/tt&gt; class&amp;nbsp;method.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="is-this-really-dry"&gt;
&lt;h3&gt;Is this really &lt;span class="caps"&gt;DRY&lt;/span&gt;&amp;nbsp;?&lt;/h3&gt;
&lt;p&gt;Let&amp;#8217;s now suppose that we wanted to allow our class based view to print something on the header even if no header is provided
when you configure it. The only way to do it would be to re-define the &lt;tt class="docutils literal"&gt;render&lt;/tt&gt; method like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;DEFAULT HEADER&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;        &amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;            &amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                &amp;lt;h1&amp;gt;{header}&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                {body}&lt;/span&gt;
&lt;span class="s2"&gt;            &amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;        &amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;br /&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is definitely not the &lt;span class="caps"&gt;DRY&lt;/span&gt; way to do it because you would need to re-define the whole &lt;tt class="docutils literal"&gt;render&lt;/tt&gt; method. Think
what would happen if
you wanted to print &lt;tt class="docutils literal"&gt;&amp;quot;&lt;span class="caps"&gt;ANOTHER&lt;/span&gt; &lt;span class="caps"&gt;DEFAULT&lt;/span&gt; &lt;span class="caps"&gt;HEADER&lt;/span&gt;&amp;quot;&lt;/tt&gt; as a default header for some other view - once again re-defining
&lt;tt class="docutils literal"&gt;render&lt;/tt&gt;! In fact, the above
&lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt; is naively implemented because it does not allow proper customization through inheritance. The
same problems for the header arise also when you need modify the body; for
example, if you wanted to add an index number before displaying the items of the list then you&amp;#8217;d need to again re-implement the
whole &lt;tt class="docutils literal"&gt;render&lt;/tt&gt; method.&lt;/p&gt;
&lt;p&gt;If that was our only option then we could just stick to functional views. However, we can do
much better if we define the class based view in such a way that allows inherited classes to override methods that
define specific parts of the functionality. To do this the class-based-view must be properly implemented so each
part of its functionality is implemented by a different&amp;nbsp;method.&lt;/p&gt;
&lt;p&gt;Here&amp;#8217;s how we could improve the &lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt; to make it more &lt;span class="caps"&gt;DRY&lt;/span&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;CustomClassView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Better Custom Class View&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;lt;br /&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;            &amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                &amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                    &amp;lt;h1&amp;gt;{header}&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                    {body}&lt;/span&gt;
&lt;span class="s2"&gt;                &amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;            &amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render_context&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
            &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So what happens here? First of all we inherit from &lt;tt class="docutils literal"&gt;ClassClassView&lt;/tt&gt; to keep the
&lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; method which doesn&amp;#8217;t need changing. Beyond this, the render
uses methods (&lt;tt class="docutils literal"&gt;get_header&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;render_context&lt;/tt&gt;) to retrieve the values from the header and the body - this means
that we could re-define these methods to an inherited class in order to override
what these methods will return. Beyond &lt;tt class="docutils literal"&gt;get_header&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;render_contex&lt;/tt&gt; I&amp;#8217;ve added
a &lt;tt class="docutils literal"&gt;get_context&lt;/tt&gt; method that is used by &lt;tt class="docutils literal"&gt;render_context&lt;/tt&gt; to make this &lt;span class="caps"&gt;CBV&lt;/span&gt; even
more re-usable. For example I may
need to configure the context (add/remove items from the context i.e have a &lt;span class="caps"&gt;CBV&lt;/span&gt;
that adds a last item with the number of list items to the list to be displayed). Of course this could
be done from &lt;tt class="docutils literal"&gt;render_context&lt;/tt&gt; &lt;em&gt;but&lt;/em&gt; this means that I would need to define my new functionality
(modifying the context items) &lt;em&gt;and&lt;/em&gt; re-defining the context list formatting. It is much
better (in my opinion always) to keep properly separated these&amp;nbsp;things.&lt;/p&gt;
&lt;p&gt;Now, the above is a first try that I created to mainly fulfil my requirement of
having a default header and some more examples I will discuss later (and keep
everything simple enough). You could
extract more functionality as methods-for-overriding, for example the render
method could be written like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_template&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render_context&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
        &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and add a &lt;tt class="docutils literal"&gt;get_template&lt;/tt&gt; method that will return the actual html template. There&amp;#8217;s no
hard rules here on what functionality should be extracted to a method (so it could
be overridden) however I recommend to follow the &lt;span class="caps"&gt;YAGNI&lt;/span&gt; rule (i.e implement everything
as normal and when you see that some functionality needs to be overridden then refactor
your code to extract it to a separate&amp;nbsp;method).&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s see an example of adding the default header functionality by overriding &lt;tt class="docutils literal"&gt;get_header&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultHeaderBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;DEFAULT HEADER&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Classes inheriting from &lt;tt class="docutils literal"&gt;DefaultHeaderBetterCustomClassView&lt;/tt&gt; can choose to not
actually define a header attribute so &lt;tt class="docutils literal"&gt;&amp;quot;&lt;span class="caps"&gt;DEFAULT&lt;/span&gt; &lt;span class="caps"&gt;HEADER&lt;/span&gt;&amp;quot;&lt;/tt&gt; will be printed instead. Keep in
mind that for &lt;tt class="docutils literal"&gt;DefaultHeaderBetterCustomClassView&lt;/tt&gt; to be actually useful you&amp;#8217;ll need to
have more than one classes that need this default-header functionality (or else you could
just set the header attribute of your class to &lt;tt class="docutils literal"&gt;&amp;quot;&lt;span class="caps"&gt;DEFAULT&lt;/span&gt; &lt;span class="caps"&gt;HEADER&lt;/span&gt;&amp;quot;&lt;/tt&gt; - this is not
user generated input, this is your source&amp;nbsp;code!).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="re-using-view-functionality"&gt;
&lt;h3&gt;Re-using view&amp;nbsp;functionality&lt;/h3&gt;
&lt;p&gt;We have come now to a crucial point in this chapter, so please stick with me. Let&amp;#8217;s say that you have
&lt;em&gt;more than one&lt;/em&gt; class based views that contain a header attribute. You want to include
the default header functionality on all of them so that if any view instantiated from these
class based views doesn&amp;#8217;t define a header
the default string will be output (I know that this may be a rather trivial example but I want
to keep everything simple to make following easy - instead of the default header the functionality
you want to override may be adding stuff to the context or filtering the objects you&amp;#8217;ll retrieve
from the&amp;nbsp;database).&lt;/p&gt;
&lt;p&gt;To re-use this default header functionality from multiple classes you have &lt;em&gt;two&lt;/em&gt; options:
Either inherit all classes that need this functionality from &lt;tt class="docutils literal"&gt;DefaultHeaderBetterCustomClassView&lt;/tt&gt; or
extract the custom &lt;tt class="docutils literal"&gt;get_header&lt;/tt&gt; method to a &lt;em&gt;mixin&lt;/em&gt; and inherit from the mixin. A mixin is a class not
related to the class based view hierarchy we are using - the mixin inherits from object (or from another
mixin) and just defines the methods and attributes that need to be overridden. When the mixin is &lt;em&gt;mixed&lt;/em&gt;
with the ancestors of a class its functionality will be used by that class (we&amp;#8217;ll see how shortly). So
the mixin will only define &lt;tt class="docutils literal"&gt;get_header&lt;/tt&gt; and not all other methods like
&lt;tt class="docutils literal"&gt;render&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;get_context&lt;/tt&gt; etc. Using the
&lt;tt class="docutils literal"&gt;DefaultHeaderBetterCustomClassView&lt;/tt&gt; is enough for some cases but for the general case
of re-using the functionality you&amp;#8217;ll need to create the mixin. Let&amp;#8217;s see&amp;nbsp;why:&lt;/p&gt;
&lt;p&gt;Suppose that you have a base class that renders the header and context as &lt;span class="caps"&gt;JSON&lt;/span&gt; instead of the &lt;span class="caps"&gt;HTML&lt;/span&gt;
template, something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;JsonCustomClassView&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

    &lt;span class="nd"&gt;@classmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;instance&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dumps&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
                &lt;span class="s1"&gt;&amp;#39;header&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                &lt;span class="s1"&gt;&amp;#39;context&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
            &lt;span class="p"&gt;}))&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that this class does not inherit from our previous hierarchy (i.e does not
inherit from BetterCustomClassView) but from object since it provides
its own &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; method. How could we re-use default header functionality
in this class (without having to re-implement it)? One solution would be to create a class that
inherits from both &lt;tt class="docutils literal"&gt;JsonCustomClassView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;DefaultHeaderBetterCustomClassView&lt;/tt&gt; using something&amp;nbsp;like&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# OPTION 1&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultHeaderJsonCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DefaultHeaderBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;JsonCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="c1"&gt;# OR&lt;/span&gt;
&lt;span class="c1"&gt;# OPTION 2&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;JsonDefaultHeaderCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;JsonCustomClassView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DefaultHeaderBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;What will happen here? Notice that the methods &lt;tt class="docutils literal"&gt;get_header&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; exist in &lt;em&gt;both&lt;/em&gt; ancestor classes! So
which one will be used in each case? Actually, there&amp;#8217;s a (rather complex) rule for that called
&lt;span class="caps"&gt;MRO&lt;/span&gt; (Method Resolution Order). The &lt;span class="caps"&gt;MRO&lt;/span&gt; is also what can used to know which &lt;tt class="docutils literal"&gt;get_header&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; will be used in each case in the previous&amp;nbsp;example.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="interlude-an-mro-primer"&gt;
&lt;h3&gt;Interlude: An &lt;span class="caps"&gt;MRO&lt;/span&gt;&amp;nbsp;primer&lt;/h3&gt;
&lt;p&gt;What is &lt;span class="caps"&gt;MRO&lt;/span&gt;? For every class that Python sees, it tries to create a &lt;em&gt;list&lt;/em&gt; (&lt;span class="caps"&gt;MRO&lt;/span&gt; list) of ancestor classes containing that class as
the first element and its ancestors in a specific order I&amp;#8217;ll discuss in the next paragraph. When a method
of an object of that specific class needs to be
called, then the method will be searched in the &lt;span class="caps"&gt;MRO&lt;/span&gt; list (from the first element of the &lt;span class="caps"&gt;MRO&lt;/span&gt; list i.e. starting with the class it self) - when a class is found
in the list that defines the method then that method instance (i.e. the method defined in this class) will be called and the search will stop (careful readers: I haven&amp;#8217;t
yet talked about &lt;em&gt;super&lt;/em&gt; so please be&amp;nbsp;patient).&lt;/p&gt;
&lt;p&gt;Now, how is the &lt;span class="caps"&gt;MRO&lt;/span&gt; list created? As I explained, the first element
is the class itself. The second element is the &lt;span class="caps"&gt;MRO&lt;/span&gt; of the &lt;em&gt;leftmost&lt;/em&gt; ancestor of that object (so &lt;span class="caps"&gt;MRO&lt;/span&gt; will
run recursively on each ancestor), the third element will be the &lt;span class="caps"&gt;MRO&lt;/span&gt; of the ancestor right next to the leftmost
ancestor etc. There is one extra and important rule: When a class is found multiple times in the &lt;span class="caps"&gt;MRO&lt;/span&gt; list (for example
if some elements have a common ancestor) then &lt;em&gt;only the last occurrence in the list will be kept&lt;/em&gt; - so each class
will exist only once in the &lt;span class="caps"&gt;MRO&lt;/span&gt; list. The above rule implies that the
rightmost element in every &lt;span class="caps"&gt;MRO&lt;/span&gt; list will always be object - please make sure you
understand why before&amp;nbsp;continuing.&lt;/p&gt;
&lt;p&gt;Thus, the &lt;span class="caps"&gt;MRO&lt;/span&gt; list for &lt;tt class="docutils literal"&gt;DefaultHeaderJsonCustomClassView&lt;/tt&gt; defined in the previous section
is (remember, start
with the class to the left and add the &lt;span class="caps"&gt;MRO&lt;/span&gt; of each of its ancestors starting
from the leftmost one):
&lt;tt class="docutils literal"&gt;[DefaultHeaderJsonCustomClassView, DefaultHeaderBetterCustomClassView, BetterCustomClassView, CustomClassView, JsonCustomClassView, object]&lt;/tt&gt;, while
for &lt;tt class="docutils literal"&gt;JsonDefaultHeaderCustomClassView&lt;/tt&gt; is
&lt;tt class="docutils literal"&gt;[JsonDefaultHeaderCustomClassView, JsonCustomClassView, DefaultHeaderBetterCustomClassView, BetterCustomClassView, CustomClassView, object]&lt;/tt&gt;. What this
means is that for &lt;tt class="docutils literal"&gt;DefaultHeaderJsonCustomClassView&lt;/tt&gt; the &lt;tt class="docutils literal"&gt;CustomClassView.as_view()&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;DefaultHeaderBetterCustomClassView.get_header()&lt;/tt&gt;  (thus
we will not get the &lt;span class="caps"&gt;JSON&lt;/span&gt; output) and for &lt;tt class="docutils literal"&gt;JsonDefaultHeaderCustomClassView&lt;/tt&gt; the &lt;tt class="docutils literal"&gt;JsonCustomClassView.as_view()&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;JsonCustomClassView.get_header()&lt;/tt&gt;
will be used (so we won&amp;#8217;t get the default header functionality) - i.e none of those two options will result to the desired&amp;nbsp;behaviour.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s try an example that has the same base class twice in the hierarchy (actually the previous examples also had a class twice in
the hierarchy - &lt;tt class="docutils literal"&gt;object&lt;/tt&gt; but let&amp;#8217;s be more explicit). For this, we&amp;#8217;ll create a
&lt;tt class="docutils literal"&gt;DefaultContextBetterCustomClassView&lt;/tt&gt; that returns a default context if the context is empty
(similar to the default header&amp;nbsp;functionality).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultContextBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;DEFAULT CONTEXT&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now we&amp;#8217;ll create a class that inherits from both &lt;tt class="docutils literal"&gt;DefaultHeaderBetterCustomClassView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;DefaultContextBetterCustomClassView&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultHeaderContextCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DefaultHeaderBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DefaultContextBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let&amp;#8217;s do the &lt;span class="caps"&gt;MRO&lt;/span&gt; for the &lt;tt class="docutils literal"&gt;DefaultHeaderContextCustomClassView&lt;/tt&gt; class:&lt;/p&gt;
&lt;p&gt;Initially, the &lt;span class="caps"&gt;MRO&lt;/span&gt; will be the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
Starting with the initial class
1. DefaultHeaderContextCustomClassView
Follows the leftmost class (DefaultHeaderBetterCustomClassView) MRO
2. DefaultHeaderContextCustomClassView, 3. BetterCustomClassView, 4. CustomClassView, 5. object
And finally the next class (DefaultContextBetterCustomClassView) MRO
6. DefaultContextBetterCustomClassView, 7. BetterCustomClassView, 8. CustomClassView, 9. object
&lt;/pre&gt;
&lt;p&gt;Notice that classes &lt;tt class="docutils literal"&gt;BetterCustomClassView&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;object&lt;/tt&gt; are repeated two times
(on place 3,4,5 and 7,8,9) thus &lt;em&gt;only&lt;/em&gt; their last (rightmost) occurrences will be kept in the list. So the
resulting &lt;span class="caps"&gt;MRO&lt;/span&gt; is the following (3,4,5 are&amp;nbsp;removed):&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;[DefaultHeaderContextCustomClassView, DefaultHeaderBetterCustomClassView, DefaultContextBetterCustomClassView, BetterCustomClassView, CustomClassView, object]&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;One funny thing here is that the &lt;tt class="docutils literal"&gt;DefaultHeaderContextCustomClassView&lt;/tt&gt; &lt;em&gt;will actually work&lt;/em&gt; properly because the
&lt;tt class="docutils literal"&gt;get_header&lt;/tt&gt; will be found in &lt;tt class="docutils literal"&gt;DefaultHeaderBetterCustomClassView&lt;/tt&gt; and the
&lt;tt class="docutils literal"&gt;get_context&lt;/tt&gt; will be found in &lt;tt class="docutils literal"&gt;DefaultContextBetterCustomClassView&lt;/tt&gt; so this
result to the correct&amp;nbsp;functionality.&lt;/p&gt;
&lt;p&gt;Yes it does work but at what cost? Do you really want to do the mental exercise
of finding out the &lt;span class="caps"&gt;MRO&lt;/span&gt; for each class you define to see which method will be actually used? Also, what would happen if the
&lt;tt class="docutils literal"&gt;DefaultHeaderContextCustomClassView&lt;/tt&gt; class also had a &lt;tt class="docutils literal"&gt;get_context&lt;/tt&gt; method defined
(hint: that &lt;tt class="docutils literal"&gt;get_context&lt;/tt&gt; would be used and the &lt;tt class="docutils literal"&gt;get_context&lt;/tt&gt; of &lt;tt class="docutils literal"&gt;DefaultContextBetterCustomClassView&lt;/tt&gt;
would be&amp;nbsp;ignored).&lt;/p&gt;
&lt;p&gt;Before finishing this interlude, I&amp;#8217;d like to make a confession: The Python &lt;span class="caps"&gt;MRO&lt;/span&gt; algorithm is not as simple as
than the procedure I described. It uses an algorithm called &lt;a class="reference external" href="https://en.wikipedia.org/wiki/C3_linearization"&gt;C3 linearization&lt;/a&gt; which seems way too complex
to start explaining or understanding if you not a &lt;span class="caps"&gt;CS&lt;/span&gt; student. What you&amp;#8217;ll need to remember is that the
procedure I described works fine in normal cases when you don&amp;#8217;t try to do something stupid. Here&amp;#8217;s a
&lt;a class="reference external" href="https://medium.com/technology-nineleaps/python-method-resolution-order-4fd41d2fcc"&gt;post that explains the theory more&lt;/a&gt;. However if you  follow along my recommendations below you won&amp;#8217;t
have any problems with &lt;span class="caps"&gt;MRO&lt;/span&gt;, actually you won&amp;#8217;t really need to use the &lt;span class="caps"&gt;MRO&lt;/span&gt; that much to understand
the method calling&amp;nbsp;hierarchy.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-mixins-for-code-reuse"&gt;
&lt;h3&gt;Using mixins for&amp;nbsp;code-reuse&lt;/h3&gt;
&lt;p&gt;The above explanation of &lt;span class="caps"&gt;MRO&lt;/span&gt; should convince you that you should avoid
mixing hierarchies of classes - if you are not convinced then wait until I introduce &lt;tt class="docutils literal"&gt;super()&lt;/tt&gt;
in the next section and I guarantee that you&amp;#8217;ll&amp;nbsp;be!&lt;/p&gt;
&lt;p&gt;So, that&amp;#8217;s why I
propose implementing common functionality that needs to be re-used between
classes only with mixins (hint: that&amp;#8217;s also what Django does). Each re-usable functionality
will be implemented in its own mixin;  class views that need to implement that
functionality will just inherit from the mixin along with the base class view. Each
one of the view classes you define should inherit from &lt;em&gt;one and only one&lt;/em&gt; other class
view and any number of mixins you want. Make sure that the view class is rightmost in
the ancestors list and the mixins are to the left of it (so that they will properly override
its behaviour; remember that the methods of the ancestors to the left are searched first
in the &lt;span class="caps"&gt;MRO&lt;/span&gt; list &amp;#8212; and the methods of the defined class have of course the highest priority
since it goes first in the &lt;span class="caps"&gt;MRO&lt;/span&gt;&amp;nbsp;list).&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s try implementing the proposed mixins for a default header and&amp;nbsp;context:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultHeaderMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;DEFAULT HEADER&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultContextMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;DEFAULT CONTEXT&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and all the proposed use cases using the base class view and the&amp;nbsp;mixins:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultHeaderMixinBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DefaultHeaderMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultContextMixinBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DefaultContextMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultHeaderContextMixinBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DefaultHeaderMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DefaultContextMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;JsonDefaultHeaderMixinCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DefaultHeaderMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;JsonCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I believe that the above definitions are self-documented and it is very easy to know which
method of the resulting class will be called each time: Start from the main class and if
the method is not found there continue from left to right to the ancestor list; since the mixins
do only one thing and do it well you&amp;#8217;ll know what each class does simply by looking at its&amp;nbsp;definition.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-super-situation"&gt;
&lt;h3&gt;The super&amp;nbsp;situation&lt;/h3&gt;
&lt;p&gt;The final (and most complex) thing and extension I&amp;#8217;d like to discuss for our custom class based views is the case
where you want to use the functionality of more than one mixins for the &lt;em&gt;same thing&lt;/em&gt;. For example, let&amp;#8217;s suppose
that we had a mixin that added some data to the context and a different mixing that added
some different data to the context. Both would use the &lt;tt class="docutils literal"&gt;get_context&lt;/tt&gt; method
and you&amp;#8217;d like to have the context data of both of them to your context. But
this is not possible using the implementations above because when a
&lt;tt class="docutils literal"&gt;get_context&lt;/tt&gt; is found in the &lt;span class="caps"&gt;MRO&lt;/span&gt; list it will be called and the &lt;span class="caps"&gt;MRO&lt;/span&gt; search
will finish&amp;nbsp;there!&lt;/p&gt;
&lt;p&gt;So how could we add the functionality of both these mixins to a class based view? This is the same problem as
if we wanted to inherit from a mixin (or a class view) and override one of its methods
but &lt;em&gt;also&lt;/em&gt; call its parent (overridden) method for example to get its output and use it as the base
of the output for the overridden method. Both these situations (re-use
functionality of two mixins with the same method or re-use functionality
from a parent method you override) are the same because what stays in the end is
the &lt;span class="caps"&gt;MRO&lt;/span&gt; list. For example say we we had the following base&amp;nbsp;class&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class V:pass
&lt;/pre&gt;
&lt;p&gt;and we wanted to override it either using mixins or by using normal&amp;nbsp;inheritance.&lt;/p&gt;
&lt;p&gt;When using mixins for example like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class M1:pass
class M2:pass
class MIXIN(M2, M1, V):pass
&lt;/pre&gt;
&lt;p&gt;we&amp;#8217;ll have the following &lt;span class="caps"&gt;MRO&lt;/span&gt;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
# MIXIN.mro()
# [MIXIN, M2, M1, V, object, ]
&lt;/pre&gt;
&lt;p&gt;while when using inheritance like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class M1V(V):pass
class M2M1V(M1V):pass
class INHERITANCE(M2M1V):pass
&lt;/pre&gt;
&lt;p&gt;we&amp;#8217;ll have the following &lt;span class="caps"&gt;MRO&lt;/span&gt;:&lt;/p&gt;
&lt;blockquote&gt;
# &lt;span class="caps"&gt;INHERITANCE&lt;/span&gt;.mro()
# [&lt;span class="caps"&gt;INHERITANCE&lt;/span&gt;, &lt;span class="caps"&gt;M2M1V&lt;/span&gt;, &lt;span class="caps"&gt;M1V&lt;/span&gt;, V, object ]&lt;/blockquote&gt;
&lt;p&gt;As we can see in both cases the base class V is the last one (just next to object)
and between this class and the one that needs the functionality (&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;MIXIN&lt;/span&gt;&lt;/tt&gt; in the first
case and &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;INHERITANCE&lt;/span&gt;&lt;/tt&gt; in the second case) there are
the classes that will define the extra functionality that needs to be re-used: &lt;tt class="docutils literal"&gt;M2&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;M1&lt;/tt&gt; (start from
left to right) in the first case and &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;M2M1V&lt;/span&gt;&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;M1V&lt;/span&gt;&lt;/tt&gt; (follow the inheritance hierarchy)
in the second case. So in both cases when calling a method they will be searched the same way using
the &lt;span class="caps"&gt;MRO&lt;/span&gt; list and when the method is found it will be executed and the search will&amp;nbsp;stop.&lt;/p&gt;
&lt;p&gt;But what if we needed to re-use some method from &lt;tt class="docutils literal"&gt;V&lt;/tt&gt; (or from some other ancestor) and
a class on the left of the &lt;span class="caps"&gt;MRO&lt;/span&gt; list has the same method?
The answer, as you should have guessed by now if you have some Python knowledge is &lt;tt class="docutils literal"&gt;super()&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;super&lt;/tt&gt; method can be used by a class method to call a method of &lt;em&gt;its ancestors&lt;/em&gt; respecting
the &lt;span class="caps"&gt;MRO&lt;/span&gt;. Thus, running &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;super().x()&lt;/span&gt;&lt;/tt&gt; from a method instance will try to find method &lt;tt class="docutils literal"&gt;x()&lt;/tt&gt;
on the &lt;span class="caps"&gt;MRO&lt;/span&gt; ancestors of this instance &lt;em&gt;even if the instance defines the &amp;#8220;x()&amp;#8220; method&lt;/em&gt; i.e it will
not search the first element of the &lt;span class="caps"&gt;MRO&lt;/span&gt; list. Notice
that if the &lt;tt class="docutils literal"&gt;x()&lt;/tt&gt; method does not exist in the headless-&lt;span class="caps"&gt;MRO&lt;/span&gt; chain you&amp;#8217;ll get an attribute error.
So, usually, you&amp;#8217;ll can &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;super().x()&lt;/span&gt;&lt;/tt&gt; from &lt;em&gt;inside&lt;/em&gt; the &lt;tt class="docutils literal"&gt;x()&lt;/tt&gt; method to call your parent&amp;#8217;s (as
specified by the &lt;span class="caps"&gt;MRO&lt;/span&gt; list) same-named method and retrieve its&amp;nbsp;output.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s take a closer look at how &lt;tt class="docutils literal"&gt;super()&lt;/tt&gt; works using a simple example. For this, we&amp;#8217;ll define a method calld &lt;tt class="docutils literal"&gt;x()&lt;/tt&gt; on all classes
of the previous&amp;nbsp;example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;V&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;From V&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;M1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;From M1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;M2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;From M2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MIXIN&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;M1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;From MIXIN&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;M1V&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;From M1V&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;M2M1V&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M1V&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;From M2M1V&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;INHERITANCE&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;M2M1V&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;From INHERITANCE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;MIXIN OUTPUT&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;MIXIN&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;INHERITANCE OUTPUT&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;INHERITANCE&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here&amp;#8217;s the&amp;nbsp;output:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
MIXIN OUTPUT
From V
From M1
From M2
From MIXIN
INHERITANCE OUTPUT
From V
From M1V
From M2M1V
From INHERITANCE
&lt;/pre&gt;
&lt;p&gt;Notice when each message is printed: Because x() first calls its &lt;tt class="docutils literal"&gt;super()&lt;/tt&gt; method
and then it prints the message in both cases first the &lt;tt class="docutils literal"&gt;From V&lt;/tt&gt; message is printed
from the base class and then from the following classes in the hierarchy (as per the &lt;span class="caps"&gt;MRO&lt;/span&gt;)
ending with the class of the instance (either &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;MIXIN&lt;/span&gt;&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;INHERITANCE&lt;/span&gt;&lt;/tt&gt;). Also the
print order is the same in both cases as we&amp;#8217;ve already explained. Please make
sure you understand why the output is like this before&amp;nbsp;continuing.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-super-in-our-hierarchy"&gt;
&lt;h3&gt;Using super in our&amp;nbsp;hierarchy&lt;/h3&gt;
&lt;p&gt;Using super and mixins it is easy to mix and match functionality to create new
classes. Of course, super can be used without mixins when overriding a method from
a class you inherit from and want to also call your ancestor&amp;#8217;s&amp;nbsp;method.&lt;/p&gt;
&lt;p&gt;Here&amp;#8217;s how we could add a prefix to the&amp;nbsp;header:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HeaderPrefixMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;PREFIX: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and here&amp;#8217;s how it could be&amp;nbsp;used:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HeaderPrefixBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HeaderPrefixMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Hello!&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will retrieve the header from the ancestor and properly print the header displaying both &lt;span class="caps"&gt;PREFIX&lt;/span&gt; and Hello.
What if we wanted to re-use the default header mixin? First let&amp;#8217;s change &lt;tt class="docutils literal"&gt;DefaultHeaderMixin&lt;/tt&gt;
to properly use &lt;tt class="docutils literal"&gt;super()&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultHeaderSuperMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;DEFAULT HEADER&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HeaderPrefixDefaultBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HeaderPrefixMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DefaultHeaderSuperMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice the order of the ancestor classes. The &lt;tt class="docutils literal"&gt;get_header()&lt;/tt&gt; of  &lt;tt class="docutils literal"&gt;HeaderPrefixMixin&lt;/tt&gt; will be called which
will call the &lt;tt class="docutils literal"&gt;get_header()&lt;/tt&gt; of
&lt;tt class="docutils literal"&gt;DefaultHeaderSuperMixin&lt;/tt&gt; (which will call the &lt;tt class="docutils literal"&gt;get_header()&lt;/tt&gt; of &lt;tt class="docutils literal"&gt;BetterCustomClassView&lt;/tt&gt; returning &lt;tt class="docutils literal"&gt;None&lt;/tt&gt;).
So the result will be &lt;tt class="docutils literal"&gt;&amp;quot;&lt;span class="caps"&gt;PREFIX&lt;/span&gt;: &lt;span class="caps"&gt;DEFAULT&lt;/span&gt; &lt;span class="caps"&gt;HEADER&lt;/span&gt;&amp;quot;&lt;/tt&gt;. However if instead we had defined this class&amp;nbsp;like&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HeaderPrefixDefaultBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DefaultHeaderSuperMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HeaderPrefixMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;the result would be &lt;tt class="docutils literal"&gt;&amp;quot;&lt;span class="caps"&gt;PREFIX&lt;/span&gt;: &amp;quot;&lt;/tt&gt; (&lt;span class="caps"&gt;DEFAULT&lt;/span&gt; &lt;span class="caps"&gt;HEADER&lt;/span&gt; won&amp;#8217;t be printed). Can you understand&amp;nbsp;why?&lt;/p&gt;
&lt;p&gt;One thing to keep in mind is that most probably you&amp;#8217;ll need to call &lt;tt class="docutils literal"&gt;super()&lt;/tt&gt; and return its output when you override a method.
Even if you think that you don&amp;#8217;t need to call it for this view or mixin, you may need it later from some other view or mixin that
inherits from this view. Also notice that &lt;tt class="docutils literal"&gt;super()&lt;/tt&gt; may not return anything but may have some
side-effects in your class (for example set a &lt;tt class="docutils literal"&gt;self&lt;/tt&gt; attribute) which you won&amp;#8217;t get if you don&amp;#8217;t call&amp;nbsp;it!&lt;/p&gt;
&lt;p&gt;For another example of super, let&amp;#8217;s define a couple of mixins that add things to the&amp;nbsp;context:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ExtraContext1Mixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ExtraContext2Mixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;insert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;data2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The first one retrieves the ancestor context list and appends &lt;tt class="docutils literal"&gt;'data1'&lt;/tt&gt; to the
it while the second one will insert &lt;tt class="docutils literal"&gt;'data2'&lt;/tt&gt; to the start of the list. To use
these mixins just add them to the ancestor list of your class hierarchy as usually.
One interesting thing to notice here is that because of how &lt;tt class="docutils literal"&gt;get_context&lt;/tt&gt; is
defined we&amp;#8217;ll get the same output no matter the order of the mixins in the hierarchy
since &lt;tt class="docutils literal"&gt;ExtraContext1Mixin&lt;/tt&gt; will append &lt;tt class="docutils literal"&gt;data1&lt;/tt&gt; to the end of the context list and
the &lt;tt class="docutils literal"&gt;ExtraContext2Mixin&lt;/tt&gt; will insert &lt;tt class="docutils literal"&gt;data2&lt;/tt&gt; to the start of the context&amp;nbsp;list.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ExtraContext12BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ExtraContext1Mixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ExtraContext2Mixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ExtraContext21BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ExtraContext2Mixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ExtraContext1Mixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If instead both of these mixins appended the item to the end of the list, then
the output would be different depending on the ancestor order.
Of course, since we&amp;#8217;ve already defined &lt;tt class="docutils literal"&gt;HeaderPrefixMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;DefaultHeaderSuperMixin&lt;/tt&gt; nothing stops us
from using all those mixins&amp;nbsp;together!&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AllTogetherNowBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HeaderPrefixMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DefaultHeaderSuperMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ExtraContext1Mixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;mixins&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ExtraContext2Mixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;BetterCustomClassView&lt;/span&gt;
    &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This will have the desired behaviour of adding a prefix to the header, having a default header if not one was defined
and adding the extra context from both&amp;nbsp;mixins!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="testing-all-this"&gt;
&lt;h3&gt;Testing all&amp;nbsp;this&lt;/h3&gt;
&lt;p&gt;In the accompanying project at &lt;a class="reference external" href="https://github.com/spapas/cbv-tutorial"&gt;https://github.com/spapas/cbv-tutorial&lt;/a&gt; you can take a look at how this
custom &lt;span class="caps"&gt;CBV&lt;/span&gt; hierarchy works by running it and taking a look at the &lt;tt class="docutils literal"&gt;core&lt;/tt&gt; project (visit &lt;a class="reference external" href="http://127.0.0.1:8001/non-django-cbv/"&gt;http://127.0.0.1:8001/non-django-cbv/&lt;/a&gt;).
There you can take a look at the views.py and mixins.py to see all the views and mixins we&amp;#8217;ve discussed in this&amp;nbsp;chapter.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="a-high-level-overview-of-cbvs"&gt;
&lt;h2&gt;A high level overview of&amp;nbsp;CBVs&lt;/h2&gt;
&lt;p&gt;After the previous rather long (but I hope gentle enough) introduction to implementing
our own class based view hierarchy using inheritance, mixins, &lt;span class="caps"&gt;MRO&lt;/span&gt;, method overriding
and &lt;tt class="docutils literal"&gt;super&lt;/tt&gt; we can now start talking about the Django Class Based Views (CBVs). Our
guide will be the &lt;a class="reference external" href="http://ccbv.co.uk`"&gt;&lt;span class="caps"&gt;CBV&lt;/span&gt; inspector&lt;/a&gt; application which displays all classes and mixins
that Django CBVs are using along with their methods and attributes. Using this application
and after reading this article you should be able to quickly and definitely know
which method or attribute you need to define to each one of your mixins or&amp;nbsp;views.&lt;/p&gt;
&lt;p&gt;To use &lt;span class="caps"&gt;CBV&lt;/span&gt; inspector, just click on a class name (for example &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt;); you will
immediately see its &lt;span class="caps"&gt;MRO&lt;/span&gt; ancestors, its list of attributes (and the ancestor class that defines
each one) and finally a list of methods that this class and all its ancestors define.
Of course when a method is defined by multiple classes the &lt;span class="caps"&gt;MRO&lt;/span&gt; ordering will be used -
super is used when the functionality of the ancestor classes is also used. The &lt;span class="caps"&gt;CBV&lt;/span&gt;
inspector (and our project) has Python 3 syntax. If you want to follow along with
Python 2 (I don&amp;#8217;t recommend it though since Django 2.0 only supports Python 3.x) use the following
syntax to call super for method &lt;tt class="docutils literal"&gt;x()&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ClassName&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;this is the same as&amp;nbsp;calling&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;in Python&amp;nbsp;3.x.&lt;/p&gt;
&lt;div class="section" id="taking-a-look-at-the-view"&gt;
&lt;h3&gt;Taking a look at the&amp;nbsp;View&lt;/h3&gt;
&lt;p&gt;In any case, our travel starts from the central &lt;span class="caps"&gt;CBV&lt;/span&gt; class which is (intuitively) called &amp;#8230; &lt;a class="reference external" href="https://ccbv.co.uk/View"&gt;View&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;This class is used as the base in Django&amp;#8217;s &lt;span class="caps"&gt;CBV&lt;/span&gt; hierarchy (similar to how  &lt;tt class="docutils literal"&gt;CustomClassView&lt;/tt&gt;
was used in our own hierarchy). It has only one attribute
(&lt;tt class="docutils literal"&gt;http_method_names&lt;/tt&gt;) and a very small number of methods. The most important method is the
&lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; class method (which is similar to the one we defined in the previous section).
The &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; will instantiate an instance object of the &lt;tt class="docutils literal"&gt;View&lt;/tt&gt; class
(actually the class that inherits from &lt;tt class="docutils literal"&gt;View&lt;/tt&gt;) and use this object to properly generate a functional&amp;nbsp;view.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;View&lt;/tt&gt; class cannot be used as it is
but it must be inherited by a child class. The child class needs to define a method
that has the same name as each http method that is supported - for example if
only &lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;GET&lt;/span&gt; and &lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;POST&lt;/span&gt; are supported then the inherited class must define a
&lt;tt class="docutils literal"&gt;get&lt;/tt&gt; and a &lt;tt class="docutils literal"&gt;post&lt;/tt&gt; method; these methods are called from the functional view
through a method called &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; and need to return a proper response object. So,
we have two central methods here: The &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; class method that creates the
object instance and returns its view function and &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; that will call
the proper named class method depending on the &lt;span class="caps"&gt;HTTP&lt;/span&gt; method (i.e post, get, put
etc). One thing to keep from this discussion is that you shouldn&amp;#8217;t ever need to
mess with &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; but, because &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; is the only instance method that is
guaranteed to run every time the class based view will run, you will frequently
need to override it especially to control access&amp;nbsp;control.&lt;/p&gt;
&lt;p&gt;As an example, we can implemented the &lt;tt class="docutils literal"&gt;BetterCustomClassView&lt;/tt&gt; from the first
section using &lt;tt class="docutils literal"&gt;View&lt;/tt&gt; as its&amp;nbsp;ancestor:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DjangoBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;View&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;header&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;lt;br /&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="s2"&gt;            &amp;lt;html&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                &amp;lt;body&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                    &amp;lt;h1&amp;gt;{header}&amp;lt;/h1&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;                    {body}&lt;/span&gt;
&lt;span class="s2"&gt;                &amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;            &amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_header&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render_context&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
            &lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This method won&amp;#8217;t print anything but of course it could use the mixins from
before to have some default&amp;nbsp;values:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DefaultHeaderContextDjangoBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DefaultHeaderMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DefaultContextMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DjangoBetterCustomClassView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Of course instead of using our mixins and render methods it would be much better
to use the proper ones defined by Django - that&amp;#8217;s what we&amp;#8217;re going to do from
now on I just wanted to make clear that there&amp;#8217;s nothing special in Django&amp;#8217;s &lt;span class="caps"&gt;CBV&lt;/span&gt;
hierarchy and can be overridden as we&amp;#8217;d&amp;nbsp;like.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="redirectview-and-templateview"&gt;
&lt;h3&gt;RedirectView and&amp;nbsp;TemplateView&lt;/h3&gt;
&lt;p&gt;Continuing our tour of Django CBVs I&amp;#8217;d like to talk a little about the classes
that the &lt;span class="caps"&gt;CBV&lt;/span&gt; Inspector puts in the same level as &lt;tt class="docutils literal"&gt;View&lt;/tt&gt; (&lt;span class="caps"&gt;GENERIC&lt;/span&gt; &lt;span class="caps"&gt;BASE&lt;/span&gt;):
&lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/base/#redirectview"&gt;RedirectView&lt;/a&gt; and &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/base/#templateview"&gt;TemplateView&lt;/a&gt;. Both inherit directly from &lt;tt class="docutils literal"&gt;View&lt;/tt&gt; and, the
first one defines a &lt;tt class="docutils literal"&gt;get&lt;/tt&gt; method that returns a redirect to another page
while the latter one renders and returns a Django template in the &lt;tt class="docutils literal"&gt;get&lt;/tt&gt;
method.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;RedirectView&lt;/tt&gt; inherits directly from view and has attributes like &lt;tt class="docutils literal"&gt;url&lt;/tt&gt;
(to use a static url)
or &lt;tt class="docutils literal"&gt;pattern_name&lt;/tt&gt; (to use one of the patterns define in your urls.py)
to define where it should redirect. These attributes are
used by the &lt;tt class="docutils literal"&gt;get_redirect_url&lt;/tt&gt; which will generate the actual url to redirect
to and can be overriden for example to redirect to a different location depending
on the current&amp;nbsp;user.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;TemplateView&lt;/tt&gt; on the other hand inherits from &lt;tt class="docutils literal"&gt;View&lt;/tt&gt; and two more classes (actually
these are mixins) beyond &lt;tt class="docutils literal"&gt;View&lt;/tt&gt;: &lt;tt class="docutils literal"&gt;TemplateResponseMixin&lt;/tt&gt; and
&lt;tt class="docutils literal"&gt;ContextMixin&lt;/tt&gt;. If you take a look at them you&amp;#8217;ll see that the
&lt;tt class="docutils literal"&gt;TemplateResponseMixin&lt;/tt&gt; defines some template-related attributes (most important being
the &lt;tt class="docutils literal"&gt;template_name&lt;/tt&gt;) and two
methods: One that retrieves the template that will be used to render this View
(&lt;tt class="docutils literal"&gt;get_template_names&lt;/tt&gt;)
and one that actually renders the template (&lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt;) using a
&lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/template-response/#django.template.response.TemplateResponse"&gt;TemplateResponse&lt;/a&gt; instance. The
&lt;tt class="docutils literal"&gt;ContextMixin&lt;/tt&gt; provides the &lt;tt class="docutils literal"&gt;get_context_data&lt;/tt&gt; that is
passed to the template to be rendered and should be overridden if you want to
pass more context&amp;nbsp;variables.&lt;/p&gt;
&lt;p&gt;We can already see many opportunities of reusing and overriding
functionality and improving our &lt;span class="caps"&gt;DRY&lt;/span&gt; score, for example: Create a catch all RedirectView
that depending on the remainder of the url it will redirect to a different page,
create a mixin that appends some things to the context of all CBVs using it, use dynamic templates
based on some other condition (that&amp;#8217;s actually what Detail/List/UpdateView
are doing), render a template to a different output than Html (for example a
text file) etc. I&amp;#8217;ll try to present examples for these in the next&amp;nbsp;section.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-formview"&gt;
&lt;h3&gt;The&amp;nbsp;FormView&lt;/h3&gt;
&lt;p&gt;The next view we&amp;#8217;re going to talk about is &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-editing/#formview"&gt;FormView&lt;/a&gt;. This is a view that can be
used whenever we want to display a form (&lt;em&gt;not&lt;/em&gt; a form related to a Model i.e for
Create/Update/Delete, for these cases there are specific CBVs we&amp;#8217;ll see later).
It is interesting to take a look at the list of its
ancestors: &lt;tt class="docutils literal"&gt;TemplateResponseMixin&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;BaseFormView&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;ContextMixin&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;ProcessFormView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;View&lt;/tt&gt;.
We are familiar with &lt;tt class="docutils literal"&gt;TemplateResponseMixin&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;ContextMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;View&lt;/tt&gt; but not with
the others. Before discussing these classes let&amp;#8217;s take a look at the FormView
hierarchy, courtesy of &lt;a class="reference external" href="http://ccbv.cco.uk"&gt;http://ccbv.cco.uk&lt;/a&gt; and &lt;a class="reference external" href="http://yuml.me"&gt;http://yuml.me&lt;/a&gt;:&lt;/p&gt;
&lt;img src="https://yuml.me/diagram/plain;/class/[TemplateResponseMixin%7Bbg:white%7D]%5E-[FormView%7Bbg:green%7D],%20[BaseFormView%7Bbg:white%7D]%5E-[FormView%7Bbg:green%7D],%20[FormMixin%7Bbg:white%7D]%5E-[BaseFormView%7Bbg:white%7D],%20[ContextMixin%7Bbg:white%7D]%5E-[FormMixin%7Bbg:white%7D],%20[ProcessFormView%7Bbg:white%7D]%5E-[BaseFormView%7Bbg:white%7D],%20[View%7Bbg:lightblue%7D]%5E-[ProcessFormView%7Bbg:white%7D].svg" alt="FormView"&gt;&lt;p&gt;The above diagram should make everything easier: The &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt; inherits
from &lt;tt class="docutils literal"&gt;ContextMixin&lt;/tt&gt; and overrides its &lt;tt class="docutils literal"&gt;get_context_data&lt;/tt&gt; method to add the
form to the view. Beyond this, it adds some attributes and methods for proper form handling, for
example the &lt;tt class="docutils literal"&gt;form_class&lt;/tt&gt; (attribute when the form class will be the same always) and
&lt;tt class="docutils literal"&gt;get_form_class()&lt;/tt&gt; (method when the form class will be dynamic for example
depending on the logged in user), &lt;tt class="docutils literal"&gt;initial&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;get_initial()&lt;/tt&gt; (same logic as before for
the form&amp;#8217;s initial values), &lt;tt class="docutils literal"&gt;form_valid()&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;form_invalid()&lt;/tt&gt; to define
what should happen when the form is valid or invalid, &lt;tt class="docutils literal"&gt;get_form_kwargs&lt;/tt&gt; to pass
some keyword arguments to the form&amp;#8217;s constructor etc. Notice that FormMixin
does not define any form handling logic (i.e check if the form is valid and call
its &lt;tt class="docutils literal"&gt;form_valid()&lt;/tt&gt; method) &amp;#8212; this logic is defined in the &lt;tt class="docutils literal"&gt;ProcessFormView&lt;/tt&gt;
which inherits from &lt;tt class="docutils literal"&gt;View&lt;/tt&gt; and defines proper &lt;tt class="docutils literal"&gt;get()&lt;/tt&gt; (just render the form)
and &lt;tt class="docutils literal"&gt;post()&lt;/tt&gt; (check if the form is valid and call &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; else call &lt;tt class="docutils literal"&gt;form_invalid&lt;/tt&gt;)&amp;nbsp;methods.&lt;/p&gt;
&lt;p&gt;One interesting here is to notice here is that Django defines both the &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;ProcessFormView&lt;/tt&gt;.
The &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt; offers the basic Form elements (the form class, initial data
etc) and could be re-used in a different flow beyond the one offered by
&lt;tt class="docutils literal"&gt;ProcessFormView&lt;/tt&gt; (for example display the form as a &lt;span class="caps"&gt;JSON&lt;/span&gt; object instead of a
Django template). On the other hand, &lt;tt class="docutils literal"&gt;ProcessFormView&lt;/tt&gt; is required in order to
define the &lt;tt class="docutils literal"&gt;get&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;post&lt;/tt&gt; methods that are needed from the &lt;tt class="docutils literal"&gt;View&lt;/tt&gt;. These
methods can&amp;#8217;t be overridden in the FormMixin since that would mean that the mixin
would behave as a&amp;nbsp;view!&lt;/p&gt;
&lt;p&gt;Finally, the &lt;tt class="docutils literal"&gt;BaseFormView&lt;/tt&gt; class is used to
inherit from &lt;tt class="docutils literal"&gt;ProcessFormView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt;. It does not do anything
more than providing a base class that other classes that want to use the form
functionality (i.e both the &lt;tt class="docutils literal"&gt;ProcessFormView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt;) will inherit&amp;nbsp;from.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-listview-and-detailview"&gt;
&lt;h3&gt;The ListView and&amp;nbsp;DetailView&lt;/h3&gt;
&lt;p&gt;Next in our Django &lt;span class="caps"&gt;CBV&lt;/span&gt; tour is the &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#listview"&gt;ListView&lt;/a&gt;. The &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt; is used to render multiple
objects in a template, for example in a list or table. Here&amp;#8217;s a diagram of the class
hierarchy (courtesy of &lt;a class="reference external" href="http://ccbv.cco.uk"&gt;http://ccbv.cco.uk&lt;/a&gt; and &lt;a class="reference external" href="http://yuml.me"&gt;http://yuml.me&lt;/a&gt;):&lt;/p&gt;
&lt;img src="https://yuml.me/diagram/plain;/class/[MultipleObjectTemplateResponseMixin%7Bbg:white%7D]%5E-[ListView%7Bbg:green%7D],%20[TemplateResponseMixin%7Bbg:white%7D]%5E-[MultipleObjectTemplateResponseMixin%7Bbg:white%7D],%20[BaseListView%7Bbg:white%7D]%5E-[ListView%7Bbg:green%7D],%20[MultipleObjectMixin%7Bbg:white%7D]%5E-[BaseListView%7Bbg:white%7D],%20[ContextMixin%7Bbg:white%7D]%5E-[MultipleObjectMixin%7Bbg:white%7D],%20[View%7Bbg:lightblue%7D]%5E-[BaseListView%7Bbg:white%7D].svg" alt="ListView"&gt;&lt;p&gt;The &lt;tt class="docutils literal"&gt;MultipleObjectMixin&lt;/tt&gt; is used make a query to the database (either using a
model or a queryset) and pass the results to the context. It also supports
custom ordering (&lt;tt class="docutils literal"&gt;get_ordering()&lt;/tt&gt;) and pagination (&lt;tt class="docutils literal"&gt;paginate_queryset()&lt;/tt&gt;).
However, the most important method of this mixin is &lt;tt class="docutils literal"&gt;get_queryset()&lt;/tt&gt;. This
method checks to see if the &lt;tt class="docutils literal"&gt;queryset&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;model&lt;/tt&gt; attribute are defined
(&lt;tt class="docutils literal"&gt;queryset&lt;/tt&gt; will be checked first so it has priority if both are defined) and
returns a queryset result (taking into account the ordering). This queryset
result will be used by the &lt;tt class="docutils literal"&gt;get_context_data()&lt;/tt&gt; method of this mixin to
actually put it to the context by saving to a context variable named &lt;tt class="docutils literal"&gt;object_list&lt;/tt&gt;.
Notice that you can set the &lt;tt class="docutils literal"&gt;context_object_name&lt;/tt&gt; attribute to add and extra
another variable to the context with the queryset beyond &lt;tt class="docutils literal"&gt;object_list&lt;/tt&gt; (for
example if you have an &lt;tt class="docutils literal"&gt;ArticleLsitView&lt;/tt&gt; you can set &lt;tt class="docutils literal"&gt;context_object_name = articles&lt;/tt&gt; to
be able to do &lt;tt class="docutils literal"&gt;{% for article in articles %}&lt;/tt&gt; in your context instead of
&lt;tt class="docutils literal"&gt;{% for article in object_list %}&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;MultipleObjectMixin&lt;/tt&gt; can be used and
overridden when we need to put multiple objects in a View. This mixin is
inherited (along with &lt;tt class="docutils literal"&gt;View&lt;/tt&gt;) from &lt;tt class="docutils literal"&gt;BaseListView&lt;/tt&gt; that adds a proper &lt;tt class="docutils literal"&gt;get&lt;/tt&gt;
method to call &lt;tt class="docutils literal"&gt;get_context_data&lt;/tt&gt; and pass the result to the&amp;nbsp;template.&lt;/p&gt;
&lt;p&gt;As we can also see, Django uses the &lt;tt class="docutils literal"&gt;MultipleObjectTemplateResponseMixin&lt;/tt&gt; that
inherits from &lt;tt class="docutils literal"&gt;TemplateResponseMixin&lt;/tt&gt; to render the template. This mixin does
some magic with the queryset or model to define a
template name (so you won&amp;#8217;t need to define it yourself) - that&amp;#8217;s from where the
&lt;tt class="docutils literal"&gt;app_label/app_model_list.html&lt;/tt&gt; default template name is&amp;nbsp;created.&lt;/p&gt;
&lt;p&gt;Similar to the &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt; is the &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#detailview"&gt;DetailView&lt;/a&gt; which has the same class hierarchy as the &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt; with two differences:
It uses &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; instead of &lt;tt class="docutils literal"&gt;MultipleOjbectMixin&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;SingleObjectTemplateResponseMixin&lt;/tt&gt; instead of &lt;tt class="docutils literal"&gt;MultipleObjectTemplateResponseMixin&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;BaseDetailView&lt;/tt&gt; instead of &lt;tt class="docutils literal"&gt;BaseListView&lt;/tt&gt;. The
&lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; will use the &lt;tt class="docutils literal"&gt;get_queryset()&lt;/tt&gt; (in a similar manner to the &lt;tt class="docutils literal"&gt;get_queryset()&lt;/tt&gt; of
&lt;tt class="docutils literal"&gt;MultipleObjectMixin&lt;/tt&gt;) method to return a single object (so all attributes and methods
concerning ordering or pagination are missing) but instead has the &lt;tt class="docutils literal"&gt;get_object()&lt;/tt&gt; method which
will pick and return a single object from that queryset (using a &lt;tt class="docutils literal"&gt;pk&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;slug&lt;/tt&gt; parameter). This object
will be put to the context of this view by the &lt;tt class="docutils literal"&gt;get_context_data&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;BaseDetailView&lt;/tt&gt; just
defines a proper &lt;tt class="docutils literal"&gt;get&lt;/tt&gt; to call the &lt;tt class="docutils literal"&gt;get_context_data&lt;/tt&gt; (of &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;) and finally
the &lt;tt class="docutils literal"&gt;SingleObjectTemplateResponseMixin&lt;/tt&gt; will automatically generate the template name (i.e generate
&lt;tt class="docutils literal"&gt;app_label/app_model_detail.html&lt;/tt&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-createview"&gt;
&lt;h3&gt;The&amp;nbsp;CreateView&lt;/h3&gt;
&lt;p&gt;The next Django &lt;span class="caps"&gt;CBV&lt;/span&gt; we&amp;#8217;ll talk about is &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#createview"&gt;CreateView&lt;/a&gt;. This class is used to create a new instance
of a model. It has a rather complex hierarchy diagram but we&amp;#8217;ve already discussed most of these&amp;nbsp;classes:&lt;/p&gt;
&lt;img src="https://yuml.me/diagram/plain;/class/[SingleObjectTemplateResponseMixin%7Bbg:white%7D]%5E-[CreateView%7Bbg:green%7D],%20[TemplateResponseMixin%7Bbg:white%7D]%5E-[SingleObjectTemplateResponseMixin%7Bbg:white%7D],%20[BaseCreateView%7Bbg:white%7D]%5E-[CreateView%7Bbg:green%7D],%20[ModelFormMixin%7Bbg:white%7D]%5E-[BaseCreateView%7Bbg:white%7D],%20[FormMixin%7Bbg:white%7D]%5E-[ModelFormMixin%7Bbg:white%7D],%20[ContextMixin%7Bbg:white%7D]%5E-[FormMixin%7Bbg:white%7D],%20[SingleObjectMixin%7Bbg:white%7D]%5E-[ModelFormMixin%7Bbg:white%7D],%20[ContextMixin%7Bbg:white%7D]%5E-[SingleObjectMixin%7Bbg:white%7D],%20[ProcessFormView%7Bbg:white%7D]%5E-[BaseCreateView%7Bbg:white%7D],%20[View%7Bbg:lightblue%7D]%5E-[ProcessFormView%7Bbg:white%7D].svg" /&gt;&lt;p&gt;As we can see the &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; inherits from &lt;tt class="docutils literal"&gt;BaseCreateView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;SingleObjectTemplateResponseMixin&lt;/tt&gt;. The
&lt;tt class="docutils literal"&gt;SingleObjectTemplateResponseMixin&lt;/tt&gt; is mainly used to define the template names that will be searched for
(i.e &lt;tt class="docutils literal"&gt;app_label/app_model_form.html&lt;/tt&gt;), while the &lt;tt class="docutils literal"&gt;BaseCreateView&lt;/tt&gt;
is used to combine the functionality of &lt;tt class="docutils literal"&gt;ProcessFormView&lt;/tt&gt; (that handles the basic form workflow as we have
already discussed) and &lt;tt class="docutils literal"&gt;ModelFormMixin&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;ModelFormMixin&lt;/tt&gt; is a rather complex mixin that inherits from
both &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; functionality is not really used by &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt;
(since no object will need to be retrieved for the &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt;) however the &lt;tt class="docutils literal"&gt;ModelFormMixin&lt;/tt&gt; is also used
by &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt; that&amp;#8217;s why &lt;tt class="docutils literal"&gt;ModelFormMixin&lt;/tt&gt; also inherits from it (to retrieve the object that will be&amp;nbsp;updated).&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;ModelFormMixin&lt;/tt&gt; mixin adds functionality
for handling forms related to models and object instances. More specifically it adds functionality for:
* creating a form class (if one is not provided) by the configured model / queryset. If you don&amp;#8217;t provide the form class (by using the &lt;tt class="docutils literal"&gt;form_class&lt;/tt&gt; attribute) then you need to configure the fields that the generated form will display by passing an array of field names through the &lt;tt class="docutils literal"&gt;fields&lt;/tt&gt; attribute
* overrides the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; in order to save the object instance of the form
* fixes &lt;tt class="docutils literal"&gt;get_success_url&lt;/tt&gt; to redirect to the saved object&amp;#8217;s absolute_url when the object is saved
* pass the current object to be updated (that was retrieving through the &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;) -if there is a current object- to the form as the &lt;tt class="docutils literal"&gt;instance&lt;/tt&gt; attribute&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-updateview-and-deleteview"&gt;
&lt;h3&gt;The UpdateView and&amp;nbsp;DeleteView&lt;/h3&gt;
&lt;p&gt;The &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#updateview"&gt;UpdateView&lt;/a&gt; class is almost identical to the &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; - the only difference is that
&lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt; inherits from &lt;tt class="docutils literal"&gt;BaseUpdateView&lt;/tt&gt; (and &lt;tt class="docutils literal"&gt;SingleObjectTemplateResponseMixin&lt;/tt&gt;) instead
of &lt;tt class="docutils literal"&gt;BaseCreateView&lt;/tt&gt;.  The &lt;tt class="docutils literal"&gt;BaseUpdateView&lt;/tt&gt; overrides the &lt;tt class="docutils literal"&gt;get&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;post&lt;/tt&gt; methods of
&lt;tt class="docutils literal"&gt;ProcessFormView&lt;/tt&gt; to retrieve the object (using &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;&amp;#8216;s &lt;tt class="docutils literal"&gt;get_object()&lt;/tt&gt;)
and assign it to an instance variable - this will then be picked up by the &lt;tt class="docutils literal"&gt;ModelFormMixin&lt;/tt&gt; and used
properly in the form as explained before. One thing I notice here is that it seems that the hierarchy would
be better if the &lt;tt class="docutils literal"&gt;ModelFormMixin&lt;/tt&gt; inherited &lt;em&gt;only&lt;/em&gt; from &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt; (instead of both from
&lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;) and &lt;tt class="docutils literal"&gt;BaseUpdateView&lt;/tt&gt; inheriting from &lt;tt class="docutils literal"&gt;ProcessFormView&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;ModelForMixin&lt;/tt&gt; &lt;em&gt;and&lt;/em&gt; &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;. This way the &lt;tt class="docutils literal"&gt;BaseCreateView&lt;/tt&gt; wouldn&amp;#8217;t get the
non-needed &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; functionality. I am not sure why Django is implemented this way
(i.e the &lt;tt class="docutils literal"&gt;ModelFormMixin&lt;/tt&gt; also inheriting from &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; thus passing this non-needed
functionality to &lt;tt class="docutils literal"&gt;BaseCreateView&lt;/tt&gt;) &amp;#8212; if a reader has a clue I&amp;#8217;d like to know&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;In any way, I&amp;#8217;d like to also present the &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#deleteview"&gt;DeleteView&lt;/a&gt; which is more or less the same as the &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/class-based-views/generic-display/#detailview"&gt;DetailView&lt;/a&gt;
with the addition of the &lt;tt class="docutils literal"&gt;DeleteMixin&lt;/tt&gt; in the mix. The &lt;tt class="docutils literal"&gt;DeleteMixin&lt;/tt&gt; adds a &lt;tt class="docutils literal"&gt;post()&lt;/tt&gt; method
that will delete the object when called and makes &lt;tt class="docutils literal"&gt;success_url&lt;/tt&gt; required (since there would be no
object to redirect to after this view is&amp;nbsp;posted).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="access-control-mixins"&gt;
&lt;h3&gt;Access control&amp;nbsp;mixins&lt;/h3&gt;
&lt;p&gt;Another small hierarchy of class based views (actually these are all mixins) are the authentication ones which
can be used to control access to a view.
These are &lt;tt class="docutils literal"&gt;AcessMixin&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;LoginRequiredMixin&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;PermissionRequiredMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;UserPassesTestMixin&lt;/tt&gt;.
The &lt;tt class="docutils literal"&gt;AccessMixin&lt;/tt&gt; provides some basic functionality (i.e what to do when the user does not have access
to the view, find out the login url to redirect him etc) and is used as a base for the other three. These
three override the &lt;tt class="docutils literal"&gt;dispatch()&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;View&lt;/tt&gt; to check if the user has the specific rights (i.e
if he has logged in for &lt;tt class="docutils literal"&gt;LoginRequiredMixin&lt;/tt&gt;, if he has the defined permissions for &lt;tt class="docutils literal"&gt;PermissionRequiredMixin&lt;/tt&gt;
or if he passes the provided test in &lt;tt class="docutils literal"&gt;UserPassesTextMixin&lt;/tt&gt;). If the user has the rights the view will proceed
as normally (call super&amp;#8217;s dispatch) else the access denied functionality from &lt;tt class="docutils literal"&gt;AccessMixin&lt;/tt&gt; will be&amp;nbsp;implemented.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="some-other-cbvs"&gt;
&lt;h3&gt;Some other&amp;nbsp;CBVs&lt;/h3&gt;
&lt;p&gt;Beyond the class based views I discussed in this section, Django also has a bunch of CBVs related
to account views (&lt;tt class="docutils literal"&gt;LoginView&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;LogoutView&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;PasswordChangeView&lt;/tt&gt; etc) and Dates (&lt;tt class="docutils literal"&gt;DateDetailView&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;YearArchiveView&lt;/tt&gt; etc).
I won&amp;#8217;t go into detail about these since they follow the same concepts and use most of the mixins
we&amp;#8217;ve discussed before. Using the &lt;span class="caps"&gt;CBV&lt;/span&gt; Inspector you should be able to follow along and decide the methods you need
to override for your&amp;nbsp;needs.&lt;/p&gt;
&lt;p&gt;Also, most well written Django packages will define their own CBVs that inherit
from the Django CBVs - with the knowledge you acquired here you will be able to follow along on their source code to understand how everything&amp;nbsp;works.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="real-world-use-cases"&gt;
&lt;h2&gt;Real world use&amp;nbsp;cases&lt;/h2&gt;
&lt;p&gt;In this section I am going to present a number of use cases demonstrating the usefulness of Django CBVs. In most of
these examples I am going to override one of the methods of the mixins I discussed in the previous section. There
are &lt;em&gt;two&lt;/em&gt; methods you can use for integrating the following use cases to your&amp;nbsp;application.&lt;/p&gt;
&lt;p&gt;Create your own class inheriting from one of the Django CBVs and add to it directly the method to override. For example,
if you wanted to override the &lt;tt class="docutils literal"&gt;get_queryset()&lt;/tt&gt; method a &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt; you would do&amp;nbsp;a:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;GetQuerysetOverrideListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PUBLISHED&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is useful if you know that you aren&amp;#8217;t going to need the overriden &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt; functionality to a different
method and following the &lt;span class="caps"&gt;YAGNI&lt;/span&gt; principle (or if you know that even if you need it you could inherit from &lt;tt class="docutils literal"&gt;GetQuerysetOverrideListView&lt;/tt&gt;
i.e in another ListView).
However, if you know that there may be more CBVs that would need their
queryset filtered by &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;status='&lt;span class="caps"&gt;PUBLISHED&lt;/span&gt;'&lt;/span&gt;&lt;/tt&gt; then you should add a mixin that would be used by your&amp;nbsp;CBVs:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;GetQuerysetOverrideMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PUBLISHED&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;GetQuerysetOverrideListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;GetQuerysetOverrideMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, one thing that needs some discussion here is that the method &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt; is provided by a mixin (in fact
it is provided by two mixins: &lt;tt class="docutils literal"&gt;MultipleObjectMixin&lt;/tt&gt; for &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; for &lt;tt class="docutils literal"&gt;DetailView&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;DeleteView&lt;/tt&gt;). Because of how &lt;span class="caps"&gt;MRO&lt;/span&gt; works, I won&amp;#8217;t need to inherit &lt;tt class="docutils literal"&gt;GetQuerysetOverrideMixin&lt;/tt&gt; from
&lt;tt class="docutils literal"&gt;MultipleObjectMixin&lt;/tt&gt; (or &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; but let&amp;#8217;s ignore that for now) but I can just inherit from object
and make sure that, as already discussed, put the mixin &lt;em&gt;before&lt;/em&gt; (to the left) of the &lt;span class="caps"&gt;CBV&lt;/span&gt;. Notice that even if I had
defined &lt;tt class="docutils literal"&gt;GetQuerysetOverrideMixin&lt;/tt&gt; as &lt;tt class="docutils literal"&gt;GetQuerysetOverrideMixin(MultipleObjectMixin)&lt;/tt&gt; the &lt;tt class="docutils literal"&gt;MultipleObjectMixin&lt;/tt&gt; class would
be found &lt;em&gt;twice&lt;/em&gt; in the &lt;span class="caps"&gt;MRO&lt;/span&gt; list so only the rightmost instance would remain. So the &lt;span class="caps"&gt;MRO&lt;/span&gt; for both &lt;tt class="docutils literal"&gt;GetQuerysetOverrideMixin(object, )&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;GetQuerysetOverrideMixin(MultipleObjectMixin)&lt;/tt&gt; &lt;em&gt;would be the same&lt;/em&gt;! Also, inheriting directly from object makes
our &lt;tt class="docutils literal"&gt;GetQuerysetOverrideMixin&lt;/tt&gt; more &lt;span class="caps"&gt;DRY&lt;/span&gt; since if it inherited from &lt;tt class="docutils literal"&gt;MultipleObjectMixin&lt;/tt&gt; we&amp;#8217;d need to create &lt;em&gt;another&lt;/em&gt;
version of it that would inherit from &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;; this is because &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt; exists in both these&amp;nbsp;mixins.&lt;/p&gt;
&lt;p&gt;For some of the following use cases I am also going to use the following models for user generated content (articles and uploaded&amp;nbsp;files):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;STATUS_CHOICES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DRAFT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Draft&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PUBLISHED&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Published&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;REMOVED&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Removed&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Category&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__str__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;

    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;publisher_access&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Publisher Access&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
            &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;admin_access&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Admin Access&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AbstractGeneralInfo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;choices&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;STATUS_CHOICES&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;category&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;on_delete&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PROTECT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;created_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;auto_now_add&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;created_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AUTH_USER_MODEL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;on_delete&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PROTECT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;related_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%(class)s&lt;/span&gt;&lt;span class="s1"&gt;_created_by&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;modified_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;auto_now&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;modified_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AUTH_USER_MODEL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;on_delete&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PROTECT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;related_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%(class)s&lt;/span&gt;&lt;span class="s1"&gt;_modified_by&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;owned_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AUTH_USER_MODEL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;on_delete&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PROTECT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;related_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%(class)s&lt;/span&gt;&lt;span class="s1"&gt;_owned_by&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;published_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;null&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;abstract&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Article&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AbstractGeneralInfo&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TextField&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Document&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AbstractGeneralInfo&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;description&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;FileField&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;All this can be found on the accompanying project &lt;a class="reference external" href="https://github.com/spapas/cbv-tutorial"&gt;https://github.com/spapas/cbv-tutorial&lt;/a&gt; on the djangocbv app (visit &lt;a class="reference external" href="http://127.0.0.1:8001/djangocbv/"&gt;http://127.0.0.1:8001/djangocbv/&lt;/a&gt;).&lt;/p&gt;
&lt;div class="section" id="do-something-when-a-valid-form-is-submitted"&gt;
&lt;h3&gt;Do something when a valid form is&amp;nbsp;submitted&lt;/h3&gt;
&lt;p&gt;When a form is submitted and the form is valid
the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;ModelForMixin&lt;/tt&gt; (and &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt;) will be called. This method
can be overridden to do various things before (or after) the form is saved. For example,
you may want have a field whose value is calculated from other fields in the form or you want to
create an extra object. Let&amp;#8217;s see a generic example of overriding a &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt; with&amp;nbsp;comments:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# let&amp;#39;s calculate a field value&lt;/span&gt;
    &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;calculated_field&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="c1"&gt;# save the form by calling super().form_valid(); keep the return value - it is the value of get_success_url&lt;/span&gt;
    &lt;span class="n"&gt;redirect_to&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# For Create or UpdateView, the just-saved object will be assigned to self.object&lt;/span&gt;
    &lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Created an object with id {0}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# return the redirect&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;redirect_to&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is rather complex so I&amp;#8217;ll also explain it: The form_valid gets the actual form which, since is validated
has a &lt;tt class="docutils literal"&gt;cleaned_data&lt;/tt&gt; dictionary of values. This form also has an &lt;tt class="docutils literal"&gt;instance&lt;/tt&gt; attribute which is the object
that this form is bound to - notice that a normal &lt;tt class="docutils literal"&gt;Form&lt;/tt&gt; won&amp;#8217;t have an instance only a &lt;tt class="docutils literal"&gt;ModelForm&lt;/tt&gt;.
This can be used to modify the instance of this form as needed - before saving it. When you want to actually save
the instance you call &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;super().form_valid()&lt;/span&gt;&lt;/tt&gt; passing it the modified form (and instance). This method does
three&amp;nbsp;things&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;It saves the instance to the&amp;nbsp;database&lt;/li&gt;
&lt;li&gt;It assigns the saved object to the &lt;tt class="docutils literal"&gt;object&lt;/tt&gt; instance attribute (so you can refer to it by &lt;tt class="docutils literal"&gt;self.instance&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;It uses &lt;tt class="docutils literal"&gt;get_redirect_url&lt;/tt&gt; to retrieve the location where you should redirect after the form is&amp;nbsp;submitted&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Thus in this example we save &lt;tt class="docutils literal"&gt;redirect_to&lt;/tt&gt; to return it also from our method also and then can use &lt;tt class="docutils literal"&gt;self.object.id&lt;/tt&gt;
to log the id of the current&amp;nbsp;object.&lt;/p&gt;
&lt;p&gt;On a more specific example, notice the &lt;tt class="docutils literal"&gt;Article&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;Document&lt;/tt&gt; models which both inherit (abstract)
from &lt;tt class="docutils literal"&gt;AbstractGeneralInfo&lt;/tt&gt; have a &lt;tt class="docutils literal"&gt;created_by&lt;/tt&gt; and
a &lt;tt class="docutils literal"&gt;modified_by&lt;/tt&gt; field. These fields have to be filled automatically from the current logged in user. Now, there are various
options to do that but what I vote for is using an &lt;tt class="docutils literal"&gt;AuditableMixin&lt;/tt&gt; as I have already described in &lt;a class="reference external" href="https://spapas.github.io/2015/01/21/django-model-auditing/#adding-simple-auditing-functionality-ourselves"&gt;my Django model auditing article&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To replicate the functionality we&amp;#8217;ll create an &lt;tt class="docutils literal"&gt;AuditableMixin&lt;/tt&gt; like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;created_by&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;created_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;
        &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;modified_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This mixin can be used by both the create and update view of both &lt;tt class="docutils literal"&gt;Article&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;Document&lt;/tt&gt;. So all four of these
classes will share the same functionality. Notice that the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; method is overridden - the &lt;tt class="docutils literal"&gt;created_by&lt;/tt&gt;
of the form&amp;#8217;s instance (which is the object that was edited, remember how &lt;tt class="docutils literal"&gt;ModelFormMixin&lt;/tt&gt; works) will by set
to the current user if it is null (so it will be only set once) while the &lt;tt class="docutils literal"&gt;modified_by&lt;/tt&gt; will be set always to the
current user. Finally we call &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;super().form_valid&lt;/span&gt;&lt;/tt&gt; and return its response so
that the form will be actually saved and the redirect will go to the proper success url. To use it for example for the
&lt;tt class="docutils literal"&gt;Article&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; should be defined like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ArticleCreateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CreateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="change-the-queryset-of-the-cbv"&gt;
&lt;h3&gt;Change the queryset of the &lt;span class="caps"&gt;CBV&lt;/span&gt;&lt;/h3&gt;
&lt;p&gt;All CBVs that inherit from &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;MultipleObjectMixin&lt;/tt&gt; (&lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;DetailView&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;DeleteView&lt;/tt&gt;)
have a &lt;tt class="docutils literal"&gt;model&lt;/tt&gt; and a &lt;tt class="docutils literal"&gt;queryset&lt;/tt&gt; property that can be used (either one or the other) to define the queryset that will be used for
querying the database for that CBVs results. This queryset can be further dynamically refined by overriding the &lt;tt class="docutils literal"&gt;get_queryset()&lt;/tt&gt; method.
What I usually do is that I define the &lt;tt class="docutils literal"&gt;model&lt;/tt&gt; attribute and then override &lt;tt class="docutils literal"&gt;get_querset&lt;/tt&gt; in order to dynamically modify the&amp;nbsp;queryset.&lt;/p&gt;
&lt;p&gt;For example, let&amp;#8217;s say that I wanted to add a count of articles and documents per each category. Here&amp;#8217;s how the &lt;tt class="docutils literal"&gt;CategoryListView&lt;/tt&gt; could be&amp;nbsp;done:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CategoryListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ExportCsvMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;AdminOrPublisherPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Category&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;categories&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;annotate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;article_cnt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;article&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;document_cnt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;document&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that I also use some more mixins for this &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt; (they&amp;#8217;ll be explained later). The &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt; adds
the annotation to the &lt;tt class="docutils literal"&gt;super()&lt;/tt&gt; queryset (which will be &lt;tt class="docutils literal"&gt;Category.objects.all()&lt;/tt&gt;). One final comment is that instead
of this, I could have more or less the same functionality by implementing &lt;tt class="docutils literal"&gt;CategoryListView&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CategoryListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ExportCsvMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;AdminOrPublisherPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;categories&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;query&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Category&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;annotate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;article_cnt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;article&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;document_cnt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;document&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This has the same functionality (return all categories with the number of articles and documents for each one) and
saves some typing from overriding the &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt;  method. However as I said most of the time I use the model
attribute and override the &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt; method because it seems more explicit and descriptive to me and most of
the time I&amp;#8217;ll need to add some more filtering (based on the current user, based on some query parameter etc) that
can only be implemented on the &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="allow-each-user-to-list-view-edit-delete-only-his-own-items"&gt;
&lt;h3&gt;Allow each user to list/view/edit/delete only his own&amp;nbsp;items&lt;/h3&gt;
&lt;p&gt;Continuing from the previous example of modifying the queryset, let&amp;#8217;s suppose that we want to allow each
user to be able to list the items (articles and
documents) he has created and view/edit/delete them. We also want to allow admins and publishers to view/edit&amp;nbsp;everything.&lt;/p&gt;
&lt;p&gt;Since the &lt;tt class="docutils literal"&gt;Article&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;Document&lt;/tt&gt; models both have an &lt;tt class="docutils literal"&gt;owned_by&lt;/tt&gt; element we can use use this to filter
the results returned by &lt;tt class="docutils literal"&gt;get_queryset()&lt;/tt&gt;. For example, here&amp;#8217;s a mixin that checks if the current user is
admin or publisher. If he is a publisher then he will just return the &lt;tt class="docutils literal"&gt;super()&lt;/tt&gt; queryset. If however he is a simple
user it will return only the results that are owned by him with &lt;tt class="docutils literal"&gt;qs.filter(owned_by=self.request.user)&lt;/tt&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LimitAccessMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_perm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;djangocbv.admin_access&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_perm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;djangocbv.publisher_access&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;owned_by&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Another similar mixin that is used is the &lt;tt class="docutils literal"&gt;HideRemovedMixin&lt;/tt&gt; that, for simple users, excludes from the queryset the objects that
are&amp;nbsp;removed:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HideRemovedMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_perm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;djangocbv.admin_access&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_perm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;djangocbv.publisher_access&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exclude&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;REMOVED&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One thing that needs a little discussion is that for both of these mixins I am using &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt; to implement access control to
allow using the same mixin for views that inherit from both &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;MultipleObjectMixin&lt;/tt&gt; (since the &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt; is
used in both of them). This
means that when a user tries to access an object that has not access to he&amp;#8217;ll get a nice 404&amp;nbsp;error.&lt;/p&gt;
&lt;p&gt;Beyond this, instead of filtering the queryset,
for views inheriting from &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; (i.e &lt;tt class="docutils literal"&gt;DetailView&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;DeleteView&lt;/tt&gt;)
we could have overridden the &lt;tt class="docutils literal"&gt;get_object&lt;/tt&gt; method to raise an access denied exception. Here&amp;#8217;s how &lt;tt class="docutils literal"&gt;get_object&lt;/tt&gt; could be
overridden to raise a 403 Forbidden status when a user tries to access an object that does not belong to&amp;nbsp;him:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.core.exceptions&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;PermissionDenied&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_object&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;queryset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;obj&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_object&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;owned_by&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;PermissionDenied&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;obj&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="configure-the-form-s-initial-values-from-get-parameters"&gt;
&lt;h3&gt;Configure the form&amp;#8217;s initial values from &lt;span class="caps"&gt;GET&lt;/span&gt;&amp;nbsp;parameters&lt;/h3&gt;
&lt;p&gt;Sometimes we want to have a &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; with some fields already filled. I usually
implement this by passing the proper parameters to the &lt;span class="caps"&gt;URL&lt;/span&gt; (i.e by calling it as /create_view?category_id=2)
and then using the following mixin to override the &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt; &lt;tt class="docutils literal"&gt;get_initial&lt;/tt&gt; method in order to
return the form&amp;#8217;s initial data from&amp;nbsp;it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SetInitialMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_initial&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;initial&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SetInitialMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_initial&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;initial&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;initial&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So if the /article_create url can be used to initialte the &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; for the article,
using &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/article_create?category_id=3&lt;/span&gt;&lt;/tt&gt; will show the CreateView with the Category with id=3
pre-selected in the category&amp;nbsp;field!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pass-extra-kwargs-to-the-formview-form"&gt;
&lt;h3&gt;Pass extra kwargs to the FormView&amp;nbsp;form&lt;/h3&gt;
&lt;p&gt;This is a very common requirement. The form may need to be modified by an external condition,
for example the current user or something that can be calculated from the view. Here&amp;#8217;s a
sample mixin that passes the current request (which also includes the user) to the&amp;nbsp;form:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RequestArgMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_form_kwargs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;kwargs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RequestArgMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_form_kwargs&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;request&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;kwargs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Please notice that the form has to properly handle the extra kwarg in its constructor,
before calling the super&amp;#8217;s constructor. For
example, here&amp;#8217;s how a form that can accept the request could be&amp;nbsp;implemented:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RequestForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;request&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We use &lt;tt class="docutils literal"&gt;pop&lt;/tt&gt; to remove the request from the received &lt;tt class="docutils literal"&gt;kwargs&lt;/tt&gt; and only then we call the
parent&amp;nbsp;constructor.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="add-values-to-the-context"&gt;
&lt;h3&gt;Add values to the&amp;nbsp;context&lt;/h3&gt;
&lt;p&gt;To add values to the context of a &lt;span class="caps"&gt;CBV&lt;/span&gt; we override the &lt;tt class="docutils literal"&gt;get_context_data()&lt;/tt&gt; method. Here&amp;#8217;s
a mixin that adds a list of categories to all CBVs using&amp;nbsp;it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CategoriesContextMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;categories&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Category&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that the mixin calls super to get the context data of its ancestors and appends to it. This
mean that if we also had a mixin that f.e added the current logged in user to the context (this isn&amp;#8217;t really
needed since there&amp;#8217;s a context processor for this but anyway) then when a &lt;span class="caps"&gt;CBV&lt;/span&gt; inherited from both of
them then the data of both of them would be added to the&amp;nbsp;context.&lt;/p&gt;
&lt;p&gt;As a general comment there are three other methods the same functionality could be&amp;nbsp;achieved:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Just override the &lt;tt class="docutils literal"&gt;get_context_data&lt;/tt&gt; of the &lt;span class="caps"&gt;CBV&lt;/span&gt; you want to add extra data to its&amp;nbsp;context&lt;/li&gt;
&lt;li&gt;Add a template tag that will bring the needed data to the&amp;nbsp;template&lt;/li&gt;
&lt;li&gt;Use a context processor to bring the data to all&amp;nbsp;templates&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As can be understood, each of the above methods has certain advantages and disadvantages. For
example, if the extra data will query the database then the context processor method will add
one extra query for all page loads (even if the data is not needed). On the other hand,
the template tag will query the database only on specific views but it makes debugging and
reasoning about your template more difficult since if you have a lot of template tags you&amp;#8217;ll have
various context variables appearing from thing&amp;nbsp;air!&lt;/p&gt;
&lt;p&gt;One final comment is that overriding the &lt;tt class="docutils literal"&gt;get_context_data&lt;/tt&gt; method will probably be the most
common thing you&amp;#8217;re going to do when using CBVs (you&amp;#8217;ll definitely need to add things to the context)
so try to remember the following 3 needed&amp;nbsp;lines:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# ... here we add stuff to the ctx&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="add-a-simple-filter-to-a-listview"&gt;
&lt;h3&gt;Add a simple filter to a&amp;nbsp;ListView&lt;/h3&gt;
&lt;p&gt;For filtering I recommend using the excellent &lt;a class="reference external" href="https://github.com/carltongibson/django-filter"&gt;django-filter&lt;/a&gt; package as I&amp;#8217;ve already
presented in &lt;a class="reference external" href="https://spapas.github.io/2017/10/11/essential-django-packages/"&gt;my essential Django package list&lt;/a&gt;. Here&amp;#8217;s how a mixin can be created that
adds a filter to the&amp;nbsp;context:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AddFilterMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;filter_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter_class&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;NotImplementedError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Please define filter_class when using AddFilterMixin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;filter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter_class&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;queryset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;filter&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;filter&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context_object_name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;context_object_name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;qs&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that the &lt;tt class="docutils literal"&gt;get_context_data&lt;/tt&gt; checks to see if the &lt;tt class="docutils literal"&gt;filter_class&lt;/tt&gt; attribute has been
defined (if not it will raise a useful explanation). It will then instantiate the filter class
passing it the &lt;tt class="docutils literal"&gt;self.request.&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; and the current queryset (&lt;tt class="docutils literal"&gt;self.get_queryset()&lt;/tt&gt;) - so for
example any extra filtering you are doing to the queryset (for example only show content owned by the
current user) will be also used. Finally, pass the filter to the context and assign the
contect_object_name to the filtered&amp;nbsp;queryset.&lt;/p&gt;
&lt;p&gt;Here&amp;#8217;s for example how this mixin is used for &lt;tt class="docutils literal"&gt;ArticleListView&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ArticleListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AddFilterMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;articles&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;filter_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ArticleFilter&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And then just add the following to the &lt;tt class="docutils literal"&gt;article_list.html&lt;/tt&gt; template:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;{{&lt;/span&gt; &lt;span class="nb"&gt;filter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="p"&gt;}}&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nb"&gt;input&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;submit&amp;#39;&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Filter&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;article&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;articles&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;Display&lt;/span&gt; &lt;span class="n"&gt;article&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;only&lt;/span&gt; &lt;span class="n"&gt;filtered&lt;/span&gt; &lt;span class="n"&gt;articles&lt;/span&gt; &lt;span class="n"&gt;will&lt;/span&gt; &lt;span class="n"&gt;be&lt;/span&gt; &lt;span class="n"&gt;here&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;endfor&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="support-for-success-messages"&gt;
&lt;h3&gt;Support for success&amp;nbsp;messages&lt;/h3&gt;
&lt;p&gt;Django has a very useful &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/contrib/messages/"&gt;messages framework&lt;/a&gt; which can be used to add flash messages
to a view. A flash message is a message that persists in the sesion until it is viewed
by the user. So, for example when a user edits an object and saves it, he&amp;#8217;ll be redirected
to the success page - if you have configured a flash message to inform the user that the
save was ok then he&amp;#8217;ll see this message once and then if he reloads the page it will
be&amp;nbsp;removed.&lt;/p&gt;
&lt;p&gt;Here&amp;#8217;s a mixin that can be used to support flash messages using Django&amp;#8217;s message&amp;nbsp;framework:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SuccessMessageMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;success_message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_success_message&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;success_message&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;messages&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;success&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_success_message&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This mixin overrides the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; and adds the message using &lt;tt class="docutils literal"&gt;get_success_message&lt;/tt&gt; - this
can be overriden if you want to have a dynamic message or just set the &lt;tt class="docutils literal"&gt;success_message&lt;/tt&gt; attribute
for a static message, for example something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SuccesMessageArticleCreateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SuccessMessageMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CreateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;success_message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Object was created!&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I&amp;#8217;d like to once again point out here that since the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;super().form_valid(form)&lt;/span&gt;&lt;/tt&gt; method is properly used
then if a &lt;span class="caps"&gt;CBV&lt;/span&gt; uses multiple mixins that override form_valid (for example if your &lt;span class="caps"&gt;CBV&lt;/span&gt; overrides both
&lt;tt class="docutils literal"&gt;SuccessMessageMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;AuditableMixin&lt;/tt&gt; then the form_valid of &lt;em&gt;both&lt;/em&gt; will be called so you&amp;#8217;ll
get both the created_by/modified_by values set to the current user and the success&amp;nbsp;message!&lt;/p&gt;
&lt;p&gt;Notice that Django actually provides an implementation of &lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/contrib/messages/#adding-messages-in-class-based-views"&gt;a message mixin&lt;/a&gt; which can be used instead
of the proposed implementation here (I didn&amp;#8217;t know it until recently that&amp;#8217;s why I am using this to some
projects and I also present it&amp;nbsp;here).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="implement-a-quick-moderation"&gt;
&lt;h3&gt;Implement a quick&amp;nbsp;moderation&lt;/h3&gt;
&lt;p&gt;It is easy to implement some moderation to our model publishing. For example, let&amp;#8217;s suppose that we only
allow publishers to publish a model. Here&amp;#8217;s how it can be&amp;nbsp;done:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;REMOVED&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_perm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;djangocbv.publisher_access&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;PUBLISHED&amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DRAFT&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So, first of all we make sure that the object is not &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;REMOVED&lt;/span&gt;&lt;/tt&gt; (if it is
remove it we don&amp;#8217;t do anything else). Next we check if the current user has
&lt;tt class="docutils literal"&gt;publisher_access&lt;/tt&gt; if yes we change the object&amp;#8217;s status to &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;PUBLISHED&lt;/span&gt;&lt;/tt&gt; - on any
other case we change its status to &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DRAFT&lt;/span&gt;&lt;/tt&gt;. Notice that this means that whenever a
publisher saves the object it will be published and whenever a non-publisher saves it
it will be made a draft. We then call our ancestor&amp;#8217;s &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; to save the object
and return to success&amp;nbsp;url.&lt;/p&gt;
&lt;p&gt;I&amp;#8217;d like to repeat here that this mixin, since it calls super, can work concurrently
with any other mixins that override &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; (and also call their super method
of course), for example it can be used together with the audit (auto-fill created_by
and moderated_by) and the success mixin we defined&amp;nbsp;previously!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="allow-access-to-a-view-if-a-user-has-one-out-of-a-group-of-permissions"&gt;
&lt;h3&gt;Allow access to a view if a user has one out of a group of&amp;nbsp;permissions&lt;/h3&gt;
&lt;p&gt;For this we&amp;#8217;ll need to use the authentication mixins functionality. We could implement
this by overriding &lt;tt class="docutils literal"&gt;PermissionRequiredMixin&lt;/tt&gt; or by overriding &lt;tt class="docutils literal"&gt;UserPassesTestMixin&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Using &lt;tt class="docutils literal"&gt;PermissionRequiredMixin&lt;/tt&gt; is not very easy because the way it works
it will allow access if the user has &lt;em&gt;all&lt;/em&gt; permissions from the group (not only one as is the requirement).
Of course you could override its &lt;tt class="docutils literal"&gt;has_permission&lt;/tt&gt; method to change the way it checks if
the user has the permissions (i.e make sure it has one permission instead of&amp;nbsp;all):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AnyPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;has_permission&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;perms&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_permission_required&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_perm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;perm&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;perm&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;perms&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Also we could implement our mixin using &lt;tt class="docutils literal"&gt;UserPassesTestMixin&lt;/tt&gt; as its&amp;nbsp;base:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AnyPermissionRequiredAlternativeMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;UserPassesTestMixin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;any&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;has_perm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;perm&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;perm&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;permissions&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The functionality is very simple: If the user has one of the list of the configured permissions then the test will pass (so he&amp;#8217;ll have access to the view).
If instead the user has none of the permissions then he won&amp;#8217;t be able to access the&amp;nbsp;view.&lt;/p&gt;
&lt;p&gt;Notice that for the above implementations we inherited from &lt;tt class="docutils literal"&gt;PermissionRequiredMixin&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;UserPassesTextMixin&lt;/tt&gt; to keep their functionality - if we had inherited
these mixins from object then we&amp;#8217;d need to inherit our CBVs from both &lt;tt class="docutils literal"&gt;AnyPermissionRequiredMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;PermissionRequiredMixin&lt;/tt&gt; or
&lt;tt class="docutils literal"&gt;AnyPermissionRequiredAlternativeMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;UserPassesTestMixin&lt;/tt&gt; (with the correct &lt;span class="caps"&gt;MRO&lt;/span&gt; order of&amp;nbsp;course).&lt;/p&gt;
&lt;p&gt;Now, the whole permission cheking functionality can be even more &lt;span class="caps"&gt;DRY&lt;/span&gt;. Let&amp;#8217;s suppose that we know that there are a couple of views which should only
be visible to users having either the &lt;tt class="docutils literal"&gt;app.admin&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;app.curator&lt;/tt&gt; permission. Instead of inheriting all these views from &lt;tt class="docutils literal"&gt;AnyPermissionRequiredMixin&lt;/tt&gt;
and configuring the permissions list to each one, the &lt;span class="caps"&gt;DRY&lt;/span&gt; way to implement this is to add yet another mixin from which the CBVs will actually&amp;nbsp;inhert:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AdminOrPublisherPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AnyPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;permissions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;djangocbv.admin_access&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;djangocbv.publisher_access&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="disable-a-view-based-on-some-condition"&gt;
&lt;h3&gt;Disable a view based on some&amp;nbsp;condition&lt;/h3&gt;
&lt;p&gt;There are times you want to disable a view based on an arbitrary condition - for example example make the view
disabled before a specific date. Here&amp;#8217;s a simple mixin that overrides &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; to do&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DisabledDateMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;the_date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2018&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;date&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;today&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="n"&gt;the_date&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;PermissionDenied&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can even disable a view completely  in case you want to keep it in your urls.py using this&amp;nbsp;mixin:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DisabledDateMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;PermissionDenied&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="output-non-html-views"&gt;
&lt;h3&gt;Output non-html&amp;nbsp;views&lt;/h3&gt;
&lt;p&gt;I&amp;#8217;ve written a whole article about this, please take a look at my &lt;a class="reference external" href="https://spapas.github.io/2014/09/15/django-non-html-responses/"&gt;Django non-&lt;span class="caps"&gt;HTML&lt;/span&gt; responses&lt;/a&gt;&amp;nbsp;article.&lt;/p&gt;
&lt;p&gt;Also, notice that is very easy to create a mixin that will output a view to &lt;span class="caps"&gt;PDF&lt;/span&gt; - I have already written
an &lt;a class="reference external" href="https://spapas.github.io/2015/11/27/pdf-in-django/#using-a-cbv"&gt;essential guide for outputting PDFs in Django&lt;/a&gt; so I am just going to refer you to this article for
(much more)&amp;nbsp;information!&lt;/p&gt;
&lt;p&gt;Finally, let&amp;#8217;s take a look at a generic Mixin that you can use to add &lt;span class="caps"&gt;CSV&lt;/span&gt; exporting capabilities to a
&lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ExportCsvMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;csv&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text/csv&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-Disposition&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;attachment; filename=&amp;quot;export.csv&amp;quot;&amp;#39;&lt;/span&gt;

            &lt;span class="n"&gt;writer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;csv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;object_list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]):&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="c1"&gt;# Write headers&lt;/span&gt;
                    &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writerow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__dict__&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;startswith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
                &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writerow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__dict__&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;startswith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As you can see this mixin overrides the &lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt; method. It will check if there&amp;#8217;s a
&lt;tt class="docutils literal"&gt;csv&lt;/tt&gt; key to the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; queryset dictionary, thus the url must be called with &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;?csv=true&lt;/span&gt;&lt;/tt&gt; or something similar. You
can just add this link to your&amp;nbsp;template:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;button&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;?csv=true&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Export csv&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So if the view needs to be exported to &lt;span class="caps"&gt;CSV&lt;/span&gt;, it will create a new &lt;tt class="docutils literal"&gt;HttpResponse&lt;/tt&gt; object with the correct content type.
The next line will add a header that (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;Content-Disposition&lt;/span&gt;&lt;/tt&gt;) will mark the response as an attachment and give it a default file name.
We then crate a new &lt;tt class="docutils literal"&gt;csv.writer&lt;/tt&gt; passing the just-created response as the place to write the csv. The &lt;tt class="docutils literal"&gt;for&lt;/tt&gt; loop that follows
enumerates the &lt;tt class="docutils literal"&gt;object_list&lt;/tt&gt; value of the context (remember that this is added by the &lt;tt class="docutils literal"&gt;MultipleObjectMixin&lt;/tt&gt; and contains the
result of the &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt;). It will then use the object&amp;#8217;s &lt;tt class="docutils literal"&gt;__dict__&lt;/tt&gt; attribute to write the headers (for the first time) and then
write the values of all&amp;nbsp;objects.&lt;/p&gt;
&lt;p&gt;As another simple example, let&amp;#8217;s create a quick &lt;span class="caps"&gt;JSON&lt;/span&gt; output mixin for our&amp;nbsp;DetailViews:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;JsonDetailMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;json&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application/json&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dumps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__dict__&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;)))&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If you add this to a view inheriting from &lt;tt class="docutils literal"&gt;DetailView&lt;/tt&gt; and pass it the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;?json=true&lt;/span&gt;&lt;/tt&gt; query parameter
you&amp;#8217;ll get a &lt;span class="caps"&gt;JSON&lt;/span&gt;&amp;nbsp;response!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="use-one-templateview-for-multiple-html-templates"&gt;
&lt;h3&gt;Use one TemplateView for multiple html&amp;nbsp;templates&lt;/h3&gt;
&lt;p&gt;Using a &lt;tt class="docutils literal"&gt;TemplateView&lt;/tt&gt; you could display an html template without much problem just by
settings the &lt;tt class="docutils literal"&gt;template&lt;/tt&gt; attribute of your class. What if you wanted to have a single
&lt;tt class="docutils literal"&gt;TemplateView&lt;/tt&gt; that would display many templates based on the query path? Simple, just
override &lt;tt class="docutils literal"&gt;get_template_names&lt;/tt&gt; to return a different template based on the path. For example,
using this&amp;nbsp;view:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;class DynamicTemplateView(TemplateView):
    def get_template_names(self):
        what = self.kwargs[&amp;#39;what&amp;#39;]
        return &amp;#39;{0}.html&amp;#39;.format(what)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can render any template you have depending on the value of the &lt;tt class="docutils literal"&gt;what&lt;/tt&gt; kwarg. To allow
only specific template names you can either add a check to the above implementation (i.e that
what is &lt;tt class="docutils literal"&gt;help&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;about&lt;/tt&gt;) or you may do it to the urls.py if you use a regular expression. Thus,
to only allow &lt;tt class="docutils literal"&gt;help.html&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;about.html&lt;/tt&gt; to be rendered with this method add it to your urls like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;re_path(r&amp;#39;^show/(?P&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;what&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;help|about)/&amp;#39;, views.DynamicTemplateView.as_view(), name=&amp;#39;template-show&amp;#39;),
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finally, to use it to render the &lt;tt class="docutils literal"&gt;help.html&lt;/tt&gt; you&amp;#8217;ll just call it like &amp;lt;a href=&amp;#8217;{% url &amp;#8220;template-show&amp;#8221; &amp;#8220;help&amp;#8221;&amp;nbsp;%}&amp;#8217;&amp;gt;Help&amp;lt;/a&amp;gt;&lt;/p&gt;
&lt;p&gt;Notice that of course instead of creating the &lt;tt class="docutils literal"&gt;DynamicTemplateView&lt;/tt&gt; you could just dump these html files in your
static folder and return them using the static files functionality. However the extra thing that the &lt;tt class="docutils literal"&gt;DynamicTemplateView&lt;/tt&gt;
brings to you is that this is a full Django template thus you can use template tags, filters, your context variables, inherit
from your site-base and even override &lt;tt class="docutils literal"&gt;get_context_data&lt;/tt&gt; to add extra info to the template! All this is not possible with
static&amp;nbsp;files!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="implement-a-partial-ajax-view"&gt;
&lt;h3&gt;Implement a partial Ajax&amp;nbsp;view&lt;/h3&gt;
&lt;p&gt;Overriding &lt;tt class="docutils literal"&gt;get_template_names&lt;/tt&gt; can also be used to create a &lt;span class="caps"&gt;DRY&lt;/span&gt; Ajax view
of your data! For example, let&amp;#8217;s say that you have a &lt;tt class="docutils literal"&gt;DetailView&lt;/tt&gt; for one of your models that
has overriden the &lt;tt class="docutils literal"&gt;get_template_names&lt;/tt&gt; like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_template_names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_ajax&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ajax_partial&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;core/partial/data_ajax.html&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_template_names&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and you have also defined a normal template for classic request response viewing and an ajax template
that contains only the specific data for this instances (i.e it does not containg html body, headers, footers etc,
only a &amp;lt;div&amp;gt; with the instance&amp;#8217;s data). Notice I&amp;#8217;m using either the &lt;tt class="docutils literal"&gt;is_ajax&lt;/tt&gt; method or I directly passed &lt;span class="caps"&gt;GET&lt;/span&gt;
value (&lt;tt class="docutils literal"&gt;ajax_partial&lt;/tt&gt;) - this is needed because sometimes &lt;tt class="docutils literal"&gt;is_ajax&lt;/tt&gt; is not working as expected (depending on
how you&amp;#8217;re going to do the request), also this way you can easily test the partial ajax view through your browser
by passing it &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;?ajax_partia=true&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Using this technique you can create an Ajax view of your data just by requesting the DetailView through an
Ajax call and dumping the response you get to a modal dialog (for example)  - no need for fancy &lt;span class="caps"&gt;REST&lt;/span&gt; APIs. Also as
a bonus, the classic DetailView will work normally, so you can have the Ajax view to give a summary of the instance&amp;#8217;s
data (i.e have a subset of the info on the Ajax template) and the normal view to display&amp;nbsp;everything.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="add-a-dynamic-filter-and-or-table-to-the-context"&gt;
&lt;h3&gt;Add a dynamic filter and/or table to the&amp;nbsp;context&lt;/h3&gt;
&lt;p&gt;If you have a lot of similar models you can add a mixin that dynamically creates tables and a filters
for these models  - take a look at my &lt;a class="reference external" href="https://spapas.github.io/2015/10/05/django-dynamic-tables-similar-models/"&gt;dynamic tables and filters for similar models&lt;/a&gt;&amp;nbsp;article!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="configure-forms-for-your-views"&gt;
&lt;h3&gt;Configure forms for your&amp;nbsp;views&lt;/h3&gt;
&lt;p&gt;As I&amp;#8217;ve already explained if you are using a &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt; you&amp;#8217;ll need to set a &lt;tt class="docutils literal"&gt;form_class&lt;/tt&gt; for
your view (needed by &lt;tt class="docutils literal"&gt;FormMixin&lt;/tt&gt;) while, for an Update or &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; which use the &lt;tt class="docutils literal"&gt;ModelFormMixin&lt;/tt&gt;
you can either set the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;form-class&lt;/span&gt;&lt;/tt&gt; or directly configure the instance&amp;#8217;s fields that will be displayed
to the form using the &lt;tt class="docutils literal"&gt;fields&lt;/tt&gt; attribute.&lt;/p&gt;
&lt;p&gt;For example, let&amp;#8217;s say that you have a rather generic &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt; that will display a different form
depending on the user permissions. Here&amp;#8217;s how you could do this to return a &lt;tt class="docutils literal"&gt;SuperForm&lt;/tt&gt; if the
current user is a superuser and a &lt;tt class="docutils literal"&gt;SimpleForm&lt;/tt&gt; in other&amp;nbsp;cases:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_form_class&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_superuser&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;SuperForm&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;SimpleForm&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="display-a-different-form-for-create-and-update"&gt;
&lt;h3&gt;Display a different form for Create and&amp;nbsp;Update&lt;/h3&gt;
&lt;p&gt;There are various ways you can do this (for example you can just declare a different &lt;tt class="docutils literal"&gt;form_class&lt;/tt&gt; for your
&lt;tt class="docutils literal"&gt;Create&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt;) but I think that the most &lt;span class="caps"&gt;DRY&lt;/span&gt; one, especially if the create and update form are
similar is to pass an &lt;tt class="docutils literal"&gt;is_create&lt;/tt&gt; argument to the form which it will then be used to properly configure the&amp;nbsp;form.&lt;/p&gt;
&lt;p&gt;Thus, on your &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; you&amp;#8217;ll add this &lt;tt class="docutils literal"&gt;get_form_kwargs&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_form_kwargs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;kwargs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MyCreateView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_form_kwargs&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;is_create&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;kwargs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;while on your &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt; you&amp;#8217;ll add&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_form_kwargs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;kwargs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MyUpdateView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_form_kwargs&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;is_create&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;kwargs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Please notice that the form has to properly handle the extra kwarg in its constructor as I&amp;#8217;ve already explained&amp;nbsp;previously.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="only-allow-specific-http-methods-for-a-view"&gt;
&lt;h3&gt;Only allow specific &lt;span class="caps"&gt;HTTP&lt;/span&gt; methods for a&amp;nbsp;view&lt;/h3&gt;
&lt;p&gt;Let&amp;#8217;s say that you want to create an &lt;tt class="docutils literal"&gt;UnpublishView&lt;/tt&gt; i.e a view that will change the status of your content
to &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DRAFT&lt;/span&gt;&lt;/tt&gt;. Since this view will change your model instance it must be called through &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt;, however
you may not want to display an individual form for this view, just a button that when called will display
a client-side (Javascript) prompt and if the user clicks it it will immediately do a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; request
by submitting the form. The best way to create this is to just implement an &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt; for your model
and change its form valid to change the status to &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DRAFT&lt;/span&gt;&lt;/tt&gt;, something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DRAFT&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Beyond this, you&amp;#8217;ll need to add a &lt;tt class="docutils literal"&gt;fields = []&lt;/tt&gt; attribute to your &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt; to denote that you won&amp;#8217;t
need to update any fields from the model (since you&amp;#8217;ll update the status directly) and finally, to only allow
this view to be called through an http &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; method add the following&amp;nbsp;attribute:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;http_method_names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="create-an-umbrella-view-for-multiple-models"&gt;
&lt;h3&gt;Create an umbrella View for multiple&amp;nbsp;models&lt;/h3&gt;
&lt;p&gt;Let&amp;#8217;s say that you have a couple of models (called &lt;tt class="docutils literal"&gt;Type1&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;Type2&lt;/tt&gt; that are more or less the same and
you want to quickly create a &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt; for both of them but you&amp;#8217;d like to create just one &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt; and
separate them by their url. Here&amp;#8217;s how it could be&amp;nbsp;done:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;UmbrellaListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;template_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;umbrella_list.html&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kind&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;kind&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kind&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;type1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queryset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Type1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kind&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;type2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queryset&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Type2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;UmbrellaListView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that for this to work properly you must setup your urls like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^list/(?P&amp;lt;kind&amp;gt;type1|type2)/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UmbrellaListView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;umbrella_list&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="a-heavy-cbv-user-project"&gt;
&lt;h2&gt;A heavy &lt;span class="caps"&gt;CBV&lt;/span&gt; user&amp;nbsp;project&lt;/h2&gt;
&lt;p&gt;In this small chapter I&amp;#8217;d like to present a bunch of mixins and views that I&amp;#8217;ve defined to the
accompanying project (&lt;a class="reference external" href="https://github.com/spapas/cbv-tutorial"&gt;https://github.com/spapas/cbv-tutorial&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s start with the mixins (I won&amp;#8217;t show the mixins I&amp;#8217;ve already talked about in the previous&amp;nbsp;chapter):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SetOwnerIfNeeded&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;owned_by_id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;owned_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ChangeStatusMixin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;new_status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new_status&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;NotImplementedError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Please define new_status when using ChangeStatusMixin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;new_status&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ContentCreateMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SuccessMessageMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;SetOwnerIfNeeded&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;RequestArgMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;SetInitialMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;ModerationMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;LoginRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;success_message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Object successfully created!&amp;#39;&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ContentUpdateMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SuccessMessageMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;SetOwnerIfNeeded&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;RequestArgMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;SetInitialMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;ModerationMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;LimitAccessMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="n"&gt;LoginRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;success_message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Object successfully updated!&amp;#39;&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ContentListMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ExportCsvMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;AddFilterMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;HideRemovedMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ContentRemoveMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SuccessMessageMixin&lt;/span&gt;
                         &lt;span class="n"&gt;AdminOrPublisherPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                         &lt;span class="n"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                         &lt;span class="n"&gt;HideRemovedMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                         &lt;span class="n"&gt;ChangeStatusMixin&lt;/span&gt;&lt;span class="p"&gt;,):&lt;/span&gt;
    &lt;span class="n"&gt;http_method_names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;
    &lt;span class="n"&gt;new_status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;REMOVED&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;success_message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Object successfully removed!&amp;#39;&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ContentUnpublishMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SuccessMessageMixin&lt;/span&gt;
                            &lt;span class="n"&gt;AdminOrPublisherPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="n"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="n"&gt;UnpublishSuccessMessageMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="n"&gt;ChangeStatusMixin&lt;/span&gt;&lt;span class="p"&gt;,):&lt;/span&gt;
    &lt;span class="n"&gt;http_method_names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;
    &lt;span class="n"&gt;new_status&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DRAFT&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="n"&gt;success_message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Object successfully unpublished!&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;SetOwnerIfNeeded&lt;/tt&gt; and  &lt;tt class="docutils literal"&gt;ChangeStatusMixin&lt;/tt&gt; are simple mixins that override &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; to
introduce some functionality before saving the&amp;nbsp;object).&lt;/p&gt;
&lt;p&gt;The mixins that follow are used to group functionality of
other mixins together and will be inherited by the views. Thus, &lt;tt class="docutils literal"&gt;ContentCreateMixin&lt;/tt&gt; has the mixin functionality needed to create something (for example
an &lt;tt class="docutils literal"&gt;Article&lt;/tt&gt; or a &lt;tt class="docutils literal"&gt;Document&lt;/tt&gt;) i.e show a success message, add auditing information, set the object&amp;#8217;s owner,
pass the request to the form, set the form&amp;#8217;s initial values, do some moderation and only allow logged in users. On
a similar fashion, the &lt;tt class="docutils literal"&gt;ContentUpdateMixin&lt;/tt&gt; collects the functionality needed to update something and is similar to
&lt;tt class="docutils literal"&gt;ContentCreateMixin&lt;/tt&gt; (with the difference that it also as the &lt;tt class="docutils literal"&gt;LimitAccessMixin&lt;/tt&gt; to only allow simple users to
edit their own content). The &lt;tt class="docutils literal"&gt;ContentListMixin&lt;/tt&gt; adds functionality for export to &lt;span class="caps"&gt;CSV&lt;/span&gt;, simple filter and hiding removed&amp;nbsp;things.&lt;/p&gt;
&lt;p&gt;Finally, the &lt;tt class="docutils literal"&gt;ContentRemoveMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;ContentUnpublishMixin&lt;/tt&gt; are used to implement Views for removing and unpublishing
an object. Both of them inherit from &lt;tt class="docutils literal"&gt;ChangeStatusMixin&lt;/tt&gt; - one setting
the &lt;tt class="docutils literal"&gt;new_status&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;REMOVED&lt;/span&gt;&lt;/tt&gt; the other to &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DRAFT&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Notice that they share much functionality so I could
remove both &lt;tt class="docutils literal"&gt;ContentRemoveMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;ContentUnpublishMixin&lt;/tt&gt; and add a single &lt;tt class="docutils literal"&gt;ContentChangeStatusMixin&lt;/tt&gt; like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ContentChangeStatusMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AdminOrPublisherPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="n"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="n"&gt;UnpublishSuccessMessageMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                            &lt;span class="n"&gt;ChangeStatusMixin&lt;/span&gt;&lt;span class="p"&gt;,):&lt;/span&gt;
    &lt;span class="n"&gt;http_method_names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;
    &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Thus the &lt;tt class="docutils literal"&gt;new_status&lt;/tt&gt; attribute wouldn&amp;#8217;t be there so the views inheriting from this &lt;tt class="docutils literal"&gt;ContentChangeStatusMixin&lt;/tt&gt;
(i.e &lt;tt class="docutils literal"&gt;*RemoveView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;*UnpublishView&lt;/tt&gt;) would need to define the &lt;tt class="docutils literal"&gt;new_status&lt;/tt&gt; field themselves.
This is definitely valid (and more &lt;span class="caps"&gt;DRY&lt;/span&gt;) but less explicit than the way I&amp;#8217;ve implemented this - i.e you may
wanted to not allow publishers to remove objects, only admins (so you could implement that differently in the &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt;
or &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;ContentRemoveMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;ContentUpdateMixin&lt;/tt&gt;) this is easier if you have both the
&lt;tt class="docutils literal"&gt;ContentRemoveMixin&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;ContentUnpublishMixin&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Now let&amp;#8217;s take a look at the&amp;nbsp;views:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CategoryListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ExportCsvMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;AdminOrPublisherPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Category&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;categories&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;annotate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;article_cnt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;article&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;document_cnt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Count&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;document&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CategoryCreateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SuccessMessageMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;AdminOrPublisherPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CreateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Category&lt;/span&gt;
    &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;success_message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Category created!&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;category-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CategoryUpdateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SuccessMessageMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;AdminOrPublisherPermissionRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UpdateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Category&lt;/span&gt;
    &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;success_message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Category updated!&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;category-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CategoryDetailView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;CategoriesContextMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DetailView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Category&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;category&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;article_number&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;category&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;document_number&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;category&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ArticleListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentListMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;articles&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;filter_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ArticleFilter&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ArticleCreateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentCreateMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CreateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;
    &lt;span class="n"&gt;form_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ArticleForm&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;article-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ArticleUpdateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentUpdateMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UpdateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;
    &lt;span class="n"&gt;form_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ArticleForm&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;article-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ArticleDetailView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HideRemovedMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;JsonDetailMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DetailView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;article&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_template_names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_ajax&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;partial&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;djangocbv/_article_content_partial.html&amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_template_names&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ArticleRemoveView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentRemoveMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UpdateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;article-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ArticleUnpublishView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentUnpublishMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UpdateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;article-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DocumentListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentListMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;documents&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;filter_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;DocumentFilter&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DocumentCreateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentCreateMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CreateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;
    &lt;span class="n"&gt;form_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;DocumentForm&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;document-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DocumentUpdateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentUpdateMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UpdateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;
    &lt;span class="n"&gt;form_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;DocumentForm&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;document-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DocumentDetailView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;HideRemovedMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;JsonDetailMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DetailView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;document&amp;#39;&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DocumentRemoveView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentRemoveMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UpdateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;document-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DocumentUnpublishView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ContentUnpublishMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UpdateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Document&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;document-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DynamicTemplateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TemplateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_template_names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;what&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;what&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{0}.html&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;what&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As you will see there&amp;nbsp;are&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;4 views related to categories (Create, Detail, Update and&amp;nbsp;List)&lt;/li&gt;
&lt;li&gt;6 views related to articles (Create, Detail, Update, List, Unpublish and Remove)&amp;nbsp;and&lt;/li&gt;
&lt;li&gt;another 6 views related to documents (same as&amp;nbsp;articles).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The views for &lt;tt class="docutils literal"&gt;Article&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;Document&lt;/tt&gt; are more or less the same: They inherit
from the corresponding mixin we defined previously (&lt;tt class="docutils literal"&gt;CreateContentMixin&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;UpdateContentMixin&lt;/tt&gt; etc) add a
redirect to their corresponding list view (I am using &lt;tt class="docutils literal"&gt;redirect_lazy&lt;/tt&gt; there because &lt;tt class="docutils literal"&gt;redirect&lt;/tt&gt; wouldn&amp;#8217;t work
because it will lead to a cyclic dependency between urls and views) and define their corresponding form and model.
For the the DetailViews I don&amp;#8217;t use a group mixin like the others but I just add the &lt;tt class="docutils literal"&gt;HideRemovedMixin&lt;/tt&gt; and
&lt;tt class="docutils literal"&gt;JsonDetailMixin&lt;/tt&gt; directly to their ancestor list. This is to make clear that the group mixins (&lt;tt class="docutils literal"&gt;ContentCreateMixin&lt;/tt&gt; etc)
are optional and I could for example define &lt;tt class="docutils literal"&gt;ArticleCreateView&lt;/tt&gt; like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ArticleCreateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SuccessMessageMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="n"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="n"&gt;SetOwnerIfNeeded&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="n"&gt;RequestArgMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="n"&gt;SetInitialMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="n"&gt;ModerationMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="n"&gt;LoginRequiredMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="n"&gt;CreateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Article&lt;/span&gt;
    &lt;span class="n"&gt;form_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ArticleForm&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse_lazy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;article-list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;success_message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Object successfully created!&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;What&amp;#8217;s the advantage of using the  &lt;tt class="docutils literal"&gt;ContentCreateMixin&lt;/tt&gt;  then? Well since the same mixins are used from &lt;tt class="docutils literal"&gt;DocumentCreateView&lt;/tt&gt;
I won&amp;#8217;t need to re-define this list there. Also if for example I want to allow users that have a specific permission to create
articles and document I will remove the &lt;tt class="docutils literal"&gt;LoginRequireMixin&lt;/tt&gt; and add the &lt;tt class="docutils literal"&gt;AllowCreateContentMixin&lt;/tt&gt; only to the &lt;tt class="docutils literal"&gt;ContentCreateMixin&lt;/tt&gt;
and not to both &lt;tt class="docutils literal"&gt;ArticleCreateView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;DocumentCreateView&lt;/tt&gt; (and I won&amp;#8217;t be in danger of forgetting to change it somewhere).
Of course all this depends on your requirements and how &lt;span class="caps"&gt;DRY&lt;/span&gt; you need to&amp;nbsp;be.&lt;/p&gt;
&lt;p&gt;The category related views are simpler and override their mixins directly. Finally there&amp;#8217;s a &lt;tt class="docutils literal"&gt;DynamicTemplateView&lt;/tt&gt; to
display templates based on their filename as discussed&amp;nbsp;previously.&lt;/p&gt;
&lt;p&gt;Before continuing, please try to understand how much more &lt;span class="caps"&gt;DRY&lt;/span&gt; this project is when compared to using a traditional
functional one (or if not using mixins). For example, there&amp;#8217;s a &lt;tt class="docutils literal"&gt;RequestArgMixin&lt;/tt&gt; that is used by all views that create/update content. If &lt;span class="caps"&gt;INHERITANCE&lt;/span&gt;
didn&amp;#8217;t use that mixin I&amp;#8217;d need to re-define the same functionality (pass the current request to the form&amp;#8217;s constructor) to
4 views (Article/Document Create/Update). Or for the &lt;tt class="docutils literal"&gt;AuditableMixin&lt;/tt&gt; I&amp;#8217;d need to remember to upgrade the created/modified by
to 8 views (Article/Document&amp;nbsp;Create/Update/Unpublish/Remove)!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The previous discussion should convince you how much more &lt;span class="caps"&gt;DRY&lt;/span&gt; your views will be when using CBVs and how
much quicker will be to create your views. Also, if
you followed closely the first and second chapters you should be able to understand everything that is
needed for CBVs and be able to properly understand which method or attribute you need to override to
implement some specific functionality. Finally, the list of examples in the third chapter should help
you get started in all your &lt;span class="caps"&gt;CBV&lt;/span&gt; needs - if you have some specific question about CBVs or you&amp;#8217;d like
another use case added to the list feel free to ask and I&amp;#8217;ll try to add&amp;nbsp;it!&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="python"></category><category term="cbv"></category><category term="class-based-views"></category><category term="django"></category></entry><entry><title>Easy downloading youtube videos and mp3s using youtube-dl andÂ python</title><link href="https://spapas.github.io/2018/03/06/easy-youtube-mp3-downloading/" rel="alternate"></link><published>2018-03-06T12:20:00+02:00</published><updated>2018-03-06T12:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2018-03-06:/2018/03/06/easy-youtube-mp3-downloading/</id><summary type="html">&lt;p class="first last"&gt;Download videos (and convert them to mp3s) from youtube using python youtube-dl and&amp;nbsp;ffmpeg!&lt;/p&gt;
</summary><content type="html">&lt;p&gt;In this article I am going to present you with an easy (and advertisement/malware free) way to download
videos from youtube, converting them to mp3 if needed. Also, I will give some more useful hints, for
example how to download multiple mp3s using a script, how to break a long mp3 to same-length parts
so you could quickly skip tracks when you play it in your stereo&amp;nbsp;etc.&lt;/p&gt;
&lt;p&gt;I am going to give specific instructions for Windows users - however everything I&amp;#8217;ll propose should also be applicable
to &lt;span class="caps"&gt;OSX&lt;/span&gt; or Linux users with minor&amp;nbsp;modifications.&lt;/p&gt;
&lt;p&gt;The tools we are going to use&amp;nbsp;are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://rg3.github.io/youtube-dl/"&gt;youtube-dl&lt;/a&gt; which is a python library for downloading videos from youtube (and some other&amp;nbsp;sites)&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://www.ffmpeg.org"&gt;ffmpeg&lt;/a&gt; which is a passepartout video/audio editing&amp;nbsp;library&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="installation"&gt;
&lt;h2&gt;Installation&lt;/h2&gt;
&lt;p&gt;To install youtube-dl I recommend installing it in your global python (2 or 3) package list using pip. Please read my
&lt;a class="reference external" href="https://spapas.github.io/2017/12/20/python-2-3-windows/"&gt;previous&lt;/a&gt;&amp;nbsp;article&lt;/p&gt;
&lt;p&gt;to see how you should install and use Python 2 or 3
on Windows. Following the instructions from there, you can do the following to install youtube-dl in your global
Python 3&amp;nbsp;packages:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
py -3 -m pip install youtube-dl
&lt;/pre&gt;
&lt;p&gt;To run youtube-dl you&amp;#8217;ll write something like &lt;tt class="docutils literal"&gt;py &lt;span class="pre"&gt;-3&lt;/span&gt; &lt;span class="pre"&gt;-m&lt;/span&gt; youtube_dl url_or_video_id&lt;/tt&gt; (notice the underscore instead of dash since
dashes are not supported in module names in python). For example try something like this &lt;tt class="docutils literal"&gt;py &lt;span class="pre"&gt;-3&lt;/span&gt; &lt;span class="pre"&gt;-m&lt;/span&gt; youtube_dl YgtL4S7Hrwo&lt;/tt&gt; and you&amp;#8217;ll
be rewarded with the 2016 Pycon talk from Guido van Rossum! If you find this a little too much too type don&amp;#8217;t be afraid, I will give
some hints later about how to improve&amp;nbsp;this.&lt;/p&gt;
&lt;p&gt;To upgrade your youtube-dl installation you should do something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
py -3 -m pip install -U youtube-dl
&lt;/pre&gt;
&lt;p&gt;Notice that you must frequently upgrade your youtube-dl installation because sometimes youtube changes the requirements
for viewing / downloading videos and your old version will not work. So if for some reason something is not correct when
you use youtube-dl always try updating&amp;nbsp;first.&lt;/p&gt;
&lt;p&gt;If you wanted you could also create a virtual environment (see instructions on previously mentioned article) and install youtube-dl locally there using &lt;tt class="docutils literal"&gt;pip install &lt;span class="pre"&gt;youtube-dl&lt;/span&gt;&lt;/tt&gt;
however I prefer to install it on the global packages to be really easy for me to call it from a command prompt I open. Notice
that if you install youtube-dl in a virtualenv, after you activate that virtualenv you&amp;#8217;ll be able to run it just by typing &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;youtube-dl&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Finally, If for some reason you don&amp;#8217;t want want to mess with python and all this (or it just seems greek to you) then you
may go on and directly download a &lt;a class="reference external" href="https://yt-dl.org/latest/youtube-dl.exe"&gt;youtube-dl windows executable&lt;/a&gt;. Just put it in your path and you should be good to&amp;nbsp;go.&lt;/p&gt;
&lt;p&gt;To install ffmpeg, I recommend &lt;a class="reference external" href="https://ffmpeg.zeranoe.com/builds/"&gt;downloading the Windows build from here&lt;/a&gt; (select the correct Windows architecture of your system and
always static linking - the version doesn&amp;#8217;t matter). This will get you a zip - we are mainly interested to the three files under the
&lt;tt class="docutils literal"&gt;bin&lt;/tt&gt; folder of that zip which should be copied to a directory under your&amp;nbsp;path:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;ffmpeg is the passepartout video converting toot that we are going to&amp;nbsp;use&lt;/li&gt;
&lt;li&gt;ffprobe will print some information about a file (about its container and video/audio&amp;nbsp;streams)&lt;/li&gt;
&lt;li&gt;ffplay will play the file &amp;#8212; not really recommended there are better tools but it is invaluable
for testing; if it can be played be ffplay then ffmpeg will be able to properly read your&amp;nbsp;file&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Notice I recommend copying things to a directory in your path. This is recommended and will save you from repeatedly typing the same things
over and over. Also, later I will propose a bunch of &lt;span class="caps"&gt;DOS&lt;/span&gt; batch (.bat) files that can also be copied to that directory and help you even
more in you youtube video downloading. To add a directory to the &lt;span class="caps"&gt;PATH&lt;/span&gt;, just press Windows+Pause Break, Advanced System Settings, Advanced,
Environment Variables, edit the &amp;#8220;Path&amp;#8221; User variable (for your user) and append the directory&amp;nbsp;there.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-youtube-dl"&gt;
&lt;h2&gt;Using&amp;nbsp;youtube-dl&lt;/h2&gt;
&lt;p&gt;As I&amp;#8217;ve already explained before, to run youtube-dl you&amp;#8217;ll either write something like &lt;tt class="docutils literal"&gt;py &lt;span class="pre"&gt;-3&lt;/span&gt; &lt;span class="pre"&gt;-m&lt;/span&gt; youtube_dl&lt;/tt&gt; (if you&amp;#8217;ve installed it
to your global python packages) or run youtube-dl if you&amp;#8217;ve downloaded the pre-built exe or have installed it in a virtualenv. To save
you from some keystrokes, you can create a batch file that will run and pass any more parameters to it, something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
py -3 -m youtube_dl %*
&lt;/pre&gt;
&lt;p&gt;(the %* will capture the remaining command line) so to get the previous video just run &lt;tt class="docutils literal"&gt;getvideo YgtL4S7Hrwo&lt;/tt&gt;
(or getvideo &lt;a class="reference external" href="https://www.youtube.com/watch?v=YgtL4S7Hrwo"&gt;https://www.youtube.com/watch?v=YgtL4S7Hrwo&lt;/a&gt; - works the same with the video id or the complete&amp;nbsp;url).&lt;/p&gt;
&lt;p&gt;One thing I&amp;#8217;d like to mention here is that youtube-dl works fine with playlists and even channels. For example,
to download all videos from PyCon 2017 just do&amp;nbsp;this:&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;getvideo &lt;span class="pre"&gt;https://www.youtube.com/channel/UCrJhliKNQ8g0qoE_zvL8eVg/feed&lt;/span&gt;&lt;/tt&gt; and you should see something&amp;nbsp;like:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
E:\&amp;gt;py -3 -m youtube_dl https://www.youtube.com/channel/UCrJhliKNQ8g0qoE_zvL8eVg/feed
[youtube:channel] UCrJhliKNQ8g0qoE_zvL8eVg: Downloading channel page
[youtube:playlist] UUrJhliKNQ8g0qoE_zvL8eVg: Downloading webpage
[download] Downloading playlist: Uploads from PyCon 2017
[youtube:playlist] UUrJhliKNQ8g0qoE_zvL8eVg: Downloading page #1
[youtube:playlist] playlist Uploads from PyCon 2017: Downloading 143 videos
[download] Downloading video 1 of 143
[youtube] AjFfsOA7AQI: Downloading webpage
[youtube] AjFfsOA7AQI: Downloading video info webpage
[youtube] AjFfsOA7AQI: Extracting video information
WARNING: Requested formats are incompatible for merge and will be merged into mkv.
[download] Destination: Final remarks and conference close  - Pycon 2017-AjFfsOA7AQI.f137.mp4
[download]   2.9% of 34.49MiB at 940.52KiB/s ETA 00:36
&lt;/pre&gt;
&lt;p&gt;This is gonna take some time&amp;nbsp;&amp;#8230;&lt;/p&gt;
&lt;p&gt;Now, youtube-dl has &lt;a class="reference external" href="https://github.com/rg3/youtube-dl/blob/master/README.md#options"&gt;many options&lt;/a&gt; and can be configured with &lt;a class="reference external" href="https://github.com/rg3/youtube-dl/blob/master/README.md#configuration"&gt;default values&lt;/a&gt; depending on your
requirements. I won&amp;#8217;t go into detail about these except on some things I usually use, if you
need some help feel free to ask&amp;nbsp;me.&lt;/p&gt;
&lt;p&gt;When you download a video, youtube-dl will try to download the best quality possible for that video,
however a video may have various different formats that can be queries by passing the option &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--list-formats&lt;/span&gt;&lt;/tt&gt;
to ffmpeg, for example here&amp;#8217;s the output from the previously mentioned&amp;nbsp;video:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
E:\&amp;gt;getvideo YgtL4S7Hrwo --list-formats
[youtube] YgtL4S7Hrwo: Downloading webpage
[youtube] YgtL4S7Hrwo: Downloading video info webpage
[youtube] YgtL4S7Hrwo: Extracting video information
[info] Available formats for YgtL4S7Hrwo:
format code  extension  resolution note
249          webm       audio only DASH audio   53k , opus &amp;#64; 50k, 15.14MiB
250          webm       audio only DASH audio   72k , opus &amp;#64; 70k, 20.29MiB
171          webm       audio only DASH audio  111k , vorbis&amp;#64;128k, 29.42MiB
140          m4a        audio only DASH audio  130k , m4a_dash container, mp4a.40.2&amp;#64;128k, 38.38MiB
251          webm       audio only DASH audio  130k , opus &amp;#64;160k, 36.94MiB
278          webm       256x144    144p   58k , webm container, vp9, 30fps, video only, 11.01MiB
242          webm       426x240    240p   88k , vp9, 30fps, video only, 12.40MiB
160          mp4        256x144    144p  120k , avc1.4d400c, 30fps, video only, 33.64MiB
243          webm       640x360    360p  153k , vp9, 30fps, video only, 23.48MiB
134          mp4        640x360    360p  230k , avc1.4d401e, 30fps, video only, 28.91MiB
133          mp4        426x240    240p  260k , avc1.4d4015, 30fps, video only, 74.75MiB
244          webm       854x480    480p  289k , vp9, 30fps, video only, 39.31MiB
135          mp4        854x480    480p  488k , avc1.4d401f, 30fps, video only, 56.43MiB
247          webm       1280x720   720p  945k , vp9, 30fps, video only, 102.45MiB
136          mp4        1280x720   720p 1074k , avc1.4d401f, 30fps, video only, 116.72MiB
17           3gp        176x144    small , mp4v.20.3, mp4a.40.2&amp;#64; 24k
36           3gp        320x180    small , mp4v.20.3, mp4a.40.2
43           webm       640x360    medium , vp8.0, vorbis&amp;#64;128k
18           mp4        640x360    medium , avc1.42001E, mp4a.40.2&amp;#64; 96k
22           mp4        1280x720   hd720 , avc1.64001F, mp4a.40.2&amp;#64;192k (best)
&lt;/pre&gt;
&lt;p&gt;As you can see, each has an id and defines an extension (container)  and info about its video and audio stream.
You can download a &lt;em&gt;specific&lt;/em&gt; format by using the -f command line otpion. For example , to download the audio-only
format with the worst audio quality use &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;C:\Users\serafeim&amp;gt;getvideo&lt;/span&gt; YgtL4S7Hrwo &lt;span class="pre"&gt;-f&lt;/span&gt; 249&lt;/tt&gt;. Notice that there are
formats with audio ony and other formats with vide only. To download the worst format possible (resulting in the
smallest file size of course ) you can pass the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-f&lt;/span&gt; worst&lt;/tt&gt; command line (there&amp;#8217;s also a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-f&lt;/span&gt; best&lt;/tt&gt; command line
which is used by&amp;nbsp;default).&lt;/p&gt;
&lt;p&gt;Another thing I&amp;#8217;d like to point out here is that you can define an &lt;a class="reference external" href="https://github.com/rg3/youtube-dl/blob/master/README.md#output-template"&gt;output template&lt;/a&gt; using the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-o&lt;/span&gt;&lt;/tt&gt; option that
will format the name of the output file of your video using the provided options. There are  &lt;a class="reference external" href="https://github.com/rg3/youtube-dl/blob/master/README.md#output-template-examples"&gt;many examples in the docs&lt;/a&gt;
so I won&amp;#8217;t go into any more details&amp;nbsp;here.&lt;/p&gt;
&lt;p&gt;Another cool option is the -a that will help you download all videos from a file. For example, if you have a file
named &lt;tt class="docutils literal"&gt;videos.txt&lt;/tt&gt; with the following&amp;nbsp;contsnts:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
AjFfsOA7AQI
3dDtACSYVx0
G17E4Muylis
&lt;/pre&gt;
&lt;p&gt;running &lt;tt class="docutils literal"&gt;getvideo &lt;span class="pre"&gt;-a&lt;/span&gt; videos.txt &lt;span class="pre"&gt;-f&lt;/span&gt; worst&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;will get you all three videos in their worst quality. If you don&amp;#8217;t want to create files then you can use something
like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
for %i in (AjFfsOA7AQI 3dDtACSYVx0 G17E4Muylis) do getvideo %i -f worst
&lt;/pre&gt;
&lt;p&gt;and it will run  getvideo for all three&amp;nbsp;files.&lt;/p&gt;
&lt;p&gt;Some more options I&amp;#8217;d like to recommend using&amp;nbsp;are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--restrict-filenames&lt;/span&gt;&lt;/tt&gt; to avoid strange&amp;nbsp;filenames&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--ignore-errors&lt;/span&gt;&lt;/tt&gt; to ignore errors when download multiple files (from a playlist or a channel) - this is really
useful because if you have a play with missing items youtube-dl will stop downloading the remaining files when it
encounters the missing&amp;nbsp;one&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If you want to always use these options you may add them to your configuration file (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;C:\Users\&amp;lt;user&lt;/span&gt; &lt;span class="pre"&gt;name&amp;gt;\youtube-dl.conf&lt;/span&gt;&lt;/tt&gt;)
or to the getvideo.bat defined above i.e getvideo.bat will&amp;nbsp;be:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
py -3 -m youtube_dl --restrict-filenames --ignore-errors %*
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="extracting-mp3s"&gt;
&lt;h2&gt;Extracting&amp;nbsp;mp3s&lt;/h2&gt;
&lt;p&gt;The next step in this trip is to understand how to extract mp3s from videos that are downloaded from youtube. If you&amp;#8217;ve
payed attention you&amp;#8217;d know that by now you can download audio-only formats from youtube - however they are in a format
called &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Dynamic_Adaptive_Streaming_over_HTTP"&gt;&lt;span class="caps"&gt;DASH&lt;/span&gt;&lt;/a&gt; which most probably is &lt;em&gt;not&lt;/em&gt; playable by your car stereo (&lt;span class="caps"&gt;DASH&lt;/span&gt; is specialized for streaming audio through &lt;span class="caps"&gt;HTTP&lt;/span&gt;).&lt;/p&gt;
&lt;p&gt;Thus, the proper way to get mp3s is to post-process
the downloaded file using ffmpeg to convert it to mp3. This could be done manually (by doing something
&lt;tt class="docutils literal"&gt;ffmpeg &lt;span class="pre"&gt;-i&lt;/span&gt; input out.mp3&lt;/tt&gt; &amp;#8212; ffmpeg is smart enough to know how to convert per extension)
but thankfully youtube-dl offers the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-x&lt;/span&gt;&lt;/tt&gt; (and friend) parameters to make this automatic. Using &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-x&lt;/span&gt;&lt;/tt&gt; tells
youtube-dl to extract the audio from the video (notice that youtube-dl is smart enough to download one of the audio-only
formats so you don&amp;#8217;t have ). Using -x alone may result in a different audio format (for example .ogg) so to force conversion to mp3
you should also add the  &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--audio-format&lt;/span&gt; mp3&lt;/tt&gt; parameter. Thus, to download an mp3 you can use the following command
line (continuing from the previous&amp;nbsp;examples):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
py -3 -m youtube_dl --restrict-filenames --ignore-errors -x --audio-format mp3  AjFfsOA7AQI
&lt;/pre&gt;
&lt;p&gt;or even better, create a &lt;tt class="docutils literal"&gt;getmp3.bat&lt;/tt&gt; batch file that will be used to retrieve an&amp;nbsp;mp3:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
py -3 -m youtube_dl --restrict-filenames --ignore-errors -x --audio-format mp3 %1
&lt;/pre&gt;
&lt;p&gt;Please notice that also in this case youtube-dl is smart enough to download an audio-only format thus
you won&amp;#8217;t need to select it by hand using &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-f&lt;/span&gt;&lt;/tt&gt; to save&amp;nbsp;bandwith.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="splitting-the-mp3-file-to-parts"&gt;
&lt;h2&gt;Splitting the mp3 file to&amp;nbsp;parts&lt;/h2&gt;
&lt;p&gt;Some people would like to split their large mp3 files to same-length segments. Of course it would be better
for the file to be split by silence to individual songs (if the file contains songs) but these methods usually
don&amp;#8217;t work that good so I prefer the same length segments. To do that using ffmpeg you just need to add the
following&amp;nbsp;parameters:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
ffmpeg -i input.mp3 -segment_time 180 -f segment out.%03d.mp3&amp;quot;
&lt;/pre&gt;
&lt;p&gt;The segment time is in seconds (so each segment will be 3 minutes) while the output files will have a name like
&lt;tt class="docutils literal"&gt;out.001.mp3, out.002.mp3&lt;/tt&gt; etc.&lt;/p&gt;
&lt;p&gt;What if you&amp;#8217;d like to make the segmentation automatic? For this, I recommend writing a batch file with two
commands - one to download the mp3 and a second one to call ffmpeg to segment the file. Notice that you
could use the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--postprocessor-args&lt;/span&gt; &lt;span class="caps"&gt;ARGS&lt;/span&gt;&lt;/tt&gt; command line parameter to pass the required arguments to youtube-dl
so it will be done in one command however I&amp;#8217;d like to have a little more control thus I prefer two commands (if
you decide to use &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--postprocessor-args&lt;/span&gt; &lt;span class="caps"&gt;ARGS&lt;/span&gt;&lt;/tt&gt; keep in mind that args must be inside double quotes&amp;nbsp;&amp;#8220;&amp;#8221;).&lt;/p&gt;
&lt;p&gt;Since we are going to use two commands, we need to feed the output file of youtube-dl to ffmpeg and specify a
name for the ffmpeg output file-segments. The easiest way to do that is to just pass two parameters to the batch
file - one for the video to download and one for its name. Copy the following to a file named &lt;tt class="docutils literal"&gt;getmp3seg.bat&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
py -3 -m youtube_dl %1 -x --audio-format mp3 --audio-quality 128k -o %2.%%(ext)s&amp;quot;
ffmpeg -i %2.mp3 -segment_time 180 -f segment %2.%%03d.mp3
del %2.mp3
&lt;/pre&gt;
&lt;p&gt;You can then call it like this: &lt;tt class="docutils literal"&gt;getmp3seg AjFfsOA7AQI test&lt;/tt&gt;. The first line will download and covert
the video to mp3 and put it in a file named &lt;tt class="docutils literal"&gt;test.mp3&lt;/tt&gt; (the %2 is the test, the %% is used to
escape the % and the %(ext)s is the extensions - this is needed if you use something like -o %2.mp3
youtube-dl will be confused when trying to convert the file to mp3 and will not work). The 2nd line
will segment the file to 180 second seconds (notice that here also we need to escape %) and the third
line will delete the original mp3. This leaves us with the following 4 files (the video was around 10 minutes): &lt;tt class="docutils literal"&gt;test.000.mp3,
test.001.mp3, test.002.mp3, test.003.mp3&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;One final thing I&amp;#8217;d like to present here is a (more complex) script that you can use to download a video
and segmentize it only if it is more than 360 seconds. For this, we will also use the &lt;a class="reference external" href="http://ibiblio.org/mp3info/"&gt;mp3info&lt;/a&gt; util which can
be downloaded directly from the homepage and copied to the path. So copy the following to a script named &lt;tt class="docutils literal"&gt;getmp3seg2.bat&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;#64;echo off

IF &amp;quot;%2&amp;quot;==&amp;quot;&amp;quot; GOTO HAVE_1

py -3 -m youtube_dl %1 -x --audio-format mp3 -o %2.%%(ext)s&amp;quot;

FOR /f %%i IN ('mp3info -p &amp;quot;%%S&amp;quot; %2.mp3') DO SET koko=%%i

IF %koko%  GTR 360 (
        ECHO greater than or equal to 360
        ffmpeg -i %2.mp3 -segment_time 180 -f segment %2.%%03d.mp3
        del %2.mp3
)  else (
   ECHO less than 360
)

GOTO :eof

:HAVE_1
ECHO Please call this file with video id and title
&lt;/pre&gt;
&lt;p&gt;This is a little more complex - I&amp;#8217;ll explain it quickly: &lt;tt class="docutils literal"&gt;&amp;#64;echo off&lt;/tt&gt; is used to suppress non needed output.
The &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;IF&lt;/span&gt;&lt;/tt&gt; following makes sure that you have two parameters. The next line downloads the file and converts it to mp3. The &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;FOR&lt;/span&gt;&lt;/tt&gt;
loop is a little strange but it&amp;#8217;s result will be to retrieve the output of &lt;tt class="docutils literal"&gt;mp3info &lt;span class="pre"&gt;-o&lt;/span&gt; &amp;quot;%S&amp;quot; title.mp3&lt;/tt&gt; (which is the
duration in seconds of that mp3) and assign it to the &lt;tt class="docutils literal"&gt;koko&lt;/tt&gt; variable. The next &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;IF&lt;/span&gt;&lt;/tt&gt; checks if &lt;tt class="docutils literal"&gt;koko&lt;/tt&gt; is greater than (&lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GTR&lt;/span&gt;&lt;/tt&gt;)
360 seconds and if yes will run the conversion code we discussed before - else it will just output that it is less than 360&amp;nbsp;seconds.&lt;/p&gt;
&lt;p&gt;Finally, there&amp;#8217;s a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GOTO&lt;/span&gt;: eof&lt;/tt&gt; line to skip printing the error message when the batch is called with less than two&amp;nbsp;parameters.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-youtube-dl-from-python"&gt;
&lt;h2&gt;Using youtube-dl from&amp;nbsp;python&lt;/h2&gt;
&lt;p&gt;Integrating with youtube-dl from python is easy. Of course, you could just go on and directly call the command line
however you can have more control. The most important class is &lt;tt class="docutils literal"&gt;youtube_dl.YoutubeDL.YoutubeDL&lt;/tt&gt;. You instantiate
an object of this class class passing the parameters you&amp;#8217;d like and call its &lt;tt class="docutils literal"&gt;download()&lt;/tt&gt; instance method passing
a list of urls. Here&amp;#8217;s a small script that downloads the input video&amp;nbsp;ids:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;youtube_dl&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;YoutubeDL&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ydl_opts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
        &lt;span class="n"&gt;ydl&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;YoutubeDL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ydl_opts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;ydl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;download&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:])&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Enter list of urls to download&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Save it in a file named getvideo.py and run it like &lt;tt class="docutils literal"&gt;py &lt;span class="pre"&gt;-3&lt;/span&gt; getvideo.py AjFfsOA7AQI 3dDtACSYVx0 G17E4Muylis&lt;/tt&gt; to download all three&amp;nbsp;videos!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="fixing-your-unicode-names"&gt;
&lt;h2&gt;Fixing your unicode&amp;nbsp;names&lt;/h2&gt;
&lt;p&gt;The last thing I&amp;#8217;d like to talk about concerns people that want to download videos with Unicode characters in their titles (for example&amp;nbsp;Greek).&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s suppose that you want to download the file vFVNOaUPRow which is piano music from a well-know greek composer. If you get it without parameters
(for example &lt;tt class="docutils literal"&gt;py &lt;span class="pre"&gt;-3&lt;/span&gt; &lt;span class="pre"&gt;-m&lt;/span&gt; youtube_dl &lt;span class="pre"&gt;-x&lt;/span&gt; &lt;span class="pre"&gt;--audio-format&lt;/span&gt; mp3 vFVNOaUPRow&lt;/tt&gt;)
you&amp;#8217;ll get the following output file: &lt;tt class="docutils literal"&gt;Î ÎÎ¬Î½Î¿Ï Î§Î±ÏÎ¶Î¹Î´Î¬ÎºÎ¹Ï. ÏÎ±Î¯Î¶ÎµÎ¹ 11 ÎºÎ¿Î¼Î¼Î¬ÏÎ¹Î± ÏÏÎ¿ &lt;span class="pre"&gt;ÏÎ¹Î¬Î½Î¿-vFVNOaUPRow.f247.mp3&lt;/span&gt;&lt;/tt&gt; (notice the greek characters) while, if
you add the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--restrict-filenames&lt;/span&gt;&lt;/tt&gt; I mentioned before you&amp;#8217;ll get &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;_11-vFVNOaUPRow.f247.mp3&lt;/span&gt;&lt;/tt&gt; (notice that the greek characters have been removed
since they are not&amp;nbsp;safe).&lt;/p&gt;
&lt;p&gt;So if you use the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--restrict-filenames&lt;/span&gt;&lt;/tt&gt; parameter you&amp;#8217;ll get an output that contains &lt;em&gt;only&lt;/em&gt; the video id (and any safe characters it may find) while
if you don&amp;#8217;t use it you&amp;#8217;ll get the normal title of the video. However, most stereos &lt;em&gt;do not&lt;/em&gt; display unicode characters properly so if I get this
file to my car I&amp;#8217;ll see garbage and I won&amp;#8217;t be able to identify it &amp;#8212; I will be able to listen it but not see its&amp;nbsp;name!&lt;/p&gt;
&lt;p&gt;To fix that, I propose transliterating the unicode characters using the &lt;a class="reference external" href="https://pypi.python.org/pypi/Unidecode"&gt;unidecode&lt;/a&gt; library. Just install it using &lt;tt class="docutils literal"&gt;pip&lt;/tt&gt;. Then you can the following
script to rename all mp3 files in a directory to using english characters&amp;nbsp;only:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;unidecode&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nb"&gt;file&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listdir&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;endswith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;mp3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Renaming {0} to {1}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;unidecode&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unidecode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
            &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rename&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;unidecode&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unidecode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Copy this to a file named transliterate.py and run it in a directory containing mp3 files (&lt;tt class="docutils literal"&gt;py &lt;span class="pre"&gt;-3&lt;/span&gt; transliterate.py&lt;/tt&gt;) to rename them to non-unicode&amp;nbsp;characters.&lt;/p&gt;
&lt;/div&gt;
</content><category term="python"></category><category term="youtube"></category><category term="youtube-dl"></category><category term="ffmpeg"></category><category term="python"></category></entry><entry><title>Authentication for django-rest-framework withÂ django-rest-auth</title><link href="https://spapas.github.io/2018/03/01/django-rest-auth/" rel="alternate"></link><published>2018-03-01T22:40:00+02:00</published><updated>2018-03-01T22:40:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2018-03-01:/2018/03/01/django-rest-auth/</id><summary type="html">&lt;p class="first last"&gt;How to authenticate with&amp;nbsp;django-rest-auth&lt;/p&gt;
</summary><content type="html">&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;Most of the times I need authentication with any &lt;span class="caps"&gt;REST&lt;/span&gt; APIs defined through &lt;a class="reference external" href="http://www.django-rest-framework.org"&gt;django-rest-framework&lt;/a&gt;
I will use  &lt;a class="reference external" href="http://www.django-rest-framework.org/api-guide/authentication/#sessionauthentication"&gt;SessionAuthentication&lt;/a&gt; method. This method uses the session cookie (which is set through the
normal Django login and logout views)
to check out if there&amp;#8217;s an authenticated user and get his username. This method works only in the
same session (browser window) as the one that actually did the login but this should be enough for most&amp;nbsp;cases.&lt;/p&gt;
&lt;p&gt;However, sometimes instead of using the normal Django login/logout views, you&amp;#8217;ll want
to authentication through &lt;span class="caps"&gt;REST&lt;/span&gt; end-points, for example for using them with SPAs (where
you don&amp;#8217;t want to use the traditional views for authentication but through &lt;span class="caps"&gt;REST&lt;/span&gt; end-points) or
because you have implemented a mobile (or desktop) application that needs to authenticate with
your&amp;nbsp;script.&lt;/p&gt;
&lt;p&gt;There are various ways this could be done but one of the simplest is using &lt;a class="reference external" href="https://github.com/Tivix/django-rest-auth"&gt;django-rest-auth&lt;/a&gt;.
This project adds a number of &lt;span class="caps"&gt;REST&lt;/span&gt; end-points to your project that can be used for user login
and registration (and even social login when combined with &lt;a class="reference external" href="https://github.com/pennersr/django-allauth"&gt;django-allauth&lt;/a&gt;).
In the following I am going to write a simple tutorial on how to actually use django-rest-auth to
authenticate with django-rest-framework using the provided &lt;span class="caps"&gt;REST&lt;/span&gt; end points and how to call a
&lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; as an authenticated&amp;nbsp;user.&lt;/p&gt;
&lt;p&gt;Before continuing with the tutorial, let&amp;#8217;s take a look at what we&amp;#8217;ll build&amp;nbsp;here:&lt;/p&gt;
&lt;img alt="Our project" src="/images/rest-auth.gif" style="width: 640px;" /&gt;
&lt;p&gt;This is a single html page (styled with &lt;a class="reference external" href="https://picturepan2.github.io/spectre/"&gt;spectre.css&lt;/a&gt;) that checks if the user is logged in
and either displays the login or logout button (using javascript). When you click the login you&amp;#8217;ll get a modal in which you
can enter your credentials which will be submitted through &lt;span class="caps"&gt;REST&lt;/span&gt; to the django-rest-auth endpoint and
depending on the response will set a javascript variable (and a corresponding session/local storage key).
Then you can use the &amp;#8220;Test auth&amp;#8221; button that works only on authenticated users and returns their username.
Finally, notice that after you log out the &amp;#8220;test auth&amp;#8221; button returns a 403 access&amp;nbsp;denied.&lt;/p&gt;
&lt;p&gt;If you want to play with this project yourself, you can clone it here &lt;a class="reference external" href="https://github.com/spapas/rest_authenticate"&gt;https://github.com/spapas/rest_authenticate&lt;/a&gt;.
Just create a venv, install requirements, create a superuser and you should be good to&amp;nbsp;go!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="some-theory"&gt;
&lt;h2&gt;Some&amp;nbsp;theory&lt;/h2&gt;
&lt;p&gt;After you log in with Django, your authentication information is saved to the &amp;#8220;session&amp;#8221;_. The session is a bucket of information
that the Django application saves about your visit &amp;#8212; to distinguish between different visitors a cookie with a unique
value named &lt;tt class="docutils literal"&gt;sessionid&lt;/tt&gt; will be used. So, your web browser will send this cookie with each page request thus allowing Django
to know which bucket of information is yours (and if you&amp;#8217;ve authenticated know who are you). This is not a Django
related concept but a general one (supported by most if not all &lt;span class="caps"&gt;HTTP&lt;/span&gt; frameworks) and is used to add state to an otherwise
stateless medium (&lt;span class="caps"&gt;HTTP&lt;/span&gt;).&lt;/p&gt;
&lt;p&gt;Since the &lt;tt class="docutils literal"&gt;sessionid&lt;/tt&gt; cookie is sent not only with traditional but also with Ajax request it can be used to authenticate
&lt;span class="caps"&gt;REST&lt;/span&gt; requests after you&amp;#8217;ve logged in. This is what is used by default in django-rest-framework and as I said in the
introduction it is a very good solution for most use cases: You login to django and you can go ahead and call the &lt;span class="caps"&gt;REST&lt;/span&gt;
&lt;span class="caps"&gt;API&lt;/span&gt; through Ajax; the &lt;tt class="docutils literal"&gt;sessionid&lt;/tt&gt; cookie will be sent along with the request and you&amp;#8217;ll be&amp;nbsp;authenticated.&lt;/p&gt;
&lt;p&gt;Now, although the session authentication is nice for using in browsers, you may need to access your &lt;span class="caps"&gt;API&lt;/span&gt; through a desktop
or a mobile application where, setting the cookies yourself is not the optimal solution. Also, you may have an &lt;span class="caps"&gt;SPA&lt;/span&gt; that needs
to access an &lt;span class="caps"&gt;API&lt;/span&gt; in a different domain; using &lt;a class="reference external" href="https://stackoverflow.com/questions/3342140/cross-domain-cookies"&gt;using cookies for this is not easy&lt;/a&gt; - if possible at&amp;nbsp;all.&lt;/p&gt;
&lt;p&gt;For such cases, django-rest-framework
offers a different authentication method called &lt;tt class="docutils literal"&gt;TokenAuthentication_&lt;/tt&gt;. Using this method, each user of the Django application
is correlated with a random string (Token) which is passed along with the request at its header thus the Django app can authenticate
the user using this token! One thing that may seem strange is that since both the session cookie and a token are
set through &lt;span class="caps"&gt;HTTP&lt;/span&gt; Headers why all the fuss about tokens? Why not just use the session cookie and be done with it. Well, there are
various reasons - here&amp;#8217;s a &lt;cite&gt;rather extensive article&lt;/cite&gt; explaining some. Some of the reasons are that a token can be valid forever
while the session is something ephemeral - beyond authorization information, sessions may keep various other data for a web
application and are expired after some time to save space. Also, since tokens are used for exactly this (authentication) they
are much easier to use and reason about. Finally, as I&amp;#8217;ve already explained, sharing cookies by multiple sites is not something
you&amp;#8217;d like to&amp;nbsp;do.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="installation-configuration"&gt;
&lt;h2&gt;Installation &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt;&amp;nbsp;configuration&lt;/h2&gt;
&lt;p&gt;To install django-rest-auth just follow &lt;a class="reference external" href="http://django-rest-auth.readthedocs.io/en/latest/installation.html#installation"&gt;the instructions here&lt;/a&gt; i.e just add
&lt;tt class="docutils literal"&gt;'rest_framework', 'rest_framework.authtoken'&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;'rest_auth'&lt;/tt&gt; to your &lt;cite&gt;INSTALLED_APPS&lt;/cite&gt; in
&lt;tt class="docutils literal"&gt;settings.py&lt;/tt&gt; and run&amp;nbsp;migrate.&lt;/p&gt;
&lt;p&gt;Since I won&amp;#8217;t be adding any other apps to this project (no models are actually needed), I&amp;#8217;ve added
two directories &lt;tt class="docutils literal"&gt;static&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;templates&lt;/tt&gt; to put static files and templates there. This is configured
by adding the &lt;tt class="docutils literal"&gt;'&lt;span class="caps"&gt;DIRS&lt;/span&gt;'&lt;/tt&gt; attribte to &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;TEMPLATES&lt;/span&gt;&lt;/tt&gt;, like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;TEMPLATES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;BACKEND&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django.template.backends.django.DjangoTemplates&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;DIRS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
            &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BASE_DIR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;templates&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="p"&gt;],&lt;/span&gt;
        &lt;span class="o"&gt;//&lt;/span&gt; &lt;span class="o"&gt;...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and adding the &lt;cite&gt;STATICFILES_DIRS&lt;/cite&gt; setting:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;STATICFILES_DIRS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BASE_DIR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;static&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The remaining setting are the default as were created by &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;django-admin&lt;/span&gt; startproject&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;I have included the the following urls to &lt;tt class="docutils literal"&gt;urls.py&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;admin/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;site&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test_auth/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TestAuthView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test_auth&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rest-auth/logout/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;LogoutViewEx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rest_logout&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rest-auth/login/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;LoginView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rest_login&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;HomeTemplateView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;home&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;static&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;STATIC_URL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;document_root&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;STATIC_ROOT&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;These are: The django-admin, a test_auth view (that works only for authenticated users and returns their username),
&lt;em&gt;a view (LogoutViewEx) that overrides the rest-auth &lt;span class="caps"&gt;REST&lt;/span&gt; logout-view&lt;/em&gt; (I&amp;#8217;ll explain why this is needed in a minute),
the rest-auth &lt;span class="caps"&gt;REST&lt;/span&gt; login-view, the home template view (which is the only view implemented) and finally a mapping
of your static files to the &lt;tt class="docutils literal"&gt;STATIC_URL&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-views"&gt;
&lt;h2&gt;The&amp;nbsp;views&lt;/h2&gt;
&lt;p&gt;There are three views in this application - the &lt;tt class="docutils literal"&gt;HomeTemplateView&lt;/tt&gt;, the &lt;tt class="docutils literal"&gt;TestAuthView&lt;/tt&gt;
and the &lt;tt class="docutils literal"&gt;LogoutViewEx&lt;/tt&gt; view that overrides the normal &lt;tt class="docutils literal"&gt;LogoutView&lt;/tt&gt; of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;django-rest-auth&lt;/span&gt;&lt;/tt&gt;.
The first one is
a simple &lt;tt class="docutils literal"&gt;TemplateView&lt;/tt&gt; that just
displays an html page and loads the client side code - we&amp;#8217;ll talk about it later in the front-side&amp;nbsp;section.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;TestAuthView&lt;/tt&gt; is implemented like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TestAuthView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;APIView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;authentication_classes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authentication&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TokenAuthentication&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;
    &lt;span class="n"&gt;permission_classes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;permissions&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;IsAuthenticated&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Hello {0}!&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is very simple however I&amp;#8217;d like to make a few comments about the above. First of all you see that
I&amp;#8217;ve defined &lt;tt class="docutils literal"&gt;authentication_classes&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;permission_classes&lt;/tt&gt;. These options&amp;nbsp;define&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;which method will be used for authenticating access to the &lt;span class="caps"&gt;REST&lt;/span&gt; view i.e finding out if the user
requesting access has logged in and if yes what&amp;#8217;s his username (in our case the &lt;tt class="docutils literal"&gt;TokenAuthentication&lt;/tt&gt; will be&amp;nbsp;used)&lt;/li&gt;
&lt;li&gt;if the user is authorized (has permission) to call this &lt;span class="caps"&gt;REST&lt;/span&gt; view (in our case only authenticated users will be&amp;nbsp;allowed)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The authentication and permission clases can be set globally
in your &lt;tt class="docutils literal"&gt;settings.py&lt;/tt&gt; using &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;REST_FRAMEWORK['DEFAULT_AUTHENTICATION_CLASSES']&lt;/span&gt;&lt;/tt&gt; and
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;REST_FRAMEWORK['DEFAULT_PERMISSION_CLASSES']&lt;/span&gt;&lt;/tt&gt;
or defined per-class like this. If I wanted to have the same authentication and permission classes defined
in my &lt;tt class="docutils literal"&gt;settings.py&lt;/tt&gt; so I wouldn&amp;#8217;t need to set these options per-class I&amp;#8217;d add the following to my &lt;tt class="docutils literal"&gt;settings.py&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;REST_FRAMEWORK&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;DEFAULT_AUTHENTICATION_CLASSES&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;rest_framework.authentication.TokenAuthentication&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;DEFAULT_PERMISSION_CLASSES&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;rest_framework.permissions.IsAuthenticated&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Finally, keep in mind that you haven&amp;#8217;t defined these in your views or your settings, they will have the
following &lt;a class="reference external" href="http://www.django-rest-framework.org/api-guide/settings/#default_authentication_classes"&gt;default&lt;/a&gt; &lt;a class="reference external" href="http://www.django-rest-framework.org/api-guide/settings/#default_permission_classes"&gt;values&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;REST_FRAMEWORK&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;DEFAULT_AUTHENTICATION_CLASSES&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;rest_framework.authentication.SessionAuthentication&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;rest_framework.authentication.BasicAuthentication&amp;#39;&lt;/span&gt;
    &lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;DEFAULT_PERMISSION_CLASSES&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;rest_framework.permissions.AllowAny&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above mean that if you don&amp;#8217;t define authentication and permission classes anywhere then the &lt;span class="caps"&gt;REST&lt;/span&gt;
views will use either session authentication (i.e the user has logged in normally using
the Django login views as explained before) or basic authentication
(the request provides the credentials in the header using traditional &lt;span class="caps"&gt;HTTP&lt;/span&gt; Basic authentication)
and also that all users (logged in or not) will be allowed to call all APIs (this is
probably not something you&amp;nbsp;want).&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;TokenAuthentication&lt;/tt&gt; that we are using instead means that for every user there must be a valid token which will be provided
for each request he does. The tokens are normal object instances of &lt;tt class="docutils literal"&gt;rest_framework.authtoken.models.Token&lt;/tt&gt;
and you can take a look at them (or even add one) through the Django admin (auth token - tokens). You can also
even do whatever you normally would do to an object instance, for&amp;nbsp;example:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;Token&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt;
&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;db4dcc1b9d00d1af74fb3cb41e1f9e673208485b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To authenticate with a token (using &lt;a class="reference external" href="http://www.django-rest-framework.org/api-guide/authentication/#tokenauthentication"&gt;TokenAuthentication&lt;/a&gt;), you must add an extra header to your request with the format
&lt;tt class="docutils literal"&gt;Authorization: Token token&lt;/tt&gt; for example in the previous case &lt;tt class="docutils literal"&gt;root&lt;/tt&gt; would add
&lt;tt class="docutils literal"&gt;Authorization: Token db4dcc1b9d00d1af74fb3cb41e1f9e673208485b&lt;/tt&gt;. To do this you&amp;#8217;ll need something
client-side code which we&amp;#8217;ll see in the next&amp;nbsp;section.&lt;/p&gt;
&lt;p&gt;To do it with &lt;a class="reference external" href="https://curl.haxx.se"&gt;curl&lt;/a&gt; you can just do something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl http://127.0.0.1:8000/test_auth/ -H &lt;span class="s2"&gt;&amp;quot;Authorization:Token db4dcc1b9d00d1af74fb3cb41e1f9e673208485b&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Try it with a valid and invalid token and without providing a token at all and see the response each&amp;nbsp;time.&lt;/p&gt;
&lt;p&gt;So, django-rest-framework provides the model (Token) and the mechanism (add the extra Authentication header) for
authentication with Tokens. What it does not provide is a simple way to create/remove tokens for users: This
is where &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;django-rest-auth&lt;/span&gt;&lt;/tt&gt; comes to the rescue! Its login and logout &lt;span class="caps"&gt;REST&lt;/span&gt; views will automatically
create (and delete) tokens for the users that are logging in. They will also authenticate the user
normally (using sessions) - this means that if a user logs in using the login &lt;span class="caps"&gt;REST&lt;/span&gt; endpoint he&amp;#8217;ll then
be logged in normally to the site and be able to access non-&lt;span class="caps"&gt;REST&lt;/span&gt; parts of the site (for example the django-admin).
Also, if the user logs in through the django-rest-auth &lt;span class="caps"&gt;REST&lt;/span&gt; end point and if you have are using &lt;tt class="docutils literal"&gt;SessionAuthentication&lt;/tt&gt;
to one of your views then he&amp;#8217;ll be able to authenticate to these views &lt;em&gt;without&lt;/em&gt; the need to pass the token (can
you understand&amp;nbsp;why?).&lt;/p&gt;
&lt;p&gt;Finally, let&amp;#8217;s take a look at the &lt;tt class="docutils literal"&gt;LogoutViewEx&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LogoutViewEx&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LogoutView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;authentication_classes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authentication&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TokenAuthentication&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This class only defines the authentication_classes attribute. Is this really needed? Well, it depends on
you project. If you take a look at the source code of &lt;tt class="docutils literal"&gt;LogoutView&lt;/tt&gt; (&lt;a class="reference external" href="https://github.com/Tivix/django-rest-auth/blob/master/rest_auth/views.py#L99"&gt;https://github.com/Tivix/django-rest-auth/blob/master/rest_auth/views.py#L99&lt;/a&gt;)
you&amp;#8217;ll see that it does not define &lt;tt class="docutils literal"&gt;authentication_classes&lt;/tt&gt;. This, as we&amp;#8217;ve already discussed, means that it will
fall-back to whatever you have defined in the settings (or the defaults of django-rest-framework). So, if you haven&amp;#8217;t
defined anything in the settings then you&amp;#8217;ll get the by default the
SessionAuthentication and BasicAuthentication methods (hint: &lt;em&gt;not&lt;/em&gt; the &lt;tt class="docutils literal"&gt;TokenAuthentication&lt;/tt&gt;). This means that you won&amp;#8217;t be able to
logout when you pass the token (but &lt;em&gt;will&lt;/em&gt; be able to logout from the web-app after you login - why?). So to make everything
crystal and be able to reason better about the behavior I specifically define the &lt;tt class="docutils literal"&gt;LogoutViewEx&lt;/tt&gt; to use the &lt;tt class="docutils literal"&gt;TokenAuthentication&lt;/tt&gt; - that&amp;#8217;s
what you&amp;#8217;d use if you developed a mobile or desktop app&amp;nbsp;anyway.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-client-side-scripts"&gt;
&lt;h2&gt;The client side&amp;nbsp;scripts&lt;/h2&gt;
&lt;p&gt;I&amp;#8217;ve included all client-side code to a &lt;tt class="docutils literal"&gt;home.html&lt;/tt&gt; template that is loaded
from the &lt;tt class="docutils literal"&gt;HomeTemplateView&lt;/tt&gt;. The client-side code has been implemented only with jQuery because I think
this is the library that most people are familiar with - and is really easy to be understood even if you
are not familiar with it. It more or less consists of four sections in&amp;nbsp;html:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A user-is-logged-in section that displays the username and the logout&amp;nbsp;button&lt;/li&gt;
&lt;li&gt;A user-is-not-logged-in section that displays a message and the login&amp;nbsp;button&lt;/li&gt;
&lt;li&gt;A test-auth section that displays a button for calling the &lt;tt class="docutils literal"&gt;TestAuthView&lt;/tt&gt; defined previously and outputs its&amp;nbsp;response&lt;/li&gt;
&lt;li&gt;The login&amp;nbsp;modal&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here&amp;#8217;s the html (using spectre.css for&amp;nbsp;styling):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;container grid-lg&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Test&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;columns&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;non-logged-in&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;column col-3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            You have to log-in!
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;column col-3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;btn btn-primary&amp;quot;&lt;/span&gt;  &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;loginButton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Login&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;columns&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;logged-in&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;column col-3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            Welcome &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;span-username&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;!
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;column col-3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;btn btn-primary&amp;quot;&lt;/span&gt;  &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;logoutButton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Logout&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;hr&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;columns&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;test&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;column col-3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;btn btn-primary&amp;quot;&lt;/span&gt;  &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;testAuthButton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Test auth&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;column col-9&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;test-auth-response&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;modal&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;login-modal&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;#close&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;modal-overlay close-modal&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;aria-label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Close&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;modal-container&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;modal-header&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;#close&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;btn btn-clear float-right close-modal&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;aria-label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Close&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;modal-title h5&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Please login&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;modal-body&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;form&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                    {% csrf_token %}
                    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;form-group&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;label&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;form-label&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;for&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input-username&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Username&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;label&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;input&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;form-input&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input-username&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;placeholder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Name&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;form-group&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;label&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;form-label&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;for&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input-password&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Password&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;label&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;input&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;form-input&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;password&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input-password&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;placeholder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Password&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;form-group&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;label&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;form-checkbox&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;for&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input-local-storage&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;input&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;checkbox&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;input-local-storage&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;i&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;form-icon&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;i&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;  Use local storage (remember me)
                        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;label&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;form&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;label label-error mt-1 d-invisible&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;modal-error&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                    Unable to login!
                &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;modal-footer&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;btn btn-primary&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;loginOkButton&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Ok&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;#close&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;btn close-modal&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Close&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The html is very simple and I don&amp;#8217;t think I need to explain much  - notice that the &lt;cite&gt;#logged-in&lt;/cite&gt; and
&lt;cite&gt;#non-logged-in&lt;/cite&gt; sections are mutually exclusive (I use &lt;tt class="docutils literal"&gt;$.show()&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;$.hide()&lt;/tt&gt; to show and hide them) but the &lt;cite&gt;#test&lt;/cite&gt; section is always displayed
so you&amp;#8217;ll be able to call the test &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; when you are and are not authenticated. For the modal
to be displayed you need to add an &lt;tt class="docutils literal"&gt;active&lt;/tt&gt; class to its &lt;tt class="docutils literal"&gt;#modal&lt;/tt&gt; container.&lt;/p&gt;
&lt;p&gt;For the javascript, let&amp;#8217;s take a look at some initialization&amp;nbsp;stuff:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;g_urls&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;login&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{% url &amp;quot;rest_login&amp;quot; %}&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;logout&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{% url &amp;quot;rest_logout&amp;quot; %}&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;test_auth&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{% url &amp;quot;test_auth&amp;quot; %}&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;g_auth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;auth&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;g_auth&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;g_auth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;sessionStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;auth&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;g_auth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;JSON&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;catch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;g_auth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;getCookie&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;cookieValue&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;cookie&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;cookie&lt;/span&gt; &lt;span class="o"&gt;!==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;cookies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;cookie&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="nx"&gt;cookies&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;cookie&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;jQuery&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;trim&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cookies&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
            &lt;span class="c1"&gt;// Does this cookie string begin with the name we want?&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cookie&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;substring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;=&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;cookieValue&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;decodeURIComponent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cookie&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;substring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;cookieValue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;g_csrftoken&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;getCookie&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;csrftoken&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;initLogin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#non-logged-in&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;hide&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#logged-in&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;show&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#span-username&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;username&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;remember_me&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;auth&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;JSON&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;stringify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;sessionStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;auth&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;JSON&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;stringify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#non-logged-in&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;show&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#logged-in&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;hide&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#span-username&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;localStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;removeItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;auth&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;sessionStorage&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;removeItem&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;auth&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#test-auth-response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;First of all, I define a &lt;tt class="docutils literal"&gt;g_urls&lt;/tt&gt; window/global object that will keep the required &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;URLS&lt;/span&gt; (login/logout and test auth). These
are retrieved from Django using the &lt;tt class="docutils literal"&gt;{% url %}&lt;/tt&gt; template tag and are not hard-coded.
After that, I check to see if the user has authenticated before. Notice that because
this is client-side code, I need to do that every time the page loads or else the &lt;span class="caps"&gt;JS&lt;/span&gt; won&amp;#8217;t be initialized properly! The user login
information is stored to an object named &lt;tt class="docutils literal"&gt;g_auth&lt;/tt&gt; and contains two attributes: &lt;tt class="docutils literal"&gt;username&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;key&lt;/tt&gt; (token) and &lt;tt class="docutils literal"&gt;remember_me&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;To keep the login information I use either a key named &lt;tt class="docutils literal"&gt;auth&lt;/tt&gt; to either the &lt;tt class="docutils literal"&gt;localStorage&lt;/tt&gt; or the &lt;tt class="docutils literal"&gt;sessionStorage&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;sessionStorage&lt;/tt&gt; is used to save
info for the current browser tab (&lt;em&gt;not&lt;/em&gt; window) while the &lt;tt class="docutils literal"&gt;localStorage&lt;/tt&gt; saves info for ever (until somebody deletes it). Thus,
&lt;tt class="docutils literal"&gt;localStorage&lt;/tt&gt; can be used for implementing a &amp;#8220;remember me&amp;#8221; functionality. Notice that instead of using the session/local storage
I could instead integrate the user login information with the Django back-end. To do this I&amp;#8217;d need to see if the current user has
a session login and if yes pass his username and token to  Javascript. These values would then be read by the login initialization
code. I&amp;#8217;m leaving this as an exercise for attentive&amp;nbsp;readers.&lt;/p&gt;
&lt;p&gt;Getting the login information from the session probably is a better solution for web-apps however I think that using the local or session storage emulate better a more
general (and completely stateless) behaviour especially considering that the &lt;span class="caps"&gt;API&lt;/span&gt; may be used for mobible/desktop&amp;nbsp;apps.&lt;/p&gt;
&lt;p&gt;In any case, after you&amp;#8217;ve initialized the &lt;tt class="docutils literal"&gt;g_auth&lt;/tt&gt; object you&amp;#8217;ll need to read the &lt;span class="caps"&gt;CSRF&lt;/span&gt; cookie. By default Django requires
&lt;a class="reference external" href="https://docs.djangoproject.com/en/2.0/ref/csrf/"&gt;&lt;span class="caps"&gt;CSRF&lt;/span&gt; protection&lt;/a&gt; for all &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; requests (we do a &lt;span class="caps"&gt;POST&lt;/span&gt; request for login and logout). What happens here is that for pages that may
need to do a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; request, Django will set a cookie (&lt;span class="caps"&gt;CSRF&lt;/span&gt; cookie) in its initial response. You&amp;#8217;ll need to read that cookie and submit its
value along with the rest of your form fields when you do the &lt;span class="caps"&gt;POST&lt;/span&gt;. So the &lt;tt class="docutils literal"&gt;getCookie&lt;/tt&gt; function is just used to set the &lt;tt class="docutils literal"&gt;g_csrftoken&lt;/tt&gt; with the value
of the &lt;span class="caps"&gt;CSRF&lt;/span&gt;&amp;nbsp;cookie.&lt;/p&gt;
&lt;p&gt;The final function we define here (which is called a little later) checks to see if there is login information and hides/displays the correct
things in html. It will also set the local or session storage (depending on remember me&amp;nbsp;value).&lt;/p&gt;
&lt;p&gt;After that, we have some client side code that is inside the &lt;tt class="docutils literal"&gt;$()&lt;/tt&gt; function which will be called after the page has completely&amp;nbsp;loaded:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;initLogin&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#loginButton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;click&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#login-modal&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;addClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;active&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;

    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.close-modal&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;click&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#login-modal&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;removeClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;active&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;

    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#testAuthButton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;click&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ajax&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
            &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;g_urls&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;test_auth&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nx"&gt;method&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;GET&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nx"&gt;beforeSend&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setRequestHeader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Authorization&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Token &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#test-auth-response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;lt;span class=&amp;#39;label label-success&amp;#39;&amp;gt;Ok! Response: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;fail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#test-auth-response&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;lt;span class=&amp;#39;label label-error&amp;#39;&amp;gt;Fail! Response: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;responseText&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; (status: &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;status&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;)&amp;lt;/span&amp;gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;


    &lt;span class="c1"&gt;// continuing below ...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The first thing happening here is to call the &lt;tt class="docutils literal"&gt;initLogin&lt;/tt&gt; function to properly intiialize the page and then we add a couple of
handlers to the click buttons of the &lt;tt class="docutils literal"&gt;#loginButton&lt;/tt&gt; (which just displays the modal by adding the &lt;tt class="docutils literal"&gt;active&lt;/tt&gt; class ),
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;.close-modal&lt;/span&gt;&lt;/tt&gt; class (there are multiple
ways to close the modal thus I use a class which just removes that &lt;tt class="docutils literal"&gt;active&lt;/tt&gt; class) and finally to the &lt;tt class="docutils literal"&gt;#testAuthButton&lt;/tt&gt;. This
button will do a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; request to the &lt;tt class="docutils literal"&gt;g_urls.test_auth&lt;/tt&gt; we defined before. The important thing to notice here is that we add
a &lt;tt class="docutils literal"&gt;beforeSend&lt;/tt&gt; attribute to the &lt;tt class="docutils literal"&gt;$.ajax&lt;/tt&gt; request which, if &lt;tt class="docutils literal"&gt;g_auth&lt;/tt&gt; is defined adds an &lt;tt class="docutils literal"&gt;Authorization&lt;/tt&gt; header with the token
in the form that django-rest-framework &lt;tt class="docutils literal"&gt;TokenAuthentication&lt;/tt&gt; expects and as we&amp;#8217;ve already discussed&amp;nbsp;above:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;beforeSend&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setRequestHeader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Authorization&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Token &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If this ajax call returns ok (&lt;tt class="docutils literal"&gt;done&lt;/tt&gt; part) we just add the &lt;tt class="docutils literal"&gt;Ok&lt;/tt&gt; to a green label else if there&amp;#8217;s an error (&lt;tt class="docutils literal"&gt;fail&lt;/tt&gt; part)
we add the response text and status to a red label. You can try clicking the button and you see that only if you&amp;#8217;ve logged in
you will succeed in this&amp;nbsp;call.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s now take a look at the &lt;tt class="docutils literal"&gt;#loginOkbutton&lt;/tt&gt; click handler (inside the&amp;nbsp;modal):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#loginOkButton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;click&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#input-username&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#input-password&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;remember_me&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#input-local-storage&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;prop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;checked&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;username&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nx"&gt;password&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Will try to login with &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;password&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#modal-error&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;addClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;d-invisible&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ajax&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
            &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;g_urls&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;login&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nx"&gt;method&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;POST&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;username&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;password&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;password&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;csrfmiddlewaretoken&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;g_csrftoken&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;DONE: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;g_auth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;username&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;remember_me&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;remember_me&lt;/span&gt;
            &lt;span class="p"&gt;};&lt;/span&gt;
            &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#login-modal&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;removeClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;active&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;initLogin&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="c1"&gt;// CAREFUL! csrf token is rotated after login: https://docs.djangoproject.com/en/1.7/releases/1.5.2/#bugfixes&lt;/span&gt;
            &lt;span class="nx"&gt;g_csrftoken&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;getCookie&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;csrftoken&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;fail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;FAIL&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#modal-error&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;removeClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;d-invisible&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#modal-error&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;removeClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;d-invisible&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;All three user inputs (&lt;tt class="docutils literal"&gt;username, password, remember_me&lt;/tt&gt;) are read from the form and if both username and
password have been defined an Ajax request will be done to the &lt;tt class="docutils literal"&gt;g_urls.login&lt;/tt&gt; url. We pass
&lt;tt class="docutils literal"&gt;username, password&lt;/tt&gt; &lt;em&gt;and&lt;/em&gt; &lt;tt class="docutils literal"&gt;g_csrftoken&lt;/tt&gt; (as discussed before) as the request data. Now, if there&amp;#8217;s an
error (&lt;tt class="docutils literal"&gt;fail&lt;/tt&gt;) I just display a generic message (by removing it&amp;#8217;s &lt;cite&gt;d-invisible&lt;/cite&gt; class) while, if the
request was Ok I retrieve the &lt;tt class="docutils literal"&gt;key&lt;/tt&gt; (token) from the response, initialize the &lt;tt class="docutils literal"&gt;g_auth&lt;/tt&gt; object with the
&lt;tt class="docutils literal"&gt;username&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;key&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;remember_me&lt;/tt&gt; values and call &lt;tt class="docutils literal"&gt;initLogin&lt;/tt&gt; to show the correct divs and save
to the session/local&amp;nbsp;storage.&lt;/p&gt;
&lt;p&gt;It is important to keep in mind that with the line &lt;tt class="docutils literal"&gt;g_csrftoken = &lt;span class="pre"&gt;getCookie('csrftoken')&lt;/span&gt;&lt;/tt&gt;
we re-read the &lt;span class="caps"&gt;CSRF&lt;/span&gt; cookie. This is needed because, as you can see in the mentioned link in the comment,
after Django logs in, the csrf cookie value is rotated for security reasons so it must be re-read here (or else
the &lt;tt class="docutils literal"&gt;logout&lt;/tt&gt; that is also a &lt;span class="caps"&gt;POST&lt;/span&gt; request will not&amp;nbsp;work).&lt;/p&gt;
&lt;p&gt;Finally, here&amp;#8217;s the code for logout (still inside the &lt;tt class="docutils literal"&gt;$(function () {&lt;/tt&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#logoutButton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;click&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Trying to logout&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ajax&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
            &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;g_urls&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;logout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nx"&gt;method&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;POST&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="nx"&gt;beforeSend&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setRequestHeader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Authorization&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Token &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;g_auth&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="p"&gt;},&lt;/span&gt;
            &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;csrfmiddlewaretoken&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;g_csrftoken&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;done&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;DONE: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;g_auth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="nx"&gt;initLogin&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;fail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;FAIL: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;

&lt;span class="p"&gt;});&lt;/span&gt; &lt;span class="c1"&gt;// End of $(function () {&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The code here is very simple - just do a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; to the &lt;tt class="docutils literal"&gt;g_urls.logout&lt;/tt&gt;  and if everything is ok delete the &lt;tt class="docutils literal"&gt;g_auth&lt;/tt&gt; values
and call &lt;tt class="docutils literal"&gt;initLogin()&lt;/tt&gt; to show the correct divs and remove the &lt;tt class="docutils literal"&gt;auth&lt;/tt&gt; key from local/session storage. Notice that when
you &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; to the &lt;tt class="docutils literal"&gt;logout&lt;/tt&gt; &lt;span class="caps"&gt;REST&lt;/span&gt; end-point, you need to also add the &lt;tt class="docutils literal"&gt;Authorization&lt;/tt&gt; header with the token or else
(since we&amp;#8217;ve defined only &lt;tt class="docutils literal"&gt;TokenAuthentication&lt;/tt&gt; for the &lt;tt class="docutils literal"&gt;authentication_classes&lt;/tt&gt; for the &lt;tt class="docutils literal"&gt;LogoutViewEx&lt;/tt&gt; class)
there won&amp;#8217;t be any way to correlate the request with the user and log him&amp;nbsp;out!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Using the info presented on this article you should be able to properly login and logout to Django using &lt;span class="caps"&gt;REST&lt;/span&gt; and
also call &lt;span class="caps"&gt;REST&lt;/span&gt; end-points as an authenticated used. I recommend using the &lt;tt class="docutils literal"&gt;curl&lt;/tt&gt; utility to try to call the rest
end point with various parameters to see the response. Also, you change the &lt;tt class="docutils literal"&gt;LogoutViewEx&lt;/tt&gt; with the
default django-rest-auth &lt;tt class="docutils literal"&gt;LogoutView&lt;/tt&gt; and then try logging out through the web-app &lt;em&gt;and&lt;/em&gt; through curl and see
what happens when you try to access the test-auth&amp;nbsp;end-point.&lt;/p&gt;
&lt;p&gt;Finally, the above project can be easily modified to use
&lt;tt class="docutils literal"&gt;SessionAuthentication&lt;/tt&gt; instead of &lt;tt class="docutils literal"&gt;TokenAuthentication&lt;/tt&gt; (so you won&amp;#8217;t need &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;django-rest-auth&lt;/span&gt;&lt;/tt&gt; at all) - I&amp;#8217;m
leaving it as an exercise to the&amp;nbsp;reader.&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="django-rest-auth"></category><category term="rest"></category><category term="django-rest-framework"></category><category term="authentication"></category><category term="python"></category></entry><entry><title>Using both Python 2 and 3 inÂ Windows</title><link href="https://spapas.github.io/2017/12/20/python-2-3-windows/" rel="alternate"></link><published>2017-12-20T11:20:00+02:00</published><updated>2017-12-20T11:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2017-12-20:/2017/12/20/python-2-3-windows/</id><summary type="html">&lt;p class="first last"&gt;How to install and use both Python 2.x and 3.x on&amp;nbsp;Windows&lt;/p&gt;
</summary><content type="html">&lt;p&gt;The release of Django 2.0 was a milestone in the history of Python since it
completely dropped support for Python 2.x. I am a long time user of Django
and, loyal to the philosophy of &amp;#8220;if it is working don&amp;#8217;t change&amp;#8221; I was always
using Python&amp;nbsp;2.x.&lt;/p&gt;
&lt;p&gt;Of course right now this needs to change since new applications will need to
be developed to the latest version of Django (and Python). I am using
Windows for development (almost exclusively) and what I wanted was to
be able to create and use virtual environments for both my old projects
(using Python 2) and new projects (using Python&amp;nbsp;3).&lt;/p&gt;
&lt;p&gt;The above requirement is not as straight-forward as I&amp;#8217;d like - actually it is
if you know what you need to do and which tools you must use. That&amp;#8217;s why I
decided to write a quick step by step tutorial on how to use both versions
of Python in your Windows environment. Notice that I am using Windows 10,
Python 2.7.14 an Python&amp;nbsp;3.6.4.&lt;/p&gt;
&lt;p&gt;First of all, let&amp;#8217;s download both versions of Python
from the &lt;a class="reference external" href="https://www.python.org/downloads/"&gt;Python download page&lt;/a&gt;. I downloaded the files
python-2.7.14.msi and python-3.6.4.exe (not sure why the one is .msi and the other
is .exe it doesn&amp;#8217;t matter&amp;nbsp;anyway).&lt;/p&gt;
&lt;p&gt;Firstly I am installing Python 2.7.14 and&amp;nbsp;selecting:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Install for all&amp;nbsp;users&lt;/li&gt;
&lt;li&gt;Install to default&amp;nbsp;folder&lt;/li&gt;
&lt;li&gt;Press next to following screen (install default&amp;nbsp;customizations)&lt;/li&gt;
&lt;li&gt;This won&amp;#8217;t add the python.exe of Python 2.7 to&amp;nbsp;path&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Next I am install Python&amp;nbsp;3.6.4:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Make sure to click &amp;#8220;Install launcher for all users&amp;nbsp;(recommended)&amp;#8221;&lt;/li&gt;
&lt;li&gt;I also check &amp;#8220;Add Python 3.6to &lt;span class="caps"&gt;PATH&lt;/span&gt;&amp;#8221; (to add the Python 3.6 executable to&amp;nbsp;path)&lt;/li&gt;
&lt;li&gt;I then just click &amp;#8220;Install Now&amp;#8221; (this will put Python 3.6 to&amp;nbsp;c:)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Right now if you open a terminal window (Windows+r, cmd.exe) and run Python you will
initiate the Python 3.6 interpreter. This is useful for just dropping in a Python&amp;nbsp;interpreter.&lt;/p&gt;
&lt;p&gt;Remember the &amp;#8220;Install launcher for all users (recommended)&amp;#8221; we clicked before? This installs
the python launcher which is used to select between Python versions.
If you run it without parameters the Python 3.6 interpreter will by started. You can pass
the -2 parameter to start the python 2.x interpreter or -3 to explicitly declare the
python 3.x&amp;nbsp;interpreter:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
C:\Users\Serafeim&amp;gt;py -2
Python 2.7.14 (v2.7.14:84471935ed, Sep 16 2017, 20:19:30) [MSC v.1500 32 bit (Intel)] on win32
Type &amp;quot;help&amp;quot;, &amp;quot;copyright&amp;quot;, &amp;quot;credits&amp;quot; or &amp;quot;license&amp;quot; for more information.
&amp;gt;&amp;gt;&amp;gt; ^Z


C:\Users\Serafeim&amp;gt;py -3
Python 3.6.4 (v3.6.4:d48eceb, Dec 19 2017, 06:04:45) [MSC v.1900 32 bit (Intel)] on win32
Type &amp;quot;help&amp;quot;, &amp;quot;copyright&amp;quot;, &amp;quot;credits&amp;quot; or &amp;quot;license&amp;quot; for more information.
&amp;gt;&amp;gt;&amp;gt; ^Z
&lt;/pre&gt;
&lt;p&gt;With py we can easily start the Python interpreter we want. This is not enough though - we
need to use virtualenv and create proper virtual environments for our projects. To do this
you can add the -m option to py to run a module with the proper python version. For example,
to start an http server with Python 2 you would use the module &lt;tt class="docutils literal"&gt;SimpleHTTPServer&lt;/tt&gt; while
for python 3 you would use &lt;tt class="docutils literal"&gt;http.server&lt;/tt&gt; (&lt;a class="reference external" href="https://stackoverflow.com/questions/7943751/what-is-the-python-3-equivalent-of-python-m-simplehttpserver"&gt;as per this&lt;/a&gt;):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
C:\progr\py\pelican\spapas.github.io&amp;gt;py -2 -m SimpleHTTPServer
Serving HTTP on 0.0.0.0 port 8000 ...

C:\progr\py\pelican\spapas.github.io&amp;gt;py -3 -m http.server
Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
&lt;/pre&gt;
&lt;p&gt;Now, to create the virtual environments we&amp;#8217;ll use the virtualenv module which is installed
by default in Python 2.x (try running &lt;tt class="docutils literal"&gt;py &lt;span class="pre"&gt;-2&lt;/span&gt; &lt;span class="pre"&gt;-m&lt;/span&gt; pip freeze&lt;/tt&gt; to see the list of installed
packages for Python 2.x) and the venv module which is included in the Python 3.x core. So
to create a virtualenv for Python 2 we&amp;#8217;ll run &lt;tt class="docutils literal"&gt;py &lt;span class="pre"&gt;-2&lt;/span&gt; &lt;span class="pre"&gt;-m&lt;/span&gt; virtualenv &lt;span class="pre"&gt;name-of-virtualenv&lt;/span&gt;&lt;/tt&gt;
and for Python 3 &lt;tt class="docutils literal"&gt;py &lt;span class="pre"&gt;-3&lt;/span&gt; &lt;span class="pre"&gt;-m&lt;/span&gt; venv &lt;span class="pre"&gt;name-of-virtualenv&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
C:\progr\py&amp;gt;py -2 -m virtualenv venv-2
New python executable in C:\progr\py\venv-2\Scripts\python.exe
Installing setuptools, pip, wheel...done.

C:\progr\py&amp;gt;py -3 -m venv venv-3

C:\progr\py&amp;gt;venv-2\Scripts\activate

(venv-2) C:\progr\py&amp;gt;python -V
Python 2.7.14

(venv-2) C:\progr\py&amp;gt;deactivate

C:\progr\py&amp;gt;venv-3\Scripts\activate

(venv-3) C:\progr\py&amp;gt;python -V
Python 3.6.4
&lt;/pre&gt;
&lt;p&gt;That&amp;#8217;s how easy it is to have both Python 2.7 and Python 3.6 in your&amp;nbsp;Windows!&lt;/p&gt;
</content><category term="python"></category><category term="python"></category><category term="python-2"></category><category term="python-3"></category><category term="windows"></category></entry><entry><title>My essential django packageÂ list</title><link href="https://spapas.github.io/2017/10/11/essential-django-packages/" rel="alternate"></link><published>2017-10-11T14:20:00+03:00</published><updated>2017-10-11T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2017-10-11:/2017/10/11/essential-django-packages/</id><summary type="html">&lt;p class="first last"&gt;A list of packages (add-ons) that I use in most of my&amp;nbsp;projects&lt;/p&gt;
</summary><content type="html">&lt;p&gt;In this article I&amp;#8217;d like to present a list of django packages (add-ons) that I use
in most of my projects. I am using django for more than 5 years as my day to
day work tool to develop applications for the public sector organization I work for.
So please keep in mind that these packages are targeted to the &amp;#8220;enterpripse&amp;#8221;
audience and some things that target public (open access) web apps may be&amp;nbsp;missing.&lt;/p&gt;
&lt;p&gt;Some of these packages are included in
&lt;a class="reference external" href="https://github.com/spapas/cookiecutter-django-starter"&gt;a django cookiecutter&lt;/a&gt; I am using to start new projects and also you can find
example usage of some of these packages in my &lt;a class="reference external" href="https://github.com/spapas/mailer_server"&gt;Mailer Server&lt;/a&gt; project.
I&amp;#8217;ll also be happy to answer any
questions about these, preferably in &lt;a class="reference external" href="https://stackoverflow.com"&gt;stackoverflow&lt;/a&gt; if the questions are fit for that&amp;nbsp;site.&lt;/p&gt;
&lt;p&gt;Finally, before going to the package list, notice that most of the following are django-related and I won&amp;#8217;t include any
generic python packages (with the exception of xhtml2pdf which I discuss later). There
are a bunch of python-generic packages that I usually use (xlrd, xlwt, requests, raven, unidecode,
database connectors etc) but these won&amp;#8217;t be discussed&amp;nbsp;here.&lt;/p&gt;
&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#packages-i-use-in-all-my-projects" id="id30"&gt;Packages I use in all my projects&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-tables2" id="id31"&gt;django-tables2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-filter" id="id32"&gt;django-filter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-crispy-forms" id="id33"&gt;django-crispy-forms&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-extensions" id="id34"&gt;django-extensions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-autocomplete-light" id="id35"&gt;django-autocomplete-light&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-reversion" id="id36"&gt;django-reversion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-compressor" id="id37"&gt;django-compressor&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-debug-toolbar" id="id38"&gt;django-debug-toolbar&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#packages-i-use-when-i-need-their-functionality" id="id39"&gt;Packages I use when I need their functionality&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#xhtml2pdf" id="id40"&gt;xhtml2pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-auth-ldap" id="id41"&gt;django-auth-ldap&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-localflavor" id="id42"&gt;django-localflavor&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-constance" id="id43"&gt;django-constance&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-rq" id="id44"&gt;django-rq&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-rules-light" id="id45"&gt;django-rules-light&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-generic-scaffold" id="id46"&gt;django-generic-scaffold&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-taggit" id="id47"&gt;django-taggit&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-sendfile" id="id48"&gt;django-sendfile&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-reversion-compare" id="id49"&gt;django-reversion-compare&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-simple-history" id="id50"&gt;django-simple-history&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-import-export" id="id51"&gt;django-import-export&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-extra-views" id="id52"&gt;django-extra-views&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#easy-thumbnails" id="id53"&gt;easy-thumbnails&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-rest-framework" id="id54"&gt;django-rest-framework&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-waffle" id="id55"&gt;django-waffle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-allauth" id="id56"&gt;django-allauth&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-modeltranslation" id="id57"&gt;django-modeltranslation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-widget-tweaks" id="id58"&gt;django-widget-tweaks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-simple-captcha" id="id59"&gt;django-simple-captcha&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#wagtail" id="id60"&gt;wagtail&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id61"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="packages-i-use-in-all-my-projects"&gt;
&lt;h2&gt;Packages I use in all my&amp;nbsp;projects&lt;/h2&gt;
&lt;p&gt;These packages are used more or less in all my projects - I just install them when I
create a new project (or create the project through the cookiecutter I mention&amp;nbsp;above)/&lt;/p&gt;
&lt;div class="section" id="django-tables2"&gt;
&lt;h3&gt;django-tables2&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/bradleyayers/django-tables2"&gt;django-tables2&lt;/a&gt;, along with django-filter (following) are the two packages
I always use in my projets. You create a &lt;cite&gt;tables.py&lt;/cite&gt; module inside your applications
where you define a bunch of tables using more or less the same methodology as with
django-forms: For a &lt;cite&gt;Book&lt;/cite&gt; model, Create a &lt;cite&gt;BookTable&lt;/cite&gt; class, relate it with the model
and, if needed override some of the columns it automatically generates. For example you
can configure a column that will behave as a link to a detail view of the book, a column
that will behave as a date (with the proper formatting) or even a column that will display
a custom django template&amp;nbsp;snippet.&lt;/p&gt;
&lt;p&gt;You&amp;#8217;ll then be
able to configure the data (queryset) of this table and pass it your views context. Finally
use &lt;tt class="docutils literal"&gt;{% render_table table %}&lt;/tt&gt; to actually display your table. What
you&amp;#8217;ll get? The actual html table (with a nice style that can be configured if needed),
free pagination and free column-header sorting. After you get the hang of it, you&amp;#8217;ll be
able to add tables for your models in a couple of minutes - this is &lt;span class="caps"&gt;DRY&lt;/span&gt; for me. It also
offers some &lt;a class="reference external" href="http://django-tables2.readthedocs.io/en/latest/pages/generic-mixins.html"&gt;class based views and mixins&lt;/a&gt; for even more &lt;span class="caps"&gt;DRY&lt;/span&gt; adding tables to your&amp;nbsp;views.&lt;/p&gt;
&lt;p&gt;Finally, please notice that since version 1.8,
django-tables2 &lt;a class="reference external" href="https://django-tables2.readthedocs.io/en/latest/pages/export.html"&gt;supports exporting data&lt;/a&gt; using &lt;a class="reference external" href="https://github.com/kennethreitz/tablib"&gt;tablib&lt;/a&gt;, an old requirement of most users
of this&amp;nbsp;library.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-filter"&gt;
&lt;h3&gt;django-filter&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/carltongibson/django-filter"&gt;django-filter&lt;/a&gt; is used to create filters for your data. It plays well with
django-tables2 but you can use it to create filters for any kind of listing you want. It
works similar to django-tables2: Create a &lt;tt class="docutils literal"&gt;filters.py&lt;/tt&gt; module in your application and define
the a &lt;cite&gt;BookFilter&lt;/cite&gt; class there by relating it with the &lt;cite&gt;Book&lt;/cite&gt; model, specifying the fields
of the model you want to filter with and maybe override some of the default options. New versions
have some great built-in configuration functionality by customizing which method will be used for
filtering or even adding multiple filter methods - for example you could define your
&lt;tt class="docutils literal"&gt;BookFilter&lt;/tt&gt; like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class BookFilter(django_filters.FilterSet):
    class Meta:
        model = Book
        fields = {
            'name': ['icontains'],
            'author__last_name': ['icontains', 'startswith'],
            'publication_date': ['year', 'month', ],
        }
&lt;/pre&gt;
&lt;p&gt;which will give you the following filter form&amp;nbsp;fields:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;an ilike &amp;#8216;%value%&amp;#8217; for the book&amp;nbsp;name&lt;/li&gt;
&lt;li&gt;an ilike &amp;#8216;%value%&amp;#8217; for the author&amp;nbsp;name&lt;/li&gt;
&lt;li&gt;a like &amp;#8216;value%&amp;#8217; for the author&amp;nbsp;name&lt;/li&gt;
&lt;li&gt;a year(publication_date) = value for the&amp;nbsp;publication_date&lt;/li&gt;
&lt;li&gt;a month(publication_date) = value for the&amp;nbsp;publication_date&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;and their (&lt;span class="caps"&gt;AND&lt;/span&gt;)&amp;nbsp;combinations!&lt;/p&gt;
&lt;p&gt;The &lt;cite&gt;BookFilter&lt;/cite&gt; can be used to create a filter form in your template and then in your views
pass to it the initial queryset along with &lt;cite&gt;request.&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/cite&gt; (which will contain the filter values)
to return the filtered data (and usually pass it to the table). I&amp;#8217;ve created a sample project that
uses both django-tables2 and django-filters for you to use: &lt;a class="reference external" href="https://github.com/spapas/django_table_filtering"&gt;https://github.com/spapas/django_table_filtering&lt;/a&gt;.
Also, I&amp;#8217;ve written an article which describes a technique for &lt;a class="reference external" href="https://spapas.github.io/2015/10/05/django-dynamic-tables-similar-models/"&gt;automatically creating a filter-table view&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-crispy-forms"&gt;
&lt;h3&gt;django-crispy-forms&lt;/h3&gt;
&lt;p&gt;The forms that are created by default by django-forms are very basic and not styled properly.
To overcome this and have better styles for my forms, I always use &lt;a class="reference external" href="https://github.com/django-crispy-forms/django-crispy-forms"&gt;django-crispy-forms&lt;/a&gt;. It actually has two modes: Using the crispy template filter and using
the crispy template tag. Using the crispy template filter is very simple - just take a plain old django form and
render it in your template like this &lt;cite&gt;{{ form|crispy }}&lt;/cite&gt;. If the django-crispy-forms has been configured correctly
(with the correct template pack) the form you&amp;#8217;ll get will be much nicer than the django-default one. This is completely
automatic, you don&amp;#8217;t need to do anything&amp;nbsp;else!&lt;/p&gt;
&lt;p&gt;Now, if you have some special requirements from a form, for example
multi-column rendering, adding tabs, accordions etc then you&amp;#8217;ll need to use the &lt;cite&gt;{% crispy %}&lt;/cite&gt; template tag. To use this
you must create the layout of your form in the form&amp;#8217;s costructor using the FormHelper django-crispy-forms &lt;span class="caps"&gt;API&lt;/span&gt;. This may seem cumbersome
at first (why not just create the form&amp;#8217;s layout in the django template) but using a class to define your form&amp;#8217;s layout
has other advantages, for example all the form layout is in the actual form (not in the template) you can control
programatically the layout of the form (f.e display some fields only for administrators), you can use inheritance and
virtual methods to override how a form is rendered&amp;nbsp;etc.&lt;/p&gt;
&lt;p&gt;To help you understand how a &lt;tt class="docutils literal"&gt;FormHelper&lt;/tt&gt; looks like, here&amp;#8217;s a form that is used to edit an access Card for visitors that
displays all fields horizontally inside a panel (I am using Bootstrap for all styling and layout&amp;nbsp;purposes):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class CardForm(ModelForm):
    class Meta:
        model = Card
        fields = ['card_number', 'card_text', 'enabled']

    def __init__(self, *args, **kwargs):
        self.helper = FormHelper()
        self.helper.form_method = 'post'
        self.helper.layout = Layout(
            Fieldset(
                '',
                HTML(u&amp;quot;&amp;quot;&amp;quot;&amp;lt;div class=&amp;quot;panel panel-primary&amp;quot;&amp;gt;
                   &amp;lt;div class=&amp;quot;panel-heading&amp;quot;&amp;gt;
                       &amp;lt;h3 class=&amp;quot;panel-title&amp;quot;&amp;gt;Add card&amp;lt;/h3&amp;gt;
                   &amp;lt;/div&amp;gt;
                   &amp;lt;div class=&amp;quot;panel-body&amp;quot;&amp;gt;&amp;quot;&amp;quot;&amp;quot;),
                Div(
                   Div('card_number', css_class='col-md-4'),
                   Div('card_text', css_class='col-md-4'),
                   Div('enable',css_class='col-md-4'),
                   css_class='row'
                ),
            ),

            FormActions(
                Submit('submit', u'Save', css_class='btn btn-success'),
                HTML(u&amp;quot;&amp;lt;a class='btn btn-primary' href='{% url \&amp;quot;card_list\&amp;quot; %}'&amp;gt;Return&amp;lt;/a&amp;gt;&amp;quot; ),
            ),
            HTML(u&amp;quot;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;&amp;quot;),
        )

        super(CardForm, self).__init__(*args, **kwargs)
&lt;/pre&gt;
&lt;p&gt;Notice that forms that will be rendered with a &lt;tt class="docutils literal"&gt;FormHelper&lt;/tt&gt; actually contain their &amp;lt;form&amp;gt; tag (you don&amp;#8217;t need
to write it yourself like with plain django forms) so you have to define their method (post in this example) and submit&amp;nbsp;button.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-extensions"&gt;
&lt;h3&gt;django-extensions&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/django-extensions/django-extensions"&gt;django-extensions&lt;/a&gt; is a swiss-army-knife of django tools. I use it &lt;em&gt;always&lt;/em&gt; in my projects because of the &lt;cite&gt;runserver_plus&lt;/cite&gt;
and &lt;cite&gt;shell_plus&lt;/cite&gt; commands. The first uses the &lt;a class="reference external" href="https://spapas.github.io/2016/06/07/django-werkzeug-debugger/"&gt;Werkzeug debugger with django&lt;/a&gt; which makes django development an absolute joy
(open a python shell wherever you want in your code and start writing commands)!
The second opens a &lt;em&gt;better&lt;/em&gt; shell (your models and a bunch of django stuff are auto-imported, a better shall will be used if found&amp;nbsp;etc).&lt;/p&gt;
&lt;p&gt;The
&lt;cite&gt;runserver_plus&lt;/cite&gt; and &lt;cite&gt;shell_plus&lt;/cite&gt; alone will be more than enough for me to use this however it adds some more usefull management
commands like: &lt;cite&gt;admin_generator&lt;/cite&gt; to quickly create an admin.py for your app, &lt;cite&gt;graph_models&lt;/cite&gt; to generate a graphviz dot file of your models,
&lt;cite&gt;update_permissions&lt;/cite&gt; to synchronize the list of permissions if you have added one to an existing model and &lt;a class="reference external" href="http://django-extensions.readthedocs.io/en/latest/command_extensions.html"&gt;many, many others&lt;/a&gt;. Take a look
at them and you&amp;#8217;ll probably find more useful&amp;nbsp;things!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-autocomplete-light"&gt;
&lt;h3&gt;django-autocomplete-light&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/yourlabs/django-autocomplete-light"&gt;django-autocomplete-light&lt;/a&gt; is the best auto-complete library for django, especially after v3 was released (which greatly reduces the magic and
uses normal CBVs for configuring the querysets). You will create
an AutocompleteView for a model (similar to your other class based views) and then automatically use this view through a widget in the admin
or in your own forms. It is fully configurable (both the results and the selection templates), supports many to many fields, creating new instances
and even autocompleteing django-taggit tags! If for some reason it seems that it is not working please keep in mind that you need to includ
jquery &lt;em&gt;and&lt;/em&gt; &lt;tt class="docutils literal"&gt;{{ form.media }}&lt;/tt&gt; to your templates or else the required client side code won&amp;#8217;t be&amp;nbsp;executed.&lt;/p&gt;
&lt;p&gt;I think it is an essential for all cases because dropdowns with lots of choices have a very bad user experience - and the same is true with
many to many fields (you could use the checkboxes widget to improve their behavior a little but you will have bad behavior when there are many&amp;nbsp;choices).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-reversion"&gt;
&lt;h3&gt;django-reversion&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/etianen/django-reversion"&gt;django-reversion&lt;/a&gt; is a really important package for my projects. When it is configured properly (by adding a a reversion-middleware), it offers full auditing
for all changes in the your model instances you select (and properly groups them in case of changes to multiple instances in a simple request).
It saves a &lt;span class="caps"&gt;JSON&lt;/span&gt; representation
of all the versions of an instance in your database. Keep in mind that this may increase your database size  but if you need full auditing
then is is probably the best way to do it. I have written an article about &lt;a class="reference external" href="https://spapas.github.io/2015/01/21/django-model-auditing/"&gt;django model auditing&lt;/a&gt; that discusses this package and django-simple-history
(following)&amp;nbsp;more.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-compressor"&gt;
&lt;h3&gt;django-compressor&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/django-compressor/django-compressor/"&gt;django-compressor&lt;/a&gt; is package that combines and minifies your css and javascript (both files and line snippets) into static files. There are
other tools for this but I have never used them since django-compressor satisfies my needs. Although I&amp;#8217;ve
&lt;a class="reference external" href="https://spapas.github.io/2015/05/27/using-browserify-watchify/"&gt;written about browserify&lt;/a&gt; and friends from the node-js world I don&amp;#8217;t recommend using such tools in django to combine and minify your
javascript and css &lt;em&gt;unless&lt;/em&gt; you specifically require&amp;nbsp;them.&lt;/p&gt;
&lt;p&gt;It has an online and an offline mode. For the online mode, when a request is done it will check if the compressed file exist and if not it will
create it. This may lead to problems with permissions if your application server user cannot write to your static folders and also
your users will see exceptions if for some reason you have included a file that cannot be found. For the
offline mode, you need to run a management command that will create the static files &lt;em&gt;while deploying&lt;/em&gt; the applications - this mode is
recommended because any missing files problems etc will be resolved while deploying the&amp;nbsp;app.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-debug-toolbar"&gt;
&lt;h3&gt;django-debug-toolbar&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/jazzband/django-debug-toolbar"&gt;django-debug-toolbar&lt;/a&gt;: This is a well known package for debugging django apps that is always included in the development configuration of my projects.
It has various panels that help you debug your application but, at least for me, the most helpful is the one that displays you all &lt;span class="caps"&gt;SQL&lt;/span&gt; queries that
are executed for a page load. Because of how the django orm is working it will go on and follow all relations something that will lead to
hundreds of queries. For example, let&amp;#8217;s say that you have simple Book model with a foreign key to an Author model that has N instances in your
database. If you do a &lt;tt class="docutils literal"&gt;Book.objects.all()&lt;/tt&gt;
and want display the author name for each book in a template then you&amp;#8217;ll always do &lt;tt class="docutils literal"&gt;N+1&lt;/tt&gt; queries to the database! This is really easy to miss because
in the django you&amp;#8217;ll just do &lt;tt class="docutils literal"&gt;{% for book in books &lt;span class="pre"&gt;%}{{&lt;/span&gt; &lt;span class="pre"&gt;book.name}},&lt;/span&gt; {{ book.author.name &lt;span class="pre"&gt;}}{%&lt;/span&gt; endif %}&lt;/tt&gt; &amp;#8212; however the &lt;tt class="docutils literal"&gt;{{ book.author.name }}&lt;/tt&gt; will go
on and do an extra &lt;span class="caps"&gt;SQL&lt;/span&gt; query!!! Such cases are easily resolved by using &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.11/ref/models/querysets/#select-related"&gt;select_related&lt;/a&gt; (and &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.11/ref/models/querysets/#prefetch-related"&gt;prefetch_related&lt;/a&gt;) but you must be sure to use select_related
for all your queries (and if you add some extra things to your template you must remember to also add them to your select_related clause for the&amp;nbsp;query).&lt;/p&gt;
&lt;p&gt;So, what I recommend before going to production is to visit all your pages using django-debug-toolbar and take a quick look at the number of &lt;span class="caps"&gt;SQL&lt;/span&gt;
queries. If you see something that does not make sense (for example you see more than 10 queries) then you&amp;#8217;ll need to think about the problem I just
mentioned. Please notice that this, at least for me, is not premature optimization - this is not actually optimization! This is about writing correct
code. Let&amp;#8217;s suppose that you could not use the django orm anymore and you had to use plain old &lt;span class="caps"&gt;SQL&lt;/span&gt; queries. Would you write &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;SELECT&lt;/span&gt; * &lt;span class="caps"&gt;FROM&lt;/span&gt; books&lt;/tt&gt; and
then for each row do another &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;SELECT&lt;/span&gt; * &lt;span class="caps"&gt;FROM&lt;/span&gt; authors &lt;span class="caps"&gt;WHERE&lt;/span&gt; id=?&lt;/tt&gt; passing the author of each book &lt;em&gt;or&lt;/em&gt; do only &lt;tt class="docutils literal"&gt;select * from books b &lt;span class="caps"&gt;LEFT&lt;/span&gt; &lt;span class="caps"&gt;JOIN&lt;/span&gt;
authors a on b.author_id = a.id&lt;/tt&gt;?&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="packages-i-use-when-i-need-their-functionality"&gt;
&lt;h2&gt;Packages I use when I need their&amp;nbsp;functionality&lt;/h2&gt;
&lt;p&gt;The packages following are also essential to me but only when I need their functionality. I don&amp;#8217;t use them in all my projects
but, when I need the capabilities they offer then I will use these packages (and not some others). For example, if I need to
render PDFs in my applications then I will use the xhtml2pdf, if I need to login through &lt;span class="caps"&gt;LDAP&lt;/span&gt; I will use django-auth-ldap&amp;nbsp;etc.&lt;/p&gt;
&lt;div class="section" id="xhtml2pdf"&gt;
&lt;h3&gt;xhtml2pdf&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/xhtml2pdf/xhtml2pdf"&gt;xhtml2pdf&lt;/a&gt; is the package I use for creating &lt;span class="caps"&gt;PDF&lt;/span&gt;&amp;#8217;s with django as I&amp;#8217;ve alreadly discussed in the &lt;a class="reference external" href="https://spapas.github.io/2015/11/27/pdf-in-django/"&gt;PDFs in Django&lt;/a&gt; article (this is not
a django-specific package like most others I discuss here but it plays really good with django). You create a
normal django template, add some styling to it and dump it to html. Notice that there&amp;#8217;s a &lt;a class="reference external" href="https://github.com/chrisglass/django-xhtml2pdf"&gt;django-xhtml2pdf&lt;/a&gt; project but has not been recently updated
and after all as you can see in my article it is easy to just call xhtml2pdf directly. The xhtml2pdf library is actually a wrapper around the
excellent &lt;a class="reference external" href="http://www.reportlab.com"&gt;reportlab&lt;/a&gt; library which does the low-level pdf&amp;nbsp;output.&lt;/p&gt;
&lt;p&gt;Notice that the xhtml2pdf library had some maintenance problems
(that&amp;#8217;s why some people are suggesting other &lt;span class="caps"&gt;PDF&lt;/span&gt; solutions like WeasyPrint) however they seem to have been fixed now. Also,
I have found out that, at least for my needs (using Windows as my development environment), other soltuons are much inferior to xhtml2pdf.
I urge you to try xhtml2pdf first and only if you find that it does not cover your needs (and have asked
me about your problem) try the other&amp;nbsp;solutions.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-auth-ldap"&gt;
&lt;h3&gt;django-auth-ldap&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://bitbucket.org/psagers/django-auth-ldap/"&gt;django-auth-ldap&lt;/a&gt; is the package you&amp;#8217;ll want to use if your organization uses &lt;span class="caps"&gt;LDAP&lt;/span&gt; (or Active Directory) and you want to use it for
logging in. Just configure your &lt;span class="caps"&gt;LDAP&lt;/span&gt; server settings,
add the ldap authenticator and you&amp;#8217;ll be ready to go. Please notice that this package is a django wrapper of the python-ldap package
which actually provides the &lt;span class="caps"&gt;LDAP&lt;/span&gt;&amp;nbsp;connection.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-localflavor"&gt;
&lt;h3&gt;django-localflavor&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/django/django-localflavor"&gt;django-localflavor&lt;/a&gt; offers useful stuff for various countries, mainly form fields with the correct validation and lists of choices.
For example, for my country (Greece) you&amp;#8217;ll get a &lt;tt class="docutils literal"&gt;GRPhoneNumberField&lt;/tt&gt;, a &lt;tt class="docutils literal"&gt;GRPostalCodeField&lt;/tt&gt; and a &lt;tt class="docutils literal"&gt;GRTaxNumberCodeField&lt;/tt&gt;. Use it instead of re-implementing
the&amp;nbsp;behavior.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-constance"&gt;
&lt;h3&gt;django-constance&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/jazzband/django-constance"&gt;django-constance&lt;/a&gt; is a simple package that enables you to add quick-configurable settings in your application. To change the settings.py file
you need to edit the source and restart the application - for most installations this is a full re-deployment of the application. Fully
re-deploying the app just to change a setting is not very good practice (depending on the setting of course but if it is a business setting
it usually should be done by business users and not by&amp;nbsp;administrators).&lt;/p&gt;
&lt;p&gt;That&amp;#8217;s where django-constance comes to help you. You can define some
extra settings which can be changed through the django admin and their new value will be available immediately. Also you can configure where
these settings will be saved. One option is the database but this is not recommended - instead you can use redis so that the settings values will be
available much&amp;nbsp;quicker!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-rq"&gt;
&lt;h3&gt;django-rq&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/ui/django-rq"&gt;django-rq&lt;/a&gt; is a django wrapper for the &lt;a class="reference external" href="https://github.com/nvie/rq"&gt;rq&lt;/a&gt; library. I use it when I need asynchronous tasks (which is on almost all of my projects). More
info can be found on the two articles I have writtten about django rq (&lt;a class="reference external" href="https://spapas.github.io/2015/01/27/async-tasks-with-django-rq/"&gt;asynchronous tasks in django&lt;/a&gt; and &lt;a class="reference external" href="https://spapas.github.io/2015/09/01/django-rq-redux/"&gt;django-rq redux&lt;/a&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-rules-light"&gt;
&lt;h3&gt;django-rules-light&lt;/h3&gt;
&lt;p&gt;One of the least known packages from those I discuss here, &lt;a class="reference external" href="https://github.com/yourlabs/django-rules-light"&gt;django-rules-light&lt;/a&gt; is one of the most useful when is needed. This package
allows you to define complex rules for doing actions on model instances. Each rule is a function that gets the user that wants to do the action
and the object that the user wants to action on. The function returns True or False to allow or not allow the action. You can then use these in
both your code to programatically check if the user can do the the action and your templates to decide what buttons and options you will display.
There are also various helper methods for CBVs that make everything&amp;nbsp;easier.&lt;/p&gt;
&lt;p&gt;To properly understand the value of django-rules-light you need to have some more complex than usual action rules. For example if your actions
for an object are view / edit and all your users can view and edit their own objects then you don&amp;#8217;t really need this package. However, if your administrators
can view all objects and your object can be finalized so no changes are allowed unless an administrator tries to change it then you&amp;#8217;ll greatly benefit
from using&amp;nbsp;it!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-generic-scaffold"&gt;
&lt;h3&gt;django-generic-scaffold&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/spapas/django-generic-scaffold"&gt;django-generic-scaffold&lt;/a&gt; is a package I have created that can be used to quickly (and DRYly) create &lt;span class="caps"&gt;CRUD&lt;/span&gt; CBVs for your models. I usually don&amp;#8217;t want to
give access to the django-admin to non-technical users however sometimes I want to quickly create the required CBVs for them (list, detail, create, edit
delete). Using django-generic-scaffold you can just create a scaffold which is related with a Model and all the views will be automagically created -
you only need to link them to your urls.py. The created CBVs are fully configurable by adding extra mixins or even changing the parent class of each &lt;span class="caps"&gt;CBV&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Notice that this package does not create any source files - instead all CBVs are created on-the-fly using &lt;tt class="docutils literal"&gt;type&lt;/tt&gt;. For example, to create &lt;span class="caps"&gt;CRUD&lt;/span&gt; CBVs for
a Book model you&amp;#8217;ll do this in&amp;nbsp;scaffolding.py:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class BookCrudManager(CrudManager):
    model = models.Book
    prefix = 'books'
&lt;/pre&gt;
&lt;p&gt;and then in your urls.py you&amp;#8217;ll just append the generated urls to your url&amp;nbsp;list:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
book_crud = BookCrudManager()
urlpatterns += book_crud.get_url_patterns()
&lt;/pre&gt;
&lt;p&gt;Now you can visit the corresponding views (for example /books or /bookscreate - depends on the prefix) to add/view/edit etc your&amp;nbsp;books!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-taggit"&gt;
&lt;h3&gt;django-taggit&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/alex/django-taggit"&gt;django-taggit&lt;/a&gt; is the library you&amp;#8217;ll want to use if you have to use tags with your models. A tag is a synonym for keyword, i.e adding some
words/phrases to your instances that are used to categorise and desribe em. The relation between your to-be-tagged-model and your tags is
many to many. To use it, you just add &lt;cite&gt;tags = TaggableManager()&lt;/cite&gt; to your
model and you are ready to go! Of course it will need some more configuration to be included in django admin and django forms but thankfully,
autocomplete-lights can be &lt;a class="reference external" href="https://django-autocomplete-light.readthedocs.io/en/master/taggit.html"&gt;integrated with django-taggit&lt;/a&gt;!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-sendfile"&gt;
&lt;h3&gt;django-sendfile&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/johnsensible/django-sendfile"&gt;django-sendfile&lt;/a&gt; is a very important - at least to - me library. Sometimes, user uploaded files (media in django) should not be visible to all users
so you&amp;#8217;ll need to implement some access control through your django app. However, it is important to &lt;em&gt;not&lt;/em&gt; serve these media files through your application
server (uwsi, gunicorn etc) but use a web server (nginx, apache ect) for serving them. This is needed because your application server&amp;#8217;s purpose is
not serving files from the disk - keep in mind that the application server usually has a specified amount of workers (usually analogous to the number
of CPUs of your server, for example 4 workers ) - think what will happen if some large media files are server through these workers to users with
a slow connection! With 4 such concurrent connections your application won&amp;#8217;t be able to serve any other&amp;nbsp;content!&lt;/p&gt;
&lt;p&gt;So this package (along with the support of X-Sendfile from the web servers) helps you fulfill the above requirements:
It allowes you to check permissions to your media through your django application &lt;em&gt;but&lt;/em&gt; then offload the serving of your media files to the web server.
More info about
&lt;a class="reference external" href="https://stackoverflow.com/q/7296642/119071"&gt;django-sendfile can be found on this &lt;span class="caps"&gt;SO&lt;/span&gt; answer&lt;/a&gt; but with a few words, with django-sendfile you create a view that checks if a file is allowed to be served
and, if yes, instruct the web server to actually serve that file by appending a specific header to the&amp;nbsp;response.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-reversion-compare"&gt;
&lt;h3&gt;django-reversion-compare&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/jedie/django-reversion-compare"&gt;django-reversion-compare&lt;/a&gt; is an addon to django-reversion. It allows you to compare two different versions of a model instance
and highlights their differences using various smart algorithms (so if you have a long text field you won&amp;#8217;t only see that these are different but
you&amp;#8217;ll also see where exactly they differ, with output similar to the one you get when using&amp;nbsp;diff).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-simple-history"&gt;
&lt;h3&gt;django-simple-history&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/treyhunner/django-simple-history"&gt;django-simple-history&lt;/a&gt; has similar capabilities with django-reversion - (auditing and keeping versions of models) with a very important
difference: While django-reversion keeps a &lt;span class="caps"&gt;JSON&lt;/span&gt; representation of each version in the database (making querying very difficult), django-simple-history
creates an extra, history table for each model instance you want to track and adds each change as a new row to that table. As can be understood this
will make the history table really huge but has the advantage that you can easily query for old values. I usually use django-reversion unless I know
that I will need the history&amp;nbsp;querying.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-import-export"&gt;
&lt;h3&gt;django-import-export&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/django-import-export/django-import-export"&gt;django-import-export&lt;/a&gt; can be used to enchance your models with mass import and export capabilities (from example from/to &lt;span class="caps"&gt;CSV&lt;/span&gt;).
You will add an ModelResource class that describes (and configures) how your Model should be imported/exported. The ModelResource class can
then be easily used in your views and, more importantly, it is integrated to the django-admin. I have to confess that I have not used django-import-export
for &lt;em&gt;importing&lt;/em&gt; data because I prefer implementing my own views for that (to have better control over the whole process and because the data
I usually need to import does not usually map 1 to 1 with a model but I need to create more model instances etc). However I am using the export
capabilities of django-import-export in various projects with great success, especially the admin integration which easily fulfills the exporting
data capabilities of most&amp;nbsp;users.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-extra-views"&gt;
&lt;h3&gt;django-extra-views&lt;/h3&gt;
&lt;p&gt;Beyond django-forms, django supports a feature called &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.11/topics/forms/formsets/"&gt;Formsets&lt;/a&gt; which allows you to add/edit multiple object instances in
a single view (by displaying all instances one after the other). The classic request/response cycle of django is preserved in Formsets, so
your form instances will be submitted all together when you submit the form. The logic extension to the Formset is the &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.11/topics/forms/modelforms/#model-formsets"&gt;ModelFormset&lt;/a&gt; i.e each form
in a Formset is a ModelForm and &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.11/topics/forms/modelforms/#inline-formsets"&gt;InlineFormSet&lt;/a&gt; where you have a Parent model that has a bunch of children and you are editing the Parent &lt;em&gt;and&lt;/em&gt;
its children in a single Form. For example, you have a School and a Student model where each Student has a ForeignKey to School. The usual case
would be to edit the Student model and select her school (through a drop down or even-better if you use django-autocomplete-light through a proper
autocompelte widget). However, you may for some reason want to edit the School and display (and edit) the list of its Students &amp;#8212; that&amp;#8217;s where you&amp;#8217;ll
use an&amp;nbsp;InlineFormSet!&lt;/p&gt;
&lt;p&gt;The above features (Formsets, Modelformsets and Inlineformsets) are not supported natively by django CBVs &amp;#8212; that&amp;#8217;s where &lt;a class="reference external" href="https://github.com/AndrewIngram/django-extra-views"&gt;django-extra-views&lt;/a&gt; comes
to the foreground. You can use the corresponding CBVs of django-extra-views to support the multiple-form workflows described above. Using these CBVs
are more or less similar to using the good-old django&amp;nbsp;FormView.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="easy-thumbnails"&gt;
&lt;h3&gt;easy-thumbnails&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/SmileyChris/easy-thumbnails"&gt;easy-thumbnails&lt;/a&gt; is a great library if you want to support thumbnails. Actually, thumbnails is not 100% correct - this package can be used to
generate and manage various versions of your original images, for example you may have a small version of the image that will be used as a thumbnail,
a larger version that will be used in a gallery-carousel view and an even larger version (but not the original one which could be huge) that will be used when
the user clicks on the gallery to view a larger version of the image. To do that you define the image configurations you support in your settings.py and then
you have access
to your thumbnails both in your templates and in your views. Notice that a specific thumbnail congfiguration for an image will be created only once since
the generated images are saved so each thumbnail will be generated on the first request it contains it and will be reused in the following such&amp;nbsp;requests.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-rest-framework"&gt;
&lt;h3&gt;django-rest-framework&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/encode/django-rest-framework"&gt;django-rest-framework&lt;/a&gt; is definitely the best package for creating web APIs with django. I don&amp;#8217;t recommend using it if you want to create a quick &lt;span class="caps"&gt;JSON&lt;/span&gt; search
&lt;span class="caps"&gt;API&lt;/span&gt; (take a look at &lt;a class="reference external" href="https://spapas.github.io/2014/09/15/django-non-html-responses/"&gt;django non-&lt;span class="caps"&gt;HTML&lt;/span&gt; responses&lt;/a&gt;) but if you want to go the &lt;span class="caps"&gt;SPA&lt;/span&gt; way or if you want to create multiple APIs for various models then
this is the way to go. Integrating it to your project will need some effort (that&amp;#8217;s why I don&amp;#8217;t recommend it for quick and dirty APIs) because you&amp;#8217;ll
need to create a serializers.py which will define the serializers (more or less the fields) for the models you&amp;#8217;ll want to expose through your &lt;span class="caps"&gt;API&lt;/span&gt; and
then create the views (or the viewsets which are families of views for example list, detail, delete, update, create) and add them to your urls.py. You&amp;#8217;ll
also need to configure authentication, authorization and probably filtering and pagination. This may seem like a lot of work but the result are
excellent - you&amp;#8217;ll get a full &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; supporting create, list, detail, update, delete for any complex configuration of your models.
You can take a look at a sample application in my &lt;a class="reference external" href="https://github.com/spapas/react-tutorial"&gt;React tutorial&lt;/a&gt; repository (yes this is a repository that has a tutorial for React and
friends but the back-end is in django and&amp;nbsp;django-rest-framework).&lt;/p&gt;
&lt;p&gt;django-rest-framework integrates nicely with django-filter (mentioned above) to re-use the filters you have created for your model listings
in your &lt;span class="caps"&gt;REST&lt;/span&gt; APIs - &lt;span class="caps"&gt;DRY&lt;/span&gt; at its&amp;nbsp;best!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-waffle"&gt;
&lt;h3&gt;django-waffle&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/jsocol/django-waffle"&gt;django-waffle&lt;/a&gt; is described as a feature flipper. What does this mean? Let&amp;#8217;s say that you want to control at will when a specific view will be enabled
- this is the library you&amp;#8217;ll want to use. Or you have developed a new feature and you want to give access to it only on a subset of users for a pilot run of
the feature - once again you should use django flipper. It offers a nice admin interface where you can configure the flags that will be used for the various
feature enabling/disabling (and if they are active or not) and various template tags and functions that you can use to test if the features should be activated
or&amp;nbsp;not.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-allauth"&gt;
&lt;h3&gt;django-allauth&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/pennersr/django-allauth"&gt;django-allauth&lt;/a&gt; should be used in two cases: When you want a &lt;em&gt;better&lt;/em&gt; user registration workflow than the default (non-existant) one or you want
to integrate your application with an external OAuth provider (i.e allow your users to login through their facebook, google, twitter, github etc accounts). I
have mainly used this package for the first case and I can confirm that it works great and you can create as complex flows as you want (for example, in
one of my projects I have the following user registration-activation flow: A user registers using a custom form and using his email as username, he receives
an email with a confirmation link,
after he has confirmed his email he receivs a custom message to wait for his account activation and the administrators of the application are notified,
the administrators enable the new user&amp;#8217;s account after checking some things and only then he&amp;#8217;ll be able to log-in). One thing that must be noticed about
django-allauth is that it (in my opition) does not have very good documentation but there are lots of answers about &lt;a class="reference external" href="https://stackoverflow.com/questions/tagged/django-allauth"&gt;django-allauth in stackoverflow&lt;/a&gt; and the source code
is very clear so you can always use the source as documentation for this&amp;nbsp;package.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-modeltranslation"&gt;
&lt;h3&gt;django-modeltranslation&lt;/h3&gt;
&lt;p&gt;The &lt;a class="reference external" href="https://github.com/deschler/django-modeltranslation"&gt;django-modeltranslation&lt;/a&gt; library is the library I recommend for when you want to have translations to your models. To use it
you add a translation.py file where you declare the models and their fields that should be translated. The, depending on which languages you have configured
in your settings.py after you run makemigrations and migrate you&amp;#8217;ll see that django-modeltranslation will have included extra fields to the database, each one
with the corresponding language name (for example if you have added a field &lt;tt class="docutils literal"&gt;name&lt;/tt&gt; to the translations and have english and greek as language,
django-modeltranslation will add the fields &lt;tt class="docutils literal"&gt;name_en&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;name_el&lt;/tt&gt; to your table). You can the edit the i18n fields (using forms or the django admin) and
depending on the current language of your site when you use &lt;tt class="docutils literal"&gt;name&lt;/tt&gt; you&amp;#8217;ll get either &lt;tt class="docutils literal"&gt;name_el&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;name_en&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-widget-tweaks"&gt;
&lt;h3&gt;django-widget-tweaks&lt;/h3&gt;
&lt;p&gt;If for some reason you don&amp;#8217;t want to do django-crispy-forms, or you have a form in which you want to do a specific layout change but without
fully implementing the FormHelper then you can actually render the form in &lt;span class="caps"&gt;HTML&lt;/span&gt; and output the fields one by one. One thing that cannot
be done though is passing custom options to the rendered form field. When you do a &lt;tt class="docutils literal"&gt;{{ form.field }}&lt;/tt&gt; to your template django will render
the form field using its default options - yes this can be overriden using &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.11/ref/forms/widgets/#base-widget-classes"&gt;custom widgets&lt;/a&gt; but I don&amp;#8217;t recommend it for example if you only
want to add a class to the rendered &lt;tt class="docutils literal"&gt;&amp;lt;input&amp;gt;&lt;/tt&gt;!&lt;/p&gt;
&lt;p&gt;Instead, you can use &lt;a class="reference external" href="https://github.com/jazzband/django-widget-tweaks"&gt;django-widget-tweaks&lt;/a&gt; to pass some specific class names or attributes to
the rendered form fields - so if you use &lt;tt class="docutils literal"&gt;{{ &lt;span class="pre"&gt;form.field|add_class:&amp;quot;myclass&amp;quot;&lt;/span&gt; }}&lt;/tt&gt; the rendered &lt;tt class="docutils literal"&gt;&amp;lt;input&amp;gt;&lt;/tt&gt; will have a &lt;tt class="docutils literal"&gt;myclass&lt;/tt&gt; css&amp;nbsp;class.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-simple-captcha"&gt;
&lt;h3&gt;django-simple-captcha&lt;/h3&gt;
&lt;p&gt;Use &lt;a class="reference external" href="https://github.com/mbi/django-simple-captcha"&gt;django-simple-captcha&lt;/a&gt; to add (configurable) captchas to your django forms. This is a very simple package that does not have any requirements
beyond the Pillow library for the captcha image generator. The generated captchas are simple images with some added noise so it won&amp;#8217;t integrate
&lt;a class="reference external" href="https://www.google.com/recaptcha/intro/"&gt;reCAPTCHA&lt;/a&gt; with which you may be more familiar. I deliberatly propose this package for captchas so you won&amp;#8217;t need to integrate with Google&amp;nbsp;services.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="wagtail"&gt;
&lt;h3&gt;wagtail&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/wagtail/wagtail"&gt;wagtail&lt;/a&gt; is a great django &lt;span class="caps"&gt;CMS&lt;/span&gt;. I use it when I need to create a &lt;span class="caps"&gt;CMS&lt;/span&gt; or I need to add &lt;span class="caps"&gt;CMS&lt;/span&gt; like capabilities to a project. It has many
capabilities, too many to be listed here. I urge you to try it if you need a &lt;span class="caps"&gt;CMS&lt;/span&gt;!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The above packages should cover most of your django needs. I have listed only packages with good documentation,
that have been recently updated
and work with new django versions and should be fairly easy to integrate with your projects. If you need anything more or want to take a general
look at some of the packages that have are availablie I recommend starting
with the &lt;a class="reference external" href="https://djangopackages.org"&gt;django packages&lt;/a&gt;&amp;nbsp;site.&lt;/p&gt;
&lt;p&gt;One important thing to notice here is that some of the above packages are not really complex and their functionality can be re-implemented
by you in a couple of hours. For example, you could replicate the functionality of django-constance by adding a config dict and
a couple of methods (and template tags) of storing and retrieving the keys of that dict with redis. Or add some custom clean methods to your
forms instead of using the form fields from django-localflavor. Also, some of these packages have similar functionality and can be used (along
with a little custom code) to replicate the functionality of other packages, for exmaple instead of using django-waffle you could use
django-constance to configure if the features should be enabled or disabled and django-rules-light to control if the users have access to the feature.
Also, you could probably use django-waffle for access control, i.e allow only admins to access a specific&amp;nbsp;views.&lt;/p&gt;
&lt;p&gt;Please don&amp;#8217;t do this. This violates &lt;span class="caps"&gt;DRY&lt;/span&gt; and violates being disciplined.
Each package has its purpose and being &lt;span class="caps"&gt;DRY&lt;/span&gt; means that you use it for its purpose, &lt;em&gt;not&lt;/em&gt; re-implementing it and &lt;em&gt;not&lt;/em&gt; re-using it for other purposes.
When somebody (or you after some months) sees that package in requirements or INSTALLED_APPS he will conclude that you are using it for
its intented purpose and thank you because you have saved him some time - please don&amp;#8217;t make him waste his time by needing to read your source code to understand
any smart tricks or reinventing the&amp;nbsp;wheel.&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="python"></category></entry><entry><title>Automatically create a category table in Postgresql by extracting unique tableÂ values</title><link href="https://spapas.github.io/2017/07/04/postgresql-auto-create-category-column/" rel="alternate"></link><published>2017-07-04T09:05:00+03:00</published><updated>2017-07-04T09:05:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2017-07-04:/2017/07/04/postgresql-auto-create-category-column/</id><summary type="html">&lt;p class="first last"&gt;A postgresql script to help you automatically create a new category table by extracting its values from a table and generate the&amp;nbsp;relations&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Recently I was given an &lt;span class="caps"&gt;SQL&lt;/span&gt; table containing some useful data. The problem with that table was that it was was non-properly normalized but was completely flat,
i.e all its columns contained varchar values while, some of them should have instead contained foreign keys to other tables. Here&amp;#8217;s an example of how this
table looked&amp;nbsp;like:&lt;/p&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="14%" /&gt;
&lt;col width="25%" /&gt;
&lt;col width="28%" /&gt;
&lt;col width="33%" /&gt;
&lt;/colgroup&gt;
&lt;thead valign="bottom"&gt;
&lt;tr&gt;&lt;th class="head" colspan="4"&gt;Parts&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;th class="head"&gt;&lt;span class="caps"&gt;ID&lt;/span&gt;&lt;/th&gt;
&lt;th class="head"&gt;Serial&lt;/th&gt;
&lt;th class="head"&gt;Category&lt;/th&gt;
&lt;th class="head"&gt;Manufacturer&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;423431&lt;/td&gt;
&lt;td&gt;Monitor&lt;/td&gt;
&lt;td&gt;&lt;span class="caps"&gt;LG&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;534552&lt;/td&gt;
&lt;td&gt;Monitor&lt;/td&gt;
&lt;td&gt;&lt;span class="caps"&gt;LG&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;435634&lt;/td&gt;
&lt;td&gt;Printer&lt;/td&gt;
&lt;td&gt;&lt;span class="caps"&gt;HP&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;534234&lt;/td&gt;
&lt;td&gt;Printer&lt;/td&gt;
&lt;td&gt;Samsung&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;234212&lt;/td&gt;
&lt;td&gt;Monitor&lt;/td&gt;
&lt;td&gt;Samsung&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;123123&lt;/td&gt;
&lt;td&gt;Monitor&lt;/td&gt;
&lt;td&gt;&lt;span class="caps"&gt;LG&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The normalized version of this table should have been instead like&amp;nbsp;this:&lt;/p&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="13%" /&gt;
&lt;col width="23%" /&gt;
&lt;col width="28%" /&gt;
&lt;col width="38%" /&gt;
&lt;/colgroup&gt;
&lt;thead valign="bottom"&gt;
&lt;tr&gt;&lt;th class="head" colspan="4"&gt;Parts&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;th class="head"&gt;&lt;span class="caps"&gt;ID&lt;/span&gt;&lt;/th&gt;
&lt;th class="head"&gt;Serial&lt;/th&gt;
&lt;th class="head"&gt;Category_id&lt;/th&gt;
&lt;th class="head"&gt;Manufacturer_id&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;423431&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;534552&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;435634&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;534234&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;234212&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;6&lt;/td&gt;
&lt;td&gt;123123&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;with the following extra tables that contain the category values with proper foreign&amp;nbsp;keys:&lt;/p&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="22%" /&gt;
&lt;col width="78%" /&gt;
&lt;/colgroup&gt;
&lt;thead valign="bottom"&gt;
&lt;tr&gt;&lt;th class="head" colspan="2"&gt;Category&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;th class="head"&gt;&lt;span class="caps"&gt;ID&lt;/span&gt;&lt;/th&gt;
&lt;th class="head"&gt;Name&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;Monitor&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Printer&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="17%" /&gt;
&lt;col width="83%" /&gt;
&lt;/colgroup&gt;
&lt;thead valign="bottom"&gt;
&lt;tr&gt;&lt;th class="head" colspan="2"&gt;Manufacturer&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;th class="head"&gt;&lt;span class="caps"&gt;ID&lt;/span&gt;&lt;/th&gt;
&lt;th class="head"&gt;Name&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;Monitor&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Printer&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The normalized version should be used instead of the flat one &lt;a class="reference external" href="http://www.imdb.com/title/tt0057012/quotes?item=qt0454452"&gt;for reasons which at this moment must be all too obvious&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Having such non-normalized tables is also a common problem I experience with Django: When creating a model
I usually define some &lt;tt class="docutils literal"&gt;CharField&lt;/tt&gt;  with pre-defined &lt;tt class="docutils literal"&gt;choices&lt;/tt&gt; which &amp;#8220;will never change&amp;#8221;. Sometime during the
development (if I am lucky) or when the project is live for years I will be informed that the choices need not
only to be changed but must be changed by the users of the site without the need to change the source code! Or
that the choices/categories have properties (beyond their name) that need to be defined and used in the project. Both
of these cases mean that these categories need to be extracted from simple strings to full Django models (i.e get
normalized in their own&amp;nbsp;table)!&lt;/p&gt;
&lt;p&gt;In this post I will present a function written in &lt;span class="caps"&gt;PL&lt;/span&gt;/pgsql that will automatically normalize a column from a
flat table like the previous. Specifically, using the previous example,
if you have a table named &lt;tt class="docutils literal"&gt;part&lt;/tt&gt; that has a non-normalized
column named &lt;tt class="docutils literal"&gt;category&lt;/tt&gt; then when you call &lt;tt class="docutils literal"&gt;select &lt;span class="pre"&gt;export_relation('part',&lt;/span&gt; 'category')&lt;/tt&gt; the following
will&amp;nbsp;happen:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A new table named &lt;tt class="docutils literal"&gt;part_category&lt;/tt&gt; will be created. This table will contain two columns &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;name&lt;/tt&gt;, with &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; being the primary key and &lt;tt class="docutils literal"&gt;name&lt;/tt&gt; having a unique constraint. If the table exists it will be dropped and&amp;nbsp;re-ccreated&lt;/li&gt;
&lt;li&gt;A new column named &lt;tt class="docutils literal"&gt;category_id&lt;/tt&gt; will be added to &lt;tt class="docutils literal"&gt;part&lt;/tt&gt;. This column will be a foreign key to the new table &lt;tt class="docutils literal"&gt;part_category&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;&lt;dl class="first docutils"&gt;
&lt;dt&gt;For each unique value &lt;tt class="docutils literal"&gt;v&lt;/tt&gt; of &lt;tt class="docutils literal"&gt;category&lt;/tt&gt;:&lt;/dt&gt;
&lt;dd&gt;&lt;ul class="first last"&gt;
&lt;li&gt;Insert a new record in &lt;tt class="docutils literal"&gt;part_category&lt;/tt&gt; with &lt;tt class="docutils literal"&gt;v&lt;/tt&gt; in the &lt;tt class="docutils literal"&gt;name&lt;/tt&gt; field of the table and save the inserted id to &lt;tt class="docutils literal"&gt;current_id&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Set &lt;tt class="docutils literal"&gt;current_id&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;category_id&lt;/tt&gt;  to all rows of &lt;tt class="docutils literal"&gt;part&lt;/tt&gt; where &lt;tt class="docutils literal"&gt;category&lt;/tt&gt; has the value of &lt;tt class="docutils literal"&gt;v&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Before diving in to the &lt;span class="caps"&gt;PL&lt;/span&gt;/pgSQL script that does the above changes to the table I&amp;#8217;d like to notice that I am
not very experienced with &lt;span class="caps"&gt;PL&lt;/span&gt;/pgSQL since I rarerly use it
(I actually avoid writing code in the database) however, because the case I described is ideal for using a database script
I&amp;#8217;ve bitten the bullet and implemented&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;Beyond it&amp;#8217;s actual functionality, this script can be used as a reference/cookbook for common &lt;span class="caps"&gt;PL&lt;/span&gt;/pgSQL&amp;nbsp;tasks:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Create/define a &lt;span class="caps"&gt;PL&lt;/span&gt;/pgSQL function (stored&amp;nbsp;procedure)&lt;/li&gt;
&lt;li&gt;Declare&amp;nbsp;variables&lt;/li&gt;
&lt;li&gt;Assign values to&amp;nbsp;variables&lt;/li&gt;
&lt;li&gt;Execute &lt;span class="caps"&gt;SQL&lt;/span&gt; commands with variable defined table / column&amp;nbsp;names&lt;/li&gt;
&lt;li&gt;Log process in &lt;span class="caps"&gt;PL&lt;/span&gt;/pgSQL&lt;/li&gt;
&lt;li&gt;Executing code&amp;nbsp;conditionally&lt;/li&gt;
&lt;li&gt;Loop through the rows of a&amp;nbsp;query&lt;/li&gt;
&lt;li&gt;Save the primary key of an inserted&amp;nbsp;row&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The script works however I feel that more experienced &lt;span class="caps"&gt;PL&lt;/span&gt;/pgSQL developers would write things different - if you have any
proposals please comment out and I&amp;#8217;ll be happy to incorporate them to the&amp;nbsp;script.&lt;/p&gt;
&lt;p&gt;Now, let&amp;#8217;s now take a look at the actual&amp;nbsp;script:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;CREATE&lt;/span&gt; &lt;span class="k"&gt;OR&lt;/span&gt; &lt;span class="k"&gt;REPLACE&lt;/span&gt; &lt;span class="k"&gt;FUNCTION&lt;/span&gt; &lt;span class="n"&gt;export_relation&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table_name&lt;/span&gt; &lt;span class="nb"&gt;varchar&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;column_name&lt;/span&gt; &lt;span class="nb"&gt;varchar&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;RETURNS&lt;/span&gt; &lt;span class="nb"&gt;void&lt;/span&gt; &lt;span class="k"&gt;AS&lt;/span&gt; &lt;span class="s"&gt;$$&lt;/span&gt;
&lt;span class="k"&gt;DECLARE&lt;/span&gt;
    &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="nb"&gt;varchar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="nb"&gt;boolean&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;new_table_name&lt;/span&gt; &lt;span class="nb"&gt;varchar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;new_column_name&lt;/span&gt; &lt;span class="nb"&gt;varchar&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;current_id&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;BEGIN&lt;/span&gt;
    &lt;span class="n"&gt;new_table_name&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;table_name&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;_&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="n"&gt;column_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="n"&gt;new_column_name&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="n"&gt;column_name&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;_id&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;execute&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;drop table if exists %s cascade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_table_name&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;execute&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CREATE TABLE %s (id serial NOT NULL, name character varying(255) NOT NULL, CONSTRAINT %s_pkey PRIMARY KEY (id), CONSTRAINT %s_unique UNIQUE (name))WITH ( OIDS=FALSE)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;new_table_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_table_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_table_name&lt;/span&gt;
    &lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;execute&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;select exists(SELECT column_name  FROM information_schema.columns WHERE table_name=&amp;#39;&amp;#39;%s&amp;#39;&amp;#39; and column_name=&amp;#39;&amp;#39;%s&amp;#39;&amp;#39;) as x&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;table_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_column_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;into&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="k"&gt;false&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="k"&gt;notice&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Creating colum&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;execute&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ALTER TABLE %s ADD COLUMN %s integer null&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;table_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_column_name&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;execute&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ALTER TABLE %s ADD CONSTRAINT fk_%s FOREIGN KEY (%s) REFERENCES %s(id)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;table_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_column_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_column_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_table_name&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="k"&gt;IN&lt;/span&gt; &lt;span class="k"&gt;execute&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;select %s from %s group by(%s)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;column_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;table_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;column_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;LOOP&lt;/span&gt;
        &lt;span class="k"&gt;RAISE&lt;/span&gt; &lt;span class="k"&gt;NOTICE&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Inserting new value %s ...&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;execute&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;insert into  %s(name) values (&amp;#39;&amp;#39;%s&amp;#39;&amp;#39;) returning id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_table_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;into&lt;/span&gt; &lt;span class="n"&gt;current_id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="k"&gt;notice&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Created ID %&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;current_id&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;execute&lt;/span&gt; &lt;span class="n"&gt;format&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;update %s set %s = %s where %s = &amp;#39;&amp;#39;%s&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;table_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_column_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;current_id&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;column_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt; &lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;END&lt;/span&gt; &lt;span class="k"&gt;LOOP&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="cm"&gt;/* Uncomment this if you want to drop the flat column&lt;/span&gt;
&lt;span class="cm"&gt;    raise notice &amp;#39;Dropping colmn&amp;#39;;&lt;/span&gt;
&lt;span class="cm"&gt;    execute format (&amp;#39;alter table %s drop column %s&amp;#39;, table_name, column_name);&lt;/span&gt;
&lt;span class="cm"&gt;    */&lt;/span&gt;

&lt;span class="k"&gt;END&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="s"&gt;$$&lt;/span&gt; &lt;span class="k"&gt;LANGUAGE&lt;/span&gt; &lt;span class="n"&gt;plpgsql&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The first line creates or updates the script. You can just copy over this script to an &lt;span class="caps"&gt;SQL&lt;/span&gt; window and run it as many times as you like (making changes
between runs) and the script will be always updated. The function that is created is actually a procedure since it returns &lt;tt class="docutils literal"&gt;void&lt;/tt&gt; and takes two parameters.
The &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DECLARE&lt;/span&gt;&lt;/tt&gt; section that follows contains all the variables that are used in the&amp;nbsp;script:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;val&lt;/tt&gt; is the current value of the category when looping through their&amp;nbsp;values&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;res&lt;/tt&gt; is a boolean variable used for a&amp;nbsp;conditional&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;new_table_name&lt;/tt&gt; is the name of the table that will be&amp;nbsp;created&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;new_column_name&lt;/tt&gt; is the name of the column that will be added to the old&amp;nbsp;table&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;current_id&lt;/tt&gt; is the id of the last inserted value in the new&amp;nbsp;table&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;After the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;BEGIN&lt;/span&gt;&lt;/tt&gt; the actual procedure starts: First the values of &lt;tt class="docutils literal"&gt;new_table_name&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;new_column_name&lt;/tt&gt; are initialized to be used throughout the code and
then the new table is dropped (if exists) and re-created. Noticce the &lt;tt class="docutils literal"&gt;execute format (parameter)&lt;/tt&gt; function that executes the &lt;span class="caps"&gt;SQL&lt;/span&gt; contained in the parameter which
is a string and is constructed using the variables we&amp;#8217;ve defined. The next line checks if the old table has the new column (i.e category_id) and saves
the result in the &lt;tt class="docutils literal"&gt;res&lt;/tt&gt; variable to check if the new column exists and if not add it to the old&amp;nbsp;table.&lt;/p&gt;
&lt;p&gt;A loop enumerating all unique values of the category column of the old table is then executed. Notice that &lt;tt class="docutils literal"&gt;val&lt;/tt&gt; will contain a single value since the &lt;span class="caps"&gt;SQL&lt;/span&gt; that is executed
will return a single column (that&amp;#8217;s why it is declared as varchar). If we returned more than one column from the select the val could be declared as &lt;tt class="docutils literal"&gt;record&lt;/tt&gt; and access its
properties through dot notation (&lt;tt class="docutils literal"&gt;val.prop1&lt;/tt&gt; etc). The value is inserted to the newly created table using a &lt;tt class="docutils literal"&gt;insert into table values () returning id&lt;/tt&gt; &lt;span class="caps"&gt;SQL&lt;/span&gt; syntax
(so that the new id will be returned - this is an insert/select hybrid command) and saved to the &lt;tt class="docutils literal"&gt;current_id&lt;/tt&gt; variable. The &lt;tt class="docutils literal"&gt;current_id&lt;/tt&gt; variable then is used to update
the new column that was added to the old table with the proper foreign key&amp;nbsp;value.&lt;/p&gt;
&lt;p&gt;Notice that I&amp;#8217;ve a commented out code in the end - if you want you can uncomment it and the old (flat) column will be dropped - so in my examply the &lt;tt class="docutils literal"&gt;category&lt;/tt&gt; column will be
removed since I will have &lt;tt class="docutils literal"&gt;category_id&lt;/tt&gt; to find out the name of each category. I recommend to uncomment this and actually drop the column since when you have both &lt;tt class="docutils literal"&gt;category&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;category_id&lt;/tt&gt; the values of these two columns are going to get out of sync and since you&amp;#8217;ll have duplicate information your table will be even more non-normalized. You can
of course keep the column to make sure that the script works as you want since if the column is not dropped you can easily return to the previous state of the database by
removeing the new table and&amp;nbsp;column.&lt;/p&gt;
&lt;p&gt;To call it just run &lt;tt class="docutils literal"&gt;select &lt;span class="pre"&gt;export_relation('part',&lt;/span&gt; 'category')&lt;/tt&gt; and you should see some debug info in the messages tab. When the script is finished you&amp;#8217;ll have the
&lt;tt class="docutils literal"&gt;part_category&lt;/tt&gt; table and &lt;tt class="docutils literal"&gt;category_id&lt;/tt&gt; column in the &lt;tt class="docutils literal"&gt;part&lt;/tt&gt; table.&lt;/p&gt;
</content><category term="postgresql"></category><category term="postgresql"></category><category term="plpgsql"></category></entry><entry><title>Creating custom components forÂ ag-grid</title><link href="https://spapas.github.io/2017/01/03/ag-grid-custom-components/" rel="alternate"></link><published>2017-01-03T09:55:00+02:00</published><updated>2017-01-03T09:55:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2017-01-03:/2017/01/03/ag-grid-custom-components/</id><summary type="html">&lt;p class="first last"&gt;How to create custom components (renderers and editors) for the excellent ag-grid grid&amp;nbsp;library&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Recently I had to integrate an application with a javascript (client-side) excel-like grid. After some research
I found out that &lt;a class="reference external" href="https://www.ag-grid.com/"&gt;ag-grid&lt;/a&gt; is (at least for me) the best javascript grid library. It has an open source version with a &lt;span class="caps"&gt;MIT&lt;/span&gt; license
so it can safely be used by all your projects and a commercial, enteprise version that includes a bunch of
extra features. The open source version should be sufficient for most projects however I really recommend
buying the commercial version to support this very useful&amp;nbsp;library.&lt;/p&gt;
&lt;p&gt;The greatest characteristic of ag-grid in my opinion is its openess and &lt;span class="caps"&gt;API&lt;/span&gt; that enables you to
extend it to support all your needs! An example of this &lt;span class="caps"&gt;API&lt;/span&gt; will be presented in this article where
I will implement two components that can be included in your&amp;nbsp;grid:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;An array editor through which you will be able to create cells that can be used to insert a list of values. For example, if you have a grid of employees, you will be able to add a &amp;#8220;children&amp;#8221; cell that will contain the names of each employee&amp;#8217;s children properly separated (one line per&amp;nbsp;child)&lt;/li&gt;
&lt;li&gt;An object editor through which you will be able to create cells that can be used to insert flat objects. For example, for the grid of employees, you may add an &amp;#8220;address&amp;#8221; cell that, when edited will be expanded to seperate fields for Address, City, Zip code and&amp;nbsp;Country.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="a-common-ground"&gt;
&lt;h2&gt;A common&amp;nbsp;ground&lt;/h2&gt;
&lt;p&gt;First of all, let&amp;#8217;s create a simple example that will act as a common ground for our&amp;nbsp;components:&lt;/p&gt;
&lt;div class="jsfiddle"&gt;&lt;iframe width="100%" height="300" src="//jsfiddle.net/6vmvdmzj/6/embedded/js,resources,html,css,result/light/" allowfullscreen="allowfullscreen" frameborder="0"&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;p&gt;As you can see, I have defined a bunch of columns for the grid and then create a new grid passing it the &lt;tt class="docutils literal"&gt;myGrid&lt;/tt&gt; div
and the &lt;tt class="docutils literal"&gt;gridOptions&lt;/tt&gt; (which are kept to a minimum). Finally, there&amp;#8217;s an event handler for button click that adds an
empty&amp;nbsp;row:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;columns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;headerName&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;editable&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;headerName&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;editable&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;headerName&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Address&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;address&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;editable&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;headerName&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Children&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;children&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;editable&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;];&lt;/span&gt;

&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;gridOptions&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;columnDefs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;columns&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;rowData&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="nx"&gt;agGrid&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Grid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;querySelector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#myGrid&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nx"&gt;gridOptions&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;querySelector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#addRow&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;addEventListener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;click&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;gridOptions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;api&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addItems&lt;/span&gt;&lt;span class="p"&gt;([{}]);&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You may be able to edit both the address and the children of each employee in the above example however this is
not intuitive. The editors will be able to enter any kind of address they want and add the children seperated by commas,
spaces, dashes or whatever they want. Of course you could add validators to enforce some formatting for these fields
however I think that using custom components has a much better user&amp;nbsp;experience.&lt;/p&gt;
&lt;p&gt;Please notice that the above example along with the following components will be implemented in pure (no-framework) javascript. Integrating
ag-grid with a javascript framework like angular or react in an &lt;span class="caps"&gt;SPA&lt;/span&gt; should not be difficult however I find it easier to adjust my &lt;span class="caps"&gt;SPA&lt;/span&gt;
so that the grid component is seperate and does not need interoperability with other &lt;span class="caps"&gt;SPA&lt;/span&gt; components since all components like renderers
and editors will be integrated to the&amp;nbsp;grid!&lt;/p&gt;
&lt;p&gt;Also, using pure javascript for your
custom components makes them faster than adding another layer of indirection through react as can be seen on the on &lt;a class="reference external" href="https://www.ag-grid.com/best-react-data-grid/index.php"&gt;ag-grid react integration&lt;/a&gt;:&lt;/p&gt;
&lt;blockquote&gt;
If you do use React, be aware that you are adding an extra layer of indirection into ag-Grid. ag-Grid&amp;#8217;s internal framework is already highly tuned to work incredibly fast and does not require React or anything else to make it faster. If you are looking for a lightning fast grid, even if you are using React and the ag-grid-react component, consider using plain ag-Grid Components (as explained on the pages for rendering etc) inside ag-Grid instead of creating React counterparts.&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class="section" id="editors-and-renderers"&gt;
&lt;h2&gt;Editors and&amp;nbsp;renderers&lt;/h2&gt;
&lt;p&gt;A custom column in ag-grid actually has two distinctive parts: An object that is used for &lt;a class="reference external" href="https://www.ag-grid.com/javascript-grid-cell-rendering/"&gt;rendering&lt;/a&gt; and an object that is used
for &lt;a class="reference external" href="https://www.ag-grid.com/javascript-grid-cell-editing/"&gt;editing&lt;/a&gt; the cell value. You can have columns with the built in editor and a custom renderer, columns with the built in renderer
and a custom editor and cells with custom editors and rendererers. I urge you to read the &lt;a class="reference external" href="https://www.ag-grid.com/documentation-main/documentation.php"&gt;documentation&lt;/a&gt; on both renderers and
editors in order to understand most of the decisions I have made for the implemented&amp;nbsp;components.&lt;/p&gt;
&lt;p&gt;A renderer can&amp;nbsp;be:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;a function that receives the value of the cell and returns either an &lt;span class="caps"&gt;HTML&lt;/span&gt; string or a complete &lt;span class="caps"&gt;DOM&lt;/span&gt;&amp;nbsp;object&lt;/li&gt;
&lt;li&gt;a class that provides methods for returning the &lt;span class="caps"&gt;HTML&lt;/span&gt; string or &lt;span class="caps"&gt;DOM&lt;/span&gt; object for the&amp;nbsp;cell&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The function is much easier to use however biting the bullet and providing a renderer class is better for non-trivial rendering.
This is because the function will be called each time the cell needs to be &lt;em&gt;refreshed&lt;/em&gt; (refer to the docs on what refreshing means)
while, the class provides a specific &lt;tt class="docutils literal"&gt;refresh()&lt;/tt&gt; method that is called instead. This way, using the class you can generate the &lt;span class="caps"&gt;DOM&lt;/span&gt; structure
for the cell once, when it is first created and then when its value changes you&amp;#8217;ll only call its refresh method to update the value. We&amp;#8217;ll
see how this works&amp;nbsp;later.&lt;/p&gt;
&lt;p&gt;An editor is a class that should provide methods for returning the &lt;span class="caps"&gt;DOM&lt;/span&gt; structure for the cell editing (for example an &lt;tt class="docutils literal"&gt;&amp;lt;input&amp;gt;&lt;/tt&gt; field)
and the current value of the&amp;nbsp;field.&lt;/p&gt;
&lt;p&gt;Both renderer and editor classes can be attached to columns using &lt;tt class="docutils literal"&gt;cellEditor&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;cellRenderer&lt;/tt&gt; column properties. You also may
pass per-column properties to each cell using the &lt;tt class="docutils literal"&gt;cellEditorParams&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;cellRendererParams&lt;/tt&gt; propertie. For example, you may have
a renderer for booleans that displays icons for true/false and you want to use different icons depending on the column type, or you
may want to create a validation-editor that receives a function and accepts the value you enter only if the function returns true - the
valid function could be different for different column&amp;nbsp;types.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="creating-the-object-cell-editor"&gt;
&lt;h2&gt;Creating the object cell&amp;nbsp;editor&lt;/h2&gt;
&lt;p&gt;The first component we&amp;#8217;ll present here is an object renderer/editor. This component will receiver a list of fields and will
allow the user to edit them in a popup grouped together. Here&amp;#8217;s a fiddle with the Address of each employee using the
object editing&amp;nbsp;component:&lt;/p&gt;
&lt;div class="jsfiddle"&gt;&lt;iframe width="100%" height="300" src="//jsfiddle.net/0o85uywr/4/embedded/js,resources,html,css,result/light/" allowfullscreen="allowfullscreen" frameborder="0"&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;p&gt;To integrate it with the ag-grid I&amp;#8217;ve added an addressFields list containg the fields of the object like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;addressFields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
  &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;address&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Address&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zip&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ZIP&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;},&lt;/span&gt;
  &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;city&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;City&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and then passed this as a parameter to both the renderer and editor for the address&amp;nbsp;field:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;headerName&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Address&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;address&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;editable&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;cellRenderer&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;ObjectCellRenderer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;cellEditor&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;ObjectEditor&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;cellEditorParams&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;fields&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;addressFields&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="nx"&gt;cellRendererParams&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;fields&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;addressFields&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;ObjectEditor&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;ObjectCellRenderer&lt;/tt&gt; are the actual editor and renderer of the component. I will start by representing the renderer&amp;nbsp;first:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;ObjectCellRenderer&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;

&lt;span class="nx"&gt;ObjectCellRenderer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;init&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// Create the DOM element to display&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;span&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;refresh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The ObjectCellRender is an javascript object to which we define an &lt;tt class="docutils literal"&gt;init&lt;/tt&gt; method. This method will be called by ag-grid when
the component is first created, passing it a params object with various useful params, like the user-defined parameters (from &lt;tt class="docutils literal"&gt;cellRendererParams&lt;/tt&gt;)
and the actual value of othe cell. We just create an empty span &lt;span class="caps"&gt;DOM&lt;/span&gt; element that will be used to display the value of the object and call &lt;tt class="docutils literal"&gt;refresh&lt;/tt&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;ObjectCellRenderer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;refresh&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// If we have a value build the representation&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;: &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="nx"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="c1"&gt;// Put representation to the DOM element&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nx"&gt;ObjectCellRenderer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getGui&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;refresh&lt;/tt&gt; method generates the text value of the cell (that will be put inside the span we created in init). It first checks if the &lt;tt class="docutils literal"&gt;value&lt;/tt&gt; attribute
of &lt;tt class="docutils literal"&gt;params&lt;/tt&gt; is defined and if yes, it appends the label of each object attribute (which we pass through &lt;tt class="docutils literal"&gt;cellRendererParams.fields.label&lt;/tt&gt;) along with its value
(which is retrieved from the &lt;tt class="docutils literal"&gt;params.value&lt;/tt&gt; using &lt;tt class="docutils literal"&gt;cellRendererParams.fields.name&lt;/tt&gt;). Notice ag-grid puts the result of the &lt;tt class="docutils literal"&gt;getGui&lt;/tt&gt; method in the cell - so
we just return the span we create. Also, we created the span element in init but filled it in refresh - to avoid it creating the same element lots of times (this would
be more imporntant of course on more expensive&amp;nbsp;operations).&lt;/p&gt;
&lt;p&gt;Now let&amp;#8217;s continue with &lt;tt class="docutils literal"&gt;ObjectEditor&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;ObjectEditor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;

&lt;span class="c1"&gt;// Surpress some keypresses&lt;/span&gt;
&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;onKeyDown&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;which&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;keyCode&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;37&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt;  &lt;span class="c1"&gt;// left&lt;/span&gt;
        &lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;39&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="c1"&gt;// right&lt;/span&gt;
        &lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="c1"&gt;// tab&lt;/span&gt;
        &lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;stopPropagation&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nx"&gt;ObjectEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;init&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// Create the container DOM element&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;div&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;style&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;border-radius: 15px; border: 1px solid grey;background: #e6e6e6;padding: 10px; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onkeydown&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;onKeyDown&lt;/span&gt;

    &lt;span class="c1"&gt;// Create the object-editing form&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;: &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;input&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;input&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;input&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;input&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;br&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="c1"&gt;// Create a save button&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;saveButton&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;saveButton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createTextNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Ok&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="nx"&gt;saveButton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addEventListener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;click&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;stopEditing&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;saveButton&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;init&lt;/tt&gt; function of ObjectEditor ise used to create a container div element that will hold the actual input elements. Then, using the fields
that were passed as a parameter to the editor it creates a &lt;tt class="docutils literal"&gt;label&lt;/tt&gt;, an &lt;tt class="docutils literal"&gt;input&lt;/tt&gt; and a &lt;tt class="docutils literal"&gt;br&lt;/tt&gt; element and inserts them one by one to the container div. The input is
instantiated with the current value of each attribute while its name is taken from the name of the corresponding field (from the fields parameter).
Finally, a saveButton is created that will stop the editing when&amp;nbsp;clicked.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;ObjectEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getGui&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="nx"&gt;ObjectEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;afterGuiAttached&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;inputs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementsByTagName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;input&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;inputs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;focus&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="nx"&gt;ObjectEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getValue&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;
    &lt;span class="c1"&gt;// Create the cell value (an object) from the inputs values&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;inputs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementsByTagName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;input&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;inputs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
          &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;inputs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;inputs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sr"&gt;/^\s+|\s+$/g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="nx"&gt;ObjectEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;destroy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="nx"&gt;ObjectEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;isPopup&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The other methods of ObjectEditor are simpler: &lt;tt class="docutils literal"&gt;getGui&lt;/tt&gt; actually returns the container we built in the &lt;tt class="docutils literal"&gt;init&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;afterGuiAttached&lt;/tt&gt;
is called when the component is attached to the &lt;span class="caps"&gt;DOM&lt;/span&gt; and focuses on the first input element, &lt;tt class="docutils literal"&gt;getValue&lt;/tt&gt; enumerates the input elements,
takes their value (and names) and return an object with the name/value pairs, &lt;tt class="docutils literal"&gt;destroy&lt;/tt&gt; dosn&amp;#8217;t do anything however it must be defined
and can be used for cleaning up if needed and &lt;tt class="docutils literal"&gt;isPopup&lt;/tt&gt; returns true to display the container as a popup instead of&amp;nbsp;inline.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="creating-the-array-like-cell-editor"&gt;
&lt;h2&gt;Creating the array-like cell&amp;nbsp;editor&lt;/h2&gt;
&lt;p&gt;The multi-line renderer/editor will allow a cell to contain a list of values. Here&amp;#8217;s the complete fiddle where the &amp;#8220;children&amp;#8221; column
is using the multi-line&amp;nbsp;component:&lt;/p&gt;
&lt;div class="jsfiddle"&gt;&lt;iframe width="100%" height="300" src="//jsfiddle.net/a6s7r4tq/1/embedded/js,resources,html,css,result/light/" allowfullscreen="allowfullscreen" frameborder="0"&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;p&gt;To integrate it with ag-grid we just need to use the corresponding editor and&amp;nbsp;renderer:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;headerName&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Children&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;children&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;editable&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;cellRenderer&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;MultiLineCellRenderer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;cellEditor&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;MultiLineEditor&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;MultiLineCellRenderer&lt;/tt&gt; is similar to the &lt;tt class="docutils literal"&gt;ObjectCellRenderer&lt;/tt&gt;. A span/container element is created
at the &lt;tt class="docutils literal"&gt;init&lt;/tt&gt; method and the &lt;tt class="docutils literal"&gt;refresh&lt;/tt&gt; method is called to fill it. The &lt;tt class="docutils literal"&gt;refresh&lt;/tt&gt; method outputs the
number of items in the list (i.e it writes N items) and uses the span&amp;#8217;s &lt;tt class="docutils literal"&gt;title&lt;/tt&gt; to display a tooltip with
the values of the&amp;nbsp;items:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;MultiLineCellRenderer&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;

&lt;span class="nx"&gt;MultiLineCellRenderer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;init&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;span&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;refresh&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nx"&gt;MultiLineCellRenderer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;refresh&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="kc"&gt;undefined&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;0 items&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class="c1"&gt;// Create the tooltip for the cell&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;res&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; item&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="nx"&gt;MultiLineCellRenderer&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getGui&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The logic of the &lt;tt class="docutils literal"&gt;MultiLineEditor&lt;/tt&gt; is also similar to the &lt;tt class="docutils literal"&gt;ObjectEditor&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;MultiLineEditor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;

&lt;span class="nx"&gt;MultiLineEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onKeyDown&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;which&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;keyCode&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;37&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt;  &lt;span class="c1"&gt;// left&lt;/span&gt;
        &lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;39&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="c1"&gt;// right&lt;/span&gt;
        &lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;  &lt;span class="c1"&gt;// tab&lt;/span&gt;
        &lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;stopPropagation&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="c1"&gt;// Used to append list items (their value along with the remove button)&lt;/span&gt;
&lt;span class="nx"&gt;MultiLineEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addLine&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;li&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;li&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;span&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;span&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;removeButton&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;removeButton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;margin-left: 5px; text-align: right; &amp;#39;&lt;/span&gt;
    &lt;span class="nx"&gt;removeButton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Remove&amp;#39;&lt;/span&gt;
    &lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;li&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;span&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nx"&gt;li&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;removeButton&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;li&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;that&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;removeButton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addEventListener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;click&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;that&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;removeChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;parentElement&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nx"&gt;MultiLineEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;init&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;that&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;div&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;style&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;border-radius: 15px; border: 1px solid grey;background: #e6e6e6;padding: 10px;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ol&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addLine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;input&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addButton&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addButton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Add&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addButton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addEventListener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;click&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;that&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="kc"&gt;undefined&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nx"&gt;that&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addLine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;that&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;that&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addButton&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;saveButton&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createElement&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;saveButton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Ok&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;saveButton&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;addEventListener&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;click&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;stopEditing&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;appendChild&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;saveButton&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;A &lt;tt class="docutils literal"&gt;div&lt;/tt&gt; element that will display the popup editor is created first. In this container we add a &lt;tt class="docutils literal"&gt;ol&lt;/tt&gt; element and then,
if there are values in the list they will be
appended in that &lt;tt class="docutils literal"&gt;ol&lt;/tt&gt; using the &lt;tt class="docutils literal"&gt;addLine&lt;/tt&gt; method. This method creates a &lt;tt class="docutils literal"&gt;li&lt;/tt&gt; element the value of each list item along with a
remove &lt;tt class="docutils literal"&gt;button&lt;/tt&gt; which removes the corresponding &lt;tt class="docutils literal"&gt;li&lt;/tt&gt; element when clicked (that &lt;tt class="docutils literal"&gt;that=this&lt;/tt&gt; is needed because
the click callback function of the button has a different &lt;tt class="docutils literal"&gt;this&lt;/tt&gt; than the &lt;tt class="docutils literal"&gt;addLine&lt;/tt&gt; method so &lt;tt class="docutils literal"&gt;that&lt;/tt&gt; needs
to be used&amp;nbsp;instead).&lt;/p&gt;
&lt;p&gt;After the list of the items, there&amp;#8217;s an &lt;tt class="docutils literal"&gt;input&lt;/tt&gt; whose value will be inserted to the list when clicking the
add &lt;tt class="docutils literal"&gt;button&lt;/tt&gt;. The same &lt;tt class="docutils literal"&gt;addLine&lt;/tt&gt; function we used when initializing the component is used here to append the
input&amp;#8217;s value to the &lt;tt class="docutils literal"&gt;ol&lt;/tt&gt;. Finally the save &lt;tt class="docutils literal"&gt;button&lt;/tt&gt; stops the list&amp;nbsp;editing:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;MultiLineEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getGui&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="nx"&gt;MultiLineEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;afterGuiAttached&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;inputs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;container&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementsByTagName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;input&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="nx"&gt;inputs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;focus&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="nx"&gt;MultiLineEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getValue&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[];&lt;/span&gt;
    &lt;span class="c1"&gt;// The value is the text of all the span items of the li items&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;items&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementsByTagName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;span&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;items&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;items&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;res&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="nx"&gt;MultiLineEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;destroy&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="nx"&gt;MultiLineEditor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;prototype&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;isPopup&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For the value of this component, we just enumerate through the &lt;tt class="docutils literal"&gt;li span&lt;/tt&gt; items of the list we created through &lt;tt class="docutils literal"&gt;addLine&lt;/tt&gt;
and add it to a normal javascript&amp;nbsp;array.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="some-more-discussion-about-the-components"&gt;
&lt;h2&gt;Some more discussion about the&amp;nbsp;components&lt;/h2&gt;
&lt;p&gt;The above components can be used as they are however I think that their greatest value is that they should show-off some of
the capabilities of ag-grid and used as templates to build up your own stuff. Beyond styling or changing the layout
of the multi-line and the object editor, I can think of a great number of extensions for them. Some examples, left as
an excerise to the&amp;nbsp;reader:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;The renderer components are rather simple, you may create any &lt;span class="caps"&gt;DOM&lt;/span&gt; structure you want in&amp;nbsp;them&lt;/li&gt;
&lt;li&gt;Pass a function as a parameter to the object or multi-line editor that will be used as a validator for the values (i.e not allow nulls or enforce a specific format) - then you can add another &amp;#8220;error&amp;#8221; &lt;tt class="docutils literal"&gt;span&lt;/tt&gt; that will be displayed if the validation does not&amp;nbsp;pass&lt;/li&gt;
&lt;li&gt;Make the object editor smarter by passing the type of each attribute (i.e text, number, boolean, date) and check that each input corresponds to that&amp;nbsp;type&lt;/li&gt;
&lt;li&gt;Pass a min/max number of list items for the multi-line&amp;nbsp;editor&lt;/li&gt;
&lt;li&gt;The multi-line editor doesn&amp;#8217;t really need to have only text values for each item. You could combine the multi-line editor with the object editor so that each line has a specific, object-like structure. For example, for each child we may have two attributes, name and date of&amp;nbsp;birth&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</content><category term="javascript"></category><category term="javascript"></category><category term="component"></category><category term="ag-grid"></category><category term="grid"></category></entry><entry><title>Getting a logical backup of all databases of your PostgresqlÂ server</title><link href="https://spapas.github.io/2016/11/02/postgresql-backup/" rel="alternate"></link><published>2016-11-02T15:10:00+02:00</published><updated>2016-11-02T15:10:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2016-11-02:/2016/11/02/postgresql-backup/</id><summary type="html">&lt;p class="first last"&gt;A script to help you backup your postgresql&amp;nbsp;databases&lt;/p&gt;
</summary><content type="html">&lt;p&gt;In this small post I will present a small bash script that could be used to create logical backups of all the databases in a Postgresql server along
with some other goodies. More specifically, the script&amp;nbsp;will:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Create two files at /tmp to output information (one for debugging and one with info for sending it through email at the&amp;nbsp;end)&lt;/li&gt;
&lt;li&gt;Create a backup directory with the current&amp;nbsp;date&lt;/li&gt;
&lt;li&gt;Create a list of all databases found on the&amp;nbsp;server&lt;/li&gt;
&lt;li&gt;For each database, vacuum and analyze it, backup it, gzip it and put it in the backup&amp;nbsp;directory&lt;/li&gt;
&lt;li&gt;Write info about the backup in the info log&amp;nbsp;file&lt;/li&gt;
&lt;li&gt;Do the same for global&amp;nbsp;objects&lt;/li&gt;
&lt;li&gt;Send an email when the backup is finished with the info&amp;nbsp;log&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now, in my system I&amp;#8217;m using an external folder at &lt;tt class="docutils literal"&gt;/mnt/backupdb&lt;/tt&gt; to put my backups. You may either use the same technique or connect remotely to a
postgresql database (so you need to change the parameters of &lt;tt class="docutils literal"&gt;vacuumdb&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;pg_dump&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;pg_dumpall&lt;/tt&gt; to define the server and credentials to connect to)
and put the backups to a local&amp;nbsp;disc.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/sh&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &amp;gt; /tmp/db_backup.log
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &amp;gt; /tmp/db_backup_info.log
&lt;span class="nv"&gt;date_str&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;date +&lt;span class="s2"&gt;&amp;quot;%Y%m%d_%H%M%S&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="nv"&gt;backup_dir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/mnt/backupdb/pg_backup.&lt;span class="nv"&gt;$date_str&lt;/span&gt;

mkdir &lt;span class="nv"&gt;$backup_dir&lt;/span&gt;
&lt;span class="nb"&gt;pushd&lt;/span&gt; &lt;span class="nv"&gt;$backup_dir&lt;/span&gt; &amp;gt; /dev/null

&lt;span class="nv"&gt;dbs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;sudo -u postgres psql -Upostgres -lt &lt;span class="p"&gt;|&lt;/span&gt; grep -v : &lt;span class="p"&gt;|&lt;/span&gt; cut -d &lt;span class="se"&gt;\|&lt;/span&gt; -f &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; grep -v template &lt;span class="p"&gt;|&lt;/span&gt; grep -v -e &lt;span class="s1"&gt;&amp;#39;^\s*$&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed -e &lt;span class="s1"&gt;&amp;#39;s/  *$//&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;  tr &lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Will backup: &lt;/span&gt;&lt;span class="nv"&gt;$dbs&lt;/span&gt;&lt;span class="s2"&gt; to &lt;/span&gt;&lt;span class="nv"&gt;$backup_dir&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log
&lt;span class="k"&gt;for&lt;/span&gt; db in &lt;span class="nv"&gt;$dbs&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Starting backup for &lt;/span&gt;&lt;span class="nv"&gt;$db&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log
  &lt;span class="nv"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$db&lt;/span&gt;.&lt;span class="nv"&gt;$date_str&lt;/span&gt;.sql.gz
  sudo -u postgres vacuumdb --analyze -Upostgres &lt;span class="nv"&gt;$db&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup.log
  sudo -u postgres pg_dump -Upostgres -v &lt;span class="nv"&gt;$db&lt;/span&gt; -F p &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&amp;gt; /tmp/db_backup.log &lt;span class="p"&gt;|&lt;/span&gt; gzip &amp;gt; &lt;span class="nv"&gt;$filename&lt;/span&gt;
  &lt;span class="nv"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;stat &lt;span class="nv"&gt;$filename&lt;/span&gt; --printf&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
  &lt;span class="nv"&gt;kb_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;scale=2; &lt;/span&gt;&lt;span class="nv"&gt;$size&lt;/span&gt;&lt;span class="s2"&gt; / 1024.0&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; bc&lt;span class="sb"&gt;`&lt;/span&gt;
  &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Finished backup for &lt;/span&gt;&lt;span class="nv"&gt;$db&lt;/span&gt;&lt;span class="s2"&gt; - size is &lt;/span&gt;&lt;span class="nv"&gt;$kb_size&lt;/span&gt;&lt;span class="s2"&gt; KB&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log
&lt;span class="k"&gt;done&lt;/span&gt;

&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Backing up global objects&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log
&lt;span class="nv"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;global.&lt;span class="nv"&gt;$date_str&lt;/span&gt;.sql.gz
sudo -u postgres pg_dumpall -Upostgres -v -g &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&amp;gt; /tmp/db_backup.log &lt;span class="p"&gt;|&lt;/span&gt; gzip &amp;gt; &lt;span class="nv"&gt;$filename&lt;/span&gt;
&lt;span class="nv"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;stat &lt;span class="nv"&gt;$filename&lt;/span&gt; --printf&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="nv"&gt;kb_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;scale=2; &lt;/span&gt;&lt;span class="nv"&gt;$size&lt;/span&gt;&lt;span class="s2"&gt; / 1024.0&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; bc&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Finished backup for global - size is &lt;/span&gt;&lt;span class="nv"&gt;$kb_size&lt;/span&gt;&lt;span class="s2"&gt; KB&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log

&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Ok!&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log
mail -s &lt;span class="s2"&gt;&amp;quot;Backup results&amp;quot;&lt;/span&gt; spapas@mymail.foo.bar  &amp;lt; /tmp/db_backup_info.log
&lt;span class="nb"&gt;popd&lt;/span&gt; &amp;gt; /dev/null
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let&amp;#8217;s explain a bit the above script: The two first lines (echo &amp;#8230;)  will just clear out the two files &lt;tt class="docutils literal"&gt;/tmp/db_backup.log&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;/tmp/db_backup_info.log&lt;/tt&gt;. The first
will contain debug info from the commands and the second one will contain our info that will be sent through an email at the end of the backup. After that, we initialize
&lt;tt class="docutils literal"&gt;date_str&lt;/tt&gt; with the current date in the form &lt;tt class="docutils literal"&gt;20161102_145011&lt;/tt&gt; and the backup_dir with the correct directory to save the backups to. We then create the backup directory
and switch to it with &lt;tt class="docutils literal"&gt;pushd&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The following, rather long command will assign the names of the databases to the &lt;tt class="docutils literal"&gt;dbs&lt;/tt&gt; variable. So how is it working? &lt;tt class="docutils literal"&gt;psql &lt;span class="pre"&gt;-lt&lt;/span&gt;&lt;/tt&gt; lists the names of the databases, but lists
also more non-needed information which we remove with the following commands (grep, cut etc). The sed removes whitespace and the tr concatenates individual lines to a single line
so dbs will have a value like &amp;#8216;db1 db2 &amp;#8230;&amp;#8217;. For each one of these files then we assign its name and date to a filename and then, after we execute vacuumdb we use pg_dump with gzip to actually
create the backup and output it to the file. The other two lines (size and kb_size) are used to calculate the size of the backup file (to be sure that something is actually created) - you&amp;#8217;ll
need to install bc for that. The same process is followed the to backup global objects (usernames etc) using &lt;tt class="docutils literal"&gt;pg_dumpall &lt;span class="pre"&gt;-g&lt;/span&gt;&lt;/tt&gt;. Finally, we send a mail with a subject of &amp;#8220;Backup results&amp;#8221;
and body the contents of &lt;tt class="docutils literal"&gt;/tmp/db_backup_info.log&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;I&amp;#8217;ve saved this file to &lt;tt class="docutils literal"&gt;/var/lib/pgsql/db_backup_all.sh&lt;/tt&gt;. To run I propose using cron &amp;#8212; just edit your crontab (through &lt;tt class="docutils literal"&gt;vi /etc/crontab&lt;/tt&gt;) and add the&amp;nbsp;line&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
15 2  *  *  * root       /usr/bin/bash /var/lib/pgsql/db_backup_all.sh
&lt;/pre&gt;
&lt;p&gt;This will run the backup every night at 2.15. Uses the root user to have access rights to the backup folder. One thing to be careful about is that on Redhat/Centos distributions,
the above won&amp;#8217;t work because sudo requires a tty to work and cron doesn&amp;#8217;t have one. To fix this, comment out the&amp;nbsp;line&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
Defaults    requiretty
&lt;/pre&gt;
&lt;p&gt;of your /etc/sudoers&amp;nbsp;file.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update 02/12/2016:&lt;/strong&gt; Here&amp;#8217;s a little better version of the above script&amp;nbsp;that&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;Create two files for each database, one with &lt;span class="caps"&gt;SQL&lt;/span&gt; script backup, one with binary backup. Although with &lt;span class="caps"&gt;SQL&lt;/span&gt; backup you can check out the backup and maybe do changes before applying it, the binary backup is a more foolproof method of restoring everything to your database! Also, instead of restoring the database through &lt;tt class="docutils literal"&gt;psql&lt;/tt&gt; (as required by the &lt;span class="caps"&gt;SQL&lt;/span&gt; script backup), using the binary backup you can restore through the &lt;tt class="docutils literal"&gt;pg_restore&lt;/tt&gt; tool.&lt;/li&gt;
&lt;li&gt;Adds a function to output the file size (so the script is more &lt;span class="caps"&gt;DRY&lt;/span&gt;)&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/sh&lt;/span&gt;

&lt;span class="k"&gt;function&lt;/span&gt; output_file_size &lt;span class="o"&gt;{&lt;/span&gt;
  &lt;span class="nv"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;stat &lt;span class="nv"&gt;$1&lt;/span&gt; --printf&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;%s&amp;quot;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
  &lt;span class="nv"&gt;kb_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;scale=2; &lt;/span&gt;&lt;span class="nv"&gt;$size&lt;/span&gt;&lt;span class="s2"&gt; / 1024.0&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; bc&lt;span class="sb"&gt;`&lt;/span&gt;
  &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Finished backup for &lt;/span&gt;&lt;span class="nv"&gt;$2&lt;/span&gt;&lt;span class="s2"&gt; - size is &lt;/span&gt;&lt;span class="nv"&gt;$kb_size&lt;/span&gt;&lt;span class="s2"&gt; KB&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log
&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &amp;gt; /tmp/db_backup.log
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt; &amp;gt; /tmp/db_backup_info.log
&lt;span class="nv"&gt;date_str&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;date +&lt;span class="s2"&gt;&amp;quot;%Y%m%d_%H%M%S&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="nv"&gt;backup_dir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/mnt/backupdb/dbpg/pg_backup.&lt;span class="nv"&gt;$date_str&lt;/span&gt;

mkdir &lt;span class="nv"&gt;$backup_dir&lt;/span&gt;
&lt;span class="nb"&gt;pushd&lt;/span&gt; &lt;span class="nv"&gt;$backup_dir&lt;/span&gt; &amp;gt; /dev/null
&lt;span class="nv"&gt;dbs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;sudo -u postgres psql -Upostgres -lt &lt;span class="p"&gt;|&lt;/span&gt; cut -d &lt;span class="se"&gt;\|&lt;/span&gt; -f &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; grep -v template &lt;span class="p"&gt;|&lt;/span&gt; grep -v -e &lt;span class="s1"&gt;&amp;#39;^\s*$&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; sed -e &lt;span class="s1"&gt;&amp;#39;s/  *$//&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;  tr &lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="c1"&gt;#dbs=&amp;#39;dgul  hrms  mailer_server  missions  postgres&amp;#39;&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Will backup: &lt;/span&gt;&lt;span class="nv"&gt;$dbs&lt;/span&gt;&lt;span class="s2"&gt; to &lt;/span&gt;&lt;span class="nv"&gt;$backup_dir&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log
&lt;span class="k"&gt;for&lt;/span&gt; db in &lt;span class="nv"&gt;$dbs&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
  &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Starting backup for &lt;/span&gt;&lt;span class="nv"&gt;$db&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log
  &lt;span class="nv"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$db&lt;/span&gt;.&lt;span class="nv"&gt;$date_str&lt;/span&gt;.sql.gz
  &lt;span class="nv"&gt;filename_binary&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$db&lt;/span&gt;.&lt;span class="nv"&gt;$date_str&lt;/span&gt;.bak.gz
  sudo -u postgres vacuumdb --analyze -Upostgres &lt;span class="nv"&gt;$db&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup.log
  sudo -u postgres pg_dump -Upostgres -v &lt;span class="nv"&gt;$db&lt;/span&gt; -F p &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&amp;gt; /tmp/db_backup.log &lt;span class="p"&gt;|&lt;/span&gt; gzip &amp;gt; &lt;span class="nv"&gt;$filename&lt;/span&gt;
  sudo -u postgres pg_dump -Upostgres -v &lt;span class="nv"&gt;$db&lt;/span&gt; -F c &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&amp;gt; /tmp/db_backup.log &lt;span class="p"&gt;|&lt;/span&gt; gzip &amp;gt; &lt;span class="nv"&gt;$filename_binary&lt;/span&gt;
  output_file_size &lt;span class="nv"&gt;$filename&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$db&lt;/span&gt;&lt;span class="s2"&gt; sql&amp;quot;&lt;/span&gt;
  output_file_size &lt;span class="nv"&gt;$filename_binary&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$db&lt;/span&gt;&lt;span class="s2"&gt; bin&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Backing up global objects&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log
&lt;span class="nv"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;global.&lt;span class="nv"&gt;$date_str&lt;/span&gt;.sql.gz
sudo -u postgres pg_dumpall -Upostgres -v -g &lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&amp;gt; /tmp/db_backup.log &lt;span class="p"&gt;|&lt;/span&gt; gzip &amp;gt; &lt;span class="nv"&gt;$filename&lt;/span&gt;
output_file_size &lt;span class="nv"&gt;$filename&lt;/span&gt; global
&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Ok!&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; /tmp/db_backup_info.log
mail -s &lt;span class="s2"&gt;&amp;quot;Backup results&amp;quot;&lt;/span&gt; spapas@hcg.gr  &amp;lt; /tmp/db_backup_info.log
&lt;span class="nb"&gt;popd&lt;/span&gt; &amp;gt; /dev/null
&lt;/pre&gt;&lt;/div&gt;
</content><category term="postgresql"></category><category term="bash"></category><category term="cron"></category><category term="postgresql"></category></entry><entry><title>A pandas pivot_tableÂ primer</title><link href="https://spapas.github.io/2016/09/21/pandas-pivot-table-primer/" rel="alternate"></link><published>2016-09-21T11:20:00+03:00</published><updated>2016-09-21T11:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2016-09-21:/2016/09/21/pandas-pivot-table-primer/</id><summary type="html">&lt;p&gt;A primer on how to use the very useful pivot_table command of a pandas&amp;nbsp;dataframe.&lt;/p&gt;</summary><content type="html">&lt;style type="text/css"&gt;/*!
*
* IPython notebook
*
*/
/* &lt;span class="caps"&gt;CSS&lt;/span&gt; font colors for translated &lt;span class="caps"&gt;ANSI&lt;/span&gt; escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #&lt;span class="caps"&gt;3E424D&lt;/span&gt;;
}
.ansi-black-bg {
  background-color: #&lt;span class="caps"&gt;3E424D&lt;/span&gt;;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #&lt;span class="caps"&gt;E75C58&lt;/span&gt;;
}
.ansi-red-bg {
  background-color: #&lt;span class="caps"&gt;E75C58&lt;/span&gt;;
}
.ansi-red-intense-fg {
  color: #&lt;span class="caps"&gt;B22B31&lt;/span&gt;;
}
.ansi-red-intense-bg {
  background-color: #&lt;span class="caps"&gt;B22B31&lt;/span&gt;;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #&lt;span class="caps"&gt;DDB62B&lt;/span&gt;;
}
.ansi-yellow-bg {
  background-color: #&lt;span class="caps"&gt;DDB62B&lt;/span&gt;;
}
.ansi-yellow-intense-fg {
  color: #&lt;span class="caps"&gt;B27D12&lt;/span&gt;;
}
.ansi-yellow-intense-bg {
  background-color: #&lt;span class="caps"&gt;B27D12&lt;/span&gt;;
}
.ansi-blue-fg {
  color: #&lt;span class="caps"&gt;208FFB&lt;/span&gt;;
}
.ansi-blue-bg {
  background-color: #&lt;span class="caps"&gt;208FFB&lt;/span&gt;;
}
.ansi-blue-intense-fg {
  color: #&lt;span class="caps"&gt;0065CA&lt;/span&gt;;
}
.ansi-blue-intense-bg {
  background-color: #&lt;span class="caps"&gt;0065CA&lt;/span&gt;;
}
.ansi-magenta-fg {
  color: #&lt;span class="caps"&gt;D160C4&lt;/span&gt;;
}
.ansi-magenta-bg {
  background-color: #&lt;span class="caps"&gt;D160C4&lt;/span&gt;;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #&lt;span class="caps"&gt;60C6C8&lt;/span&gt;;
}
.ansi-cyan-bg {
  background-color: #&lt;span class="caps"&gt;60C6C8&lt;/span&gt;;
}
.ansi-cyan-intense-fg {
  color: #&lt;span class="caps"&gt;258F8F&lt;/span&gt;;
}
.ansi-cyan-intense-bg {
  background-color: #&lt;span class="caps"&gt;258F8F&lt;/span&gt;;
}
.ansi-white-fg {
  color: #&lt;span class="caps"&gt;C5C1B4&lt;/span&gt;;
}
.ansi-white-bg {
  background-color: #&lt;span class="caps"&gt;C5C1B4&lt;/span&gt;;
}
.ansi-white-intense-fg {
  color: #&lt;span class="caps"&gt;A1A6B2&lt;/span&gt;;
}
.ansi-white-intense-bg {
  background-color: #&lt;span class="caps"&gt;A1A6B2&lt;/span&gt;;
}
.ansi-default-inverse-fg {
  color: #&lt;span class="caps"&gt;FFFFFF&lt;/span&gt;;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #&lt;span class="caps"&gt;E3F2FD&lt;/span&gt;;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #&lt;span class="caps"&gt;E3F2FD&lt;/span&gt;;
  border-right-width: 1px;
  background: #&lt;span class="caps"&gt;E3F2FD&lt;/span&gt;;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #&lt;span class="caps"&gt;42A5F5&lt;/span&gt;;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #&lt;span class="caps"&gt;66BB6A&lt;/span&gt;;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #&lt;span class="caps"&gt;66BB6A&lt;/span&gt;;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell &gt; div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #&lt;span class="caps"&gt;303F9F&lt;/span&gt;;
  border-top: 1px solid transparent;
}
div.input_area &gt; div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area &gt; div.highlight &gt; pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the &lt;head&gt; if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In &lt;span class="caps"&gt;CM2&lt;/span&gt;, this used to be 0.4em, but in &lt;span class="caps"&gt;CM3&lt;/span&gt; it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In &lt;span class="caps"&gt;CM3&lt;/span&gt; this went to 4px from 0 in &lt;span class="caps"&gt;CM2&lt;/span&gt;. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev &lt;Maniac@SoftwareManiacs.Org&gt;
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt;;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #&lt;span class="caps"&gt;AA22FF&lt;/span&gt;;
  font-weight: bold;
}
.highlight-meta {
  color: #&lt;span class="caps"&gt;AA22FF&lt;/span&gt;;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #&lt;span class="caps"&gt;AA22FF&lt;/span&gt;;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt;;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #&lt;span class="caps"&gt;AA22FF&lt;/span&gt;;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but &lt;span class="caps"&gt;FF&lt;/span&gt; barfs all over that */
  height: 24em;
  /* &lt;span class="caps"&gt;FF&lt;/span&gt; needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/&lt;span class="caps"&gt;FF&lt;/span&gt; */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph &gt; img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell &gt; div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
&lt;/style&gt;
&lt;style type="text/css"&gt;.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #&lt;span class="caps"&gt;FF0000&lt;/span&gt; } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #&lt;span class="caps"&gt;BC7A00&lt;/span&gt; } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #&lt;span class="caps"&gt;FF0000&lt;/span&gt; } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #&lt;span class="caps"&gt;0044DD&lt;/span&gt; } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt; } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #&lt;span class="caps"&gt;0000FF&lt;/span&gt;; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #&lt;span class="caps"&gt;AA22FF&lt;/span&gt; } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #&lt;span class="caps"&gt;D2413A&lt;/span&gt;; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #&lt;span class="caps"&gt;0000FF&lt;/span&gt; } /* Name.Function */
.highlight .nl { color: #&lt;span class="caps"&gt;A0A000&lt;/span&gt; } /* Name.Label */
.highlight .nn { color: #&lt;span class="caps"&gt;0000FF&lt;/span&gt;; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #&lt;span class="caps"&gt;AA22FF&lt;/span&gt;; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt; } /* Literal.String.Affix */
.highlight .sb { color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt; } /* Literal.String.Backtick */
.highlight .sc { color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt; } /* Literal.String.Char */
.highlight .dl { color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt; } /* Literal.String.Delimiter */
.highlight .sd { color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt;; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt; } /* Literal.String.Double */
.highlight .se { color: #&lt;span class="caps"&gt;BB6622&lt;/span&gt;; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt; } /* Literal.String.Heredoc */
.highlight .si { color: #&lt;span class="caps"&gt;BB6688&lt;/span&gt;; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #&lt;span class="caps"&gt;BB6688&lt;/span&gt; } /* Literal.String.Regex */
.highlight .s1 { color: #&lt;span class="caps"&gt;BA2121&lt;/span&gt; } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #&lt;span class="caps"&gt;0000FF&lt;/span&gt; } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */&lt;/style&gt;
&lt;style type="text/css"&gt;
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #&lt;span class="caps"&gt;3E424D&lt;/span&gt;; }
.ansi-black-bg { background-color: #&lt;span class="caps"&gt;3E424D&lt;/span&gt;; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #&lt;span class="caps"&gt;E75C58&lt;/span&gt;; }
.ansi-red-bg { background-color: #&lt;span class="caps"&gt;E75C58&lt;/span&gt;; }
.ansi-red-intense-fg { color: #&lt;span class="caps"&gt;B22B31&lt;/span&gt;; }
.ansi-red-intense-bg { background-color: #&lt;span class="caps"&gt;B22B31&lt;/span&gt;; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #&lt;span class="caps"&gt;DDB62B&lt;/span&gt;; }
.ansi-yellow-bg { background-color: #&lt;span class="caps"&gt;DDB62B&lt;/span&gt;; }
.ansi-yellow-intense-fg { color: #&lt;span class="caps"&gt;B27D12&lt;/span&gt;; }
.ansi-yellow-intense-bg { background-color: #&lt;span class="caps"&gt;B27D12&lt;/span&gt;; }
.ansi-blue-fg { color: #&lt;span class="caps"&gt;208FFB&lt;/span&gt;; }
.ansi-blue-bg { background-color: #&lt;span class="caps"&gt;208FFB&lt;/span&gt;; }
.ansi-blue-intense-fg { color: #&lt;span class="caps"&gt;0065CA&lt;/span&gt;; }
.ansi-blue-intense-bg { background-color: #&lt;span class="caps"&gt;0065CA&lt;/span&gt;; }
.ansi-magenta-fg { color: #&lt;span class="caps"&gt;D160C4&lt;/span&gt;; }
.ansi-magenta-bg { background-color: #&lt;span class="caps"&gt;D160C4&lt;/span&gt;; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #&lt;span class="caps"&gt;60C6C8&lt;/span&gt;; }
.ansi-cyan-bg { background-color: #&lt;span class="caps"&gt;60C6C8&lt;/span&gt;; }
.ansi-cyan-intense-fg { color: #&lt;span class="caps"&gt;258F8F&lt;/span&gt;; }
.ansi-cyan-intense-bg { background-color: #&lt;span class="caps"&gt;258F8F&lt;/span&gt;; }
.ansi-white-fg { color: #&lt;span class="caps"&gt;C5C1B4&lt;/span&gt;; }
.ansi-white-bg { background-color: #&lt;span class="caps"&gt;C5C1B4&lt;/span&gt;; }
.ansi-white-intense-fg { color: #&lt;span class="caps"&gt;A1A6B2&lt;/span&gt;; }
.ansi-white-intense-bg { background-color: #&lt;span class="caps"&gt;A1A6B2&lt;/span&gt;; }

.ansi-bold { font-weight: bold; }
&lt;/style&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Introduction"&gt;Introduction&lt;a class="anchor-link" href="#Introduction"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Recently, I started using the &lt;a href="http://pandas.pydata.org/"&gt;pandas&lt;/a&gt; python library to improve the quality 
(and quantity) of statistics in my applications. One pandas method that I use frequently and is really powerful is &lt;code&gt;pivot_table&lt;/code&gt;. This is a rather complex method that has
&lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html"&gt;very poor documentation&lt;/a&gt;.
Beyond this, this command is explained a little more in an article about 
&lt;a href="http://pandas.pydata.org/pandas-docs/stable/reshaping.html"&gt;data reshaping&lt;/a&gt;, however, even this leaves
much to be desired (when I first tried reading it I was overwhelmed by the amount of information&amp;nbsp;there).&lt;/p&gt;
&lt;p&gt;A great introduction to pandas is the &lt;a href="http://www.gregreda.com/2013/10/26/intro-to-pandas-data-structures/"&gt;three part series&lt;/a&gt; by Greg Reda - it touches &lt;code&gt;pivot_table&lt;/code&gt; however I was only able to understand it properly &lt;em&gt;after&lt;/em&gt; I played a lot with it. I don&amp;#8217;t know, maybe playing with &lt;code&gt;pivot_table&lt;/code&gt; yourself (or being really experienced in such concepts) is the only way to properly comprehend it! To help with this journey however I&amp;#8217;m going to try to explain various basic pandas concepts that will lead us to the &lt;code&gt;pivot_table&lt;/code&gt; command (and some of its friends). Notice that I&amp;#8217;m using pandas&amp;nbsp;0.18.1.&lt;/p&gt;
&lt;p&gt;I have to mention that I am no expert in statistics or
numeric analysis so this post won&amp;#8217;t have any advanced 
information and may even point out some obvious things. However
keep in mind things that may seem obvious to some
experts are really difficult to grasp for a&amp;nbsp;non-expert.&lt;/p&gt;
&lt;p&gt;Before continuing, please notice that this article has been written as a &lt;a href="http://jupyter.org/"&gt;jupyter notebook&lt;/a&gt; and was integrated with pelican using the &lt;a href="https://github.com/danielfrg/pelican-ipynb"&gt;pelican-ipynb plugin&lt;/a&gt;. I had to do some modifications to my theme to better integrate the notebook styling, however some stuff may not look as nice as the other articles. I have to mention that this integration is really great and I totally recommend&amp;nbsp;it!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="The-DataFrame"&gt;The DataFrame&lt;a class="anchor-link" href="#The-DataFrame"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The most important data structure that pandas uses is the &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html"&gt;DataFrame&lt;/a&gt;. This can be thought as a two dimensional array, something like an Excel spreadsheet. In the pandas nomenclature, the rows of that two-dimensional array are called &lt;em&gt;indexes&lt;/em&gt; (while the columns are still called &lt;em&gt;columns&lt;/em&gt;) &amp;#8212; I&amp;#8217;ll either use rows or indexes for the rows of the DataFrame. The rows are called indexes because they can be used to &amp;#8230; index data (think of each column as a dictionary). However please notice that pandas has a different data structure named &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Index.html"&gt;Index&lt;/a&gt; that is used to store the names of the headers (axis) of the rows and&amp;nbsp;columns.&lt;/p&gt;
&lt;p&gt;If we horizontally/vertically pick the values of a single row(index)/column we&amp;#8217;ll be left with a different data structure called &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.html"&gt;Series&lt;/a&gt; - this is more or less a single dimensional array (or a dictionary with the names of the columns/indexes as keys). There&amp;#8217;s also a &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Panel.html"&gt;Panel&lt;/a&gt; data structure which is 3-dimensional, more like a complete Excel workbook (the third dimension being the individual sheets of the workbook) but I won&amp;#8217;t cover that&amp;nbsp;here.&lt;/p&gt;
&lt;p&gt;More info on the above can be found on the corresponding &lt;a href="http://pandas.pydata.org/pandas-docs/stable/dsintro.html"&gt;article about data structures&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There are various ways to read the data for a Series or DataFrame: Initializing through &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.from_records.html"&gt;arrays or dicts&lt;/a&gt;, &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.from_csv.html"&gt;reading from csv&lt;/a&gt;, &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_excel.html"&gt;xls&lt;/a&gt;, &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_sql_query.html"&gt;database&lt;/a&gt;, combinining series to create an array and various others. I won&amp;#8217;t go into any details about this but will include some examples on how to create Series and DataFrames. If you are familiar with python you can just convert everything to a dict and read that instead of researching individual&amp;nbsp;methods.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Using-Series"&gt;Using Series&lt;a class="anchor-link" href="#Using-Series"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The &lt;code&gt;Series&lt;/code&gt; data structure is more or less used to store a single dimensional array of data. This array-like structure could either have numbers as indexes (so will be more similar to a normal array) or have textual indexes (so will be more similar to a dictionary). Let&amp;#8217;s see some&amp;nbsp;examples:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[203]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Return the class name of the object&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__class__&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;

&lt;span class="c1"&gt;# Use an array to create a Series&lt;/span&gt;
&lt;span class="n"&gt;series1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;series1 (&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;series1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;)&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;series1&lt;/span&gt;
&lt;span class="c1"&gt;# Notice that the index names were automatically generated as 0,1,2&lt;/span&gt;
&lt;span class="c1"&gt;# Use a dict to create a Series&lt;/span&gt;
&lt;span class="c1"&gt;# notice that the keys of the dict will be the index names&lt;/span&gt;
&lt;span class="n"&gt;series2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;series2 (&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;series2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;)&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;series2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;series1 ( Series )
0    10
1    20
2    30
dtype: int64
series2 ( Series )
row1    11
row2    22
row3    33
dtype: int64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The are various ways to select values from the Series. You can use textual or numeric indexes or you can filter the elements using an intuitive&amp;nbsp;syntax:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[204]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Get values from series using named indexes&lt;/span&gt;
&lt;span class="n"&gt;series2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# Can also use slicing and interesting operations &lt;/span&gt;
&lt;span class="c1"&gt;# like array in array [[]] to select specific indexes&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;series1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;series1&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;series2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;series2&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;row3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;1    20
2    30
dtype: int64
0    10
2    30
dtype: int64
row2    22
row3    33
dtype: int64
row1    11
row3    33
dtype: int64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[205]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Filtering series&lt;/span&gt;
&lt;span class="c1"&gt;# You can use comparison operators with a Series to &lt;/span&gt;
&lt;span class="c1"&gt;# get an array of booleans with the result of each element&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Boolean result&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;series2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;
&lt;span class="c1"&gt;# This boolean array can then be used to filter the Series&lt;/span&gt;
&lt;span class="c1"&gt;# by returning only the elements that are &amp;quot;True&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Filtered result&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;series2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;series2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Boolean result
row1    False
row2     True
row3     True
dtype: bool
Filtered result
row2    22
row3    33
dtype: int64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[206]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# The above means that we&amp;#39;ll only get the second and third (index: 0,2)&lt;/span&gt;

&lt;span class="c1"&gt;# So we can create a function that returns Boolean, apply it to &lt;/span&gt;
&lt;span class="c1"&gt;# all elements of series with map and use the result for indexing!&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;is_22&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Map filtering&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;series2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;series2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;is_22&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Map filtering
row2    22
dtype: int64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The &lt;code&gt;map&lt;/code&gt; method above gets a callback function and applies it to all elements of the Series, returning a new Series with the results. It is similar to the &lt;code&gt;map(function, sequence) -&amp;gt; list&lt;/code&gt; global python funtion. Using map filtering is the most general way to filter elements of a&amp;nbsp;series.&lt;/p&gt;
&lt;h2 id="Using-DataFrames"&gt;Using DataFrames&lt;a class="anchor-link" href="#Using-DataFrames"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Let&amp;#8217;s start by a quick introduction to see some basic operations on&amp;nbsp;DataFrames:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[207]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Create a DataFrame using a two-dimensional array&lt;/span&gt;
&lt;span class="c1"&gt;# Notice that the indexes and column names were automatically generated&lt;/span&gt;
&lt;span class="n"&gt;df1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;([[&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;]])&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Dataframe from array: df1(&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;)&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df1&lt;/span&gt;

&lt;span class="c1"&gt;# Use a dict to give names to columns&lt;/span&gt;
&lt;span class="n"&gt;df2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;([{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;}])&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Dataframe from dict: df2(&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;)&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df2&lt;/span&gt;

&lt;span class="c1"&gt;# Give names to indexes&lt;/span&gt;
&lt;span class="n"&gt;df3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; 
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;idx2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Dataframe from dict, named indexes: df3(&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;)&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;

&lt;span class="c1"&gt;# What happens when columns are missing&lt;/span&gt;
&lt;span class="n"&gt;df4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;([{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;}])&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Dataframe from dict, missing columns: df4(&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df4&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;)&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df4&lt;/span&gt;

&lt;span class="c1"&gt;# Create a DataFrame by combining series&lt;/span&gt;
&lt;span class="n"&gt;df5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Series&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;])],&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Dataframe from series: df5(&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;)&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df5&lt;/span&gt;

&lt;span class="c1"&gt;# Output a dataframe as html&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df5&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_html&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# Notice that there are many more interesting DataFrame output methods, like&lt;/span&gt;
&lt;span class="c1"&gt;# to_csv, to_dict, to_excel, to_json, to_latex, to_msgpack, to_string,&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Dataframe from array: df1( DataFrame )
    0   1   2
0  10  20  30
1  40  50  60
Dataframe from dict: df2( DataFrame )
   col1  col2  col3
0    10    20    30
1    40    50    60
Dataframe from dict, named indexes: df3( DataFrame )
      col1  col2  col3
idx1    10    20    30
idx2    40    50    60
Dataframe from dict, missing columns: df4( DataFrame )
   col1  col2  col3  col4
0  10.0    20    30   NaN
1   NaN    40    50  60.0
Dataframe from series: df5( DataFrame )
   0  1
a  1  2
b  3  4
&amp;lt;table border=&amp;#34;1&amp;#34; class=&amp;#34;dataframe&amp;#34;&amp;gt;
  &amp;lt;thead&amp;gt;
    &amp;lt;tr style=&amp;#34;text-align: right;&amp;#34;&amp;gt;
      &amp;lt;th&amp;gt;&amp;lt;/th&amp;gt;
      &amp;lt;th&amp;gt;0&amp;lt;/th&amp;gt;
      &amp;lt;th&amp;gt;1&amp;lt;/th&amp;gt;
    &amp;lt;/tr&amp;gt;
  &amp;lt;/thead&amp;gt;
  &amp;lt;tbody&amp;gt;
    &amp;lt;tr&amp;gt;
      &amp;lt;th&amp;gt;a&amp;lt;/th&amp;gt;
      &amp;lt;td&amp;gt;1&amp;lt;/td&amp;gt;
      &amp;lt;td&amp;gt;2&amp;lt;/td&amp;gt;
    &amp;lt;/tr&amp;gt;
    &amp;lt;tr&amp;gt;
      &amp;lt;th&amp;gt;b&amp;lt;/th&amp;gt;
      &amp;lt;td&amp;gt;3&amp;lt;/td&amp;gt;
      &amp;lt;td&amp;gt;4&amp;lt;/td&amp;gt;
    &amp;lt;/tr&amp;gt;
  &amp;lt;/tbody&amp;gt;
&amp;lt;/table&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Reading a DataFrame from an array of python dicts is (at least for me) the easiest way to put my data in a DataFrame. Use any normal python method to generate that array of dicts and then just initialize the DataFrme with that. Also, the &lt;code&gt;to_html&lt;/code&gt; method is really useful to quickly output a DataFrame to your web application - don&amp;#8217;t forget to add some styling to the &lt;code&gt;.dataframe&lt;/code&gt; class!&lt;/p&gt;
&lt;p&gt;Selecting values from the Dataframe is very easy if you know how to do it. You index (&lt;code&gt;[]&lt;/code&gt;) directly to select&amp;nbsp;columns:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[208]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;df3(&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;)&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;

&lt;span class="c1"&gt;# We can get a column as a Series&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Get column as series&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# Or multiple columns as a DataFrame&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Get multiple columns&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;col2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;

&lt;span class="c1"&gt;# We can also get the column by its idx &lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Get column by index&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;

&lt;span class="c1"&gt;# Pick values from a dataframe using array indexing&lt;/span&gt;
&lt;span class="c1"&gt;# df3[&amp;#39;col2&amp;#39;] returns a Series so using the [&amp;#39;idx2&amp;#39;] &lt;/span&gt;
&lt;span class="c1"&gt;# index to it will return the actual value&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Get value&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;df3( DataFrame )
      col1  col2  col3
idx1    10    20    30
idx2    40    50    60
Get column as series
idx1    30
idx2    60
Name: col3, dtype: int64
Get multiple columns
      col3  col2
idx1    30    20
idx2    60    50
Get column by index
idx1    20
idx2    50
Name: col2, dtype: int64
Get value
50
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Also you use the &lt;code&gt;loc/iloc&lt;/code&gt; properties of the &lt;code&gt;DataFrame&lt;/code&gt; to select rows/indexes (either by number or by text). The &lt;code&gt;loc/iloc&lt;/code&gt; actually behave as a two dimensional array - they can get two parameters, the first one being the row/rows and the second one being the&amp;nbsp;column/columns:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[209]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Pick an index (select a horizontal line) as a series&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Get index as a series&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# Also can pick by index number&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Get index as a series by index&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# iloc can be used to numerically index both rows and columns by passing two indexes:&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Two dimensional - get by index&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;:]&lt;/span&gt; &lt;span class="c1"&gt;# This is the same as the previous&lt;/span&gt;
&lt;span class="c1"&gt;# so to select the first column we&amp;#39;ll use&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Two dimensional - get by column&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# We could do more interesting things, for example select a square&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Two dimensional - get by index and column&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# Loc which is for label based indexing can also be used as a two dimensional index&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Two dimensional - use label based indexing&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Get index as a series
col1    10
col2    20
col3    30
Name: idx1, dtype: int64
Get index as a series by index
col1    10
col2    20
col3    30
Name: idx1, dtype: int64
Two dimensional - get by index
col1    10
col2    20
col3    30
Name: idx1, dtype: int64
Two dimensional - get by column
idx1    10
idx2    40
Name: col1, dtype: int64
Two dimensional - get by index and column
      col2  col3
idx1    20    30
idx2    50    60
Two dimensional - use label based indexing
idx1    10
idx2    40
Name: col1, dtype: int64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Of course, boolean indexing and filtering can also be used just like in&amp;nbsp;Series:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[210]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Boolean dataframe&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Boolean indexing&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;is_20_or_50&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;
&lt;span class="c1"&gt;# We need to use applymap (instead of map we used in Series)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Boolean indexing&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;applymap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;is_20_or_50&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Boolean dataframe
       col1   col2   col3
idx1  False  False  False
idx2   True   True   True
Boolean indexing
      col1  col2  col3
idx1   NaN   NaN   NaN
idx2  40.0  50.0  60.0
Boolean indexing
      col1  col2  col3
idx1   NaN    20   NaN
idx2   NaN    50   NaN
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Notice that for the DataFrame we use the &lt;code&gt;applymap&lt;/code&gt; method which applies the callback function to all individual elements of the  DataFrame and returns the result as a new  DataFrame (with the same dimensions of course). The boolean indexing is nice but it does not actually drop not needed things, we see that we just get a NaN in the positions that are filtered. Could we do something better? The answer is yes, but we&amp;#8217;ll need to do index/column boolean indexing - i.e select only specific columns or indexes and then pass these to filter the&amp;nbsp;dataframe:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[211]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Let&amp;#39;s see the indexes that have *10* in their col1 column&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;
&lt;span class="c1"&gt;# And then select *only* these indexes (i.e idx1)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# Now we can do exactly the opposite (see columns that have 10 in their idx1 index)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;
&lt;span class="c1"&gt;# And then select *only* these columns (i.e col1)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;idx1     True
idx2    False
Name: col1, dtype: bool
      col1  col2  col3
idx1    10    20    30
col1     True
col2    False
col3    False
Name: idx1, dtype: bool
      col1
idx1    10
idx2    40
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[212]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Let&amp;#39;s finally see a general solution to boolean selecting with loc:&lt;/span&gt;
&lt;span class="c1"&gt;# Select specific columns &lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[:,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# Select specific rows&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# Select specific rows and cols&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# So we can pass two boolean arrays to loc, the first for selecting indexes and &lt;/span&gt;
&lt;span class="c1"&gt;# the second for selecting columns&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;      col1  col3
idx1    10    30
idx2    40    60
      col1  col2  col3
idx2    40    50    60
      col1  col3
idx2    40    60
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Modifying-DataFrames"&gt;Modifying DataFrames&lt;a class="anchor-link" href="#Modifying-DataFrames"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;It&amp;#8217;s easy to modify the DataFrame by changing its values, adding more indexes / columns, dropping rows and columns, renaming columns and indexes. Notice that some operations are performed in place (so they modify the original DataFrame), while others return a copy of the original&amp;nbsp;array.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[213]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Let&amp;#39;s copy because some of the following operators change the dataframes&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Change values of a column&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;41&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Change values of an index&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;We can change more specific values (a 2x2 array here)&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Add another column to an existing dataframe (changes DataFrame)&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col4&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Add another row (index) to an existing dataframe (changes DataFrame)&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Drop a row (returns new object)&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Drop a column (returns new object)&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Rename index (returns new object)&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rename&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;new-idx-1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Rename column (returns new object)&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rename&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;col1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;new-col-1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Transpose array- change columns to rows and vice versa&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Double transpose - returns the initial DataFrame&amp;quot;&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;      col1  col2  col3
idx1    10    20    30
idx2    40    50    60
Change values of a column
      col1  col2  col3
idx1    11    20    30
idx2    41    50    60
Change values of an index
      col1  col2  col3
idx1    11    21    31
idx2    41    50    60
We can change more specific values (a 2x2 array here)
      col1  col2  col3
idx1     4     3    31
idx2     2     1    60
Add another column to an existing dataframe (changes DataFrame)
      col1  col2  col3  col4
idx1     4     3    31     1
idx2     2     1    60     2
Add another row (index) to an existing dataframe (changes DataFrame)
      col1  col2  col3  col4
idx1     4     3    31     1
idx2     2     1    60     2
idx3   100   200   300   400
Drop a row (returns new object)
      col1  col2  col3  col4
idx2     2     1    60     2
idx3   100   200   300   400
Drop a column (returns new object)
      col2  col3  col4
idx1     3    31     1
idx2     1    60     2
idx3   200   300   400
Rename index (returns new object)
           col1  col2  col3  col4
new-idx-1     4     3    31     1
idx2          2     1    60     2
idx3        100   200   300   400
Rename column (returns new object)
      new-col-1  col2  col3  col4
idx1          4     3    31     1
idx2          2     1    60     2
idx3        100   200   300   400
Transpose array- change columns to rows and vice versa
      idx1  idx2  idx3
col1     4     2   100
col2     3     1   200
col3    31    60   300
col4     1     2   400
Double transpose - returns the initial DataFrame
      col1  col2  col3  col4
idx1     4     3    31     1
idx2     2     1    60     2
idx3   100   200   300   400
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="More-advanced-operations"&gt;More advanced operations&lt;a class="anchor-link" href="#More-advanced-operations"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Beyond the previous, more or less basic operations, pandas allows you to do some advanced operations like &lt;span class="caps"&gt;SQL&lt;/span&gt;-like joins of more than one dataset or, applying a function to each of the rows / columns or even individual cells of the&amp;nbsp;DataFrame:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[214]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;authors_df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;([{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Michael Crichton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}],&lt;/span&gt;  &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;It&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; 
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The Stand&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; 
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Airframe&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Jurassic Park&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;authors_df&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;merge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authors_df&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;left_on&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;right_on&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;   id              name
0   1      Stephen King
1   2  Michael Crichton
   author_id  id           name
0          1   1             It
1          1   2      The Stand
2          2   3       Airframe
3          2   4  Jurassic Park
   author_id  id_x         name_x  id_y            name_y
0          1     1             It     1      Stephen King
1          1     2      The Stand     1      Stephen King
2          2     3       Airframe     2  Michael Crichton
3          2     4  Jurassic Park     2  Michael Crichton
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As can be seen above, the &lt;code&gt;merge&lt;/code&gt; method of DataFrame can be used to do an sql-like join with another DataFrame, using specific columns as join-keys for each of the two dataframes (&lt;code&gt;left_on&lt;/code&gt; and &lt;code&gt;right_on&lt;/code&gt;). There are a lot of options for doing various join types (left, right, inner, outer etc) and concatenating DataFrames with other ways - most are discussed in the &lt;a href="http://pandas.pydata.org/pandas-docs/stable/merging.html"&gt;corresponding post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s see another method of doing the above join that is more controlled, using the &lt;code&gt;apply&lt;/code&gt; method of DataFrame that &lt;em&gt;applies&lt;/em&gt; a function to each row/column of the DataFrame and returns the result as a&amp;nbsp;series:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[215]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Let&amp;#39;s do the join using a different method&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;author_df_partial&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;authors_df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;authors_df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;author_df_partial&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;   author_id  id           name       author name
0          1   1             It      Stephen King
1          1   2      The Stand      Stephen King
2          2   3       Airframe  Michael Crichton
3          2   4  Jurassic Park  Michael Crichton
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;How does this work? We pass the &lt;code&gt;axis=1&lt;/code&gt; parameter to &lt;code&gt;apply&lt;/code&gt; so that the callback function will be called for each row of the DataFrame (by default &lt;code&gt;axis=0&lt;/code&gt; which means it will be called for each column). So, &lt;code&gt;f&lt;/code&gt; will be called getting each row as an input. From this &lt;code&gt;book_df&lt;/code&gt; row, we get the &lt;code&gt;author_id&lt;/code&gt; it contains and filter &lt;code&gt;authors_df&lt;/code&gt; by it. Notice that &lt;code&gt;author_df_partial&lt;/code&gt; is actually a DataFrame containing only one row, so we need to filter it by getting its only line, using &lt;code&gt;iloc[0]&lt;/code&gt; which will return a Series and finally, we return the author name using the corresponding index &lt;code&gt;name&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;When calling the &lt;code&gt;apply&lt;/code&gt; method, by defautl the &lt;code&gt;axis&lt;/code&gt; parameter is 0 (i.e the function will be called for each column). When I first encountered this I found it very strange because I thought that most users would usually want to apply a function to each of the rows. However, there&amp;#8217;s a reason for applying the function to all columns, here&amp;#8217;s an&amp;nbsp;example:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[216]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;temperature&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;moisture&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;68&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;temperature&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;moisture&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;72&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;temperature&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;31.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;moisture&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;58&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;temperature&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;28.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;moisture&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;42&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="c1"&gt;# We can easily create statistics for our data using apply -- that&amp;#39;s why&lt;/span&gt;
&lt;span class="c1"&gt;# axis=0 is the default parameter to apply (to operate vertically to each column)&lt;/span&gt;
&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;avg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;average&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;len&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sum&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;     moisture  temperature
0        68.0         31.0
1        72.0         33.0
2        58.0         31.5
3        42.0         28.5
avg      60.0         31.0
len       5.0          5.0
sum     305.0        160.0
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Comprehending-pivot_table"&gt;Comprehending &lt;code&gt;pivot_table&lt;/code&gt;&lt;a class="anchor-link" href="#Comprehending-pivot_table"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;After this (rather long) introduction to using and manipulating DataFrames, the time has come to see &lt;code&gt;pivot_table&lt;/code&gt;. The &lt;code&gt;pivot_table&lt;/code&gt; method is applied to a DataFrame and its purpose is to &amp;#8220;reshape&amp;#8221; and &amp;#8220;aggregate&amp;#8221; the values of a DataFrame . More on reshaping can be found &lt;a href="http://pandas.pydata.org/pandas-docs/stable/reshaping.html"&gt;here&lt;/a&gt; and it means changing the indexes/columns of the DataFrame to create a new DataFrame that fits our needs. Aggregate on the other hand means that for each of the cells of the new DataFrame we&amp;#8217;ll create a summary of the data that should have appeared&amp;nbsp;there.&lt;/p&gt;
&lt;p&gt;We&amp;#8217;ll start by explaining how to create a nice set of data for the &lt;code&gt;pivot_table&lt;/code&gt; operations!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The recommended type of input (at least by me) to the &lt;code&gt;pivot_table&lt;/code&gt; is a simple DataFrame like the one I have already created:  Your index will be the &lt;code&gt;id&lt;/code&gt; of your database (or you could even have an auto-generated index like in the example) and the columns will be the values you want to aggregate and reshape. This is very easy to create either by reading a file (xls/csv) or by a simple &lt;span class="caps"&gt;SQL&lt;/span&gt; query (substituting all foreign keys with a representative value). In the above example, we actually have the following columns: &lt;em&gt;author, genre, name, pages, year, decade, size&lt;/em&gt; - this is a pool of data that will be very useful to remember for later and it is important to also keep it in your mind for your data. So, use a unique id as the index and remember the names of your&amp;nbsp;columns.&lt;/p&gt;
&lt;p&gt;As we can see in the documentation, the &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html"&gt;pivot_table method&lt;/a&gt; uses four basic&amp;nbsp;parameters:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;index&lt;/code&gt;: An array of the data that will be used as indexes to the resulting (i.e the reshaped and aggregated)&amp;nbsp;DataFrame&lt;/li&gt;
&lt;li&gt;&lt;code&gt;columns&lt;/code&gt;: An array of the data that will be used as a columns to the resulting&amp;nbsp;DataFrame&lt;/li&gt;
&lt;li&gt;&lt;code&gt;values&lt;/code&gt;: An array of the data whose values we want to aggregate in each&amp;nbsp;cell&lt;/li&gt;
&lt;li&gt;&lt;code&gt;aggfunc&lt;/code&gt;: Which is the function (or functions) that will be used for aggregating the&amp;nbsp;values&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, how it actually works? You select a number of the headers from your pool of data and assign them to either &lt;code&gt;index&lt;/code&gt; or &lt;code&gt;columns&lt;/code&gt;, depending if you want to put them horizontally or vertically. Notice that both &lt;code&gt;index&lt;/code&gt; and &lt;code&gt;columns&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;take either a string (to denote a single column) or an array to denote multiple&amp;nbsp;columns&lt;/li&gt;
&lt;li&gt;are optional (but you must define one of them) &amp;#8212; if you skip either columns or index you&amp;#8217;ll get a &lt;code&gt;Series&lt;/code&gt; instead of a &lt;code&gt;DataFrame&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;are interchangable (you can put any header from your pool to either index or columns, depending on how you want to display your&amp;nbsp;data)&lt;/li&gt;
&lt;li&gt;are mutually exclusive (you can&amp;#8217;t put the same header in both index and&amp;nbsp;columns)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Multiple data headers means that you&amp;#8217;ll have &lt;a href="http://pandas.pydata.org/pandas-docs/stable/advanced.html"&gt;hierachical indexes / columns&lt;/a&gt; in your pivot (or &lt;code&gt;MultiIndex&lt;/code&gt; as it&amp;#8217;s called - remember that &lt;code&gt;Index&lt;/code&gt; is used to store the axis of the DataFrame), ie the rows/columns would be grouped by a hierarchy. Let&amp;#8217;s see an example of multiple&amp;nbsp;indexes:&lt;/p&gt;
&lt;p&gt;If we used &lt;code&gt;'decade'&lt;/code&gt; as an index, then the pivot_table index would be&amp;nbsp;like&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;70s&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;80s&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;90s&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;while, if we used &lt;code&gt;['decade', 'year']&lt;/code&gt; we&amp;#8217;d hove something&amp;nbsp;like&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;70s&lt;/code&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;1975&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;1978&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;80s&lt;/code&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;1980&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;1982&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230;&lt;/li&gt;
&lt;li&gt;&amp;#8230;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;90s&lt;/code&gt;&lt;ul&gt;
&lt;li&gt;&lt;code&gt;1990&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230;&lt;/li&gt;
&lt;li&gt;&amp;#8230; &lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, each year would automatically be grouped to its corresponing decade. The same would be true if we used &lt;code&gt;['decade', 'year']&lt;/code&gt; in columns (but we&amp;#8217;ll now have a vertical grouping from top to bottom). Notice that pandas doesn&amp;#8217;t know if the values have any parent / child relationship but just goes from left to right (or top to bottom). For example, if we had used &lt;code&gt;['year', 'decade']&lt;/code&gt;, we&amp;#8217;d get something&amp;nbsp;like:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;1975 70s'&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230; &lt;/li&gt;
&lt;li&gt;&lt;code&gt;1978 70s'&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;1980 80s'&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230; &lt;/li&gt;
&lt;li&gt;&lt;code&gt;1982 80s'&lt;/code&gt; value1 value2&amp;nbsp;&amp;#8230;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Also, pandas doesn&amp;#8217;t care if the values of the hierarchical index are actually related. We could for example had selected a multi index of &lt;code&gt;['decade', 'size', 'genre']&lt;/code&gt; that&amp;nbsp;would&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;display the list of decades at the left (or at the top if we used it as a&amp;nbsp;column)&lt;/li&gt;
&lt;li&gt;for each decade will display the sizes of the book of that decade at the center (header column or row) and&amp;nbsp;finally&lt;/li&gt;
&lt;li&gt;at the right header (or bottom correspondingly) will display the available genres for each&amp;nbsp;size. &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, since we have 3 values for each decade, 3 values for each size and 4 values for each genre in our dataset, each decade will appear 1 time (at the left), each size will appear 3 times (one for each decade) in the middle and each genre will appear 3x3 = 9(one for each combination of decade and size) times in the right. The total number of lines that our MultiIndex will contain is 3x3x4 = 36 (one line for each combination of&amp;nbsp;decade/size/genre).&lt;/p&gt;
&lt;p&gt;I hope the above clarifies how index and columns are used to create the headers for rows and index of &lt;code&gt;pivot_table&lt;/code&gt;. I will show some examples of various index and columns combinations but first, I&amp;#8217;d like to talk about contents of the pivot table (since we&amp;#8217;ve only talked about the headers of rows/columns until&amp;nbsp;now).&lt;/p&gt;
&lt;p&gt;The values that the pivot_table will contain are defined through the other two parameters, &lt;code&gt;values&lt;/code&gt; and &lt;code&gt;aggfunc&lt;/code&gt;: We select one or more columns of the initial DataFrame through the &lt;code&gt;values&lt;/code&gt; parameter and these are aggregated in the corresponding cell of the resulting dataframe using the aggfunc fuction, so for each cell as defined by index and column, pandas will pick the values that correspond to that cell and pass them to a function that will return the result (by combining these values). As can be understood, the values must be different than index and columns (so all three sets of values, index and columns must not intersect). By default, the &lt;code&gt;values&lt;/code&gt; and &lt;code&gt;aggfunc&lt;/code&gt; parameters may be ommited - this will result in using average as the function and selecting all numerical columns (that are not in indexes or columns of course) in the&amp;nbsp;values.&lt;/p&gt;
&lt;p&gt;I know that this is difficult to understand so I&amp;#8217;ll give a simple example right away. Let&amp;#8217;s first create a nice set of data for our&amp;nbsp;samples:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[218]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DataFrame&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;It&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1138&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1986&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Horror&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;  
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The Stand&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;823&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1978&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Horror&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt; 
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Salem&lt;/span&gt;&lt;span class="se"&gt;\&amp;#39;&lt;/span&gt;&lt;span class="s1"&gt;s Lot&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;439&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1975&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Horror&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Misery&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;320&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1987&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Thriller&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Pet Sematary&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;374&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1983&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Horror&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Bag of bones&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;529&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1998&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Horror&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Different Seasons&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;527&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1982&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Thriller&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;The Dark Tower: The Gunslinger&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;224&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1982&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Fantasy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;The Dark Tower II: The Drawing of the Three&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1987&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Fantasy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;The Dark Tower III: The Waste Lands&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;512&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1991&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Fantasy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Stephen King&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;The Dark Tower IV: Wizard and Glass&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;787&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1998&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Fantasy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Michael Crichton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Airframe&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;352&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1996&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Michael Crichton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Jurassic Park&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;448&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1990&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Fantasy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Michael Crichton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Congo&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;348&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1980&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Fantasy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Michael Crichton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Sphere&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;385&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1987&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Fantasy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Michael Crichton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Rising Sun&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;385&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1992&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Michael Crichton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Disclosure &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;597&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1994&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Michael Crichton&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The Lost World &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;430&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1995&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Fantasy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;John Grisham&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;A Time to Kill&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;515&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1989&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;John Grisham&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The Firm&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;432&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1991&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;John Grisham&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The Pelican Brief&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;387&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1992&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;John Grisham&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The Chamber&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;496&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1994&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;John Grisham&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The Rainmaker&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;434&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1995&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;John Grisham&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The Runaway Jury&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;414&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1996&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;John Grisham&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The Street Lawyer&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;347&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1998&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;George Pelecanos&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Nick&lt;/span&gt;&lt;span class="se"&gt;\&amp;#39;&lt;/span&gt;&lt;span class="s1"&gt;s Trip &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;276&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1993&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;George Pelecanos&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;A Firing Offense&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;216&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1992&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;George Pelecanos&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;The Big Blowdown&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;313&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1996&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;George R.R Martin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;A Clash of Kings&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;768&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1998&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Fantasy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;George R.R Martin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;A Game of Thrones&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;694&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1996&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Fantasy&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="c1"&gt;# Add a decade column to the books DataFrame&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_decade&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;0&lt;/span&gt;&lt;span class="se"&gt;\&amp;#39;&lt;/span&gt;&lt;span class="s1"&gt;s&amp;#39;&lt;/span&gt;
    
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;add_decade&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Add a size column to the books DataFrame&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;600&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;big&amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;small&amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;medium&amp;#39;&lt;/span&gt;
    
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;size&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;add_size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# Let&amp;#39;s display it sorted here&lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_values&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[218]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;name&lt;/th&gt;
      &lt;th&gt;pages&lt;/th&gt;
      &lt;th&gt;year&lt;/th&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;size&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Horror&lt;/td&gt;
      &lt;td&gt;Salem&amp;#8217;s Lot&lt;/td&gt;
      &lt;td&gt;439&lt;/td&gt;
      &lt;td&gt;1975&lt;/td&gt;
      &lt;td&gt;70&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Horror&lt;/td&gt;
      &lt;td&gt;The Stand&lt;/td&gt;
      &lt;td&gt;823&lt;/td&gt;
      &lt;td&gt;1978&lt;/td&gt;
      &lt;td&gt;70&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;big&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;A Time to Kill&lt;/td&gt;
      &lt;td&gt;515&lt;/td&gt;
      &lt;td&gt;1989&lt;/td&gt;
      &lt;td&gt;80&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;Michael Crichton&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;Congo&lt;/td&gt;
      &lt;td&gt;348&lt;/td&gt;
      &lt;td&gt;1980&lt;/td&gt;
      &lt;td&gt;80&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;The Dark Tower: The Gunslinger&lt;/td&gt;
      &lt;td&gt;224&lt;/td&gt;
      &lt;td&gt;1982&lt;/td&gt;
      &lt;td&gt;80&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;small&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;The Dark Tower &lt;span class="caps"&gt;II&lt;/span&gt;: The Drawing of the Three&lt;/td&gt;
      &lt;td&gt;400&lt;/td&gt;
      &lt;td&gt;1987&lt;/td&gt;
      &lt;td&gt;80&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;Michael Crichton&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;Sphere&lt;/td&gt;
      &lt;td&gt;385&lt;/td&gt;
      &lt;td&gt;1987&lt;/td&gt;
      &lt;td&gt;80&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Horror&lt;/td&gt;
      &lt;td&gt;Pet Sematary&lt;/td&gt;
      &lt;td&gt;374&lt;/td&gt;
      &lt;td&gt;1983&lt;/td&gt;
      &lt;td&gt;80&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Horror&lt;/td&gt;
      &lt;td&gt;It&lt;/td&gt;
      &lt;td&gt;1138&lt;/td&gt;
      &lt;td&gt;1986&lt;/td&gt;
      &lt;td&gt;80&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;big&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Thriller&lt;/td&gt;
      &lt;td&gt;Different Seasons&lt;/td&gt;
      &lt;td&gt;527&lt;/td&gt;
      &lt;td&gt;1982&lt;/td&gt;
      &lt;td&gt;80&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Thriller&lt;/td&gt;
      &lt;td&gt;Misery&lt;/td&gt;
      &lt;td&gt;320&lt;/td&gt;
      &lt;td&gt;1987&lt;/td&gt;
      &lt;td&gt;80&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;The Firm&lt;/td&gt;
      &lt;td&gt;432&lt;/td&gt;
      &lt;td&gt;1991&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;Michael Crichton&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;Rising Sun&lt;/td&gt;
      &lt;td&gt;385&lt;/td&gt;
      &lt;td&gt;1992&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;The Pelican Brief&lt;/td&gt;
      &lt;td&gt;387&lt;/td&gt;
      &lt;td&gt;1992&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;26&lt;/th&gt;
      &lt;td&gt;George Pelecanos&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;A Firing Offense&lt;/td&gt;
      &lt;td&gt;216&lt;/td&gt;
      &lt;td&gt;1992&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;small&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;25&lt;/th&gt;
      &lt;td&gt;George Pelecanos&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;Nick&amp;#8217;s Trip&lt;/td&gt;
      &lt;td&gt;276&lt;/td&gt;
      &lt;td&gt;1993&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;small&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;Michael Crichton&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;Disclosure&lt;/td&gt;
      &lt;td&gt;597&lt;/td&gt;
      &lt;td&gt;1994&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;The Chamber&lt;/td&gt;
      &lt;td&gt;496&lt;/td&gt;
      &lt;td&gt;1994&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;The Rainmaker&lt;/td&gt;
      &lt;td&gt;434&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;Michael Crichton&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;Airframe&lt;/td&gt;
      &lt;td&gt;352&lt;/td&gt;
      &lt;td&gt;1996&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;The Runaway Jury&lt;/td&gt;
      &lt;td&gt;414&lt;/td&gt;
      &lt;td&gt;1996&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;27&lt;/th&gt;
      &lt;td&gt;George Pelecanos&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;The Big Blowdown&lt;/td&gt;
      &lt;td&gt;313&lt;/td&gt;
      &lt;td&gt;1996&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;24&lt;/th&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;The Street Lawyer&lt;/td&gt;
      &lt;td&gt;347&lt;/td&gt;
      &lt;td&gt;1998&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;Michael Crichton&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;Jurassic Park&lt;/td&gt;
      &lt;td&gt;448&lt;/td&gt;
      &lt;td&gt;1990&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;The Dark Tower &lt;span class="caps"&gt;III&lt;/span&gt;: The Waste Lands&lt;/td&gt;
      &lt;td&gt;512&lt;/td&gt;
      &lt;td&gt;1991&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;Michael Crichton&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;The Lost World&lt;/td&gt;
      &lt;td&gt;430&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;29&lt;/th&gt;
      &lt;td&gt;George R.R Martin&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;A Game of Thrones&lt;/td&gt;
      &lt;td&gt;694&lt;/td&gt;
      &lt;td&gt;1996&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;big&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;The Dark Tower &lt;span class="caps"&gt;IV&lt;/span&gt;: Wizard and Glass&lt;/td&gt;
      &lt;td&gt;787&lt;/td&gt;
      &lt;td&gt;1998&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;big&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;28&lt;/th&gt;
      &lt;td&gt;George R.R Martin&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;A Clash of Kings&lt;/td&gt;
      &lt;td&gt;768&lt;/td&gt;
      &lt;td&gt;1998&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;big&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Horror&lt;/td&gt;
      &lt;td&gt;Bag of bones&lt;/td&gt;
      &lt;td&gt;529&lt;/td&gt;
      &lt;td&gt;1998&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[219]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Here&amp;#39;s the first example&lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[219]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;pages&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;year&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;631.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1976.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;515.000000&lt;/td&gt;
      &lt;td&gt;339.25&lt;/td&gt;
      &lt;td&gt;756.0&lt;/td&gt;
      &lt;td&gt;423.5&lt;/td&gt;
      &lt;td&gt;1989.000000&lt;/td&gt;
      &lt;td&gt;1984.000000&lt;/td&gt;
      &lt;td&gt;1984.5&lt;/td&gt;
      &lt;td&gt;1984.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;387.416667&lt;/td&gt;
      &lt;td&gt;606.50&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1994.083333&lt;/td&gt;
      &lt;td&gt;1994.666667&lt;/td&gt;
      &lt;td&gt;1998.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In the above, we aggregated dour books by their decade and&amp;nbsp;genre.&lt;/p&gt;
&lt;p&gt;As we can see we just passed &lt;code&gt;decade&lt;/code&gt; as an index and &lt;code&gt;genre&lt;/code&gt; as a column. We ommited &lt;code&gt;values&lt;/code&gt; and &lt;code&gt;aggfunc&lt;/code&gt; so the default values were used. What happened? Pandas created a new DataFrame that had the values of decade as its index and the values of genre as its columns. Now, for each of the values (remember that since we ommited values, pandas just gets all numerical data, i.e pages and year) it found the corresponding entries for each cell, got their average and put it in that cell. For example, since there are no Crime genre books in the 70&amp;#8217;s we got a &lt;code&gt;NaN&lt;/code&gt; to both the pages and year values. However, there are two Horror books, with 823 and 439 pages so their average is 631. Notice that for each value a separate top-level multi-column containing all indexes and columns was created - we can display only pages or year by indexing with &lt;code&gt;['pages']&lt;/code&gt; or &lt;code&gt;['year']&lt;/code&gt;. We can think of each of the values columns as a seperate pivot table, so in the above example we have a pivot table for pages and a pivot table for&amp;nbsp;year.&lt;/p&gt;
&lt;p&gt;The above year column will also use the default average aggregate, something that doesn&amp;#8217;t actually makes sense. So we can use &lt;code&gt;values&lt;/code&gt; to explicitly define which values to aggregate &amp;#8212; here&amp;#8217;s how we can display only the&amp;nbsp;pages:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[220]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;#The above is more or less the same as with books_df.pivot_table(index=[&amp;#39;decade&amp;#39;, ], columns=[&amp;#39;genre&amp;#39;], )[&amp;#39;pages&amp;#39;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[220]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;631.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;515.000000&lt;/td&gt;
      &lt;td&gt;339.25&lt;/td&gt;
      &lt;td&gt;756.0&lt;/td&gt;
      &lt;td&gt;423.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;387.416667&lt;/td&gt;
      &lt;td&gt;606.50&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[221]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# In the above, we could pass [&amp;#39;pages&amp;#39;] instead of &amp;#39;pages&amp;#39; as the values.&lt;/span&gt;
&lt;span class="c1"&gt;# This will result in creating a multi-column index with &amp;#39;pages&amp;#39; as the top level column&lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[221]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;pages&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;631.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;515.000000&lt;/td&gt;
      &lt;td&gt;339.25&lt;/td&gt;
      &lt;td&gt;756.0&lt;/td&gt;
      &lt;td&gt;423.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;387.416667&lt;/td&gt;
      &lt;td&gt;606.50&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[222]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Also, please notice that you can skip index or columns (but not both) to get a series&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;decade
70&amp;#39;s    631.000000
80&amp;#39;s    470.111111
90&amp;#39;s    464.052632
Name: pages, dtype: float64
decade
70&amp;#39;s    631.000000
80&amp;#39;s    470.111111
90&amp;#39;s    464.052632
Name: pages, dtype: float64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Notice that above we have exactly the same result since for both cases we got a &lt;code&gt;Series&lt;/code&gt; (it doesn&amp;#8217;t matter that we used index in the first and columns in the second). Also, since we use &lt;em&gt;less&lt;/em&gt; columns from our data pool (we used only decade while previously we used both decade and genre), the aggregation is more coarse: We got the averages of book pages in each decade. Of course, we could have the same values as before but use a multi-column&amp;nbsp;index:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[223]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;s1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;s2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;s1 equals s2: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;s1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;equals&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;s1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;
&lt;span class="n"&gt;s1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;s1 equals s2:  True
MultiIndex(levels=[[u&amp;#39;70&amp;#39;s&amp;#39;, u&amp;#39;80&amp;#39;s&amp;#39;, u&amp;#39;90&amp;#39;s&amp;#39;], [u&amp;#39;Crime&amp;#39;, u&amp;#39;Fantasy&amp;#39;, u&amp;#39;Horror&amp;#39;, u&amp;#39;Thriller&amp;#39;]],
           labels=[[0, 1, 1, 1, 1, 2, 2, 2], [2, 0, 1, 2, 3, 0, 1, 2]],
           names=[u&amp;#39;decade&amp;#39;, u&amp;#39;genre&amp;#39;])
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[223]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;decade  genre   
70&amp;#39;s    Horror      631.000000
80&amp;#39;s    Crime       515.000000
        Fantasy     339.250000
        Horror      756.000000
        Thriller    423.500000
90&amp;#39;s    Crime       387.416667
        Fantasy     606.500000
        Horror      529.000000
Name: pages, dtype: float64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The above return a Series with a multi column index (they are both the same). Notice that the data is exactly the same as when we passed decade and genre in in index and column. The only difference is that some NaN rows have been dropped from the Series while in the DataFrame are there, for example Crime/70&amp;#8217;s (the DataFrame will by default drop a row or index if all its values are NaN). Finally, take a look at how the multi index is represented (each easy to decypher&amp;nbsp;it).&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s now say that we actually wanted to have a meaningful value for the year, for example the first year we have a book for that&amp;nbsp;genre/decade:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[224]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# I&amp;#39;ll intentionally skip values again to see what happens&lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;min&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[224]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;author&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;name&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;pages&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;year&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;size&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;Salem&amp;#8217;s Lot&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;439&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;1975&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;big&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Michael Crichton&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;A Time to Kill&lt;/td&gt;
      &lt;td&gt;Congo&lt;/td&gt;
      &lt;td&gt;It&lt;/td&gt;
      &lt;td&gt;Different Seasons&lt;/td&gt;
      &lt;td&gt;515&lt;/td&gt;
      &lt;td&gt;224&lt;/td&gt;
      &lt;td&gt;374&lt;/td&gt;
      &lt;td&gt;320&lt;/td&gt;
      &lt;td&gt;1989&lt;/td&gt;
      &lt;td&gt;1980&lt;/td&gt;
      &lt;td&gt;1983&lt;/td&gt;
      &lt;td&gt;1982&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
      &lt;td&gt;big&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;George Pelecanos&lt;/td&gt;
      &lt;td&gt;George R.R Martin&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;A Firing Offense&lt;/td&gt;
      &lt;td&gt;A Clash of Kings&lt;/td&gt;
      &lt;td&gt;Bag of bones&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;216&lt;/td&gt;
      &lt;td&gt;430&lt;/td&gt;
      &lt;td&gt;529&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;1991&lt;/td&gt;
      &lt;td&gt;1990&lt;/td&gt;
      &lt;td&gt;1998&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
      &lt;td&gt;big&lt;/td&gt;
      &lt;td&gt;medium&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This is more interesting. It seems that since we didn&amp;#8217;t use the default aggfunc value but instead we passed our own (&lt;code&gt;min&lt;/code&gt;), pandas did not use only the numerical values but used instead &lt;em&gt;all remaining columns&lt;/em&gt; as values: Remember that our pool of data was &lt;em&gt;author, genre, name, pages, year, decade, size&lt;/em&gt;, the genre and decade were used as an index/column so the remaining headers were used as values: author, name, pages, year, size! For the pages and year we can understand what happens: For example, for the Horror novels of the 80&amp;#8217;s, the one with the minimal pages is Pet Sematery with 374 pages. The same has also the minimal year (1983).  However, the one with the minimal name is &lt;code&gt;It&lt;/code&gt; (since &lt;code&gt;I&lt;/code&gt; is before &lt;code&gt;P&lt;/code&gt; it just compares strings). The author is the same for both(&lt;code&gt;Stephen King&lt;/code&gt;) and the minimum size is medium (since &lt;code&gt;small (s) &amp;gt; medium (m)&lt;/code&gt;). Of course we could pass the &lt;code&gt;values&lt;/code&gt; parameter to actually define which values we wanted to&amp;nbsp;see.&lt;/p&gt;
&lt;p&gt;Another really interesting thing is to take a peek at which are the values that are passed to the aggregation function. For this, we can just use &lt;code&gt;tuple&lt;/code&gt;:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[225]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Please notice that for reasons unknown to me, if I used aggfunc=tuple it would throw an exception&lt;/span&gt;
&lt;span class="n"&gt;books_df_tuples&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;tuple&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;books_df_tuples&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[225]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;author&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;name&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;pages&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;year&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;size&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;(Stephen King, Stephen King)&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;(The Stand, Salem&amp;#8217;s Lot)&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;(823, 439)&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;(1978, 1975)&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;(big, medium)&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;(John Grisham,)&lt;/td&gt;
      &lt;td&gt;(Stephen King, Stephen King, Michael Crichton,&amp;#8230;&lt;/td&gt;
      &lt;td&gt;(Stephen King, Stephen King)&lt;/td&gt;
      &lt;td&gt;(Stephen King, Stephen King)&lt;/td&gt;
      &lt;td&gt;(A Time to Kill,)&lt;/td&gt;
      &lt;td&gt;(The Dark Tower: The Gunslinger, The Dark Towe&amp;#8230;&lt;/td&gt;
      &lt;td&gt;(It, Pet Sematary)&lt;/td&gt;
      &lt;td&gt;(Misery, Different Seasons)&lt;/td&gt;
      &lt;td&gt;(515,)&lt;/td&gt;
      &lt;td&gt;(224, 400, 348, 385)&lt;/td&gt;
      &lt;td&gt;(1138, 374)&lt;/td&gt;
      &lt;td&gt;(320, 527)&lt;/td&gt;
      &lt;td&gt;(1989,)&lt;/td&gt;
      &lt;td&gt;(1982, 1987, 1980, 1987)&lt;/td&gt;
      &lt;td&gt;(1986, 1983)&lt;/td&gt;
      &lt;td&gt;(1987, 1982)&lt;/td&gt;
      &lt;td&gt;(medium,)&lt;/td&gt;
      &lt;td&gt;(small, medium, medium, medium)&lt;/td&gt;
      &lt;td&gt;(big, medium)&lt;/td&gt;
      &lt;td&gt;(medium, medium)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;(Michael Crichton, Michael Crichton, Michael C&amp;#8230;&lt;/td&gt;
      &lt;td&gt;(Stephen King, Stephen King, Michael Crichton,&amp;#8230;&lt;/td&gt;
      &lt;td&gt;(Stephen King,)&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;(Airframe, Rising Sun, Disclosure , The Firm, &amp;#8230;&lt;/td&gt;
      &lt;td&gt;(The Dark Tower &lt;span class="caps"&gt;III&lt;/span&gt;: The Waste Lands, The Dark&amp;#8230;&lt;/td&gt;
      &lt;td&gt;(Bag of bones,)&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;(352, 385, 597, 432, 387, 496, 434, 414, 347, &amp;#8230;&lt;/td&gt;
      &lt;td&gt;(512, 787, 448, 430, 768, 694)&lt;/td&gt;
      &lt;td&gt;(529,)&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;(1996, 1992, 1994, 1991, 1992, 1994, 1995, 199&amp;#8230;&lt;/td&gt;
      &lt;td&gt;(1991, 1998, 1990, 1995, 1998, 1996)&lt;/td&gt;
      &lt;td&gt;(1998,)&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;(medium, medium, medium, medium, medium, mediu&amp;#8230;&lt;/td&gt;
      &lt;td&gt;(medium, big, medium, medium, big, big)&lt;/td&gt;
      &lt;td&gt;(medium,)&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[226]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Dont worry about the ellipsis, the values are all there in each cell, for example&lt;/span&gt;
&lt;span class="n"&gt;books_df_tuples&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Crime&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90&lt;/span&gt;&lt;span class="se"&gt;\&amp;#39;&lt;/span&gt;&lt;span class="s1"&gt;s&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[226]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;(&amp;#39;Michael Crichton&amp;#39;,
 &amp;#39;Michael Crichton&amp;#39;,
 &amp;#39;Michael Crichton&amp;#39;,
 &amp;#39;John Grisham&amp;#39;,
 &amp;#39;John Grisham&amp;#39;,
 &amp;#39;John Grisham&amp;#39;,
 &amp;#39;John Grisham&amp;#39;,
 &amp;#39;John Grisham&amp;#39;,
 &amp;#39;John Grisham&amp;#39;,
 &amp;#39;George Pelecanos&amp;#39;,
 &amp;#39;George Pelecanos&amp;#39;,
 &amp;#39;George Pelecanos&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Notice that for the columns we havea MultiIndex of both value_type (author, name etc) and genre (Crime, Fantasy etc) while for the index we have the decade. So by &lt;code&gt;books_df_tuples['author']&lt;/code&gt; we&amp;#8217;ll get the author values DataFrame, by &lt;code&gt;books_df_tuples['author']['Crime']&lt;/code&gt; we&amp;#8217;ll get the Crime column of that DataFrame as a series and finally with &lt;code&gt;books_df_tuples['author']['Crime']['90\'s']&lt;/code&gt; we&amp;#8217;ll get the actuall value which is all author names that have written Crime books in the 90&amp;#8217;s &amp;#8212; authors that have written multiple books will be displayed multiple&amp;nbsp;times.&lt;/p&gt;
&lt;p&gt;What if we wanted to only display the different authors for each genre and decade and remove&amp;nbsp;duplicates:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[227]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[227]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Stephen King, Michael Crichton&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;John Grisham, Michael Crichton, George Pelecanos&lt;/td&gt;
      &lt;td&gt;Stephen King, George R.R Martin, Michael Crichton&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;What happens above is that we use the &lt;code&gt;lambda x: ', '.join(set(x))&lt;/code&gt; function to aggregate. This function will create a set (i.e remove duplicates) from the input (which is the corresponding values for each cell) and then join the set members using &lt;code&gt;','&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Notice that the inpout parameter that is passed to our aggfunc is actually a &lt;code&gt;Series&lt;/code&gt; so don&amp;#8217;t be alarmed if some list operations are not&amp;nbsp;working:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[228]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[228]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;&amp;lt;class &amp;#8216;pandas.core.series.Series&amp;#8217;&amp;gt;&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;&amp;lt;class &amp;#8216;pandas.core.series.Series&amp;#8217;&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;class &amp;#8216;pandas.core.series.Series&amp;#8217;&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;class &amp;#8216;pandas.core.series.Series&amp;#8217;&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;class &amp;#8216;pandas.core.series.Series&amp;#8217;&amp;gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;&amp;lt;class &amp;#8216;pandas.core.series.Series&amp;#8217;&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;class &amp;#8216;pandas.core.series.Series&amp;#8217;&amp;gt;&lt;/td&gt;
      &lt;td&gt;&amp;lt;class &amp;#8216;pandas.core.series.Series&amp;#8217;&amp;gt;&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Before continuing, I&amp;#8217;d like to present another two parameters that could be passed to the pivot_table: &lt;code&gt;fill_value&lt;/code&gt; to define a value to display when no values are found to be aggregated for a cell and &lt;code&gt;margins&lt;/code&gt; to enable or disable margin rows/columns to the left/bottom that will aggregate all values of that column, for&amp;nbsp;example:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[229]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;values&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;margins&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="n"&gt;fill_value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[229]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;All&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Stephen King, Michael Crichton&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Stephen King, John Grisham, Michael Crichton&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;John Grisham, Michael Crichton, George Pelecanos&lt;/td&gt;
      &lt;td&gt;Stephen King, George R.R Martin, Michael Crichton&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;Stephen King, George R.R Martin, John Grisham,&amp;#8230;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;All&lt;/th&gt;
      &lt;td&gt;John Grisham, Michael Crichton, George Pelecanos&lt;/td&gt;
      &lt;td&gt;Stephen King, George R.R Martin, Michael Crichton&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Stephen King, George R.R Martin, John Grisham,&amp;#8230;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The &amp;#8220;All&amp;#8221; column above will aggregate all values for each row/column (and the All/All down right will aggregate all&amp;nbsp;values).&lt;/p&gt;
&lt;p&gt;Using our previous knowledge of multi column indexes, let&amp;#8217;s display the average number of pages each author writes for each decade and&amp;nbsp;genre:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[230]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[230]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th colspan="2" halign="left"&gt;Michael Crichton&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;Stephen King&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;631.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;515.000000&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;366.5&lt;/td&gt;
      &lt;td&gt;312.0&lt;/td&gt;
      &lt;td&gt;756.0&lt;/td&gt;
      &lt;td&gt;423.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;268.333333&lt;/td&gt;
      &lt;td&gt;731.0&lt;/td&gt;
      &lt;td&gt;418.333333&lt;/td&gt;
      &lt;td&gt;444.666667&lt;/td&gt;
      &lt;td&gt;439.0&lt;/td&gt;
      &lt;td&gt;649.5&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[231]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# One interesting thing is that if we changed the order of the multi-columns we&amp;#39;d get the same data&lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[231]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;Crime&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;631.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;515.000000&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;366.5&lt;/td&gt;
      &lt;td&gt;312.0&lt;/td&gt;
      &lt;td&gt;756.0&lt;/td&gt;
      &lt;td&gt;423.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;268.333333&lt;/td&gt;
      &lt;td&gt;418.333333&lt;/td&gt;
      &lt;td&gt;444.666667&lt;/td&gt;
      &lt;td&gt;731.0&lt;/td&gt;
      &lt;td&gt;439.0&lt;/td&gt;
      &lt;td&gt;649.5&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[232]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Or we can interchange index with columns to get the same data in a horizontal format&lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[232]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;268.333333&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;731.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;515.0&lt;/td&gt;
      &lt;td&gt;418.333333&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;444.666667&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;366.5&lt;/td&gt;
      &lt;td&gt;439.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;312.0&lt;/td&gt;
      &lt;td&gt;649.500000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;td&gt;631.0&lt;/td&gt;
      &lt;td&gt;756.0&lt;/td&gt;
      &lt;td&gt;529.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;423.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So, &lt;code&gt;Michael Crichton&lt;/code&gt; was writing 445 pages for Crime novels and 439 pages for Fantasy novels on average at the 90&amp;#8217;s (of course this would be true if we had included all works of Michael Crichton).
In the previous table we can see that, for example for &lt;code&gt;George Pelecanos&lt;/code&gt; only the &lt;code&gt;Crime&lt;/code&gt; genre is displayed (since he&amp;#8217;s only Crime genre books in our database). Pandas automatically drops columns / lines where everything is empty (NaN)&amp;#8212; if we for some reason wanted to display it, could use the &lt;code&gt;dropna=False&lt;/code&gt; parameter:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[233]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;dropna&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[233]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="20" halign="left"&gt;pages&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;George Pelecanos&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;George R.R Martin&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;John Grisham&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;Michael Crichton&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;Stephen King&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;631.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;515.000000&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;366.5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;312.0&lt;/td&gt;
      &lt;td&gt;756.0&lt;/td&gt;
      &lt;td&gt;423.5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;268.333333&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;731.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;418.333333&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;444.666667&lt;/td&gt;
      &lt;td&gt;439.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;649.5&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[234]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# We can create any combination we want with our multi-index colums, for example let&amp;#39;s see where each book belongs&lt;/span&gt;
&lt;span class="c1"&gt;# be decade / year / author and genre / size&lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;size&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
    &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;v&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;fill_value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[234]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;size&lt;/th&gt;
      &lt;th colspan="2" halign="left"&gt;big&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;medium&lt;/th&gt;
      &lt;th colspan="2" halign="left"&gt;small&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;year&lt;/th&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;name&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1975&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;Salem&amp;#8217;s Lot&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1978&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;The Stand&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="9" valign="top"&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1980&lt;/th&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Congo&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1982&lt;/th&gt;
      &lt;th rowspan="2" valign="top"&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;Different Seasons&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Dark Tower: The Gunslinger&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1983&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;Pet Sematary&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1986&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;It&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;1987&lt;/th&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Sphere&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;Misery&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Dark Tower &lt;span class="caps"&gt;II&lt;/span&gt;: The Drawing of the Three&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1989&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;A Time to Kill&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="19" valign="top"&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1990&lt;/th&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Jurassic Park&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1991&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;The Firm&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;The Dark Tower &lt;span class="caps"&gt;III&lt;/span&gt;: The Waste Lands&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;1992&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;A Firing Offense&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;The Pelican Brief&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Rising Sun&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1993&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;Nick&amp;#8217;s Trip&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1994&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;The Chamber&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Disclosure&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1995&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;The Rainmaker&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;The Lost World&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="4" valign="top"&gt;1996&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;The Big Blowdown&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;th&gt;A Game of Thrones&lt;/th&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;The Runaway Jury&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Airframe&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="4" valign="top"&gt;1998&lt;/th&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;th&gt;A Clash of Kings&lt;/th&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;The Street Lawyer&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;Bag of bones&lt;/th&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Dark Tower &lt;span class="caps"&gt;IV&lt;/span&gt;: Wizard and Glass&lt;/th&gt;
      &lt;td&gt;v&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
      &lt;td&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;One more advanced thing I&amp;#8217;d like to cover here is that we could define multiple aggregate functions for each one of our values by passing a dictionary of &lt;code&gt;value:function&lt;/code&gt; to the &lt;code&gt;aggfunc&lt;/code&gt; parameter. For example, if we wanted to&amp;nbsp;display&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;the sum of the pages that have been&amp;nbsp;written&lt;/li&gt;
&lt;li&gt;the range of years for which we have&amp;nbsp;books&lt;/li&gt;
&lt;li&gt;the names of the&amp;nbsp;authors&lt;/li&gt;
&lt;li&gt;the name of one book we&amp;nbsp;have&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;for each genre each decade, we could do something like&amp;nbsp;this&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[235]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;years&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{0} - {1}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;years&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;years&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_book&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;books&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Don&amp;#39;t forget the the passed parameter is a Series so we use iloc to index it&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;books&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iloc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;get_names&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;get_range&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;get_book&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="n"&gt;fill_value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[235]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;year&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;pages&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;name&lt;/th&gt;
      &lt;th colspan="4" halign="left"&gt;author&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;1975 - 1978&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;1262&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;The Stand&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;1989 - 1989&lt;/td&gt;
      &lt;td&gt;1980 - 1987&lt;/td&gt;
      &lt;td&gt;1983 - 1986&lt;/td&gt;
      &lt;td&gt;1982 - 1987&lt;/td&gt;
      &lt;td&gt;515&lt;/td&gt;
      &lt;td&gt;1357&lt;/td&gt;
      &lt;td&gt;1512&lt;/td&gt;
      &lt;td&gt;847&lt;/td&gt;
      &lt;td&gt;A Time to Kill&lt;/td&gt;
      &lt;td&gt;The Dark Tower: The Gunslinger&lt;/td&gt;
      &lt;td&gt;It&lt;/td&gt;
      &lt;td&gt;Misery&lt;/td&gt;
      &lt;td&gt;John Grisham&lt;/td&gt;
      &lt;td&gt;Stephen King, Michael Crichton&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;1991 - 1998&lt;/td&gt;
      &lt;td&gt;1990 - 1998&lt;/td&gt;
      &lt;td&gt;1998 - 1998&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;4649&lt;/td&gt;
      &lt;td&gt;3639&lt;/td&gt;
      &lt;td&gt;529&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;Airframe&lt;/td&gt;
      &lt;td&gt;The Dark Tower &lt;span class="caps"&gt;III&lt;/span&gt;: The Waste Lands&lt;/td&gt;
      &lt;td&gt;Bag of bones&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
      &lt;td&gt;John Grisham, Michael Crichton, George Pelecanos&lt;/td&gt;
      &lt;td&gt;Stephen King, George R.R Martin, Michael Crichton&lt;/td&gt;
      &lt;td&gt;Stephen King&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As we&amp;#8217;ve already mentioned, the above is more or less like four different pivot tables &amp;#8212; for example we could get a pivot table with only pages if we passed &lt;code&gt;'pages'&lt;/code&gt; as the &lt;code&gt;values&lt;/code&gt; and &lt;code&gt;sum&lt;/code&gt; as the &lt;code&gt;aggfunc&lt;/code&gt; in the above method&amp;nbsp;call.&lt;/p&gt;
&lt;h1 id="Friends-of-pivot_table"&gt;Friends of pivot_table&lt;a class="anchor-link" href="#Friends-of-pivot_table"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The &lt;code&gt;pivot_table&lt;/code&gt; method has some friends &amp;#8212; these are functions that operate on DataFrame and can do reshaping but they are not as powerful as pivot_table. Let&amp;#8217;s introduce some of&amp;nbsp;them:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[236]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# First, I&amp;#39;ll create a DataFrame as an example:&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# This df has a Multi-index in columns - first level is the genres, second level is the authors&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;MultiIndex(levels=[[u&amp;#39;Crime&amp;#39;, u&amp;#39;Fantasy&amp;#39;, u&amp;#39;Horror&amp;#39;, u&amp;#39;Thriller&amp;#39;], [u&amp;#39;George Pelecanos&amp;#39;, u&amp;#39;George R.R Martin&amp;#39;, u&amp;#39;John Grisham&amp;#39;, u&amp;#39;Michael Crichton&amp;#39;, u&amp;#39;Stephen King&amp;#39;]],
           labels=[[0, 0, 0, 1, 1, 1, 2, 3], [0, 2, 3, 1, 3, 4, 4, 4]],
           names=[u&amp;#39;genre&amp;#39;, u&amp;#39;author&amp;#39;])
Index([u&amp;#39;70&amp;#39;s&amp;#39;, u&amp;#39;80&amp;#39;s&amp;#39;, u&amp;#39;90&amp;#39;s&amp;#39;], dtype=&amp;#39;object&amp;#39;, name=u&amp;#39;decade&amp;#39;)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[236]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;Crime&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1262.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;515.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;733.0&lt;/td&gt;
      &lt;td&gt;624.0&lt;/td&gt;
      &lt;td&gt;1512.0&lt;/td&gt;
      &lt;td&gt;847.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;805.0&lt;/td&gt;
      &lt;td&gt;2510.0&lt;/td&gt;
      &lt;td&gt;1334.0&lt;/td&gt;
      &lt;td&gt;1462.0&lt;/td&gt;
      &lt;td&gt;878.0&lt;/td&gt;
      &lt;td&gt;1299.0&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Notice above the &lt;code&gt;MultiIndex&lt;/code&gt; and &lt;code&gt;Index&lt;/code&gt; structs that are used to hold the axis for columns and&amp;nbsp;index.&lt;/p&gt;
&lt;h2 id="Stack-/-unstack"&gt;Stack / unstack&lt;a class="anchor-link" href="#Stack-/-unstack"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;These two operations move columns to indexes and vice-versa. Let&amp;#8217;s see what the &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.stack.html"&gt;manual says&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;stack: Pivot a level of the (possibly hierarchical) column labels, returning a DataFrame (or Series in the case of an object with a single level of column labels) having a hierarchical index with a new inner-most level of row&amp;nbsp;labels. &lt;/li&gt;
&lt;li&gt;unstack: Pivot a level of the (necessarily hierarchical) index labels, returning a DataFrame having a new level of column labels whose inner-most level consists of the pivoted index labels. If the index is not a MultiIndex, the output will be a Series (the analogue of stack when the columns are not a MultiIndex). The level involved will automatically get&amp;nbsp;sorted.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I must confess that I was not able to comprehend the above! A more easy explanation is&amp;nbsp;that:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;stack will re-arrange the values of the DataFrame so that the most inner column (the one at the bottom) will be converted to the most inner index (to the&amp;nbsp;right)&lt;/li&gt;
&lt;li&gt;unstack will do the exactly opposite: Re-arrange the values of the DataFrame so that the most inner index (the one at the right) will be converted to the most inner column (to the&amp;nbsp;bottom)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Also, stack and unstack do not really make sense. It would be much easier (at least to me) if stack was named &lt;code&gt;col_to_idx&lt;/code&gt; (or &lt;code&gt;col_to_row&lt;/code&gt;) and unstack was named &lt;code&gt;idx_to_col&lt;/code&gt; (&lt;code&gt;row_to_col&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;Before looking at examples of stack and unstack let&amp;#8217;s take a look at the index and columns of our dataframe. Notice again the  &lt;code&gt;Index&lt;/code&gt; and &lt;code&gt;MultiIndex&lt;/code&gt; data&amp;nbsp;structs:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[237]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Index&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Column&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Index
Index([u&amp;#39;70&amp;#39;s&amp;#39;, u&amp;#39;80&amp;#39;s&amp;#39;, u&amp;#39;90&amp;#39;s&amp;#39;], dtype=&amp;#39;object&amp;#39;, name=u&amp;#39;decade&amp;#39;)
Column
MultiIndex(levels=[[u&amp;#39;Crime&amp;#39;, u&amp;#39;Fantasy&amp;#39;, u&amp;#39;Horror&amp;#39;, u&amp;#39;Thriller&amp;#39;], [u&amp;#39;George Pelecanos&amp;#39;, u&amp;#39;George R.R Martin&amp;#39;, u&amp;#39;John Grisham&amp;#39;, u&amp;#39;Michael Crichton&amp;#39;, u&amp;#39;Stephen King&amp;#39;]],
           labels=[[0, 0, 0, 1, 1, 1, 2, 3], [0, 2, 3, 1, 3, 4, 4, 4]],
           names=[u&amp;#39;genre&amp;#39;, u&amp;#39;author&amp;#39;])
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[238]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;stacked&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Index&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;stacked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Column&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;stacked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;
&lt;span class="n"&gt;stacked&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Index
MultiIndex(levels=[[u&amp;#39;70&amp;#39;s&amp;#39;, u&amp;#39;80&amp;#39;s&amp;#39;, u&amp;#39;90&amp;#39;s&amp;#39;], [u&amp;#39;George Pelecanos&amp;#39;, u&amp;#39;George R.R Martin&amp;#39;, u&amp;#39;John Grisham&amp;#39;, u&amp;#39;Michael Crichton&amp;#39;, u&amp;#39;Stephen King&amp;#39;]],
           labels=[[0, 1, 1, 1, 2, 2, 2, 2, 2], [4, 2, 3, 4, 0, 1, 2, 3, 4]],
           names=[u&amp;#39;decade&amp;#39;, u&amp;#39;author&amp;#39;])
Column
Index([u&amp;#39;Crime&amp;#39;, u&amp;#39;Fantasy&amp;#39;, u&amp;#39;Horror&amp;#39;, u&amp;#39;Thriller&amp;#39;], dtype=&amp;#39;object&amp;#39;, name=u&amp;#39;genre&amp;#39;)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[238]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1262.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;td&gt;515.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;733.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;624.0&lt;/td&gt;
      &lt;td&gt;1512.0&lt;/td&gt;
      &lt;td&gt;847.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="5" valign="top"&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;td&gt;805.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1462.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;td&gt;2510.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;td&gt;1334.0&lt;/td&gt;
      &lt;td&gt;878.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1299.0&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We see that the &lt;code&gt;author&lt;/code&gt; column (which was the most inner column) was moved to the right of the indexes. The rows (index) was converted to a multi-index  while the columns is a simple index&amp;nbsp;now.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[239]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# We can of course stack again -- this time we&amp;#39;ll get a series (with a three level index) since there are no more columns&lt;/span&gt;
&lt;span class="n"&gt;stacked2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stacked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;stacked2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;
&lt;span class="n"&gt;stacked2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;MultiIndex(levels=[[u&amp;#39;70&amp;#39;s&amp;#39;, u&amp;#39;80&amp;#39;s&amp;#39;, u&amp;#39;90&amp;#39;s&amp;#39;], [u&amp;#39;George Pelecanos&amp;#39;, u&amp;#39;George R.R Martin&amp;#39;, u&amp;#39;John Grisham&amp;#39;, u&amp;#39;Michael Crichton&amp;#39;, u&amp;#39;Stephen King&amp;#39;], [u&amp;#39;Crime&amp;#39;, u&amp;#39;Fantasy&amp;#39;, u&amp;#39;Horror&amp;#39;, u&amp;#39;Thriller&amp;#39;]],
           labels=[[0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2], [4, 2, 3, 4, 4, 4, 0, 1, 2, 3, 3, 4, 4], [2, 0, 1, 1, 2, 3, 0, 1, 0, 0, 1, 1, 2]],
           names=[u&amp;#39;decade&amp;#39;, u&amp;#39;author&amp;#39;, u&amp;#39;genre&amp;#39;])
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[239]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;decade  author             genre   
70&amp;#39;s    Stephen King       Horror      1262.0
80&amp;#39;s    John Grisham       Crime        515.0
        Michael Crichton   Fantasy      733.0
        Stephen King       Fantasy      624.0
                           Horror      1512.0
                           Thriller     847.0
90&amp;#39;s    George Pelecanos   Crime        805.0
        George R.R Martin  Fantasy     1462.0
        John Grisham       Crime       2510.0
        Michael Crichton   Crime       1334.0
                           Fantasy      878.0
        Stephen King       Fantasy     1299.0
                           Horror       529.0
dtype: float64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[240]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# unstack does the opposite operation&lt;/span&gt;
&lt;span class="n"&gt;unstacked&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;unstacked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;
&lt;span class="n"&gt;unstacked&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;MultiIndex(levels=[[u&amp;#39;Crime&amp;#39;, u&amp;#39;Fantasy&amp;#39;, u&amp;#39;Horror&amp;#39;, u&amp;#39;Thriller&amp;#39;], [u&amp;#39;George Pelecanos&amp;#39;, u&amp;#39;George R.R Martin&amp;#39;, u&amp;#39;John Grisham&amp;#39;, u&amp;#39;Michael Crichton&amp;#39;, u&amp;#39;Stephen King&amp;#39;], [u&amp;#39;70&amp;#39;s&amp;#39;, u&amp;#39;80&amp;#39;s&amp;#39;, u&amp;#39;90&amp;#39;s&amp;#39;]],
           labels=[[0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3], [0, 0, 0, 2, 2, 2, 3, 3, 3, 1, 1, 1, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4], [0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2, 0, 1, 2]],
           names=[u&amp;#39;genre&amp;#39;, u&amp;#39;author&amp;#39;, u&amp;#39;decade&amp;#39;])
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[240]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;genre     author             decade
Crime     George Pelecanos   70&amp;#39;s         NaN
                             80&amp;#39;s         NaN
                             90&amp;#39;s       805.0
          John Grisham       70&amp;#39;s         NaN
                             80&amp;#39;s       515.0
                             90&amp;#39;s      2510.0
          Michael Crichton   70&amp;#39;s         NaN
                             80&amp;#39;s         NaN
                             90&amp;#39;s      1334.0
Fantasy   George R.R Martin  70&amp;#39;s         NaN
                             80&amp;#39;s         NaN
                             90&amp;#39;s      1462.0
          Michael Crichton   70&amp;#39;s         NaN
                             80&amp;#39;s       733.0
                             90&amp;#39;s       878.0
          Stephen King       70&amp;#39;s         NaN
                             80&amp;#39;s       624.0
                             90&amp;#39;s      1299.0
Horror    Stephen King       70&amp;#39;s      1262.0
                             80&amp;#39;s      1512.0
                             90&amp;#39;s       529.0
Thriller  Stephen King       70&amp;#39;s         NaN
                             80&amp;#39;s       847.0
                             90&amp;#39;s         NaN
dtype: float64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We now see that the  that the &lt;code&gt;decade&lt;/code&gt; column (which was the only index) was moved as the most inner to the columns &amp;#8212; however this also converts this DataFrame to a&amp;nbsp;Series!&lt;/p&gt;
&lt;p&gt;One interesting thing to notice is that a Series can only be &lt;code&gt;unstack()&lt;/code&gt;ed since it has no columns (so &lt;code&gt;stack&lt;/code&gt; won&amp;#8217;t work, remember stack =&amp;nbsp;col_to_idx)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[241]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# unstack - move the rightmost idx (decade) to columns&lt;/span&gt;
&lt;span class="n"&gt;unstacked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[241]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;Crime&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;805.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;515.0&lt;/td&gt;
      &lt;td&gt;2510.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1334.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1462.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;733.0&lt;/td&gt;
      &lt;td&gt;878.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;624.0&lt;/td&gt;
      &lt;td&gt;1299.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;1262.0&lt;/td&gt;
      &lt;td&gt;1512.0&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;847.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[243]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#Also, because `unstack` works on series we can use it for ever to cycle through different representations&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[243]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th colspan="5" halign="left"&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th colspan="5" halign="left"&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th colspan="5" halign="left"&gt;90&amp;#8217;s&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;515.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;805.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2510.0&lt;/td&gt;
      &lt;td&gt;1334.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;733.0&lt;/td&gt;
      &lt;td&gt;624.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1462.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;878.0&lt;/td&gt;
      &lt;td&gt;1299.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1262.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1512.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;847.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[244]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# One final comment is that stack and unstack can get a level parameter to inticate which&lt;/span&gt;
&lt;span class="c1"&gt;# index/column level we want to pivot&lt;/span&gt;
&lt;span class="c1"&gt;# For example the following will unstack - idx_to_col the leftmost index (genre)&lt;/span&gt;
&lt;span class="n"&gt;unstacked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unstack&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;level&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[244]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;George Pelecanos&lt;/th&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;805.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;George R.R Martin&lt;/th&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1462.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;John Grisham&lt;/th&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;515.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;2510.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;Michael Crichton&lt;/th&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;733.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;1334.0&lt;/td&gt;
      &lt;td&gt;878.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;Stephen King&lt;/th&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1262.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;624.0&lt;/td&gt;
      &lt;td&gt;1512.0&lt;/td&gt;
      &lt;td&gt;847.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1299.0&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="pivot"&gt;pivot&lt;a class="anchor-link" href="#pivot"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html"&gt;&lt;code&gt;pivot&lt;/code&gt;&lt;/a&gt; command will convert a column values to an index. This is similar like the &lt;code&gt;pivot_table&lt;/code&gt; but does not aggregate the values and does not create multi-hierarchy indexes so you must be careful that each cell will contain only one&amp;nbsp;value.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[245]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# We&amp;#39;ll use the initial books_df DataFrame&lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# Notice that we used &amp;#39;name&amp;#39; as an index (to be sure that each cell will contain a single value)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[245]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;Crime&lt;/th&gt;
      &lt;th&gt;Fantasy&lt;/th&gt;
      &lt;th&gt;Horror&lt;/th&gt;
      &lt;th&gt;Thriller&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;name&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;A Clash of Kings&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1998.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;A Firing Offense&lt;/th&gt;
      &lt;td&gt;1992.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;A Game of Thrones&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1996.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;A Time to Kill&lt;/th&gt;
      &lt;td&gt;1989.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Airframe&lt;/th&gt;
      &lt;td&gt;1996.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Bag of bones&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1998.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Congo&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1980.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Different Seasons&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1982.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Disclosure&lt;/th&gt;
      &lt;td&gt;1994.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;It&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1986.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Jurassic Park&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1990.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Misery&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1987.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Nick&amp;#8217;s Trip&lt;/th&gt;
      &lt;td&gt;1993.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Pet Sematary&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1983.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Rising Sun&lt;/th&gt;
      &lt;td&gt;1992.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Salem&amp;#8217;s Lot&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1975.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Sphere&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1987.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Big Blowdown&lt;/th&gt;
      &lt;td&gt;1996.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Chamber&lt;/th&gt;
      &lt;td&gt;1994.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Dark Tower &lt;span class="caps"&gt;II&lt;/span&gt;: The Drawing of the Three&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1987.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Dark Tower &lt;span class="caps"&gt;III&lt;/span&gt;: The Waste Lands&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1991.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Dark Tower &lt;span class="caps"&gt;IV&lt;/span&gt;: Wizard and Glass&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1998.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Dark Tower: The Gunslinger&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1982.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Firm&lt;/th&gt;
      &lt;td&gt;1991.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Lost World&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1995.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Pelican Brief&lt;/th&gt;
      &lt;td&gt;1992.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Rainmaker&lt;/th&gt;
      &lt;td&gt;1995.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Runaway Jury&lt;/th&gt;
      &lt;td&gt;1996.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Stand&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1978.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;The Street Lawyer&lt;/th&gt;
      &lt;td&gt;1998.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[246]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# We could pivot by using name as a column&lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[246]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;name&lt;/th&gt;
      &lt;th&gt;A Clash of Kings&lt;/th&gt;
      &lt;th&gt;A Firing Offense&lt;/th&gt;
      &lt;th&gt;A Game of Thrones&lt;/th&gt;
      &lt;th&gt;A Time to Kill&lt;/th&gt;
      &lt;th&gt;Airframe&lt;/th&gt;
      &lt;th&gt;Bag of bones&lt;/th&gt;
      &lt;th&gt;Congo&lt;/th&gt;
      &lt;th&gt;Different Seasons&lt;/th&gt;
      &lt;th&gt;Disclosure&lt;/th&gt;
      &lt;th&gt;It&lt;/th&gt;
      &lt;th&gt;&amp;#8230;&lt;/th&gt;
      &lt;th&gt;The Dark Tower &lt;span class="caps"&gt;III&lt;/span&gt;: The Waste Lands&lt;/th&gt;
      &lt;th&gt;The Dark Tower &lt;span class="caps"&gt;IV&lt;/span&gt;: Wizard and Glass&lt;/th&gt;
      &lt;th&gt;The Dark Tower: The Gunslinger&lt;/th&gt;
      &lt;th&gt;The Firm&lt;/th&gt;
      &lt;th&gt;The Lost World&lt;/th&gt;
      &lt;th&gt;The Pelican Brief&lt;/th&gt;
      &lt;th&gt;The Rainmaker&lt;/th&gt;
      &lt;th&gt;The Runaway Jury&lt;/th&gt;
      &lt;th&gt;The Stand&lt;/th&gt;
      &lt;th&gt;The Street Lawyer&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;#8230;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;823.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;515.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;348.0&lt;/td&gt;
      &lt;td&gt;527.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1138.0&lt;/td&gt;
      &lt;td&gt;&amp;#8230;&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;224.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;768.0&lt;/td&gt;
      &lt;td&gt;216.0&lt;/td&gt;
      &lt;td&gt;694.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;352.0&lt;/td&gt;
      &lt;td&gt;529.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;597.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;&amp;#8230;&lt;/td&gt;
      &lt;td&gt;512.0&lt;/td&gt;
      &lt;td&gt;787.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;432.0&lt;/td&gt;
      &lt;td&gt;430.0&lt;/td&gt;
      &lt;td&gt;387.0&lt;/td&gt;
      &lt;td&gt;434.0&lt;/td&gt;
      &lt;td&gt;414.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;347.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;3 rows Ã 30&amp;nbsp;columns&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;What happens is that we got the values of one column and coverted these to a column/index and use another column&amp;#8217;s values as the values of the new DataFrame. So, in the first example the values of the genre column were converted to columns and inside each cell we put the page number. In the second example instead we converted the decade value to index and put the page number inside each cell. In both cases we used the name of the book to be sure that we would each cell will contain one value (remember that pivot cannot&amp;nbsp;aggregate).&lt;/p&gt;
&lt;p&gt;The &lt;code&gt;pivot&lt;/code&gt; command is not very useful (at least to me) since it does not actually modify (by aggregating) data but just changes its representation - you won&amp;#8217;t get any new information from &lt;code&gt;pivot&lt;/code&gt; but you&amp;#8217;ll only display it differently. Also keep in mind that each cell after the pivoting must contain &lt;em&gt;one&lt;/em&gt; value, for example in the above wouldn&amp;#8217;t work if we used &lt;code&gt;author&lt;/code&gt; as columns (instead of book&amp;nbsp;name).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="groupby"&gt;groupby&lt;a class="anchor-link" href="#groupby"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The final method we&amp;#8217;ll talk about and is related to &lt;code&gt;pivot_table&lt;/code&gt; is &lt;a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html"&gt;&lt;code&gt;groupby&lt;/code&gt;&lt;/a&gt;. This of course is related to the &lt;span class="caps"&gt;SQL&lt;/span&gt; group by method and should be easy to comprehend. The &lt;code&gt;groupby&lt;/code&gt; gets a parameter that defines how to group the entries and returns a GroupBy object that contains the groups. The GroupBy object can be enumerated to get the groups and their data. It&amp;#8217;s interesting to take a look at the structure of each such&amp;nbsp;object:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[247]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;groupby_object&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;groupby&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;groupby_object&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# Let&amp;#39;s see what groupby-object contains&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;groupby_object&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;type: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;len: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;#len(x), type(x[0]), type(x[1]), x[0]&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;first element of tuple&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;second element of tuple&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;&amp;lt;class &amp;#39;pandas.core.groupby.DataFrameGroupBy&amp;#39;&amp;gt;
type:  &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; len:  2
first element of tuple &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; (&amp;#34;70&amp;#39;s&amp;#34;, &amp;#39;Stephen King&amp;#39;)
second element of tuple &amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
type:  &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; len:  2
first element of tuple &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; (&amp;#34;80&amp;#39;s&amp;#34;, &amp;#39;John Grisham&amp;#39;)
second element of tuple &amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
type:  &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; len:  2
first element of tuple &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; (&amp;#34;80&amp;#39;s&amp;#34;, &amp;#39;Michael Crichton&amp;#39;)
second element of tuple &amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
type:  &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; len:  2
first element of tuple &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; (&amp;#34;80&amp;#39;s&amp;#34;, &amp;#39;Stephen King&amp;#39;)
second element of tuple &amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
type:  &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; len:  2
first element of tuple &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; (&amp;#34;90&amp;#39;s&amp;#34;, &amp;#39;George Pelecanos&amp;#39;)
second element of tuple &amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
type:  &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; len:  2
first element of tuple &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; (&amp;#34;90&amp;#39;s&amp;#34;, &amp;#39;George R.R Martin&amp;#39;)
second element of tuple &amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
type:  &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; len:  2
first element of tuple &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; (&amp;#34;90&amp;#39;s&amp;#34;, &amp;#39;John Grisham&amp;#39;)
second element of tuple &amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
type:  &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; len:  2
first element of tuple &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; (&amp;#34;90&amp;#39;s&amp;#34;, &amp;#39;Michael Crichton&amp;#39;)
second element of tuple &amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
type:  &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; len:  2
first element of tuple &amp;lt;type &amp;#39;tuple&amp;#39;&amp;gt; (&amp;#34;90&amp;#39;s&amp;#34;, &amp;#39;Stephen King&amp;#39;)
second element of tuple &amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So, from the above we can see that the GroupBy object contains a number of 2-element tuples. Each tuple contains (another tuple with) the columns that were used for groupping and the actual data of that group (as a DataFrame). Now, we could either use the enumeration I shown above to operate on each group or, better, to use some of the methods that the GroupBy object&amp;nbsp;contains:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[248]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# get some statistics&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;groupby_object&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mean&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;groupby_object&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# We can use the aggregate method to do anything we want&lt;/span&gt;
&lt;span class="c1"&gt;# Each aggregate function will get a Series with the values (similar to pivot_table)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;year_aggr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{0}-{1}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;genre_aggr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;groupby_object&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aggregate&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;year_aggr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;genre_aggr&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;                               pages         year
decade author                                    
70&amp;#39;s   Stephen King       631.000000  1976.500000
80&amp;#39;s   John Grisham       515.000000  1989.000000
       Michael Crichton   366.500000  1983.500000
       Stephen King       497.166667  1984.500000
90&amp;#39;s   George Pelecanos   268.333333  1993.666667
       George R.R Martin  731.000000  1997.000000
       John Grisham       418.333333  1994.333333
       Michael Crichton   442.400000  1993.400000
       Stephen King       609.333333  1995.666667
                          pages   year
decade author                         
70&amp;#39;s   Stephen King        1262   3953
80&amp;#39;s   John Grisham         515   1989
       Michael Crichton     733   3967
       Stephen King        2983  11907
90&amp;#39;s   George Pelecanos     805   5981
       George R.R Martin   1462   3994
       John Grisham        2510  11966
       Michael Crichton    2212   9967
       Stephen King        1828   5987
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[248]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;pages&lt;/th&gt;
      &lt;th&gt;year&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;Horror&lt;/td&gt;
      &lt;td&gt;1262&lt;/td&gt;
      &lt;td&gt;1978-1975&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;515&lt;/td&gt;
      &lt;td&gt;1989-1989&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;733&lt;/td&gt;
      &lt;td&gt;1987-1980&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;Fantasy, Horror, Thriller&lt;/td&gt;
      &lt;td&gt;2983&lt;/td&gt;
      &lt;td&gt;1987-1982&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="5" valign="top"&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;805&lt;/td&gt;
      &lt;td&gt;1996-1992&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;1462&lt;/td&gt;
      &lt;td&gt;1998-1996&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;2510&lt;/td&gt;
      &lt;td&gt;1998-1991&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;td&gt;Fantasy, Crime&lt;/td&gt;
      &lt;td&gt;2212&lt;/td&gt;
      &lt;td&gt;1996-1990&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;Fantasy, Horror&lt;/td&gt;
      &lt;td&gt;1828&lt;/td&gt;
      &lt;td&gt;1998-1991&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[249]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# It&amp;#39;s interesting to notice that the previous is exactly&lt;/span&gt;
&lt;span class="c1"&gt;# the same that we can do with this pivot_table command&lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;genre_aggr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;year_aggr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[249]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;genre&lt;/th&gt;
      &lt;th&gt;pages&lt;/th&gt;
      &lt;th&gt;year&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;Horror&lt;/td&gt;
      &lt;td&gt;1262&lt;/td&gt;
      &lt;td&gt;1978-1975&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;515&lt;/td&gt;
      &lt;td&gt;1989-1989&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;733&lt;/td&gt;
      &lt;td&gt;1987-1980&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;Fantasy, Horror, Thriller&lt;/td&gt;
      &lt;td&gt;2983&lt;/td&gt;
      &lt;td&gt;1987-1982&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="5" valign="top"&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;805&lt;/td&gt;
      &lt;td&gt;1996-1992&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;1462&lt;/td&gt;
      &lt;td&gt;1998-1996&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;2510&lt;/td&gt;
      &lt;td&gt;1998-1991&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;td&gt;Fantasy, Crime&lt;/td&gt;
      &lt;td&gt;2212&lt;/td&gt;
      &lt;td&gt;1996-1990&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;Fantasy, Horror&lt;/td&gt;
      &lt;td&gt;1828&lt;/td&gt;
      &lt;td&gt;1998-1991&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[250]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# The added value of pivot_table over group of course is that we could instead do &lt;/span&gt;
&lt;span class="n"&gt;books_df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;genre&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;genre_aggr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;year_aggr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;pages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="c1"&gt;# or any other combination of columns - index we wanted&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[250]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;genre&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;pages&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;year&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;author&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;George Pelecanos&lt;/th&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;805&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;1996-1992&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;George R.R Martin&lt;/th&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;1462&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;1998-1996&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;John Grisham&lt;/th&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;Crime&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;515&lt;/td&gt;
      &lt;td&gt;2510&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;1989-1989&lt;/td&gt;
      &lt;td&gt;1998-1991&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Michael Crichton&lt;/th&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;Fantasy&lt;/td&gt;
      &lt;td&gt;Fantasy, Crime&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;733&lt;/td&gt;
      &lt;td&gt;2212&lt;/td&gt;
      &lt;td&gt;None&lt;/td&gt;
      &lt;td&gt;1987-1980&lt;/td&gt;
      &lt;td&gt;1996-1990&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Stephen King&lt;/th&gt;
      &lt;td&gt;Horror&lt;/td&gt;
      &lt;td&gt;Fantasy, Horror, Thriller&lt;/td&gt;
      &lt;td&gt;Fantasy, Horror&lt;/td&gt;
      &lt;td&gt;1262&lt;/td&gt;
      &lt;td&gt;2983&lt;/td&gt;
      &lt;td&gt;1828&lt;/td&gt;
      &lt;td&gt;1978-1975&lt;/td&gt;
      &lt;td&gt;1987-1982&lt;/td&gt;
      &lt;td&gt;1998-1991&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="A-real-world-example"&gt;A real-world example&lt;a class="anchor-link" href="#A-real-world-example"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;To continue with a real-world example, I will use the &lt;a href="http://grouplens.org/datasets/movielens/"&gt;MovieLens 100k&lt;/a&gt; to represent some &lt;code&gt;pivot_table&lt;/code&gt; (and friends) operations. To load the data I&amp;#8217;ve used the code already provided by the &lt;a href="http://www.gregreda.com/2013/10/26/working-with-pandas-dataframes/"&gt;three part series I already mentioned&lt;/a&gt;. Notice that this won&amp;#8217;t load the genre of the movie (left as an excersize to the&amp;nbsp;reader).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[251]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Useful to display graphs inline&lt;/span&gt;
&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="k"&gt;matplotlib&lt;/span&gt; inline
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[252]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;

&lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;C:/Users/serafeim/Downloads/ml-100k&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# Change this to your own directory&lt;/span&gt;
&lt;span class="n"&gt;u_cols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;sex&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;occupation&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zip_code&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;u.user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;sep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;|&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;u_cols&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;latin-1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;r_cols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;movie_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;unix_timestamp&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;ratings&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;u.data&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;sep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;r_cols&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;latin-1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m_cols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;movie_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;release_date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;video_release_date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;imdb_url&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;movies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;u.item&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;sep&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;|&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;m_cols&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;usecols&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;latin-1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;movie_ratings&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;movies&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;merge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ratings&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lens&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;movie_ratings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;merge&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;users&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[252]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;movie_id&lt;/th&gt;
      &lt;th&gt;title&lt;/th&gt;
      &lt;th&gt;release_date&lt;/th&gt;
      &lt;th&gt;video_release_date&lt;/th&gt;
      &lt;th&gt;imdb_url&lt;/th&gt;
      &lt;th&gt;user_id&lt;/th&gt;
      &lt;th&gt;rating&lt;/th&gt;
      &lt;th&gt;unix_timestamp&lt;/th&gt;
      &lt;th&gt;age&lt;/th&gt;
      &lt;th&gt;sex&lt;/th&gt;
      &lt;th&gt;occupation&lt;/th&gt;
      &lt;th&gt;zip_code&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;Toy Story (1995)&lt;/td&gt;
      &lt;td&gt;01-Jan-1995&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;http://us.imdb.com/M/title-exact?Toy%20Story%2&amp;#8230;&lt;/td&gt;
      &lt;td&gt;308&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;887736532&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;M&lt;/td&gt;
      &lt;td&gt;retired&lt;/td&gt;
      &lt;td&gt;95076&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;Get Shorty (1995)&lt;/td&gt;
      &lt;td&gt;01-Jan-1995&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;http://us.imdb.com/M/title-exact?Get%20Shorty%&amp;#8230;&lt;/td&gt;
      &lt;td&gt;308&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;887737890&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;M&lt;/td&gt;
      &lt;td&gt;retired&lt;/td&gt;
      &lt;td&gt;95076&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;Copycat (1995)&lt;/td&gt;
      &lt;td&gt;01-Jan-1995&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;http://us.imdb.com/M/title-exact?Copycat%20(1995)&lt;/td&gt;
      &lt;td&gt;308&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;887739608&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;M&lt;/td&gt;
      &lt;td&gt;retired&lt;/td&gt;
      &lt;td&gt;95076&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;Twelve Monkeys (1995)&lt;/td&gt;
      &lt;td&gt;01-Jan-1995&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;http://us.imdb.com/M/title-exact?Twelve%20Monk&amp;#8230;&lt;/td&gt;
      &lt;td&gt;308&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;887738847&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;M&lt;/td&gt;
      &lt;td&gt;retired&lt;/td&gt;
      &lt;td&gt;95076&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;Babe (1995)&lt;/td&gt;
      &lt;td&gt;01-Jan-1995&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;http://us.imdb.com/M/title-exact?Babe%20(1995)&lt;/td&gt;
      &lt;td&gt;308&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;887736696&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;M&lt;/td&gt;
      &lt;td&gt;retired&lt;/td&gt;
      &lt;td&gt;95076&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As we can see, we are using the &lt;code&gt;merge&lt;/code&gt; method of DataFrame to do an &lt;span class="caps"&gt;SQL&lt;/span&gt;-style join between &lt;code&gt;movies&lt;/code&gt; and &lt;code&gt;ratings&lt;/code&gt; and then between &lt;code&gt;movie_ratings&lt;/code&gt; and &lt;code&gt;users&lt;/code&gt; - this will result in a fat DataFrame with all the info of the movie and user for each review. The &lt;code&gt;head&lt;/code&gt; method displays the 5 first rows of the&amp;nbsp;DataFrame.&lt;/p&gt;
&lt;p&gt;We can see that there&amp;#8217;s a &lt;code&gt;zip_code&lt;/code&gt; - I wanted to convert it to the specific &lt;span class="caps"&gt;US&lt;/span&gt;-state. There&amp;#8217;s a service from &lt;code&gt;ziptasticapi.com&lt;/code&gt; that can be used for that but you need to do the queries one-by-one! I&amp;#8217;ve executed the queries once and created a zip-state dict to be used&amp;nbsp;instead:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[253]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# The following can be used to find out the state by zip_code for each row&lt;/span&gt;
&lt;span class="n"&gt;API&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://ziptasticapi.com/{0}&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;states&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_state&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;global&lt;/span&gt; &lt;span class="n"&gt;states&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;states&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;states&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;User-Agent&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Mozilla/5.0&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;req&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;API&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;    
    &lt;span class="n"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;state&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;states&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;state&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;state&lt;/span&gt;

&lt;span class="c1"&gt;#using this command we can add the state column&lt;/span&gt;
&lt;span class="c1"&gt;#lens[&amp;#39;state&amp;#39;]=lens[&amp;#39;zip_code&amp;#39;].apply(get_state)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[254]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# However, since we shouldn&amp;#39;t call the zipstatic API so many times, I&amp;#39;ll provide here the&lt;/span&gt;
&lt;span class="c1"&gt;# dict of zip:state (that I actually got through the previous command)&lt;/span&gt;
&lt;span class="n"&gt;states2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;73013&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77042&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;61455&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55345&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19711&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19716&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55343&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;15203&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48446&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92093&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92653&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;61073&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55346&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;32303&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;32301&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;32712&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06437&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01581&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85719&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;12065&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10960&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;32789&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01375&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60135&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98501&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95521&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;49512&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02215&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80209&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97330&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98006&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;52302&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60187&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;46005&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;46260&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63021&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;17036&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;99206&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10707&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;75206&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21208&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;75204&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60007&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60005&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22902&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21201&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21206&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22906&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;45680&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94025&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53144&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;05001&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97208&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;54494&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90008&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;45660&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53214&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53210&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53211&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;37411&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;37412&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63119&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10025&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10022&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10021&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44648&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60641&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78213&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78212&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22973&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;96819&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;HI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;42647&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;62901&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;62903&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90095&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;04102&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;14627&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20006&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;70808&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;LA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20003&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20001&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;70802&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;LA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;05452&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20009&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20008&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08610&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33775&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30329&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;76013&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;84408&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;UT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11758&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95014&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08052&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;37777&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;37771&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;76309&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;23509&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;50311&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33884&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30803&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;42459&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95064&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02859&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;RI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;68504&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;40243&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;68503&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02918&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;RI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;34656&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;L1V3W&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22003&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55113&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55117&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55116&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;23112&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91201&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91206&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06927&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55337&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02136&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11577&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;47130&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02139&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02138&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;N2L5N&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;15217&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;15213&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;50670&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;04988&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19382&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;87501&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NM&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55454&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19149&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19146&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55021&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;V1G4L&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06405&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;73071&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77459&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92037&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60089&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;64118&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21114&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98101&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98103&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98102&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02341&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94306&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94305&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85233&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11753&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90814&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;14534&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98072&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;16803&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;43512&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10309&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95468&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60402&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60152&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;75218&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98199&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;12603&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90254&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;84116&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;UT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;16801&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;41850&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97214&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97215&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97212&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10019&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10018&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;49705&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10011&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10010&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10016&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;13210&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78209&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60659&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01754&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60657&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;70124&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;LA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;12345&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95161&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20015&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94708&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;58202&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ND&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29379&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94703&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94702&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;68767&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;24060&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33763&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33765&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;54248&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80303&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;03062&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;03060&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;18301&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08403&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94551&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48043&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;28450&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78264&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63304&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06333&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08105&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;07102&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;18015&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11231&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;27606&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;38115&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95076&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77845&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77841&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;14476&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08360&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02903&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;RI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01945&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;40256&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91919&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;89801&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NV&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48825&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48823&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;07204&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92154&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55106&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55107&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55104&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55105&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55108&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55109&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;61755&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91351&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Y1A6B&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91606&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;28734&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55320&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78205&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11201&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01824&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;47024&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;43212&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;43215&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02125&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08816&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;15222&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;M7A1A&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97520&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;76234&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55420&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55423&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55422&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55038&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55428&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94560&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;T8H1N&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;16125&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02154&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;R3T5K&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;35802&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97006&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02159&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;32250&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;50613&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92020&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60804&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21044&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98117&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;E2A4H&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90804&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;74101&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22903&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22904&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;52245&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;52246&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;52241&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;17331&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20723&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63044&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;17110&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10314&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;32605&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60067&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90247&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;61820&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;84103&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;UT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;84105&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;UT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;84107&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;UT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60090&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;99835&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98281&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;05201&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10003&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20090&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90064&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01040&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21250&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20657&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97203&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60466&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;42141&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44134&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78390&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44133&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;83686&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;14085&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;45810&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;75006&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63146&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91335&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;39762&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80302&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44224&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;37076&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33755&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;54901&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;03052&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30220&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94403&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91040&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29464&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;49931&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;49938&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;71457&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;LA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;03755&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78739&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77048&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30040&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11101&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;83702&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;31211&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;83709&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;34105&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;76201&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91903&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01913&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;31404&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;27705&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;27708&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92121&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29631&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;28480&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94583&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;V0R2H&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91344&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;28806&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95821&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95823&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;43202&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11211&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11217&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;43204&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77504&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01960&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;82435&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19047&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;15235&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;15237&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;15232&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92629&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55436&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;50112&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55439&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92626&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22030&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98682&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;65203&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19341&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77005&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77009&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77008&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02146&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02143&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;56567&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93055&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;27249&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06492&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93117&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20064&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;64131&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;17604&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94086&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01915&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02320&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01810&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02324&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06260&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;32067&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78155&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;43537&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94131&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90405&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85210&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;17325&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53188&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98225&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53066&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95403&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;32114&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01602&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02176&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85281&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85282&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22911&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53115&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20817&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97405&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90291&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97403&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;54467&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97408&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;68106&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;25652&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WV&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60476&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;75240&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;12205&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;14853&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;V0R2M&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;14850&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;05464&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20910&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85710&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85711&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44124&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44691&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48118&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29210&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;49428&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95628&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;75013&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94612&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94619&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94618&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;84302&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;UT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97232&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;59801&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;36106&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;15610&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33556&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;14211&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;V5A2B&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;14216&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;99709&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;37212&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;40206&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;40205&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78741&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78628&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78746&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;50266&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95050&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;66315&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77904&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30350&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30606&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;83716&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;79508&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;67401&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;27713&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;23092&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55128&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80227&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55122&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92507&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55125&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97124&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;43201&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94591&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;66221&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30078&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;66046&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;28814&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;23322&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77081&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;89503&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NV&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77840&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;07310&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01970&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55013&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08832&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22306&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55409&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55408&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55406&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;73162&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;73439&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06472&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93101&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93063&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93109&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55303&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;96349&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AP&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55305&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;07733&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98038&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98034&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;17345&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;43017&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;31820&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06371&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85202&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93402&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;51157&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;38866&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20879&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95453&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53171&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98257&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20707&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19807&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93711&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;61801&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98133&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97365&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;05779&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;46538&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01701&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22932&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;75094&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20770&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;70116&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;LA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60440&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94117&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94115&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80538&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48322&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;45243&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80027&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90210&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85016&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90034&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48103&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20902&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48105&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;59717&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29201&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29206&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29205&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63129&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60614&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60615&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60613&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20685&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94608&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48197&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95110&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;36117&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08534&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;37901&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91105&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48076&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95129&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29440&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20057&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95123&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01080&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33319&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;07030&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;71701&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;07039&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78750&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78756&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;17870&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;27502&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02140&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;99603&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97229&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;76059&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;V3N4P&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01331&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30011&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;N4T1A&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;40515&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;48911&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;50325&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92103&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;50322&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30067&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30068&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06811&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77801&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;L9G2B&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22202&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22207&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;22206&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11238&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;K7L5J&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;89104&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NV&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;87544&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NM&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;43221&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01940&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;23237&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19102&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19104&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95938&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55412&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55413&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55414&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55417&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;16509&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;16506&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60302&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55369&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90036&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;73034&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;27105&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;61401&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;19422&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;39042&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98121&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98027&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21012&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21010&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93612&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;96754&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;HI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06365&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93550&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93555&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;93003&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60115&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;45439&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80228&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;64153&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91505&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;81648&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;49036&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;12180&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11701&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53715&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53711&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53713&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90630&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94040&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94043&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;05146&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80521&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80526&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80525&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44265&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;09645&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33716&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60626&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63132&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63130&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01002&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98801&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;83814&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90703&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;42101&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44212&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;54302&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44405&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;84010&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;UT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80913&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80919&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;37235&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29301&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44106&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;84604&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;UT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;84601&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;UT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33308&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;37725&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;18053&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;03261&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;07029&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78602&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95032&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;99687&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;28018&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;27514&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;27510&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;27511&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;17961&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08034&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30002&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;12866&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92688&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;15017&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;40504&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;40503&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92110&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92113&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92115&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29646&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30093&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;73132&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33484&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06779&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;23226&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;23227&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;VA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;10522&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06906&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;61462&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;74078&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;74075&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OK&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06518&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77073&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06513&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06512&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;43085&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;51250&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92064&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98620&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02110&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;02113&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92660&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92705&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60201&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60202&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;32707&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;56321&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06355&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11787&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90840&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;06059&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97007&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;11727&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63645&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;49508&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21911&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60515&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80236&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;26241&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WV&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85258&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;98405&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97302&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85251&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;97301&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;46032&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;62522&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;45218&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53706&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53705&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;76111&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53703&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21218&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60035&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;57197&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63033&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20755&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;01720&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;85032&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;AZ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;75230&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;38401&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20854&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;03869&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20850&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80127&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;80123&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;53202&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WI&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90016&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;58644&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ND&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;90019&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;63108&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MO&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;12550&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94143&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33066&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;FL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;68147&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60630&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;20784&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;70403&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;LA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;33205&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94720&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95662&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95660&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;18505&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;PA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44074&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;M4J2K&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;44092&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;OH&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94533&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;50233&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;79070&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;94920&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08043&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;47401&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30033&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;78704&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;30030&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;66215&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;KS&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;21227&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;95316&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;29678&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;SC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;60008&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;47905&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;91711&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;47906&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;IN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;55443&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;77380&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;TX&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;13820&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NY&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;26506&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;WV&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;31909&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;08904&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NJ&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;92374&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;CA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; 
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;00000&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;E2E3R&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; 

&lt;span class="c1"&gt;# And use the dict to initialize lens[&amp;#39;state&amp;#39;]:&lt;/span&gt;
&lt;span class="n"&gt;lens&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;state&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lens&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;zip_code&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;states2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Beyond the state, I&amp;#8217;d like to add some other columns for describing data and drop a bunch of non-needed&amp;nbsp;columns:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[255]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;

&lt;span class="c1"&gt;# Let&amp;#39;s also initialize it by the release_year, decade and review day&lt;/span&gt;
&lt;span class="n"&gt;lens&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;release_year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lens&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;release_date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lens&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lens&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;release_year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0&amp;#39;s&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;lens&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;review_day&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lens&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;unix_timestamp&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromtimestamp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strftime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;%A&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;# And remove some non-needed stuff&lt;/span&gt;
&lt;span class="n"&gt;final_lens&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;release_date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;zip_code&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;unix_timestamp&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;video_release_date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;imdb_url&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;movie_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;user_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Also add an idx column&lt;/span&gt;
&lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;

&lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[255]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;title&lt;/th&gt;
      &lt;th&gt;rating&lt;/th&gt;
      &lt;th&gt;age&lt;/th&gt;
      &lt;th&gt;sex&lt;/th&gt;
      &lt;th&gt;occupation&lt;/th&gt;
      &lt;th&gt;state&lt;/th&gt;
      &lt;th&gt;release_year&lt;/th&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;review_day&lt;/th&gt;
      &lt;th&gt;idx&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Toy Story (1995)&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;M&lt;/td&gt;
      &lt;td&gt;retired&lt;/td&gt;
      &lt;td&gt;&lt;span class="caps"&gt;CA&lt;/span&gt;&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;Tuesday&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Get Shorty (1995)&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;M&lt;/td&gt;
      &lt;td&gt;retired&lt;/td&gt;
      &lt;td&gt;&lt;span class="caps"&gt;CA&lt;/span&gt;&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;Tuesday&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Copycat (1995)&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;M&lt;/td&gt;
      &lt;td&gt;retired&lt;/td&gt;
      &lt;td&gt;&lt;span class="caps"&gt;CA&lt;/span&gt;&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;Tuesday&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Twelve Monkeys (1995)&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;M&lt;/td&gt;
      &lt;td&gt;retired&lt;/td&gt;
      &lt;td&gt;&lt;span class="caps"&gt;CA&lt;/span&gt;&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;Tuesday&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;Babe (1995)&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;60&lt;/td&gt;
      &lt;td&gt;M&lt;/td&gt;
      &lt;td&gt;retired&lt;/td&gt;
      &lt;td&gt;&lt;span class="caps"&gt;CA&lt;/span&gt;&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
      &lt;td&gt;90&amp;#8217;s&lt;/td&gt;
      &lt;td&gt;Tuesday&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So, after the previous (I hope easy) modifications we have a DataFrame that contains useful info about reviews of movies. Each line of the dataframe contains the following 9 columns of&amp;nbsp;data:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Title of&amp;nbsp;movie&lt;/li&gt;
&lt;li&gt;Rating it got from this&amp;nbsp;review&lt;/li&gt;
&lt;li&gt;Age of the&amp;nbsp;reviewer&lt;/li&gt;
&lt;li&gt;Sex of the&amp;nbsp;reviewer&lt;/li&gt;
&lt;li&gt;Occupation of the&amp;nbsp;reviewer&lt;/li&gt;
&lt;li&gt;State (&lt;span class="caps"&gt;US&lt;/span&gt;) of the&amp;nbsp;reviewer&lt;/li&gt;
&lt;li&gt;Release year of the&amp;nbsp;movie&lt;/li&gt;
&lt;li&gt;Decade the movie was&amp;nbsp;released&lt;/li&gt;
&lt;li&gt;Day of the&amp;nbsp;review&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let&amp;#8217;s take a peek at the movies of which decade were prefered by reviewers, by sex. First of all, we&amp;#8217;ll do a pivot table to aggregate the rating and idx columns values by sex and decade. For the rating we&amp;#8217;ll take the average of the reviews for each decade/sex while, for idx we&amp;#8217;ll get the len (just to count the number of&amp;nbsp;reviews):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[256]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sex&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;average&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="n"&gt;fill_value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;
&lt;span class="c1"&gt;# We see that there are a bunch of movies without decade, we&amp;#39;ll drop them using the drop method&lt;/span&gt;
&lt;span class="c1"&gt;# Notice that I pass &amp;#39;&amp;#39; to drop to remove the column with empty index&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;          rating              idx       
sex            F         M      F      M
decade                                  
        3.500000  3.428571      2      7
20&amp;#39;s    2.857143  3.632653      7     49
30&amp;#39;s    3.961340  3.912455    388   1108
40&amp;#39;s    3.952641  4.029412    549   1700
50&amp;#39;s    3.835006  3.972403    897   2609
60&amp;#39;s    3.852321  3.891015    948   2927
70&amp;#39;s    3.754007  3.899522   1435   4807
80&amp;#39;s    3.700214  3.764700   2802   9320
90&amp;#39;s    3.437366  3.384938  18712  51733
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[256]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="2" halign="left"&gt;rating&lt;/th&gt;
      &lt;th colspan="2" halign="left"&gt;idx&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;sex&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;20&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;2.857143&lt;/td&gt;
      &lt;td&gt;3.632653&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;49&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;30&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.961340&lt;/td&gt;
      &lt;td&gt;3.912455&lt;/td&gt;
      &lt;td&gt;388&lt;/td&gt;
      &lt;td&gt;1108&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;40&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.952641&lt;/td&gt;
      &lt;td&gt;4.029412&lt;/td&gt;
      &lt;td&gt;549&lt;/td&gt;
      &lt;td&gt;1700&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;50&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.835006&lt;/td&gt;
      &lt;td&gt;3.972403&lt;/td&gt;
      &lt;td&gt;897&lt;/td&gt;
      &lt;td&gt;2609&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;60&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.852321&lt;/td&gt;
      &lt;td&gt;3.891015&lt;/td&gt;
      &lt;td&gt;948&lt;/td&gt;
      &lt;td&gt;2927&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.754007&lt;/td&gt;
      &lt;td&gt;3.899522&lt;/td&gt;
      &lt;td&gt;1435&lt;/td&gt;
      &lt;td&gt;4807&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.700214&lt;/td&gt;
      &lt;td&gt;3.764700&lt;/td&gt;
      &lt;td&gt;2802&lt;/td&gt;
      &lt;td&gt;9320&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.437366&lt;/td&gt;
      &lt;td&gt;3.384938&lt;/td&gt;
      &lt;td&gt;18712&lt;/td&gt;
      &lt;td&gt;51733&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now, we see that we have the rating and review count for both men and women. However, I&amp;#8217;d also like to get their combined (average rating and total review) values. There are two ways that this can be done: First, we can create &lt;em&gt;another&lt;/em&gt; dataframe that does not seperate&amp;nbsp;sex:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[257]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;prefered_decade&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;average&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="n"&gt;fill_value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# Drop non needed index&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prefered_decade&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[257]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;idx&lt;/th&gt;
      &lt;th&gt;rating&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;20&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;56&lt;/td&gt;
      &lt;td&gt;3.535714&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;30&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;1496&lt;/td&gt;
      &lt;td&gt;3.925134&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;40&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;2249&lt;/td&gt;
      &lt;td&gt;4.010671&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;50&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3506&lt;/td&gt;
      &lt;td&gt;3.937250&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;60&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3875&lt;/td&gt;
      &lt;td&gt;3.881548&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;6242&lt;/td&gt;
      &lt;td&gt;3.866069&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;12122&lt;/td&gt;
      &lt;td&gt;3.749794&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;70445&lt;/td&gt;
      &lt;td&gt;3.398864&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now, these two DataFrames can be easily combined because they have the same index. I&amp;#8217;ll put the values from the total DataFrame as a second level index to the seperated (by sex) DataFrame - notice how the multi index is used for&amp;nbsp;indexing:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[258]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;total&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prefered_decade&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;total&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prefered_decade&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[258]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="2" halign="left"&gt;rating&lt;/th&gt;
      &lt;th colspan="2" halign="left"&gt;idx&lt;/th&gt;
      &lt;th&gt;rating&lt;/th&gt;
      &lt;th&gt;idx&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;sex&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
      &lt;th&gt;total&lt;/th&gt;
      &lt;th&gt;total&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;20&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;2.857143&lt;/td&gt;
      &lt;td&gt;3.632653&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;49&lt;/td&gt;
      &lt;td&gt;3.535714&lt;/td&gt;
      &lt;td&gt;56&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;30&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.961340&lt;/td&gt;
      &lt;td&gt;3.912455&lt;/td&gt;
      &lt;td&gt;388&lt;/td&gt;
      &lt;td&gt;1108&lt;/td&gt;
      &lt;td&gt;3.925134&lt;/td&gt;
      &lt;td&gt;1496&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;40&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.952641&lt;/td&gt;
      &lt;td&gt;4.029412&lt;/td&gt;
      &lt;td&gt;549&lt;/td&gt;
      &lt;td&gt;1700&lt;/td&gt;
      &lt;td&gt;4.010671&lt;/td&gt;
      &lt;td&gt;2249&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;50&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.835006&lt;/td&gt;
      &lt;td&gt;3.972403&lt;/td&gt;
      &lt;td&gt;897&lt;/td&gt;
      &lt;td&gt;2609&lt;/td&gt;
      &lt;td&gt;3.937250&lt;/td&gt;
      &lt;td&gt;3506&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;60&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.852321&lt;/td&gt;
      &lt;td&gt;3.891015&lt;/td&gt;
      &lt;td&gt;948&lt;/td&gt;
      &lt;td&gt;2927&lt;/td&gt;
      &lt;td&gt;3.881548&lt;/td&gt;
      &lt;td&gt;3875&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.754007&lt;/td&gt;
      &lt;td&gt;3.899522&lt;/td&gt;
      &lt;td&gt;1435&lt;/td&gt;
      &lt;td&gt;4807&lt;/td&gt;
      &lt;td&gt;3.866069&lt;/td&gt;
      &lt;td&gt;6242&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.700214&lt;/td&gt;
      &lt;td&gt;3.764700&lt;/td&gt;
      &lt;td&gt;2802&lt;/td&gt;
      &lt;td&gt;9320&lt;/td&gt;
      &lt;td&gt;3.749794&lt;/td&gt;
      &lt;td&gt;12122&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;3.437366&lt;/td&gt;
      &lt;td&gt;3.384938&lt;/td&gt;
      &lt;td&gt;18712&lt;/td&gt;
      &lt;td&gt;51733&lt;/td&gt;
      &lt;td&gt;3.398864&lt;/td&gt;
      &lt;td&gt;70445&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now, the previous would be almost perfect but I would really prefer the rating and idx first-level columns to be all together. This can be done by using the &lt;code&gt;sort_index&lt;/code&gt; &amp;#8212; the &lt;code&gt;axis=1&lt;/code&gt; parameter sorts the columns(or else the index will be&amp;nbsp;sorted):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[259]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[259]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;idx&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;rating&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;sex&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
      &lt;th&gt;total&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
      &lt;th&gt;total&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;20&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;49&lt;/td&gt;
      &lt;td&gt;56&lt;/td&gt;
      &lt;td&gt;2.857143&lt;/td&gt;
      &lt;td&gt;3.632653&lt;/td&gt;
      &lt;td&gt;3.535714&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;30&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;388&lt;/td&gt;
      &lt;td&gt;1108&lt;/td&gt;
      &lt;td&gt;1496&lt;/td&gt;
      &lt;td&gt;3.961340&lt;/td&gt;
      &lt;td&gt;3.912455&lt;/td&gt;
      &lt;td&gt;3.925134&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;40&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;549&lt;/td&gt;
      &lt;td&gt;1700&lt;/td&gt;
      &lt;td&gt;2249&lt;/td&gt;
      &lt;td&gt;3.952641&lt;/td&gt;
      &lt;td&gt;4.029412&lt;/td&gt;
      &lt;td&gt;4.010671&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;50&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;897&lt;/td&gt;
      &lt;td&gt;2609&lt;/td&gt;
      &lt;td&gt;3506&lt;/td&gt;
      &lt;td&gt;3.835006&lt;/td&gt;
      &lt;td&gt;3.972403&lt;/td&gt;
      &lt;td&gt;3.937250&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;60&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;948&lt;/td&gt;
      &lt;td&gt;2927&lt;/td&gt;
      &lt;td&gt;3875&lt;/td&gt;
      &lt;td&gt;3.852321&lt;/td&gt;
      &lt;td&gt;3.891015&lt;/td&gt;
      &lt;td&gt;3.881548&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;1435&lt;/td&gt;
      &lt;td&gt;4807&lt;/td&gt;
      &lt;td&gt;6242&lt;/td&gt;
      &lt;td&gt;3.754007&lt;/td&gt;
      &lt;td&gt;3.899522&lt;/td&gt;
      &lt;td&gt;3.866069&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;2802&lt;/td&gt;
      &lt;td&gt;9320&lt;/td&gt;
      &lt;td&gt;12122&lt;/td&gt;
      &lt;td&gt;3.700214&lt;/td&gt;
      &lt;td&gt;3.764700&lt;/td&gt;
      &lt;td&gt;3.749794&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;18712&lt;/td&gt;
      &lt;td&gt;51733&lt;/td&gt;
      &lt;td&gt;70445&lt;/td&gt;
      &lt;td&gt;3.437366&lt;/td&gt;
      &lt;td&gt;3.384938&lt;/td&gt;
      &lt;td&gt;3.398864&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The other method to create the sex and total reviews DataFrame is to aggregate the values from &lt;code&gt;prefered_decade_by_sex&lt;/code&gt; directly  (without creating another pivot table). Take a look at the &lt;code&gt;get_average&lt;/code&gt; function below. For each row it will take the total number of reviews for men and women and multiply that number with the corresponding average. It will then divide the sum of averages with the total number of reviws to get the average for each row. We also use the &lt;code&gt;sort_index&lt;/code&gt; method to display the columns&amp;nbsp;correctly:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[260]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sex&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
    &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;average&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="n"&gt;fill_value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_average&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;total_f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;F&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;total_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;M&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;total_rating_f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;total_f&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;F&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;total_rating_m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;total_m&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;M&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;total_rating_f&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;total_rating_m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;total_f&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;total_m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;total&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;get_average&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;total&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;F&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;M&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[260]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;idx&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;rating&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;sex&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
      &lt;th&gt;total&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
      &lt;th&gt;total&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;20&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;49&lt;/td&gt;
      &lt;td&gt;56.0&lt;/td&gt;
      &lt;td&gt;2.857143&lt;/td&gt;
      &lt;td&gt;3.632653&lt;/td&gt;
      &lt;td&gt;3.535714&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;30&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;388&lt;/td&gt;
      &lt;td&gt;1108&lt;/td&gt;
      &lt;td&gt;1496.0&lt;/td&gt;
      &lt;td&gt;3.961340&lt;/td&gt;
      &lt;td&gt;3.912455&lt;/td&gt;
      &lt;td&gt;3.925134&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;40&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;549&lt;/td&gt;
      &lt;td&gt;1700&lt;/td&gt;
      &lt;td&gt;2249.0&lt;/td&gt;
      &lt;td&gt;3.952641&lt;/td&gt;
      &lt;td&gt;4.029412&lt;/td&gt;
      &lt;td&gt;4.010671&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;50&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;897&lt;/td&gt;
      &lt;td&gt;2609&lt;/td&gt;
      &lt;td&gt;3506.0&lt;/td&gt;
      &lt;td&gt;3.835006&lt;/td&gt;
      &lt;td&gt;3.972403&lt;/td&gt;
      &lt;td&gt;3.937250&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;60&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;948&lt;/td&gt;
      &lt;td&gt;2927&lt;/td&gt;
      &lt;td&gt;3875.0&lt;/td&gt;
      &lt;td&gt;3.852321&lt;/td&gt;
      &lt;td&gt;3.891015&lt;/td&gt;
      &lt;td&gt;3.881548&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;1435&lt;/td&gt;
      &lt;td&gt;4807&lt;/td&gt;
      &lt;td&gt;6242.0&lt;/td&gt;
      &lt;td&gt;3.754007&lt;/td&gt;
      &lt;td&gt;3.899522&lt;/td&gt;
      &lt;td&gt;3.866069&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;2802&lt;/td&gt;
      &lt;td&gt;9320&lt;/td&gt;
      &lt;td&gt;12122.0&lt;/td&gt;
      &lt;td&gt;3.700214&lt;/td&gt;
      &lt;td&gt;3.764700&lt;/td&gt;
      &lt;td&gt;3.749794&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;td&gt;18712&lt;/td&gt;
      &lt;td&gt;51733&lt;/td&gt;
      &lt;td&gt;70445.0&lt;/td&gt;
      &lt;td&gt;3.437366&lt;/td&gt;
      &lt;td&gt;3.384938&lt;/td&gt;
      &lt;td&gt;3.398864&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let&amp;#8217;s try to plot this DataFrame to see if we can extract some useful&amp;nbsp;conclusions:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[261]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;logy&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;prefered_decade_by_sex&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="c1"&gt;# It seems that women don&amp;#39;t like movies from the 20&amp;#39;s (but if you take at the number &lt;/span&gt;
&lt;span class="c1"&gt;# of votes there are too few women that have voted for 20&amp;#39;s movies. Also, the best&lt;/span&gt;
&lt;span class="c1"&gt;# reviews seem to be for movies of 30&amp;#39;s and 40&amp;#39;s and (as expected) the most revies&lt;/span&gt;
&lt;span class="c1"&gt;# are for newest movies&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[261]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&amp;lt;matplotlib.axes._subplots.AxesSubplot at 0x20f13e90&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
ZpZgZouBH4CPj5bQhfQApvsRh4ZeiogULkWDDiA/1qyBceNg5cqgIxEREQHnXBbQwMxKAxPNrI5z
bkXO88ysK9AIOGrqlX3YamJiIolhrHqSmgp/+1ve4xYRkYKRkpISkelnOcX08MuOHaFFC3jggQgF
JSIivihswy8BzGwgsNc592yO45cCzwGtnHM/HeW1x9xGZmTAqafCV1/BaacdUxEiIsdMwy9zp+GX
R5GaCkuXQp8+QUciIiICZnaqmZ0UelwSuBRYleOcBsB/gKuPltDl15IlULGiEjoRkcIkJodfZmV5
G40/+SSUKBF0NCIiIgCcAbxmZgl4N03HO+emmdkgYKFzbgrwNHA88I6ZGfCNc65jJIPQfDoRkcIn
JpO6N96AYsW8BVJERESigXNuGdAwl+NJ2R5f5nccqanQtavfVxERkWgSc8Mv9+2Dhx+GZ58FK1Sz
M0RERP5YZqa3xU+rVkFHIiLiv3379tG+fXsaNGhAvXr1eOedd1i0aBGJiYlccMEFtGvXji1btpCZ
mUmTJk2YNWsWAAMGDOAf//hHwNFHVsz11P3rX9C0qbdAioiIiPwuPR3KlYPy5YOORETEfx9++CEV
K1ZkypQpAOzevZt27doxadIkTjnlFN5++20eeughRo4cyZgxY7j++ut57rnnmDFjBmlpaQFHH1mB
JnXJyclhLdP8ww9eUhdnvwMRkbjl19LNkjvNpxORwqRu3brcf//9DBgwgCuvvJIyZcqwfPlyLrvs
MpxzZGVlccYZZwBQp04dunbtylVXXUVaWhpFi8Zc39YfiqktDe68E044AYYO9SkoERHxRWHc0iA/
jnVLg2uugU6doHNnH4ISEcmDgt7SYOfOnUybNo1XX32V1q1b89FHHzF37txcz73ppptISUlhzJgx
tG3btsBiBG1p8Jvly+H99+GRR4KOREREJPpkZXnz6dRTJyKFxffff0/JkiW56aab6NevH2lpaWzd
upXPPvsMgIyMDFasWAHAhAkT2L59O7NmzaJ3797s3r07yNAjLmb6He+/31sgpUyZoCMRERGJPl9+
6bWRFSoEHYmISMFYtmwZ999/PwkJCRx33HG8/PLLFC1alN69e7Nr1y4yMzO5++67KVeuHA899BAz
Z86kQoUK9O7dm759+zJ69OigqxAxMTH8csYM6NXLa7COO87nwEREJOI0/DI8xzL88vnnYelSGDHC
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
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let&amp;#8217;s try another quick &lt;code&gt;pivot_table&lt;/code&gt;. Can we see if there&amp;#8217;s a specific day-of-week at which the reviewers prefer to&amp;nbsp;vote?&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[262]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;review_day&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sex&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# Probably not&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[262]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&amp;lt;matplotlib.axes._subplots.AxesSubplot at 0x20f542d0&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Continuing our exploration of the movie-reviews data set, we&amp;#8217;d like to get the total number of reviews and average rating for each movie. To make a better display for the release we&amp;#8217;ll categorise the movies by their decade and release year (using multi index&amp;nbsp;rows):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[263]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;rating_count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;decade&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;release_year&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,],&lt;/span&gt;
    &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;average&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# Drop movies without decade&lt;/span&gt;
&lt;span class="n"&gt;rating_count&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rating_count&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;rating_count&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# Notice the nice hierarchical index on decade and release_year&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[263]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;idx&lt;/th&gt;
      &lt;th&gt;rating&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;release_year&lt;/th&gt;
      &lt;th&gt;title&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;20&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1922&lt;/th&gt;
      &lt;th&gt;Nosferatu (Nosferatu, eine Symphonie des Grauens) (1922)&lt;/th&gt;
      &lt;td&gt;54&lt;/td&gt;
      &lt;td&gt;3.555556&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1926&lt;/th&gt;
      &lt;th&gt;Scarlet Letter, The (1926)&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="8" valign="top"&gt;30&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1930&lt;/th&gt;
      &lt;th&gt;Blue Angel, The (Blaue Engel, Der) (1930)&lt;/th&gt;
      &lt;td&gt;18&lt;/td&gt;
      &lt;td&gt;3.777778&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1931&lt;/th&gt;
      &lt;th&gt;M (1931)&lt;/th&gt;
      &lt;td&gt;44&lt;/td&gt;
      &lt;td&gt;4.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1932&lt;/th&gt;
      &lt;th&gt;Farewell to Arms, A (1932)&lt;/th&gt;
      &lt;td&gt;12&lt;/td&gt;
      &lt;td&gt;3.833333&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1933&lt;/th&gt;
      &lt;th&gt;Duck Soup (1933)&lt;/th&gt;
      &lt;td&gt;93&lt;/td&gt;
      &lt;td&gt;4.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Liebelei (1933)&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;1934&lt;/th&gt;
      &lt;th&gt;Gay Divorcee, The (1934)&lt;/th&gt;
      &lt;td&gt;15&lt;/td&gt;
      &lt;td&gt;3.866667&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;It Happened One Night (1934)&lt;/th&gt;
      &lt;td&gt;81&lt;/td&gt;
      &lt;td&gt;4.012346&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Of Human Bondage (1934)&lt;/th&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;3.200000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As we can see above, there are movies with very few revies. I don&amp;#8217;t really want to count them since they&amp;#8217;ll probably won&amp;#8217;t have correct ratings. Also, instead of displaying all the movies I&amp;#8217;d like to create a small list with only the best&amp;nbsp;movies:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[264]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# So, let&amp;#39;s find the best movies (rating more than 4) with more than 150 reviews&lt;/span&gt;
&lt;span class="n"&gt;best_movies&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rating_count&lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;rating_count&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;150&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rating_count&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rating&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;best_movies&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[264]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;idx&lt;/th&gt;
      &lt;th&gt;rating&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;decade&lt;/th&gt;
      &lt;th&gt;release_year&lt;/th&gt;
      &lt;th&gt;title&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;30&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1939&lt;/th&gt;
      &lt;th&gt;Wizard of Oz, The (1939)&lt;/th&gt;
      &lt;td&gt;246&lt;/td&gt;
      &lt;td&gt;4.077236&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;40&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1941&lt;/th&gt;
      &lt;th&gt;Citizen Kane (1941)&lt;/th&gt;
      &lt;td&gt;198&lt;/td&gt;
      &lt;td&gt;4.292929&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1942&lt;/th&gt;
      &lt;th&gt;Casablanca (1942)&lt;/th&gt;
      &lt;td&gt;243&lt;/td&gt;
      &lt;td&gt;4.456790&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1946&lt;/th&gt;
      &lt;th&gt;It&amp;#8217;s a Wonderful Life (1946)&lt;/th&gt;
      &lt;td&gt;231&lt;/td&gt;
      &lt;td&gt;4.121212&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="5" valign="top"&gt;50&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1951&lt;/th&gt;
      &lt;th&gt;African Queen, The (1951)&lt;/th&gt;
      &lt;td&gt;152&lt;/td&gt;
      &lt;td&gt;4.184211&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1954&lt;/th&gt;
      &lt;th&gt;Rear Window (1954)&lt;/th&gt;
      &lt;td&gt;209&lt;/td&gt;
      &lt;td&gt;4.387560&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1957&lt;/th&gt;
      &lt;th&gt;Bridge on the River Kwai, The (1957)&lt;/th&gt;
      &lt;td&gt;165&lt;/td&gt;
      &lt;td&gt;4.175758&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1958&lt;/th&gt;
      &lt;th&gt;Vertigo (1958)&lt;/th&gt;
      &lt;td&gt;179&lt;/td&gt;
      &lt;td&gt;4.251397&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1959&lt;/th&gt;
      &lt;th&gt;North by Northwest (1959)&lt;/th&gt;
      &lt;td&gt;179&lt;/td&gt;
      &lt;td&gt;4.284916&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="5" valign="top"&gt;60&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1960&lt;/th&gt;
      &lt;th&gt;Psycho (1960)&lt;/th&gt;
      &lt;td&gt;239&lt;/td&gt;
      &lt;td&gt;4.100418&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1962&lt;/th&gt;
      &lt;th&gt;Lawrence of Arabia (1962)&lt;/th&gt;
      &lt;td&gt;173&lt;/td&gt;
      &lt;td&gt;4.231214&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;To Kill a Mockingbird (1962)&lt;/th&gt;
      &lt;td&gt;219&lt;/td&gt;
      &lt;td&gt;4.292237&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1963&lt;/th&gt;
      &lt;th&gt;Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb (1963)&lt;/th&gt;
      &lt;td&gt;194&lt;/td&gt;
      &lt;td&gt;4.252577&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1967&lt;/th&gt;
      &lt;th&gt;Graduate, The (1967)&lt;/th&gt;
      &lt;td&gt;239&lt;/td&gt;
      &lt;td&gt;4.104603&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="8" valign="top"&gt;70&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1972&lt;/th&gt;
      &lt;th&gt;Godfather, The (1972)&lt;/th&gt;
      &lt;td&gt;413&lt;/td&gt;
      &lt;td&gt;4.283293&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1973&lt;/th&gt;
      &lt;th&gt;Sting, The (1973)&lt;/th&gt;
      &lt;td&gt;241&lt;/td&gt;
      &lt;td&gt;4.058091&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1974&lt;/th&gt;
      &lt;th&gt;Godfather: Part &lt;span class="caps"&gt;II&lt;/span&gt;, The (1974)&lt;/th&gt;
      &lt;td&gt;209&lt;/td&gt;
      &lt;td&gt;4.186603&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Monty Python and the Holy Grail (1974)&lt;/th&gt;
      &lt;td&gt;316&lt;/td&gt;
      &lt;td&gt;4.066456&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1975&lt;/th&gt;
      &lt;th&gt;One Flew Over the Cuckoo&amp;#8217;s Nest (1975)&lt;/th&gt;
      &lt;td&gt;264&lt;/td&gt;
      &lt;td&gt;4.291667&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1977&lt;/th&gt;
      &lt;th&gt;Star Wars (1977)&lt;/th&gt;
      &lt;td&gt;583&lt;/td&gt;
      &lt;td&gt;4.358491&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1979&lt;/th&gt;
      &lt;th&gt;Alien (1979)&lt;/th&gt;
      &lt;td&gt;291&lt;/td&gt;
      &lt;td&gt;4.034364&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Apocalypse Now (1979)&lt;/th&gt;
      &lt;td&gt;221&lt;/td&gt;
      &lt;td&gt;4.045249&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="7" valign="top"&gt;80&amp;#8217;s&lt;/th&gt;
      &lt;th&gt;1980&lt;/th&gt;
      &lt;th&gt;Empire Strikes Back, The (1980)&lt;/th&gt;
      &lt;td&gt;367&lt;/td&gt;
      &lt;td&gt;4.204360&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1981&lt;/th&gt;
      &lt;th&gt;Raiders of the Lost Ark (1981)&lt;/th&gt;
      &lt;td&gt;420&lt;/td&gt;
      &lt;td&gt;4.252381&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1982&lt;/th&gt;
      &lt;th&gt;Blade Runner (1982)&lt;/th&gt;
      &lt;td&gt;275&lt;/td&gt;
      &lt;td&gt;4.138182&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Gandhi (1982)&lt;/th&gt;
      &lt;td&gt;195&lt;/td&gt;
      &lt;td&gt;4.020513&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1984&lt;/th&gt;
      &lt;th&gt;Amadeus (1984)&lt;/th&gt;
      &lt;td&gt;276&lt;/td&gt;
      &lt;td&gt;4.163043&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1987&lt;/th&gt;
      &lt;th&gt;Princess Bride, The (1987)&lt;/th&gt;
      &lt;td&gt;324&lt;/td&gt;
      &lt;td&gt;4.172840&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1989&lt;/th&gt;
      &lt;th&gt;Glory (1989)&lt;/th&gt;
      &lt;td&gt;171&lt;/td&gt;
      &lt;td&gt;4.076023&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="20" valign="top"&gt;90&amp;#8217;s&lt;/th&gt;
      &lt;th rowspan="2" valign="top"&gt;1991&lt;/th&gt;
      &lt;th&gt;Silence of the Lambs, The (1991)&lt;/th&gt;
      &lt;td&gt;390&lt;/td&gt;
      &lt;td&gt;4.289744&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Terminator 2: Judgment Day (1991)&lt;/th&gt;
      &lt;td&gt;295&lt;/td&gt;
      &lt;td&gt;4.006780&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="3" valign="top"&gt;1993&lt;/th&gt;
      &lt;th&gt;Fugitive, The (1993)&lt;/th&gt;
      &lt;td&gt;336&lt;/td&gt;
      &lt;td&gt;4.044643&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Much Ado About Nothing (1993)&lt;/th&gt;
      &lt;td&gt;176&lt;/td&gt;
      &lt;td&gt;4.062500&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Schindler&amp;#8217;s List (1993)&lt;/th&gt;
      &lt;td&gt;298&lt;/td&gt;
      &lt;td&gt;4.466443&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1994&lt;/th&gt;
      &lt;th&gt;Pulp Fiction (1994)&lt;/th&gt;
      &lt;td&gt;394&lt;/td&gt;
      &lt;td&gt;4.060914&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Shawshank Redemption, The (1994)&lt;/th&gt;
      &lt;td&gt;283&lt;/td&gt;
      &lt;td&gt;4.445230&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="2" valign="top"&gt;1995&lt;/th&gt;
      &lt;th&gt;Sense and Sensibility (1995)&lt;/th&gt;
      &lt;td&gt;268&lt;/td&gt;
      &lt;td&gt;4.011194&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Usual Suspects, The (1995)&lt;/th&gt;
      &lt;td&gt;267&lt;/td&gt;
      &lt;td&gt;4.385768&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="4" valign="top"&gt;1996&lt;/th&gt;
      &lt;th&gt;Braveheart (1995)&lt;/th&gt;
      &lt;td&gt;297&lt;/td&gt;
      &lt;td&gt;4.151515&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Lone Star (1996)&lt;/th&gt;
      &lt;td&gt;187&lt;/td&gt;
      &lt;td&gt;4.053476&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Secrets &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; Lies (1996)&lt;/th&gt;
      &lt;td&gt;162&lt;/td&gt;
      &lt;td&gt;4.265432&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Taxi Driver (1976)&lt;/th&gt;
      &lt;td&gt;182&lt;/td&gt;
      &lt;td&gt;4.120879&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th rowspan="6" valign="top"&gt;1997&lt;/th&gt;
      &lt;th&gt;Boot, Das (1981)&lt;/th&gt;
      &lt;td&gt;201&lt;/td&gt;
      &lt;td&gt;4.203980&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Fargo (1996)&lt;/th&gt;
      &lt;td&gt;508&lt;/td&gt;
      &lt;td&gt;4.155512&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Good Will Hunting (1997)&lt;/th&gt;
      &lt;td&gt;198&lt;/td&gt;
      &lt;td&gt;4.262626&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;span class="caps"&gt;L.A.&lt;/span&gt; Confidential (1997)&lt;/th&gt;
      &lt;td&gt;297&lt;/td&gt;
      &lt;td&gt;4.161616&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Return of the Jedi (1983)&lt;/th&gt;
      &lt;td&gt;507&lt;/td&gt;
      &lt;td&gt;4.007890&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Titanic (1997)&lt;/th&gt;
      &lt;td&gt;350&lt;/td&gt;
      &lt;td&gt;4.245714&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1998&lt;/th&gt;
      &lt;th&gt;Apt Pupil (1998)&lt;/th&gt;
      &lt;td&gt;160&lt;/td&gt;
      &lt;td&gt;4.100000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[265]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Which are the most popular movies (number of votes) ?&lt;/span&gt;
&lt;span class="n"&gt;best_movies&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_values&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ascending&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kind&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;bar&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Fargo at the 2nd and Fugitive at the 10nth place of popularity seem a little strange to mee&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[265]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&amp;lt;matplotlib.axes._subplots.AxesSubplot at 0x20f92bd0&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
aq1mFjruAAAAAElFTkSuQmCC
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[266]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Which are the best movies (vote average) ?&lt;/span&gt;
&lt;span class="n"&gt;best_movies&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_values&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ascending&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kind&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;bar&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ylim&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;4.2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mf"&gt;4.5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;# I tend to agree with most of them, however I feel that the Godfather is missing...&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[266]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&amp;lt;matplotlib.axes._subplots.AxesSubplot at 0x21210030&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let&amp;#8217;s try to see how many people of each age are voting, however instead of displaying the votes for people of each specific age, we&amp;#8217;ll seperate the ages into groups (0-10, 10,20 etc) and dispaly the counts for&amp;nbsp;them:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[267]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;review_idx_by_age&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;review_idx_by_age&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Let&amp;#39;s group by age group&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;by_age&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{0}-{1}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="n"&gt;grouped_review_idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;review_idx_by_age&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;groupby&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;by_age&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;aggregate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;grouped_review_idx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;age
7       43
10      31
11      27
13     497
14     264
15     397
16     335
17     897
18    2219
19    3514
Name: idx, dtype: int64
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[267]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;0-10        43
10-20     8181
20-30    39535
30-40    25696
40-50    15021
50-60     8704
60-70     2623
70-80      197
Name: idx, dtype: int64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[268]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Let&amp;#39;s plot our number of votes - we can see that most people voting are 20-30&lt;/span&gt;
&lt;span class="n"&gt;grouped_review_idx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kind&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pie&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;autopct&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%1.1f%%&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[268]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&amp;lt;matplotlib.axes._subplots.AxesSubplot at 0x21579610&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
AVJo9YhKtkGBAAAAAElFTkSuQmCC
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[269]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# We can also see the same (more or less) info directly from the&lt;/span&gt;
&lt;span class="c1"&gt;# initial dataset, using a histogram&lt;/span&gt;
&lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hist&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;bins&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[269]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&amp;lt;matplotlib.axes._subplots.AxesSubplot at 0x21554050&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
TkSuQmCC
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[270]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Or just by plotting the num of reviews / age (not the grouped one)&lt;/span&gt;
&lt;span class="n"&gt;review_idx_by_age&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[270]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;&amp;lt;matplotlib.axes._subplots.AxesSubplot at 0x2172d250&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
rkJggg==
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let&amp;#8217;s see how people of each occupation and sex are voting. We&amp;#8217;ll get the averages for age, and rating and total number of&amp;nbsp;reviews:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[271]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;aggrs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;average&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;average&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="c1"&gt;# This creeates a dataframe for men and women&lt;/span&gt;
&lt;span class="n"&gt;d1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;occupation&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;columns&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sex&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;aggrs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# This creates a dataframe for both&lt;/span&gt;
&lt;span class="n"&gt;d2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;final_lens&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pivot_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;occupation&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;aggfunc&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;aggrs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# Let&amp;#39;s put the values from the &amp;quot;both&amp;quot; dataframe to the men/women dataframe&lt;/span&gt;
&lt;span class="n"&gt;d1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Total&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;d1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Total&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;d1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Total&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;rating&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# And now let&amp;#39;s sort the row index so that it will have the correct multiindex&lt;/span&gt;
&lt;span class="n"&gt;occupations&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;d1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;axis&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# Finally, let&amp;#39;s sort the DataFrame by the total number of votes for each occupation&lt;/span&gt;
&lt;span class="n"&gt;occupations&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;occupations&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort_values&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Total&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;ascending&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;occupations&lt;/span&gt;
&lt;span class="c1"&gt;# Students are no1 - not a surpise!&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[271]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;age&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;idx&lt;/th&gt;
      &lt;th colspan="3" halign="left"&gt;rating&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;sex&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
      &lt;th&gt;Total&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
      &lt;th&gt;Total&lt;/th&gt;
      &lt;th&gt;F&lt;/th&gt;
      &lt;th&gt;M&lt;/th&gt;
      &lt;th&gt;Total&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;occupation&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;student&lt;/th&gt;
      &lt;td&gt;21.092697&lt;/td&gt;
      &lt;td&gt;22.510731&lt;/td&gt;
      &lt;td&gt;22.142870&lt;/td&gt;
      &lt;td&gt;5696.0&lt;/td&gt;
      &lt;td&gt;16261.0&lt;/td&gt;
      &lt;td&gt;21957&lt;/td&gt;
      &lt;td&gt;3.602879&lt;/td&gt;
      &lt;td&gt;3.484411&lt;/td&gt;
      &lt;td&gt;3.515143&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;other&lt;/th&gt;
      &lt;td&gt;31.813370&lt;/td&gt;
      &lt;td&gt;32.964704&lt;/td&gt;
      &lt;td&gt;32.568977&lt;/td&gt;
      &lt;td&gt;3665.0&lt;/td&gt;
      &lt;td&gt;6998.0&lt;/td&gt;
      &lt;td&gt;10663&lt;/td&gt;
      &lt;td&gt;3.531241&lt;/td&gt;
      &lt;td&gt;3.563447&lt;/td&gt;
      &lt;td&gt;3.552377&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;educator&lt;/th&gt;
      &lt;td&gt;37.942058&lt;/td&gt;
      &lt;td&gt;44.570167&lt;/td&gt;
      &lt;td&gt;42.789240&lt;/td&gt;
      &lt;td&gt;2537.0&lt;/td&gt;
      &lt;td&gt;6905.0&lt;/td&gt;
      &lt;td&gt;9442&lt;/td&gt;
      &lt;td&gt;3.698857&lt;/td&gt;
      &lt;td&gt;3.660246&lt;/td&gt;
      &lt;td&gt;3.670621&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;engineer&lt;/th&gt;
      &lt;td&gt;33.489655&lt;/td&gt;
      &lt;td&gt;34.371731&lt;/td&gt;
      &lt;td&gt;34.356086&lt;/td&gt;
      &lt;td&gt;145.0&lt;/td&gt;
      &lt;td&gt;8030.0&lt;/td&gt;
      &lt;td&gt;8175&lt;/td&gt;
      &lt;td&gt;3.751724&lt;/td&gt;
      &lt;td&gt;3.537609&lt;/td&gt;
      &lt;td&gt;3.541407&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;programmer&lt;/th&gt;
      &lt;td&gt;32.463007&lt;/td&gt;
      &lt;td&gt;32.502167&lt;/td&gt;
      &lt;td&gt;32.500064&lt;/td&gt;
      &lt;td&gt;419.0&lt;/td&gt;
      &lt;td&gt;7382.0&lt;/td&gt;
      &lt;td&gt;7801&lt;/td&gt;
      &lt;td&gt;3.577566&lt;/td&gt;
      &lt;td&gt;3.567732&lt;/td&gt;
      &lt;td&gt;3.568260&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;administrator&lt;/th&gt;
      &lt;td&gt;38.096081&lt;/td&gt;
      &lt;td&gt;39.688083&lt;/td&gt;
      &lt;td&gt;39.123145&lt;/td&gt;
      &lt;td&gt;2654.0&lt;/td&gt;
      &lt;td&gt;4825.0&lt;/td&gt;
      &lt;td&gt;7479&lt;/td&gt;
      &lt;td&gt;3.781839&lt;/td&gt;
      &lt;td&gt;3.555233&lt;/td&gt;
      &lt;td&gt;3.635646&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;writer&lt;/th&gt;
      &lt;td&gt;37.429848&lt;/td&gt;
      &lt;td&gt;32.219527&lt;/td&gt;
      &lt;td&gt;34.325867&lt;/td&gt;
      &lt;td&gt;2238.0&lt;/td&gt;
      &lt;td&gt;3298.0&lt;/td&gt;
      &lt;td&gt;5536&lt;/td&gt;
      &lt;td&gt;3.663986&lt;/td&gt;
      &lt;td&gt;3.180109&lt;/td&gt;
      &lt;td&gt;3.375723&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;librarian&lt;/th&gt;
      &lt;td&gt;36.707343&lt;/td&gt;
      &lt;td&gt;38.129300&lt;/td&gt;
      &lt;td&gt;37.358050&lt;/td&gt;
      &lt;td&gt;2860.0&lt;/td&gt;
      &lt;td&gt;2413.0&lt;/td&gt;
      &lt;td&gt;5273&lt;/td&gt;
      &lt;td&gt;3.580070&lt;/td&gt;
      &lt;td&gt;3.537920&lt;/td&gt;
      &lt;td&gt;3.560781&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;technician&lt;/th&gt;
      &lt;td&gt;38.000000&lt;/td&gt;
      &lt;td&gt;31.512655&lt;/td&gt;
      &lt;td&gt;31.712493&lt;/td&gt;
      &lt;td&gt;108.0&lt;/td&gt;
      &lt;td&gt;3398.0&lt;/td&gt;
      &lt;td&gt;3506&lt;/td&gt;
      &lt;td&gt;3.268519&lt;/td&gt;
      &lt;td&gt;3.540612&lt;/td&gt;
      &lt;td&gt;3.532230&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;executive&lt;/th&gt;
      &lt;td&gt;42.529412&lt;/td&gt;
      &lt;td&gt;36.203331&lt;/td&gt;
      &lt;td&gt;36.614164&lt;/td&gt;
      &lt;td&gt;221.0&lt;/td&gt;
      &lt;td&gt;3182.0&lt;/td&gt;
      &lt;td&gt;3403&lt;/td&gt;
      &lt;td&gt;3.773756&lt;/td&gt;
      &lt;td&gt;3.319610&lt;/td&gt;
      &lt;td&gt;3.349104&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;healthcare&lt;/th&gt;
      &lt;td&gt;37.644993&lt;/td&gt;
      &lt;td&gt;44.641851&lt;/td&gt;
      &lt;td&gt;38.885164&lt;/td&gt;
      &lt;td&gt;2307.0&lt;/td&gt;
      &lt;td&gt;497.0&lt;/td&gt;
      &lt;td&gt;2804&lt;/td&gt;
      &lt;td&gt;2.736021&lt;/td&gt;
      &lt;td&gt;3.639839&lt;/td&gt;
      &lt;td&gt;2.896220&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;artist&lt;/th&gt;
      &lt;td&gt;27.155510&lt;/td&gt;
      &lt;td&gt;33.088257&lt;/td&gt;
      &lt;td&gt;30.592288&lt;/td&gt;
      &lt;td&gt;971.0&lt;/td&gt;
      &lt;td&gt;1337.0&lt;/td&gt;
      &lt;td&gt;2308&lt;/td&gt;
      &lt;td&gt;3.347065&lt;/td&gt;
      &lt;td&gt;3.875841&lt;/td&gt;
      &lt;td&gt;3.653380&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;entertainment&lt;/th&gt;
      &lt;td&gt;27.546667&lt;/td&gt;
      &lt;td&gt;28.912834&lt;/td&gt;
      &lt;td&gt;28.766110&lt;/td&gt;
      &lt;td&gt;225.0&lt;/td&gt;
      &lt;td&gt;1870.0&lt;/td&gt;
      &lt;td&gt;2095&lt;/td&gt;
      &lt;td&gt;3.448889&lt;/td&gt;
      &lt;td&gt;3.440107&lt;/td&gt;
      &lt;td&gt;3.441050&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;scientist&lt;/th&gt;
      &lt;td&gt;28.273381&lt;/td&gt;
      &lt;td&gt;35.855133&lt;/td&gt;
      &lt;td&gt;35.343052&lt;/td&gt;
      &lt;td&gt;139.0&lt;/td&gt;
      &lt;td&gt;1919.0&lt;/td&gt;
      &lt;td&gt;2058&lt;/td&gt;
      &lt;td&gt;3.251799&lt;/td&gt;
      &lt;td&gt;3.637311&lt;/td&gt;
      &lt;td&gt;3.611273&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;marketing&lt;/th&gt;
      &lt;td&gt;32.106335&lt;/td&gt;
      &lt;td&gt;37.759947&lt;/td&gt;
      &lt;td&gt;36.478462&lt;/td&gt;
      &lt;td&gt;442.0&lt;/td&gt;
      &lt;td&gt;1508.0&lt;/td&gt;
      &lt;td&gt;1950&lt;/td&gt;
      &lt;td&gt;3.522624&lt;/td&gt;
      &lt;td&gt;3.474801&lt;/td&gt;
      &lt;td&gt;3.485641&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;retired&lt;/th&gt;
      &lt;td&gt;70.000000&lt;/td&gt;
      &lt;td&gt;61.375163&lt;/td&gt;
      &lt;td&gt;61.755749&lt;/td&gt;
      &lt;td&gt;71.0&lt;/td&gt;
      &lt;td&gt;1538.0&lt;/td&gt;
      &lt;td&gt;1609&lt;/td&gt;
      &lt;td&gt;3.239437&lt;/td&gt;
      &lt;td&gt;3.477243&lt;/td&gt;
      &lt;td&gt;3.466750&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;lawyer&lt;/th&gt;
      &lt;td&gt;36.000000&lt;/td&gt;
      &lt;td&gt;34.478056&lt;/td&gt;
      &lt;td&gt;34.556134&lt;/td&gt;
      &lt;td&gt;69.0&lt;/td&gt;
      &lt;td&gt;1276.0&lt;/td&gt;
      &lt;td&gt;1345&lt;/td&gt;
      &lt;td&gt;3.623188&lt;/td&gt;
      &lt;td&gt;3.741379&lt;/td&gt;
      &lt;td&gt;3.735316&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;none&lt;/th&gt;
      &lt;td&gt;33.887671&lt;/td&gt;
      &lt;td&gt;18.960821&lt;/td&gt;
      &lt;td&gt;25.007769&lt;/td&gt;
      &lt;td&gt;365.0&lt;/td&gt;
      &lt;td&gt;536.0&lt;/td&gt;
      &lt;td&gt;901&lt;/td&gt;
      &lt;td&gt;3.632877&lt;/td&gt;
      &lt;td&gt;3.878731&lt;/td&gt;
      &lt;td&gt;3.779134&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;salesman&lt;/th&gt;
      &lt;td&gt;31.318584&lt;/td&gt;
      &lt;td&gt;34.882012&lt;/td&gt;
      &lt;td&gt;33.470794&lt;/td&gt;
      &lt;td&gt;339.0&lt;/td&gt;
      &lt;td&gt;517.0&lt;/td&gt;
      &lt;td&gt;856&lt;/td&gt;
      &lt;td&gt;3.870206&lt;/td&gt;
      &lt;td&gt;3.394584&lt;/td&gt;
      &lt;td&gt;3.582944&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;doctor&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;35.592593&lt;/td&gt;
      &lt;td&gt;35.592593&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;540.0&lt;/td&gt;
      &lt;td&gt;540&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3.688889&lt;/td&gt;
      &lt;td&gt;3.688889&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;homemaker&lt;/th&gt;
      &lt;td&gt;33.416357&lt;/td&gt;
      &lt;td&gt;23.000000&lt;/td&gt;
      &lt;td&gt;32.371237&lt;/td&gt;
      &lt;td&gt;269.0&lt;/td&gt;
      &lt;td&gt;30.0&lt;/td&gt;
      &lt;td&gt;299&lt;/td&gt;
      &lt;td&gt;3.278810&lt;/td&gt;
      &lt;td&gt;3.500000&lt;/td&gt;
      &lt;td&gt;3.301003&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let&amp;#8217;s manipulate the previous DataFrame to take a look at only the occupations that have voted the most number of times. Actually, we&amp;#8217;ll get only occupations that have voted more than 6000 times, all other occupations we&amp;#8217;ll just add them to the &amp;#8220;other&amp;#8221; occupation. For this, we&amp;#8217;ll get only the &lt;code&gt;'idx'&lt;/code&gt; column and filter it by the rows which have a &lt;code&gt;Total&amp;lt;6000&lt;/code&gt;. We&amp;#8217;ll then take the sum for this DataFrame so that we&amp;#8217;ll get the total votes for each male/female and&amp;nbsp;total.&lt;/p&gt;
&lt;p&gt;Next, we&amp;#8217;ll add this to the &amp;#8220;other&amp;#8221; row of the dataframe and remove the less than 6000 rows from it. Finally, we&amp;#8217;ll plot the resulting DataFrame for all male, female and&amp;nbsp;both.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In&amp;nbsp;[272]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;occupations_num&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;occupations&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;idx&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# Let&amp;#39;s see which are the total numbers we need to add to &amp;quot;other&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;add_to_other&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;occupations_num&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;occupations_num&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Total&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;6000&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;add_to_other&lt;/span&gt;

&lt;span class="n"&gt;occupations_num&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;other&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="n"&gt;add_to_other&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;occupations_num&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;other&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c1"&gt;# Now let&amp;#39;s get the rows that have a total of &amp;gt; 6000&lt;/span&gt;
&lt;span class="n"&gt;most_voters_with_other&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;occupations_num&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;occupations_num&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Total&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;6000&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;most_voters_with_other&lt;/span&gt;
&lt;span class="n"&gt;most_voters_with_other&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;kind&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;pie&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;subplots&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;legend&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;autopct&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%1.1f%%&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;sex
F        10624.0
M        23859.0
Total    34483.0
dtype: float64
sex
F        14289.0
M        30857.0
Total    45146.0
Name: other, dtype: float64
sex                  F        M    Total
occupation                              
student         5696.0  16261.0  21957.0
other          14289.0  30857.0  45146.0
educator        2537.0   6905.0   9442.0
engineer         145.0   8030.0   8175.0
programmer       419.0   7382.0   7801.0
administrator   2654.0   4825.0   7479.0
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[272]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;array([&amp;lt;matplotlib.axes._subplots.AxesSubplot object at 0x2179D090&amp;gt;,
       &amp;lt;matplotlib.axes._subplots.AxesSubplot object at 0x18CFAC10&amp;gt;,
       &amp;lt;matplotlib.axes._subplots.AxesSubplot object at 0x18D0E0D0&amp;gt;], dtype=object)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;




&lt;div class="output_png output_subarea "&gt;
&lt;img src="data:image/png;base64,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
YL/NHLMSuI9QEvewu+fM7EHeyz7Z3PW6Mp47vx1v5G3XNd5D3H0sYbwPkYJRKY2IiIiUGs1eINK3
dXUNjQO+Z2Y7m9mewDc67DsLOMfMEmb2OWBU3rZbgQvNbLQFQ+K4QJVxWRuDIicSxhZqtxr4oJnl
D7R5N3C1mQ00s4HADwileyLSBykwIiIiIiVFsxeI9G1buIauJZSwLCaMI3FHh92vIAxuvJ4w7tCD
ecd9DrgQuBHYAEwFhrp7E3A5cG+8ns8GHs7bbz7wF2BRnA1nMPBj4HlCuc3s+PP13fU7EJHSYmHc
MhEREZG+J85e8Ft3v73YbREREZHSpIwRERER6TM0e4GIiIhsKw2+KiIiIn2JZi8QERGRbaJSGhER
ERERERHpt1RKIyIiIiIiIiL9lgIjIiIiIiIiItJvKTAiIiIiIiIiIv2WAiMiIiIiIiIi0m8pMCIi
IiIiIiIi/ZYCIyIiIiIiIiLSbykwIiIiIiIiIiL9lgIjIiIiIiIiItJvKTAiIiIiIiIiIv2WAiMi
IiIiIiIi0m8pMCIiIiIiIiIi/ZYCIyIiIiIiIiLSbykwIiIiIiIiIiL9lgIjIiIiIiIiItJvKTAi
IiIiIiIiIv2WAiMiIiIiIiIi0m8pMCIiIiIiIiIi/ZYCIyIiIiIiIiLSb/0/t/XlCX2AthkAAAAA
SUVORK5CYII=
"
&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h1 id="Conclusion"&gt;Conclusion&lt;a class="anchor-link" href="#Conclusion"&gt;&amp;#182;&lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In the previous, I have tried to present a comprehensive introduction of the &lt;code&gt;pivot_table&lt;/code&gt; command along with a small introduction to the pandas data structures (&lt;code&gt;Series&lt;/code&gt; and &lt;code&gt;DataFrame&lt;/code&gt;) and a bunch of other methods that will help in using &lt;code&gt;pivot_table&lt;/code&gt; presenting both toy and real world examples for all of them. If you feel that something is missing or you want me to add another example pivot_table operation for either the books or the movie lens dataset feel free to tell me in the&amp;nbsp;comments.&lt;/p&gt;
&lt;p&gt;I hope that after reading (and understanding) the above you&amp;#8217;ll be able to use pandas and &lt;code&gt;pivot_table&lt;/code&gt; without&amp;nbsp;problems!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
 


&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</content><category term="python"></category><category term="python"></category><category term="pandas"></category><category term="scipy"></category><category term="numpy"></category><category term="pivot"></category><category term="pivot_table"></category><category term="ipython"></category><category term="jupyter"></category><category term="notebook"></category></entry><entry><title>Splitting a query into individual fields inÂ Django</title><link href="https://spapas.github.io/2016/09/12/django-split-query/" rel="alternate"></link><published>2016-09-12T16:20:00+03:00</published><updated>2016-09-12T16:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2016-09-12:/2016/09/12/django-split-query/</id><summary type="html">&lt;p class="first last"&gt;How to split a query containing spaces into individual model&amp;nbsp;fields&lt;/p&gt;
</summary><content type="html">&lt;p&gt;As you should have already seen in &lt;a class="reference external" href="https://spapas.github.io/2015/10/05/django-dynamic-tables-similar-models/"&gt;previous articles&lt;/a&gt;, I really like using &lt;a class="reference external" href="https://github.com/alex/django-filter"&gt;django-filter&lt;/a&gt; since it covers (nearly) all my queryset filtering needs.
With django-filter, you define a bunch of fields and it will automatically create inputs for each one of these fields so that you can filter by each one of these fields individually or a
combination of&amp;nbsp;them.&lt;/p&gt;
&lt;p&gt;However, one thing that django-filter (and django in generally) lacks is the ability to &lt;em&gt;filter multiple fields using a single input&lt;/em&gt;. This functionality may be familiar to some readers from
the &lt;a class="reference external" href="https://datatables.net/"&gt;datatable&lt;/a&gt; jquery plugin. If you take a look at the example in the datatable homepage, you&amp;#8217;ll see a single &amp;#8220;Search&amp;#8221; field. What is really great is that you can enter multiple values (seperated
by spaces) into that field and it will filter the individual table values by each one of them. For example, if you enter &amp;#8220;2011 Engineer&amp;#8221; you&amp;#8217;ll see all engineering positions that started
on 2011. If you append &amp;#8220;Singapore&amp;#8221; (so you&amp;#8217;ll have &amp;#8220;2011 Engineer Singapore&amp;#8221;) you&amp;#8217;ll also get only the corresponding&amp;nbsp;results!&lt;/p&gt;
&lt;p&gt;This functionality is really useful and is very important to have if you use single-input fields to query your data. One such example is if you use autocompletes, for example with
django-autocomplete-light: You&amp;#8217;ll have a single input however you may need to filter on more than one field to find out your&amp;nbsp;selection.&lt;/p&gt;
&lt;p&gt;In the following ost I&amp;#8217;ll show you how to implement this functionality using Django and django-filters (actually django-filters will be used to provide the form) - to see it
in action you may use the &lt;a class="reference external" href="https://github.com/spapas/django_table_filtering"&gt;https://github.com/spapas/django_table_filtering&lt;/a&gt; repository (check out the &lt;cite&gt;/filter_ex/&lt;/cite&gt; view).&lt;/p&gt;
&lt;p&gt;I won&amp;#8217;t go into detail on how the code is structured (it&amp;#8217;s really simple) and I&amp;#8217;ll go directly to the filter I am using. Instead of using a filter you can of course directly query on
your view. What you actually need&amp;nbsp;is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;a queryset with the instances you want to&amp;nbsp;search&lt;/li&gt;
&lt;li&gt;a text value with the query (that may contain&amp;nbsp;spaces)&lt;/li&gt;
&lt;li&gt;a list of the names of the fields you want to&amp;nbsp;search&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;In my case, I am using a &lt;cite&gt;Book&lt;/cite&gt; model that has the following fields: &lt;cite&gt;id, title, author, category&lt;/cite&gt;. I have created a filter with a single field named &lt;cite&gt;ex&lt;/cite&gt; that will filter on
all these fields. So you should be able to enter &amp;#8220;King It&amp;#8221; and find &amp;#8220;It by Stephen King&amp;#8221;. Let&amp;#8217;s see how the filter is&amp;nbsp;implemented:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
import itertools

class BookFilterEx(django_filters.FilterSet):
    ex = django_filters.MethodFilter()
    search_fields = ['title', 'author', 'category', 'id', ]

    def filter_ex(self, qs, value):
        if value:
            q_parts = value.split()

            # Permutation code copied from http://stackoverflow.com/a/12935562/119071

            list1=self.search_fields
            list2=q_parts
            perms = [zip(x,list2) for x in itertools.permutations(list1,len(list2))]

            q_totals = Q()
            for perm in perms:
                q_part = Q()
                for p in perm:
                    q_part = q_part &amp;amp; Q(**{p[0]+'__icontains': p[1]})
                q_totals = q_totals | q_part

            qs = qs.filter(q_totals)
        return qs

    class Meta:
        model = books.models.Book
        fields = ['ex']
&lt;/pre&gt;
&lt;p&gt;The meat of this code is in the &lt;tt class="docutils literal"&gt;filter_ex&lt;/tt&gt; method, let&amp;#8217;s analyze it line by line:
First of all, we split the value to its corresponding parts using the whitespace to sperate into individual tokens. For example if the user has entered
&lt;tt class="docutils literal"&gt;King It&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;q_parts&lt;/tt&gt; be equal to &lt;tt class="docutils literal"&gt;['King', 'It']&lt;/tt&gt;. As you can see the &lt;cite&gt;search_fields&lt;/cite&gt; attribute contains the names of the
fields we want to search. The first thing I like to do is to generate all possible combinations between &lt;tt class="docutils literal"&gt;q_parts&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;search_fields&lt;/tt&gt;, I&amp;#8217;ve copied the list combination code from &lt;a class="reference external" href="http://stackoverflow.com/a/12935562/119071"&gt;http://stackoverflow.com/a/12935562/119071&lt;/a&gt; and it is the line
&lt;tt class="docutils literal"&gt;perms = [zip(x,list2) for x in &lt;span class="pre"&gt;itertools.permutations(list1,len(list2))]&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;itertools.permutations(list1,len(list2))&lt;/tt&gt; will generate all permutations of list1
that have length equal to the length of list2. I.e if list2 is &lt;tt class="docutils literal"&gt;['King', 'It']&lt;/tt&gt; (len=2) then it will generate all combinations
of search_fields with length=2, i.e it will generate the following list of&amp;nbsp;tuples:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
[
    ('title', 'author'), ('title', 'category'), ('title', 'id'), ('author', 'title'),
    ('author', 'category'), ('author', 'id'), ('category', 'title'), ('category', 'author'),
    ('category', 'id'), ('id', 'title'), ('id', 'author'), ('id', 'category')
]
&lt;/pre&gt;
&lt;p&gt;Now, the &lt;tt class="docutils literal"&gt;zip&lt;/tt&gt; will combine the elements of each one of these tuples with the elements of &lt;tt class="docutils literal"&gt;list2&lt;/tt&gt;, so, in our example
(&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;list2=['King',&lt;/span&gt; 'It']&lt;/tt&gt;) &lt;tt class="docutils literal"&gt;perms&lt;/tt&gt; will be the following&amp;nbsp;array:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
[
    [('title', 'King'), ('author', 'It')],
    [('title', 'King'), ('category', 'It')],
    [('title', 'King'), ('id', 'It')],
    [('author', 'King'), ('title', 'It')],
    [('author', 'King'), ('category', 'It')],
    [('author', 'King'), ('id', 'It')],
    [('category', 'King'), ('title', 'It')],
    [('category', 'King'), ('author', 'It')],
    [('category', 'King'), ('id', 'It')],
    [('id', 'King'), ('title', 'It')],
    [('id', 'King'), ('author', 'It')],
    [('id', 'King'), ('category', 'It')]
]
&lt;/pre&gt;
&lt;p&gt;Notice that &lt;tt class="docutils literal"&gt;itertools.permutations(list1,len(list2))&lt;/tt&gt; will return an empty list if &lt;tt class="docutils literal"&gt;len(list2) &amp;gt; len(list1)&lt;/tt&gt; - this is actually what
we want since that means that the user entered more query parts than the available fields, i.e we can&amp;#8217;t match each one of the
possible values after we split the input with a search field so we should return&amp;nbsp;nothing.&lt;/p&gt;
&lt;p&gt;Now, what I want is to create a single query that will combine the tuples in each of these combinations by &lt;span class="caps"&gt;AND&lt;/span&gt; (i.e
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;title==King&lt;/span&gt; &lt;span class="caps"&gt;AND&lt;/span&gt; &lt;span class="pre"&gt;author==It&lt;/span&gt;&lt;/tt&gt; ) and then combine all these subqueries using &lt;span class="caps"&gt;OR&lt;/span&gt; (i.e
&amp;#8220; (title==King &lt;span class="caps"&gt;AND&lt;/span&gt; author==It) &lt;span class="caps"&gt;OR&lt;/span&gt; (title==King &lt;span class="caps"&gt;AND&lt;/span&gt; category==It) &lt;span class="caps"&gt;OR&lt;/span&gt; (title==King &lt;span class="caps"&gt;AND&lt;/span&gt; id==It) &lt;span class="caps"&gt;OR&lt;/span&gt;&amp;nbsp;&amp;#8230;&amp;#8220;.&lt;/p&gt;
&lt;p&gt;This could of course be implemented with a raw sql query however we could use some interesting django tricks for this.
I&amp;#8217;ve already done something similar to &lt;a class="reference external" href="https://spapas.github.io/2015/10/05/django-dynamic-tables-similar-models/"&gt;a previous article&lt;/a&gt; so I won&amp;#8217;t go
into much detail explaining the code that creates the &lt;tt class="docutils literal"&gt;q_totals&lt;/tt&gt; &lt;tt class="docutils literal"&gt;Q&lt;/tt&gt; object. What it does is that it create a big django &lt;tt class="docutils literal"&gt;Q&lt;/tt&gt; object that combines using &lt;span class="caps"&gt;AND&lt;/span&gt; (&lt;tt class="docutils literal"&gt;&amp;amp;&lt;/tt&gt;)
all individual &lt;tt class="docutils literal"&gt;q_part&lt;/tt&gt; objects. Each &lt;tt class="docutils literal"&gt;q_part&lt;/tt&gt; object combines using &lt;span class="caps"&gt;OR&lt;/span&gt; (&lt;tt class="docutils literal"&gt;|&lt;/tt&gt;) the individual combinations of field name
and value &amp;#8212; I&amp;#8217;ve used &lt;cite&gt;__icontains`&lt;/cite&gt; to create the query. So the result will be something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
q_totals =
    Q(title__icontains='King') &amp;amp; Q(author__icontains='It')
    |
    Q(title__icontains='King') &amp;amp; Q(category__icontains='It')
    |
    Q(title__icontains='King') &amp;amp; Q(id__icontains='It')
    |
    Q(author__icontains='King') &amp;amp; Q(title__icontains='It')
    ...
&lt;/pre&gt;
&lt;p&gt;Filtering by this &lt;tt class="docutils literal"&gt;q_totals&lt;/tt&gt; will return the correct&amp;nbsp;values!&lt;/p&gt;
&lt;p&gt;One extra complication we should be aware of is what happens if the user needs to also search for books with multiple words
in their titles. For example, if the user enters &amp;#8220;Under the Dome King&amp;#8221; or &amp;#8220;It Stephen King&amp;#8221; or even &amp;#8220;The Stand Stephen King&amp;#8221;
we won&amp;#8217;t get any results&amp;nbsp;:(&lt;/p&gt;
&lt;p&gt;To fix this, we need to get all possible combinations of sequential substrings, i.e for &amp;#8220;Under the Dome King&amp;#8221;, after we
split it to [&amp;#8216;Under&amp;#8217;, &amp;#8216;the&amp;#8217;, &amp;#8216;Dome&amp;#8217;, &amp;#8216;King&amp;#8217;] we&amp;#8217;ll need the following&amp;nbsp;combinations:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
[
    ['Under', 'the', 'Dome', 'King'],
    ['Under', 'the', 'Dome King'],
    ['Under', 'the Dome', 'King'],
    ['Under', 'the Dome King'],
    ['Under the', 'Dome', 'King'],
    ['Under the', 'Dome King'],
    ['Under the Dome', 'King'],
    ['Under the Dome King']
]
&lt;/pre&gt;
&lt;p&gt;A possible solution for that problem can be found on this &lt;span class="caps"&gt;SO&lt;/span&gt; answer: &lt;a class="reference external" href="http://stackoverflow.com/a/27263616/119071"&gt;http://stackoverflow.com/a/27263616/119071&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now, to extend our solution to include this, we&amp;#8217;d need to actually search for each one of the above possiblities
and combine again the results with &lt;span class="caps"&gt;OR&lt;/span&gt;, something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
def filter_ex(self, qs, value):
    if value:
        q_parts = value.split()

        # Use a global q_totals
        q_totals = Q()

        # This part will get us all possible segmantiation of the query parts and put it in the possibilities list
        combinatorics = itertools.product([True, False], repeat=len(q_parts) - 1)
        possibilities = []
        for combination in combinatorics:
            i = 0
            one_such_combination = [q_parts[i]]
            for slab in combination:
                i += 1
                if not slab: # there is a join
                    one_such_combination[-1] += ' ' + q_parts[i]
                else:
                    one_such_combination += [q_parts[i]]
            possibilities.append(one_such_combination)

        # Now, for all possiblities we'll append all the Q objects using OR
        for p in possibilities:
            list1=self.search_fields
            list2=p
            perms = [zip(x,list2) for x in itertools.permutations(list1,len(list2))]

            for perm in perms:
                q_part = Q()
                for p in perm:
                    q_part = q_part &amp;amp; Q(**{p[0]+'__icontains': p[1]})
                q_totals = q_totals | q_part

        qs = qs.filter(q_totals)
    return qs
&lt;/pre&gt;
&lt;p&gt;The previous filtering code works fine with querise like &amp;#8220;The Stand&amp;#8221; or &amp;#8220;Under the Dome Stephen&amp;nbsp;King&amp;#8221;!&lt;/p&gt;
&lt;p&gt;One thing that you must be careful is that this code will create &lt;em&gt;very complicated and big&lt;/em&gt; queries. For example,
searching for &amp;#8220;Under the Dome Stephen King&amp;#8221; will result to &lt;cite&gt;q_totals&lt;/cite&gt; getting this monster&amp;nbsp;value:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
(OR:
(AND: ),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the'), ('category__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the'), ('id__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the'), ('author__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the'), ('id__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the'), ('author__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the'), ('category__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the'), ('category__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the'), ('id__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the'), ('title__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the'), ('id__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the'), ('title__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the'), ('category__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the'), ('author__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the'), ('id__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the'), ('title__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the'), ('id__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the'), ('title__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the'), ('author__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the'), ('author__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the'), ('category__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the'), ('title__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the'), ('category__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the'), ('title__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the'), ('author__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the'), ('category__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the'), ('id__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the'), ('author__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the'), ('id__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the'), ('author__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the'), ('category__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the'), ('category__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the'), ('id__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the'), ('title__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the'), ('id__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the'), 'title__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the'), ('category__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the'), ('author__icontains', u'Dome Stephen'),('id__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the'), ('id__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the'), ('title__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the'), ('id__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the'), ('title__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the'), ('author__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the'), ('author__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the'), ('category__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the'), ('title__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the'), ('category__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the'), ('title__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the'), ('author__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the'), ('category__icontains', u'Dome Stephen King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the'), ('id__icontains', u'Dome Stephen King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the'), ('author__icontains', u'Dome Stephen King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the'), ('id__icontains', u'Dome Stephen King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the'), ('author__icontains', u'Dome Stephen King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the'), ('category__icontains', u'Dome Stephen King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the'), ('category__icontains', u'Dome Stephen King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the'), ('id__icontains', u'Dome Stephen King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the'), ('title__icontains', u'Dome Stephen King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the'), ('id__icontains', u'Dome Stephen King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the'), ('title__icontains', u'Dome Stephen King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the'), ('category__icontains', u'Dome Stephen King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the'), ('author__icontains', u'Dome Stephen King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the'), ('id__icontains', u'Dome Stephen King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the'), ('title__icontains', u'Dome Stephen King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the'), ('id__icontains', u'Dome Stephen King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the'), ('title__icontains', u'Dome Stephen King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the'), ('author__icontains', u'Dome Stephen King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the'), ('author__icontains', u'Dome Stephen King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the'), ('category__icontains', u'Dome Stephen King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the'), ('title__icontains', u'Dome Stephen King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the'), ('category__icontains', u'Dome Stephen King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the'), ('title__icontains', u'Dome Stephen King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the'), ('author__icontains', u'Dome Stephen King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the Dome'), ('category__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the Dome'), ('id__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the Dome'), ('author__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the Dome'), ('id__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the Dome'), ('author__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the Dome'), ('category__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the Dome'), ('category__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the Dome'), ('id__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the Dome'), ('title__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the Dome'), ('id__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the Dome'), ('title__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the Dome'), ('category__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the Dome'), ('author__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the Dome'), ('id__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the Dome'), ('title__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the Dome'), ('id__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the Dome'), ('title__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the Dome'), ('author__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the Dome'), ('author__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the Dome'), ('category__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the Dome'), ('title__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the Dome'), ('category__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the Dome'), ('title__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the Dome'), ('author__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the Dome'), ('category__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the Dome'), ('id__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the Dome'), ('author__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the Dome'), ('id__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the Dome'), ('author__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the Dome'), ('category__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the Dome'), ('category__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the Dome'), ('id__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the Dome'), ('title__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the Dome'), ('id__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the Dome'), ('title__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the Dome'), ('category__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the Dome'), ('author__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the Dome'), ('id__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the Dome'), ('title__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the Dome'), ('id__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the Dome'), ('title__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the Dome'), ('author__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the Dome'), ('author__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the Dome'), ('category__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the Dome'), ('title__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the Dome'), ('category__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the Dome'), ('title__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the Dome'), ('author__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the Dome Stephen'), ('category__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the Dome Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the Dome Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the Dome Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the Dome Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the Dome Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the Dome Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the Dome Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the Dome Stephen'), ('title__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the Dome Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the Dome Stephen'), ('title__icontains', u'King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the Dome Stephen'), ('category__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the Dome Stephen'), ('author__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the Dome Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the Dome Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the Dome Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the Dome Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the Dome Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the Dome Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the Dome Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the Dome Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the Dome Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the Dome Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the Dome Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under'), ('author__icontains', u'the Dome Stephen King')),
(AND: ('title__icontains', u'Under'), ('category__icontains', u'the Dome Stephen King')),
(AND: ('title__icontains', u'Under'), ('id__icontains', u'the Dome Stephen King')),
(AND: ('author__icontains', u'Under'), ('title__icontains', u'the Dome Stephen King')),
(AND: ('author__icontains', u'Under'), ('category__icontains', u'the Dome Stephen King')),
(AND: ('author__icontains', u'Under'), ('id__icontains', u'the Dome Stephen King')),
(AND: ('category__icontains', u'Under'), ('title__icontains', u'the Dome Stephen King')),
(AND: ('category__icontains', u'Under'), ('author__icontains', u'the Dome Stephen King')),
(AND: ('category__icontains', u'Under'), ('id__icontains', u'the Dome Stephen King')),
(AND: ('id__icontains', u'Under'), ('title__icontains', u'the Dome Stephen King')),
(AND: ('id__icontains', u'Under'), ('author__icontains', u'the Dome Stephen King')),
(AND: ('id__icontains', u'Under'), ('category__icontains', u'the Dome Stephen King')),
(AND: ('title__icontains', u'Under the'), ('author__icontains', u'Dome'), ('category__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('author__icontains', u'Dome'), ('id__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('category__icontains', u'Dome'), ('author__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('category__icontains', u'Dome'), ('id__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('id__icontains', u'Dome'), ('author__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('id__icontains', u'Dome'), ('category__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('title__icontains', u'Dome'), ('category__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('title__icontains', u'Dome'), ('id__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('category__icontains', u'Dome'), ('title__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('category__icontains', u'Dome'), ('id__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('id__icontains', u'Dome'), ('title__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('id__icontains', u'Dome'), ('category__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('title__icontains', u'Dome'), ('author__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('title__icontains', u'Dome'), ('id__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('author__icontains', u'Dome'), ('title__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('author__icontains', u'Dome'), ('id__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('id__icontains', u'Dome'), ('title__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('id__icontains', u'Dome'), ('author__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('title__icontains', u'Dome'), ('author__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('title__icontains', u'Dome'), ('category__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('author__icontains', u'Dome'), ('title__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('author__icontains', u'Dome'), ('category__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('category__icontains', u'Dome'), ('title__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('category__icontains', u'Dome'), ('author__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('author__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under the'), ('author__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under the'), ('category__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under the'), ('category__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under the'), ('id__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under the'), ('id__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under the'), ('title__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under the'), ('title__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under the'), ('category__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under the'), ('category__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under the'), ('id__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under the'), ('id__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under the'), ('title__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under the'), ('title__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under the'), ('author__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under the'), ('author__icontains', u'Dome'), ('id__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under the'), ('id__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under the'), ('id__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under the'), ('title__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under the'), ('title__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under the'), ('author__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under the'), ('author__icontains', u'Dome'), ('category__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under the'), ('category__icontains', u'Dome'), ('title__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under the'), ('category__icontains', u'Dome'), ('author__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under the'), ('author__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('author__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('category__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('category__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('id__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('id__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('title__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('title__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('category__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('category__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('id__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('author__icontains', u'Under the'), ('id__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('title__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('title__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('author__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('author__icontains', u'Dome Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('id__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under the'), ('id__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('title__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('title__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('author__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('author__icontains', u'Dome Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('category__icontains', u'Dome Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under the'), ('category__icontains', u'Dome Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under the'), ('author__icontains', u'Dome Stephen King')),
(AND: ('title__icontains', u'Under the'), ('category__icontains', u'Dome Stephen King')),
(AND: ('title__icontains', u'Under the'), ('id__icontains', u'Dome Stephen King')),
(AND: ('author__icontains', u'Under the'), ('title__icontains', u'Dome Stephen King')),
(AND: ('author__icontains', u'Under the'), ('category__icontains', u'Dome Stephen King')),
(AND: ('author__icontains', u'Under the'), ('id__icontains', u'Dome Stephen King')),
(AND: ('category__icontains', u'Under the'), ('title__icontains', u'Dome Stephen King')),
(AND: ('category__icontains', u'Under the'), ('author__icontains', u'Dome Stephen King')),
(AND: ('category__icontains', u'Under the'), ('id__icontains', u'Dome Stephen King')),
(AND: ('id__icontains', u'Under the'), ('title__icontains', u'Dome Stephen King')),
(AND: ('id__icontains', u'Under the'), ('author__icontains', u'Dome Stephen King')),
(AND: ('id__icontains', u'Under the'), ('category__icontains', u'Dome Stephen King')),
(AND: ('title__icontains', u'Under the Dome'), ('author__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('title__icontains', u'Under the Dome'), ('author__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under the Dome'), ('category__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under the Dome'), ('category__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('title__icontains', u'Under the Dome'), ('id__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under the Dome'), ('id__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under the Dome'), ('title__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under the Dome'), ('title__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under the Dome'), ('category__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('author__icontains', u'Under the Dome'), ('category__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under the Dome'), ('id__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('author__icontains', u'Under the Dome'), ('id__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('category__icontains', u'Under the Dome'), ('title__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('category__icontains', u'Under the Dome'), ('title__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under the Dome'), ('author__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under the Dome'), ('author__icontains', u'Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under the Dome'), ('id__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under the Dome'), ('id__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under the Dome'), ('title__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under the Dome'), ('title__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under the Dome'), ('author__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under the Dome'), ('author__icontains', u'Stephen'), ('category__icontains', u'King')),
(AND: ('id__icontains', u'Under the Dome'), ('category__icontains', u'Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under the Dome'), ('category__icontains', u'Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under the Dome'), ('author__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under the Dome'), ('category__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under the Dome'), ('id__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under the Dome'), ('title__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under the Dome'), ('category__icontains', u'Stephen King')),
(AND: ('author__icontains', u'Under the Dome'), ('id__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under the Dome'), ('title__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under the Dome'), ('author__icontains', u'Stephen King')),
(AND: ('category__icontains', u'Under the Dome'), ('id__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under the Dome'), ('title__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under the Dome'), ('author__icontains', u'Stephen King')),
(AND: ('id__icontains', u'Under the Dome'), ('category__icontains', u'Stephen King')),
(AND: ('title__icontains', u'Under the Dome Stephen'), ('author__icontains', u'King')),
(AND: ('title__icontains', u'Under the Dome Stephen'), ('category__icontains', u'King')),
(AND: ('title__icontains', u'Under the Dome Stephen'), ('id__icontains', u'King')),
(AND: ('author__icontains', u'Under the Dome Stephen'), ('title__icontains', u'King')),
(AND: ('author__icontains', u'Under the Dome Stephen'), ('category__icontains', u'King')),
(AND: ('author__icontains', u'Under the Dome Stephen'), ('id__icontains', u'King')),
(AND: ('category__icontains', u'Under the Dome Stephen'), ('title__icontains', u'King')),
(AND: ('category__icontains', u'Under the Dome Stephen'), ('author__icontains', u'King')),
(AND: ('category__icontains', u'Under the Dome Stephen'), ('id__icontains', u'King')),
(AND: ('id__icontains', u'Under the Dome Stephen'), ('title__icontains', u'King')),
(AND: ('id__icontains', u'Under the Dome Stephen'), ('author__icontains', u'King')),
(AND: ('id__icontains', u'Under the Dome Stephen'), ('category__icontains', u'King')),
('title__icontains', u'Under the Dome Stephen King'),
('author__icontains', u'Under the Dome Stephen King'),
('category__icontains', u'Under the Dome Stephen King'),
('id__icontains', u'Under the Dome Stephen King')
)
&lt;/pre&gt;
&lt;p&gt;This query has around 200 different &lt;span class="caps"&gt;OR&lt;/span&gt; parts!!! So please be careful on the amount of search fields you&amp;#8217;ll enable to works
with this method or your database will really&amp;nbsp;struggle!&lt;/p&gt;
</content><category term="django"></category><category term="django"></category><category term="python"></category><category term="query"></category><category term="q"></category><category term="filter"></category></entry><entry><title>How to download all images of an imgurÂ album</title><link href="https://spapas.github.io/2016/06/27/download-imgur-album-images/" rel="alternate"></link><published>2016-06-27T14:20:00+03:00</published><updated>2016-06-27T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2016-06-27:/2016/06/27/download-imgur-album-images/</id><summary type="html">&lt;p class="first last"&gt;How to download all images of an imgur&amp;nbsp;album&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Recently I stubmled upon a great &lt;a class="reference external" href="http://imgur.com/"&gt;imgur&lt;/a&gt; album that contained
&lt;a class="reference external" href="http://imgur.com/a/aoi3T"&gt;379 movie stills that could be used for desktop background&lt;/a&gt;. I
really liked the idea and wanted to download all the images in order
to put them in a folder and use them as a slideshow for my Windows
desktop&amp;nbsp;background.&lt;/p&gt;
&lt;p&gt;Downloading them one by one would be considered penal
labour so I tried to find out an automatic way to get them all. With some
research in google, I found out an old post with the hint that by appending &lt;tt class="docutils literal"&gt;/zip&lt;/tt&gt;
to the &lt;span class="caps"&gt;URL&lt;/span&gt;  you could get a zip with all the images &amp;#8212; this didn&amp;#8217;t work for me. I
also tried various browser tools for scrapping or downloading all images from a page but they
didn&amp;#8217;t work also (they could only download a small number of the images and not&amp;nbsp;all).&lt;/p&gt;
&lt;p&gt;This seemed strange to me until I understood how imgur loads its images by &amp;#8220;inspecting&amp;#8221;
an image and taking a look at the page&amp;#8217;s &lt;span class="caps"&gt;DOM&lt;/span&gt; structure through the&amp;nbsp;console:&lt;/p&gt;
&lt;img alt="How imgur loads images" src="/images/imgur.gif" style="width: 700px;" /&gt;
&lt;p&gt;As we can see, the imgur client-side code has a component with a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;post-images&lt;/span&gt;&lt;/tt&gt; class
that contains the visible images (and thoese that are above/below the visible images). When
the user scrolls up/down the contents of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;post-images&lt;/span&gt;&lt;/tt&gt; will be changed accordingly
(notice how the component with &lt;tt class="docutils literal"&gt;id=EKMGEPc&lt;/tt&gt; moves down when I scroll up).
What this means is that each time there are 3-4 images (this actually depends on your window size)
under &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;post-images&lt;/span&gt;&lt;/tt&gt; that are changed when you scroll &amp;#8212; that&amp;#8217;s why downloaders / scrappers are not working (since these
tools just inspect the &lt;span class="caps"&gt;DOM&lt;/span&gt; they only see these 3-4 images to&amp;nbsp;download).&lt;/p&gt;
&lt;p&gt;Another interesting observation is that if you take a look at the network tab when you
scroll app down you won&amp;#8217;t see any ajax calls (the only network calls are the images that
are downloaded when they are appended to the &lt;span class="caps"&gt;DOM&lt;/span&gt;). So this means that somewhere there&amp;#8217;s
an array that is loaded when the page is loaded and contains all the images of the album.
If we can access this array then we&amp;#8217;d be able to get all the URLs of the&amp;nbsp;images&amp;#8230;&lt;/p&gt;
&lt;p&gt;From a quick look at the &lt;span class="caps"&gt;DOM&lt;/span&gt; structure we can understand that this is a React application
(components have a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;data-reactid&lt;/span&gt;&lt;/tt&gt; attribute). So I tried the &lt;a class="reference external" href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi"&gt;React Developer Tools&lt;/a&gt;
extension to see if I could find anything insteresting. Here&amp;#8217;s the&amp;nbsp;output:&lt;/p&gt;
&lt;img alt="Imgur - react dev tools" src="/images/imgur-react.png" style="width: 1000px;" /&gt;
&lt;p&gt;As you can see, there seem to be 4 top-level react elements &amp;#8212; the interesting one is &lt;tt class="docutils literal"&gt;GalleryPost&lt;/tt&gt;.
If you take a look at its props (in the right hand side of the react-devtools) you&amp;#8217;ll see that it has
an &lt;tt class="docutils literal"&gt;album_image_store&lt;/tt&gt; property which also seems interesting (it should be the image store for this
album). After searching a bit its attributes
you&amp;#8217;ll see that it has a &lt;tt class="docutils literal"&gt;_&lt;/tt&gt; child attribute, which has a &lt;tt class="docutils literal"&gt;posts&lt;/tt&gt; child attribute which has an &lt;tt class="docutils literal"&gt;aoi3T&lt;/tt&gt;
attribute (notice that this is similar to the &lt;span class="caps"&gt;URL&lt;/span&gt; id of the album) and, finally this has an &lt;tt class="docutils literal"&gt;images&lt;/tt&gt;
attribute with objects describing all the images of that album&amp;nbsp;\o/!&lt;/p&gt;
&lt;p&gt;Now we need to get our hands on that &lt;tt class="docutils literal"&gt;images&lt;/tt&gt; array contents. Unfortunately, right clicking doesn&amp;#8217;t seem
to do anything from react-dev-tools and there doesn&amp;#8217;t seem a way to copy data from that panel&amp;#8230; However, in
the upper right position of that window you&amp;#8217;ll see the hint &lt;tt class="docutils literal"&gt;($r in the console)&lt;/tt&gt; which means that
the selected react component is available as $r in the normal javascript console - so by&amp;nbsp;entering&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
copy($r.props.album_image_store._.posts.aoi3T.images)
&lt;/pre&gt;
&lt;p&gt;I was able to copy the images of the album to my clipboard (please notice that &lt;tt class="docutils literal"&gt;$r&lt;/tt&gt; will have the
value of the selected react component so, before trying it you must select the &lt;tt class="docutils literal"&gt;GalleryPost&lt;/tt&gt;
component in the react-dev-tools&amp;nbsp;tab)!&lt;/p&gt;
&lt;p&gt;I dumped this to a file to take a look at it - it is really easy to interpret&amp;nbsp;it:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
[
  {
    &amp;quot;hash&amp;quot;: &amp;quot;MQplfkV&amp;quot;,
    &amp;quot;title&amp;quot;: &amp;quot;2001: A Space Odyssey&amp;quot;,
    &amp;quot;description&amp;quot;: &amp;quot;Cinematographer: Geoffrey Unsworth\n\nsource:\nhttp://www.filmcaptures.com/2001-a-space-odyssey/&amp;quot;,
    &amp;quot;width&amp;quot;: 1920,
    &amp;quot;height&amp;quot;: 864,
    &amp;quot;size&amp;quot;: 2262862,
    &amp;quot;ext&amp;quot;: &amp;quot;.png&amp;quot;,
    &amp;quot;animated&amp;quot;: false,
    &amp;quot;prefer_video&amp;quot;: false,
    &amp;quot;looping&amp;quot;: false,
    &amp;quot;datetime&amp;quot;: &amp;quot;2014-10-25 04:02:58&amp;quot;,
    &amp;quot;thumbsize&amp;quot;: &amp;quot;g&amp;quot;,
    &amp;quot;minHeight&amp;quot;: 306,
    &amp;quot;shown&amp;quot;: true,
    &amp;quot;containerHeight&amp;quot;: 501
  },
..
&lt;/pre&gt;
&lt;p&gt;The imgur images have a &lt;span class="caps"&gt;URL&lt;/span&gt; of http//i.imgur.com/{hash}{ext} so, we
can use the following small python 2 program to download all images from that&amp;nbsp;album:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
import requests
import json
from slugify import slugify

# Modified from http://stackoverflow.com/a/16696317/119071
def download_file(url, local_filename):
    r = requests.get(url, stream=True)
    with open(local_filename, 'wb') as f:
        for chunk in r.iter_content(chunk_size=1024):
            if chunk: # filter out keep-alive new chunks
                f.write(chunk)
                #f.flush() commented by recommendation from J.F.Sebastian
    return local_filename


if __name__ == '__main__':
    for i, jo in enumerate(json.loads(open(&amp;quot;album.txt&amp;quot;).read())):
        filename = '{0}-{1}{2}'.format(slugify(jo['title']), i+1, jo['ext'])
        url = 'http://i.imgur.com/{0}{1}'.format(jo['hash'].strip(), jo['ext'])
        print filename, url
        download_file(url, filename)
&lt;/pre&gt;
&lt;p&gt;Notice that the above uses the &lt;tt class="docutils literal"&gt;requests&lt;/tt&gt; library to retrieve the files and the
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;python-slugify&lt;/span&gt;&lt;/tt&gt; library to generate a filename using the image title so these
libraries must be installed by using &lt;tt class="docutils literal"&gt;pip install requests &lt;span class="pre"&gt;python-slugify&lt;/span&gt;&lt;/tt&gt;. This
will read a file named &lt;tt class="docutils literal"&gt;album.txt&lt;/tt&gt; that should contain the copied imgur album images
in the same directory and download all the&amp;nbsp;images.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Disclaimer&lt;/strong&gt; The above methodology works today (27-06-2016) - probably it will
stop working sometime in the future, when imgur changes its image loading algorithm
or its image object representation.
Also, I haven&amp;#8217;t been able to find a way to quickly access the &lt;tt class="docutils literal"&gt;GalleryPost&lt;/tt&gt; react
component from the javascript console - you need to install the react dev tools and
select that component from there so that you&amp;#8217;ll have the &lt;tt class="docutils literal"&gt;$r&lt;/tt&gt; reference to it in
the javascript console. Finally, don&amp;#8217;t forget to change the
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;copy($r.props.album_image_store._.posts.aoi3T.images)&lt;/span&gt;&lt;/tt&gt;
depending on your album id (also if the id is not a valid identifier, for example it
starts with number, use &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;copy($r.props.album_image_store._.posts['aoi3T'].images&lt;/span&gt;&lt;/tt&gt;).&lt;/p&gt;
</content><category term="python"></category><category term="imgur"></category><category term="python"></category><category term="react"></category><category term="javascript"></category><category term="console"></category><category term="research"></category></entry><entry><title>Using Werkzeug debugger withÂ Django</title><link href="https://spapas.github.io/2016/06/07/django-werkzeug-debugger/" rel="alternate"></link><published>2016-06-07T10:40:00+03:00</published><updated>2016-06-07T10:40:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2016-06-07:/2016/06/07/django-werkzeug-debugger/</id><summary type="html">&lt;p class="first last"&gt;How to use the Werkzeug interactive debugger with Django to improve your development&amp;nbsp;workflow&lt;/p&gt;
</summary><content type="html">&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://werkzeug.pocoo.org/"&gt;Werkzeug&lt;/a&gt; is a &lt;span class="caps"&gt;WSGI&lt;/span&gt; utility library for Python. Beyond others, it includes an interactive
debugger - what this means is that when your python application throws an exception,
Werkzeug will display the exception stacktrace in the browser (that&amp;#8217;s not a big deal)
and allow you to write python commands interactively wherever you want in that stacktrace
(that&amp;#8217;s the important&amp;nbsp;stuff).&lt;/p&gt;
&lt;p&gt;Now, the even more important stuff is that you can &lt;em&gt;abuse&lt;/em&gt; the above feature by adding
code that will throw an exception in various parts of your application and, as a result
get an interactive python prompt at &lt;em&gt;specific&lt;/em&gt; parts of your application (for example,
before validating your form, or when a method in your model is executed). All this,
without the need to use a specific &lt;span class="caps"&gt;IDE&lt;/span&gt; to add&amp;nbsp;breakpoints!&lt;/p&gt;
&lt;p&gt;This is an old trick however some people don&amp;#8217;t use it and make their work more
difficult. Actually, this one of the first things I learned when starting with django
and use it all the time since then - I am writing this post mainly to emphasize
its usefulness and to urge more people to use it. If you don&amp;#8217;t already use it please try
it (and thank me&amp;nbsp;later).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="configuration"&gt;
&lt;h2&gt;Configuration&lt;/h2&gt;
&lt;p&gt;There are two components you need to install in your django project to use the
above&amp;nbsp;technique:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/django-extensions/django-extensions"&gt;django-extensions&lt;/a&gt;: a swiss army knife toolset for django - beyond other useful tools it includes a management command (&lt;tt class="docutils literal"&gt;runserver_plus&lt;/tt&gt;) to start the Werkzeug interactive debugger with your&amp;nbsp;project&lt;/li&gt;
&lt;li&gt;werkzeug: the werkzeug utility&amp;nbsp;library&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Both of these can just be installed with pip (even on windows). After installing them, add &lt;tt class="docutils literal"&gt;django_extensions&lt;/tt&gt; to your &lt;tt class="docutils literal"&gt;INSTALLED_APPS&lt;/tt&gt; setting to enable
the management&amp;nbsp;command.&lt;/p&gt;
&lt;p&gt;After that, you can just run &lt;tt class="docutils literal"&gt;python manage.py runserver_plus&lt;/tt&gt; - if everything was installed successfully you should see something like this (in windows at&amp;nbsp;least):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
(venv) C:\progr\py\werkzeug\testdebug&amp;gt;python manage.py runserver_plus
 * Restarting with stat
Performing system checks...

System check identified no issues (0 silenced).

Django version 1.9.7, using settings 'testdebug.settings'
Development server is running at http://127.0.0.1:8000/
Using the Werkzeug debugger (http://werkzeug.pocoo.org/)
Quit the server with CTRL-BREAK.
 * Debugger is active!
 * Debugger pin code: 143-738-172
 * Debugger is active!
 * Debugger pin code: 174-740-467
 * Running on http://127.0.0.1:8000/ (Press CTRL+C to quit)
&lt;/pre&gt;
&lt;p&gt;Now, the &amp;#8220;debugger pin&amp;#8221; you see is a way to protect your interactive debugger (i.e it asks for the pin
before allowing you to enter the interactive prompt). Since this feature should &lt;em&gt;only&lt;/em&gt; be used in your
local development system I recommend to just disable it by setting the &lt;tt class="docutils literal"&gt;WERKZEUG_DEBUG_PIN&lt;/tt&gt; environment
variable to &lt;tt class="docutils literal"&gt;off&lt;/tt&gt; (i.e &lt;tt class="docutils literal"&gt;set WERKZEUG_DEBUG_PIN=off&lt;/tt&gt; in windows). After that you should see the message
&amp;#8220; * Debugger pin disabled.  &lt;span class="caps"&gt;DEBUGGER&lt;/span&gt; &lt;span class="caps"&gt;UNSECURED&lt;/span&gt;!&amp;#8220;. Please be careful with the interactive debugger
and  &lt;em&gt;never, ever use it in a production deployment&lt;/em&gt; even with the debug pin enabled. I also recommend to
use it &lt;em&gt;only&lt;/em&gt; on a local development server (i.e the server must be run on 127.0.0.1/local &lt;span class="caps"&gt;IP&lt;/span&gt; and not
allow remote&amp;nbsp;connections).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="usage"&gt;
&lt;h2&gt;Usage&lt;/h2&gt;
&lt;p&gt;Now its time for the magic: Let&amp;#8217;s add a django view that throws an exception, like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
def test(request):
    a+=1
&lt;/pre&gt;
&lt;p&gt;to your urls.py ( &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;url(r'^test/',&lt;/span&gt; test )&lt;/tt&gt; ) and after you visit &lt;cite&gt;test&lt;/cite&gt; you should see something like&amp;nbsp;this:&lt;/p&gt;
&lt;img alt="Werkzeug debugger" src="/images/werkzeug.png" style="width: 800px;" /&gt;
&lt;p&gt;Since the &lt;tt class="docutils literal"&gt;a&lt;/tt&gt; variable was not defined you&amp;#8217;ll get an exception when you try to increaseit.
Now, notice the console icon in the lower right corner - when you click it you&amp;#8217;ll get the interactive debugger!
Now you can enter python commands exactly where the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;a+=1&lt;/span&gt;&lt;/tt&gt; code was. For example, you can see what are the
attributes of the &lt;tt class="docutils literal"&gt;request&lt;/tt&gt; object you receive (for example, just enter &lt;tt class="docutils literal"&gt;request.&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; to output the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt;
dictionary to the interactive&amp;nbsp;console).&lt;/p&gt;
&lt;p&gt;Notice that you can get interactive consoles wherever you want in the stacktrace, i.e I could get a console at line 147
of &lt;cite&gt;django.core.handlers.base&lt;/cite&gt; module on the &lt;tt class="docutils literal"&gt;get_response&lt;/tt&gt; method &amp;#8212; this is needed sometimes especially when you
want to see how your code is called by other&amp;nbsp;modules.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;As you can see, using the presented technique you can really quickly start an interactive console wherever you
want and start entering commands. I use it whenever I need to write anything non trivial (or even trivial stuff -
I sometimes prefer opening and interactive debugger to find out by trial and error how should I write a django
&lt;span class="caps"&gt;ORM&lt;/span&gt; query than open models.py) and really miss it on other environments&amp;nbsp;(Java).&lt;/p&gt;
&lt;p&gt;The above technique should also work with few modifications with other python web frameworks so it&amp;#8217;s not&amp;nbsp;django-only.&lt;/p&gt;
&lt;p&gt;Finally, please notice that both Werkzeug and django-extensions offer many more tools beyond the interactive debugger presented here -
I encourage you to research them since - if you follow my advice - you&amp;#8217;ll integrate these to &lt;em&gt;all&lt;/em&gt; your django&amp;nbsp;projects!&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="debug"></category><category term="python"></category><category term="werkzeug"></category><category term="django-extensions"></category></entry><entry><title>Understanding nested list comprehension syntax inÂ Python</title><link href="https://spapas.github.io/2016/04/27/python-nested-list-comprehensions/" rel="alternate"></link><published>2016-04-27T11:20:00+03:00</published><updated>2016-04-27T11:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2016-04-27:/2016/04/27/python-nested-list-comprehensions/</id><summary type="html">&lt;p class="first last"&gt;Write nested list comprehensions with&amp;nbsp;ease&lt;/p&gt;
</summary><content type="html">&lt;p&gt;List comprehensions are one of the really nice and powerful features of Python. It
is actually a smart way to introduce new users to functional programming concepts
(after all a list comprehension is just a combination of map and filter) and compact&amp;nbsp;statements.&lt;/p&gt;
&lt;p&gt;However, one thing that always troubled me when using list comprehensions is their
non intuitive syntax when nesting was needed. For example, let&amp;#8217;s say that we just
want to flatten a list of lists using a nested list&amp;nbsp;comprehension:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;non_flat&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To write that, somebody would think: For a simple list
comprehension I need to
write &lt;tt class="docutils literal"&gt;[ x for x in non_flat ]&lt;/tt&gt; to get all its items - however I want to retrieve each element of the &lt;tt class="docutils literal"&gt;x&lt;/tt&gt; list so I&amp;#8217;ll write something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;non_flat&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Well duh! At this time I&amp;#8217;d need research google for a working list comprehension syntax and adjust it to my needs (or give up and write it as a double for&amp;nbsp;loop).&lt;/p&gt;
&lt;p&gt;Here&amp;#8217;s the correct nested list comprehension people&amp;nbsp;wondering:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;non_flat&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;What if I wanted to add a third level of nesting or an if? Well I&amp;#8217;d just bite the bullet and use for&amp;nbsp;loops!&lt;/p&gt;
&lt;p&gt;However, if you take a look at the document describing list comprehensions in python (&lt;cite&gt;&lt;span class="caps"&gt;PEP&lt;/span&gt; 202&lt;/cite&gt;) you&amp;#8217;ll see
the following&amp;nbsp;phrase:&lt;/p&gt;
&lt;blockquote&gt;
It is proposed to allow conditional construction of list literals
using for and if clauses. &lt;strong&gt;They would nest in the same way for
loops and if statements nest now.&lt;/strong&gt;&lt;/blockquote&gt;
&lt;p&gt;This statement explains everything! &lt;em&gt;Just think in for-loops syntax&lt;/em&gt;. So, If I used for loops for the previous flattening, I&amp;#8217;d do something&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;non_flat&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;y&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;which, if &lt;cite&gt;y&lt;/cite&gt; is moved to the front and joined in one line would be the correct nested list&amp;nbsp;comprehension!&lt;/p&gt;
&lt;p&gt;So that&amp;#8217;s the way&amp;#8230; What If I wanted to include only lists with more than 2 elements in the flattening
(so &lt;cite&gt;[7,8]&lt;/cite&gt; should not be included)? I&amp;#8217;ll write it with for loops&amp;nbsp;first:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;non_flat&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;y&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;so by convering this to list comprehension we&amp;nbsp;get:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;non_flat&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Success!&lt;/p&gt;
&lt;p&gt;One final, more complex example: Let&amp;#8217;s say that we have a list
of lists of words and we want to get a list of all the letters of these words
along with the index of the list they belong to
but only for words with more than two characters. Using the same
for-loop syntax for the nested list comprehensions we&amp;#8217;ll&amp;nbsp;get:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;strings&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;foo&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;bar&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;baz&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;taz&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;koko&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;letter&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lst&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;strings&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;lst&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;letter&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;f&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;z&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;t&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;z&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
</content><category term="python"></category><category term="python"></category><category term="debug"></category><category term="404"></category><category term="error"></category></entry><entry><title>Configuring SpringÂ Boot</title><link href="https://spapas.github.io/2016/03/31/spring-boot-settings/" rel="alternate"></link><published>2016-03-31T19:20:00+03:00</published><updated>2016-03-31T19:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2016-03-31:/2016/03/31/spring-boot-settings/</id><summary type="html">&lt;p class="first last"&gt;Configuring your Spring Boot applications using application properties, profiles, locan  settings and command line arguments and deploying them using&amp;nbsp;init.d!&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#properties-vs-yml-files" id="id2"&gt;properties vs yml&amp;nbsp;files&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#structuring-your-configuration-files" id="id3"&gt;Structuring your configuration files&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#main-application-settings" id="id4"&gt;Main application&amp;nbsp;settings&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#profiles" id="id5"&gt;Profiles&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#some-more-advanced-profile-usage" id="id6"&gt;Some more advanced profile&amp;nbsp;usage&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#overriding-settings" id="id7"&gt;Overriding settings&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-a-config-application-properties" id="id8"&gt;Using a&amp;nbsp;config/application.properties&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#passing-command-line-arguments" id="id9"&gt;Passing command line&amp;nbsp;arguments&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#deploying-spring-boot-applications" id="id10"&gt;Deploying Spring Boot&amp;nbsp;applications&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id11"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;a class="reference external" href="http://projects.spring.io/spring-boot/"&gt;Spring Boot&lt;/a&gt; project is great way of building Java applications using
Spring. Instead of trying to integrate everything by hand (and usually
end up with a configuration hell) you use spring-boot to help you to
bootstrap your application: Just include its
dependencies in your pom.xml and Spring Boot will try its
best to auto-configure all these&amp;nbsp;components!&lt;/p&gt;
&lt;p&gt;Of course, no matter how hard Spring Boot tries to auto-configure everything,
you&amp;#8217;ll still need to pass some configuration to configure your databases,
caches, email sending, security etc. Thankfully, Spring Boot
can be configured without &lt;em&gt;any&lt;/em&gt; xml (actually, its a bad practice to
use xml-based configuration with it), using plain Java .properties
files or (if you prefer the more compact syntax) &lt;a class="reference external" href="https://en.wikipedia.org/wiki/YAML"&gt;&lt;span class="caps"&gt;YAML&lt;/span&gt;&lt;/a&gt; .yml&amp;nbsp;files!&lt;/p&gt;
&lt;p&gt;In this guide, along with a simple introduction to the way Spring Boot configuration
works, we&amp;#8217;ll talk about a specific way of stucturing your settings configuration files in
order to&amp;nbsp;have:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A global configuration file that will contain all your&amp;nbsp;settings&lt;/li&gt;
&lt;li&gt;Different settings for each of your environments (development, &lt;span class="caps"&gt;UAT&lt;/span&gt;, staging, production and&amp;nbsp;test)&lt;/li&gt;
&lt;li&gt;A way to configure your passwords and other sensitive data (that you don&amp;#8217;t want to put to your &lt;span class="caps"&gt;VCS&lt;/span&gt;)&lt;/li&gt;
&lt;li&gt;Being able to override any setting in any&amp;nbsp;environment&lt;/li&gt;
&lt;li&gt;Deploying your Spring Boot app in Linux using &lt;tt class="docutils literal"&gt;init.d&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To quickly test the proposed settings configuration I&amp;#8217;ve created a simple
Spring Boot project &amp;#64; &lt;a class="reference external" href="https://github.com/spapas/spring-boot-config"&gt;https://github.com/spapas/spring-boot-config&lt;/a&gt;. Just clone
it, optionally change the packaged settings (more on this later), package it (&lt;tt class="docutils literal"&gt;mvn package&lt;/tt&gt;), optionally change
the &lt;tt class="docutils literal"&gt;config&lt;/tt&gt; settings (more on this also later) and run it
(using something like &lt;tt class="docutils literal"&gt;java &lt;span class="pre"&gt;-jar&lt;/span&gt; &lt;span class="pre"&gt;spring-boot-config-0.0.1-&lt;span class="caps"&gt;SNAPSHOT&lt;/span&gt;.jar&lt;/span&gt;&lt;/tt&gt;) optionally passing it command line settings (more on this
also later). You&amp;#8217;ll then be able to visit &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;http://127.0.0.1:8080&lt;/span&gt;&lt;/tt&gt; and check the current&amp;nbsp;settings!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="properties-vs-yml-files"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;properties vs yml&amp;nbsp;files&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;You can use two kinds of files to configure your settings: Normal Java .properties files
or &lt;a class="reference external" href="https://en.wikipedia.org/wiki/YAML"&gt;&lt;span class="caps"&gt;YAML&lt;/span&gt;&lt;/a&gt; .yml files. The .properties files have the&amp;nbsp;form:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
config.value.a=1
config.value.b=2
config.value.c=3
&lt;/pre&gt;
&lt;p&gt;while the .yml files are&amp;nbsp;like:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
config:
    value:
        a: 1
        b: 2
        c: 3
&lt;/pre&gt;
&lt;p&gt;You may use whatever you wish - in the examples I&amp;#8217;ll use normal Java .properties
files because they are more compact (you don&amp;#8217;t need to use multiple lines to represent
a single setting like in &lt;span class="caps"&gt;YAML&lt;/span&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="structuring-your-configuration-files"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Structuring your configuration&amp;nbsp;files&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Spring Boot reads its configuration from &lt;a class="reference external" href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html"&gt;various places&lt;/a&gt;, however in this article we&amp;#8217;ll talk
about four of them which should be enough for most cases. Starting from the most global to the most
specific ones (i.e the latter ones will override the previous ones) these&amp;nbsp;are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Main (global) application&amp;nbsp;settings&lt;/li&gt;
&lt;li&gt;Profile&amp;nbsp;settings&lt;/li&gt;
&lt;li&gt;Local (/config)&amp;nbsp;settings&lt;/li&gt;
&lt;li&gt;Command line&amp;nbsp;arguments&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The first two are setting files that will be contained inside the artifact (jar or war) that will be
created and should be commited to your version control system. I&amp;#8217;ll call them jar-packaged
settings. The other two won&amp;#8217;t be commited to the version control but will be created directly
on the server to-deploy. Let&amp;#8217;s see a little more about&amp;nbsp;them:&lt;/p&gt;
&lt;div class="section" id="main-application-settings"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id4"&gt;Main application&amp;nbsp;settings&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;These are kept in a file named &lt;tt class="docutils literal"&gt;application.properties&lt;/tt&gt; (or &lt;tt class="docutils literal"&gt;yml&lt;/tt&gt; &amp;#8212; from now on I&amp;#8217;ll just use
&lt;cite&gt;.properties`&lt;/cite&gt; but keep in mind that you may use &lt;tt class="docutils literal"&gt;.yml&lt;/tt&gt;): This file should reside
inside the &lt;tt class="docutils literal"&gt;src\main\resources&lt;/tt&gt; folder
of your project and ideally contain all the settings your spring-boot application users. Some
of these settings will be overriden by settings kept in the next source so they may have a
default value or even be empty if they will be always overriden (or contain sensitive data
like passwords), however I still prefer to list
them all in this file even as placeholders to have a central source of all the settings that
your Spring Boot application&amp;nbsp;uses.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="profiles"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id5"&gt;Profiles&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A profile is a set of settings that can be configured to override settings from &lt;tt class="docutils literal"&gt;application.properties&lt;/tt&gt;.
Each profile is contained in a file named &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-profilename.properties&lt;/span&gt;&lt;/tt&gt; where &lt;tt class="docutils literal"&gt;profilename&lt;/tt&gt; is
the name of the profile. Now, a profile could configure anything you want, however
for most projects I propose to
have the following&amp;nbsp;profiles:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;dev&lt;/tt&gt; for your local development&amp;nbsp;settings&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;uat&lt;/tt&gt; for your &lt;span class="caps"&gt;UAT&lt;/span&gt; server&amp;nbsp;settings&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;staging&lt;/tt&gt; for your staging server&amp;nbsp;settings&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;prod&lt;/tt&gt; for your production&amp;nbsp;settings&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;test&lt;/tt&gt; for running your&amp;nbsp;tests&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(depending of course on what are your requirements, some projects may not
need &lt;tt class="docutils literal"&gt;uat&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;staging&lt;/tt&gt; but all projects should have a &lt;tt class="docutils literal"&gt;dev&lt;/tt&gt;, a &lt;tt class="docutils literal"&gt;prod&lt;/tt&gt; and a &lt;tt class="docutils literal"&gt;test&lt;/tt&gt; profile).
The configuration for these environemnts needs to be different for obvious reasons.
For example when developing you may want
to use a local database, when running tests an ephemeral in memory database
and your production database when deploying to production.
These profile configuration files will be stored inside your &lt;tt class="docutils literal"&gt;src\main\resources&lt;/tt&gt; folder,
right next to the &lt;tt class="docutils literal"&gt;application.properties&lt;/tt&gt;, i.e you&amp;#8217;ll have
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-dev.properties&lt;/span&gt;&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-prod.properties&lt;/span&gt;&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-test.properties&lt;/span&gt;&lt;/tt&gt; etc - and all these files will be kept
in your &lt;span class="caps"&gt;VCS&lt;/span&gt; (and will also be jar-packaged since they will be
contained in the resulting&amp;nbsp;artifact).&lt;/p&gt;
&lt;p&gt;How do you select which profile is active each time (i.e pick it
when running the Spring Boot application under
its corresponding&amp;nbsp;environment)?&lt;/p&gt;
&lt;p&gt;For tests, since they can be run by a different &lt;tt class="docutils literal"&gt;Main&lt;/tt&gt; than
the normal application, you should use the &lt;tt class="docutils literal"&gt;&amp;#64;ActiveProfiles&lt;/tt&gt; annotation
(for example &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;#64;ActiveProfiles(&amp;quot;test&amp;quot;)&lt;/span&gt;&lt;/tt&gt;) to make sure that the tests
will run with the correct settings. So if the contents of your &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-test.properties&lt;/span&gt;&lt;/tt&gt;
are &lt;tt class="docutils literal"&gt;config.value=Hello test!&lt;/tt&gt; running this test should produce no&amp;nbsp;errors:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nd"&gt;@RunWith&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;SpringJUnit4ClassRunner&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="nd"&gt;@SpringApplicationConfiguration&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;classes&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SpringBootConfigApplication&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="nd"&gt;@ActiveProfiles&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;test&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SpringBootConfigApplicationTests&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;

    &lt;span class="nd"&gt;@Value&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;${config.value}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="nd"&gt;@Value&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;${spring.profiles.active}&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
    &lt;span class="kd"&gt;private&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;profile&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

    &lt;span class="nd"&gt;@Test&lt;/span&gt;
    &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kt"&gt;void&lt;/span&gt; &lt;span class="nf"&gt;contextLoads&lt;/span&gt;&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
        &lt;span class="n"&gt;assertThat&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;is&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Hello test!&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
        &lt;span class="n"&gt;assertThat&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;profile&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;is&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;test&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
    &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To activate a different profile when running your Spring Boot applications
you&amp;#8217;ll need to use the &lt;tt class="docutils literal"&gt;spring.profiles.active&lt;/tt&gt; setting, so if you set
&lt;tt class="docutils literal"&gt;spring.profiles.active=prod&lt;/tt&gt; in your &lt;tt class="docutils literal"&gt;application.properties&lt;/tt&gt; and
create the packaged jar (or war) then you&amp;#8217;ll have the production settings
when you run your application (i.e the contents of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-prod.properties&lt;/span&gt;&lt;/tt&gt;
will be used to override your &lt;tt class="docutils literal"&gt;application.properties&lt;/tt&gt;). Of course, to deploy it
to &lt;span class="caps"&gt;UAT&lt;/span&gt;, you&amp;#8217;ll need to change
&lt;tt class="docutils literal"&gt;spring.profiles.active&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;uat&lt;/tt&gt; and re-create the packaged artifact &amp;#8212;
see some repetition and penal labour here? Definitely you don&amp;#8217;t want to do re-create
your artifacts for each of the environments you may want to deploy &amp;#8212;
we&amp;#8217;ll see in the next sections how to improve this flow by overriding
jar-packaged&amp;nbsp;settings!&lt;/p&gt;
&lt;div class="section" id="some-more-advanced-profile-usage"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id6"&gt;Some more advanced profile&amp;nbsp;usage&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;You may have noticed in the previous section that the name of the
annotation is &lt;tt class="docutils literal"&gt;&amp;#64;ActiveProfiles&lt;/tt&gt; and the name of the setting
&lt;tt class="docutils literal"&gt;spring.profiles.active&lt;/tt&gt; - both in plural. This of course is
on purpose: You may have &lt;em&gt;more than one&lt;/em&gt; active&amp;nbsp;profiles!&lt;/p&gt;
&lt;p&gt;This, along with the fact that you can make &lt;tt class="docutils literal"&gt;&amp;#64;Components&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;&amp;#64;Configuration&lt;/tt&gt;
available &lt;em&gt;only&lt;/em&gt; on certail profiles is a really powerful&amp;nbsp;tool!&lt;/p&gt;
&lt;p&gt;Here are some&amp;nbsp;examples:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Configure two spring-security &lt;tt class="docutils literal"&gt;&amp;#64;Configuration&lt;/tt&gt; s: Use in memory security for your dev environment, while using &lt;span class="caps"&gt;LDAP&lt;/span&gt; for your&amp;nbsp;production.&lt;/li&gt;
&lt;li&gt;If you want to support more than one database you can configure multiple profiles &amp;#8212; and use them along with the dev/uat/prod I mentioned&amp;nbsp;before.&lt;/li&gt;
&lt;li&gt;Create verbose and non-verbose logging profiles and quickly change between&amp;nbsp;them&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="overriding-settings"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;Overriding&amp;nbsp;settings&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;All the above settings we&amp;#8217;ve defined should be safely kept inside
your &lt;span class="caps"&gt;VCS&lt;/span&gt; - however we wouldn&amp;#8217;t like storing passwords or other
sensitive data to a &lt;span class="caps"&gt;VCS&lt;/span&gt;! Sensitive settings should be empty
(or have a default value) when
saved to &lt;span class="caps"&gt;VCS&lt;/span&gt; and overriden by &amp;#8220;local&amp;#8221;&amp;nbsp;settings.&lt;/p&gt;
&lt;p&gt;Also, all the previous are jar-packaged
and we definitely need a way to override them without messing
with the artifacts (for example, we need to select the
correct profile for running the application by overriding
&lt;tt class="docutils literal"&gt;spring.profiles.active&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;There two methods of overriding settings, and these are the last
two methods of the four we discussed&amp;nbsp;above:&lt;/p&gt;
&lt;div class="section" id="using-a-config-application-properties"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id8"&gt;Using a&amp;nbsp;config/application.properties&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;You can put files in a directory named &lt;tt class="docutils literal"&gt;config&lt;/tt&gt; that is at the same level
as the location from which you try to run your jar. These file should be
named either &lt;tt class="docutils literal"&gt;application.properties&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-profilename.properties&lt;/span&gt;&lt;/tt&gt;
and will be used to override your jar-packaged&amp;nbsp;settings.&lt;/p&gt;
&lt;p&gt;What happens is that Spring will at first try to load a file named &lt;tt class="docutils literal"&gt;config/application.properties&lt;/tt&gt; that will
override your jar-packaged &lt;tt class="docutils literal"&gt;application.properties&lt;/tt&gt; (so here you can set your current profile). Then, it will also try to load
a file named &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;config/application-profilename.properties&lt;/span&gt;&lt;/tt&gt; that will override
your jar-packaged &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-profilename.properties&lt;/span&gt;&lt;/tt&gt; (so here you may
override any profile related&amp;nbsp;properties).&lt;/p&gt;
&lt;p&gt;The priority of the files from lowest to&amp;nbsp;highest:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;jar-packaged &lt;tt class="docutils literal"&gt;application.properties&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;local &lt;tt class="docutils literal"&gt;config/application.properties&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;jar-packaged &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-profilename.properties&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;local &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;config/application-profilename.properties&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So (repeating for emphasis) the settings in your jar-packaged &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-profilename.properties&lt;/span&gt;&lt;/tt&gt; will &lt;em&gt;only&lt;/em&gt;
be overriden by &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;config/application-profilename.properties&lt;/span&gt;&lt;/tt&gt; (and not by the &lt;tt class="docutils literal"&gt;config/application.properties&lt;/tt&gt;
which will only override settings on the jar-packaged &lt;tt class="docutils literal"&gt;application.properties&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;Also, to make everything clear about where the &lt;tt class="docutils literal"&gt;config&lt;/tt&gt; directory should be&amp;nbsp;kept:&lt;/p&gt;
&lt;p&gt;If the current directory from which you&amp;#8217;ll run your jar is &lt;tt class="docutils literal"&gt;/home/serafeim&lt;/tt&gt; and
you want to execute &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/opt/spring/my-spring-app.jar&lt;/span&gt;&lt;/tt&gt; (so you&amp;#8217;ll run something like
&lt;tt class="docutils literal"&gt;/home/serafeim$ java &lt;span class="pre"&gt;-jar&lt;/span&gt; &lt;span class="pre"&gt;/opt/spring/my-spring-app.jar&lt;/span&gt;&lt;/tt&gt;) then
the &lt;tt class="docutils literal"&gt;config&lt;/tt&gt; directory should
be at &lt;tt class="docutils literal"&gt;/home/serafeim/config&lt;/tt&gt; (i.e at the same directory from where you execute
jar). Normally however and to avoid confusion, the best approach would
be to just put it at &lt;tt class="docutils literal"&gt;/opt/spring/config&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;cd /opt/spring&lt;/tt&gt; before running
your jar (so &lt;tt class="docutils literal"&gt;config&lt;/tt&gt; will be right next to your jar and run the jar from the&amp;nbsp;directory).&lt;/p&gt;
&lt;p&gt;Finally, my recommendation is to keep these &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;config/*properties&lt;/span&gt;&lt;/tt&gt; files off version control
(after all they should be different for each of your environments - common settings should
go to the jar-packaged files)
and to put only the profile selection setting and sensitive settings there. That means that
the &lt;tt class="docutils literal"&gt;config/application.properties&lt;/tt&gt; file should &lt;em&gt;only&lt;/em&gt; contain a &lt;tt class="docutils literal"&gt;spring.profiles.active=profilename&lt;/tt&gt;
setting to set the correct profile for this instance of your app and the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;config/application-profilename.properties&lt;/span&gt;&lt;/tt&gt;
will contain all sensitive information that you&amp;#8217;ll need to run that&amp;nbsp;profile.&lt;/p&gt;
&lt;p&gt;For example in your &lt;span class="caps"&gt;UAT&lt;/span&gt; server you&amp;#8217;ll have &lt;tt class="docutils literal"&gt;spring.profiles.active=uat&lt;/tt&gt; in your &lt;tt class="docutils literal"&gt;application.properties&lt;/tt&gt;
and your uat server passwords in your &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;application-uat.properties&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="passing-command-line-arguments"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id9"&gt;Passing command line&amp;nbsp;arguments&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The most specific way of overriding parameters (including the active profile of course) is by
directly passing these parameters as arguments when running your jar. For example,
if you run &lt;tt class="docutils literal"&gt;java &lt;span class="pre"&gt;-Dconfig.value=foo&lt;/span&gt; &lt;span class="pre"&gt;-jar&lt;/span&gt; &lt;span class="pre"&gt;my-spring-app.jar&lt;/span&gt;&lt;/tt&gt; then the &lt;tt class="docutils literal"&gt;config.value&lt;/tt&gt;
will always have a value of &lt;tt class="docutils literal"&gt;foo&lt;/tt&gt; no matter what you have in your other config&amp;nbsp;files.&lt;/p&gt;
&lt;p&gt;That&amp;#8217;s a different way to set your active profile (by passing &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-Dspring.profiles.active=profilename&lt;/span&gt;&lt;/tt&gt;)
or to quickly set sensitive settings however
I prefer to keep the settings in properties files (and not to put them in scripts where they will definitely
be missed and will be more difficult to be managed)
so I&amp;#8217;ll recommend the previous way of using a non-commited to version control local config/application.properties.
Use command line arguments only for quick tests (run something with a specific setting to test how it&amp;nbsp;works).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="deploying-spring-boot-applications"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;Deploying Spring Boot&amp;nbsp;applications&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;If you check
the deployment documentation of Spring Boot you&amp;#8217;ll see that it has various hints on
&lt;a class="reference external" href="http://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#deployment"&gt;on deploying Spring Boot applications&lt;/a&gt;. I won&amp;#8217;t go into much detail about these however I&amp;#8217;ll
represent my recommendation on deploying Spring Boot apps on Linux as an init.d&amp;nbsp;script:&lt;/p&gt;
&lt;p&gt;What is really interesting about Spring boot is that it allows you to make your jar-packaged jars &lt;a class="reference external" href="https://docs.spring.io/spring-boot/docs/current/reference/html/deployment-install.html"&gt;executable as an init.d script&lt;/a&gt; so that you will
be able to manage it using something like &lt;tt class="docutils literal"&gt;service springbootapp start/stop/restart&lt;/tt&gt; etc. To do that,
you&amp;#8217;ll just need to add the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;executable&amp;gt;true&amp;lt;/executable&amp;gt;&lt;/span&gt;&lt;/tt&gt; &lt;tt class="docutils literal"&gt;configuration&lt;/tt&gt; for your pom&amp;#8217;s
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;spring-boot-maven-plugin&lt;/span&gt;&lt;/tt&gt;. This will add some things in the start of your resulting jar file
that will make it behave as a unix init.d script. If you take a look at your package artifact
you&amp;#8217;ll see something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#    .   ____          _            __ _ _&lt;/span&gt;
&lt;span class="c1"&gt;#   /\\ / ___&amp;#39;_ __ _ _(_)_ __  __ _ \ \ \ \&lt;/span&gt;
&lt;span class="c1"&gt;#  ( ( )\___ | &amp;#39;_ | &amp;#39;_| | &amp;#39;_ \/ _` | \ \ \ \&lt;/span&gt;
&lt;span class="c1"&gt;#   \\/  ___)| |_)| | | | | || (_| |  ) ) ) )&lt;/span&gt;
&lt;span class="c1"&gt;#    &amp;#39;  |____| .__|_| |_|_| |_\__, | / / / /&lt;/span&gt;
&lt;span class="c1"&gt;#   =========|_|==============|___/=/_/_/_/&lt;/span&gt;
&lt;span class="c1"&gt;#   :: Spring Boot Startup Script ::&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;

&lt;span class="c1"&gt;### BEGIN INIT INFO&lt;/span&gt;
&lt;span class="c1"&gt;# Provides:          spring-boot-config&lt;/span&gt;
&lt;span class="c1"&gt;# Required-Start:    $remote_fs $syslog $network&lt;/span&gt;
&lt;span class="c1"&gt;# Required-Stop:     $remote_fs $syslog $network&lt;/span&gt;
&lt;span class="c1"&gt;# Default-Start:     2 3 4 5&lt;/span&gt;
&lt;span class="c1"&gt;# Default-Stop:      0 1 6&lt;/span&gt;
&lt;span class="c1"&gt;# Short-Description: spring-boot-config&lt;/span&gt;
&lt;span class="c1"&gt;# Description:       Demo project for Spring Boot configuration&lt;/span&gt;
&lt;span class="c1"&gt;# chkconfig:         2345 99 01&lt;/span&gt;
&lt;span class="c1"&gt;### END INIT INFO&lt;/span&gt;

&lt;span class="o"&gt;[[&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$DEBUG&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nb"&gt;set&lt;/span&gt; -x

&lt;span class="c1"&gt;# Initialize variables that cannot be provided by a .conf file&lt;/span&gt;
&lt;span class="nv"&gt;WORKING_DIR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nb"&gt;pwd&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="c1"&gt;# shellcheck disable=SC2153&lt;/span&gt;
&lt;span class="o"&gt;[[&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$JARFILE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;jarfile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$JARFILE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="o"&gt;[[&lt;/span&gt; -n &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$APP_NAME&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;identity&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$APP_NAME&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;

...
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One thing that may seem puzzling at first is that if make this jar executable
and try to run it you&amp;#8217;ll see that, instead of offering you the well known
options of the init scripts (Usage &amp;#8230; start/stop/restart etc)  it will immediatelly
run the application! This is because the embedded script is smart enough to
check that it will be executed as an init script only when it is executed
as a link from &lt;tt class="docutils literal"&gt;/etc/init.d&lt;/tt&gt; - else it will immediately run the&amp;nbsp;application.&lt;/p&gt;
&lt;p&gt;If
you want to quickly test that behavior, you may override the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;MODE&lt;/span&gt;&lt;/tt&gt; parameter
which forces the mode of operation of the jar. If you want to run it as a
script (without using a links from /etc/ini.d) then just set &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;MODE&lt;/span&gt;=service&lt;/tt&gt;.
So, try&amp;nbsp;runnin:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;gt; MODE=service ./springapplication.jar
Usage: ./hsk9eea.jar {start|stop|restart|force-reload|status|run}
&lt;/pre&gt;
&lt;p&gt;Success! Of course, this is just for testing purposes, to actually deploy
your application then please create a link to it from &lt;tt class="docutils literal"&gt;/etc/init.d&lt;/tt&gt; as
proposed by the Spring Boot&amp;nbsp;docs.&lt;/p&gt;
&lt;p&gt;If you want to &lt;a class="reference external" href="http://docs.spring.io/spring-boot/docs/current-SNAPSHOT/reference/htmlsingle/#deployment-script-customization"&gt;customize the init.d script&lt;/a&gt;  you can use a file named
&lt;tt class="docutils literal"&gt;sprinbootapp.conf&lt;/tt&gt; in the same directory as your &lt;tt class="docutils literal"&gt;springbootapp.jar&lt;/tt&gt;
(i.e it should have the same name as your jar with an extension of .conf). The
options from it will be sourced before running your application &amp;#8212; for example
you could set the active profile using &lt;tt class="docutils literal"&gt;RUN_ARGS&lt;/tt&gt;, however as I already
recommended, explicitly setting it to a file named &lt;tt class="docutils literal"&gt;config/applications.properties&lt;/tt&gt;
is&amp;nbsp;preferrable.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using the described file structure you should be able to fully configure Spring Boot and have all the
goodies you&amp;#8217;d expect from a modern framework: global settings, profiles, non-version control settings! Also, using the
advanced profiles techniques (multiple profiles, profile enabled
&amp;#64;Components and &amp;#64;Configurations) you&amp;#8217;ll be able to implement
some really complex configurations! Finally, you&amp;#8217;ll be able to really
quickly deploy the resulting jar as an init.d system&amp;nbsp;service!&lt;/p&gt;
&lt;/div&gt;
</content><category term="spring"></category><category term="spring"></category><category term="spring-boot"></category><category term="java"></category><category term="ldap"></category><category term="profiles"></category><category term="settings"></category><category term="properties"></category><category term="yaml"></category><category term="configuration"></category><category term="deploy"></category><category term="init.d"></category></entry><entry><title>A comprehensive react-reduxÂ tutorial</title><link href="https://spapas.github.io/2016/03/02/react-redux-tutorial/" rel="alternate"></link><published>2016-03-02T11:20:00+02:00</published><updated>2016-03-02T11:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2016-03-02:/2016/03/02/react-redux-tutorial/</id><summary type="html">&lt;p class="first last"&gt;A comprehensive tutorial for using react with&amp;nbsp;redux&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id2"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction-to-redux" id="id3"&gt;Introduction to redux&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-simple-example" id="id4"&gt;A simple&amp;nbsp;example&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#interlude-so-what-s-a-reducer" id="id5"&gt;Interlude: So what&amp;#8217;s a&amp;nbsp;reducer?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#what-about-react-redux" id="id6"&gt;What about&amp;nbsp;react-redux?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#our-project" id="id7"&gt;Our project&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#other-libraries-used" id="id8"&gt;Other libraries&amp;nbsp;used&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#redux-thunk" id="id9"&gt;redux-thunk?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#explaining-the-application" id="id10"&gt;Explaining the application&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#main-js" id="id11"&gt;main.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#store-js" id="id12"&gt;store.js&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#interlude-combining-reducers" id="id13"&gt;Interlude: Combining&amp;nbsp;reducers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#interlude-middlewares" id="id14"&gt;Interlude:&amp;nbsp;Middlewares&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#reducers-js" id="id15"&gt;reducers.js&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-global-state-tree" id="id16"&gt;The global state&amp;nbsp;tree&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#actions-js" id="id17"&gt;actions.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-app-js" id="id18"&gt;components/app.js&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-notification-js" id="id19"&gt;components/notification.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#creating-a-re-usable-notification" id="id20"&gt;Creating a re-usable&amp;nbsp;notification&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-loading-js" id="id21"&gt;components/loading.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-statpanel-js" id="id22"&gt;components/StatPanel.js&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-bookpanel-js" id="id23"&gt;components/BookPanel.js&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-booksearchpanel-js" id="id24"&gt;components/BookSearchPanel.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-table-js" id="id25"&gt;components/Table.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-pagingpanel-js" id="id26"&gt;components/PagingPanel.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#interlude-a-more-functional-component" id="id27"&gt;Interlude: A more functional&amp;nbsp;component&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-bookform" id="id28"&gt;components/BookForm&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-input" id="id29"&gt;components/Input&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-select" id="id30"&gt;components/Select&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-datepicker" id="id31"&gt;components/DatePicker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#should-i-create-my-own-input-components" id="id32"&gt;Should I create my own input&amp;nbsp;components?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-authorpanel" id="id33"&gt;components/AuthorPanel&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-authorform" id="id34"&gt;components/AuthorForm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#changing-the-ui-when-the-data-is-changed" id="id35"&gt;Changing the &lt;span class="caps"&gt;UI&lt;/span&gt; when the data is&amp;nbsp;changed&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id36"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Update 10/05/2016&lt;/strong&gt;: Add a section on how to update the &lt;span class="caps"&gt;UI&lt;/span&gt; when the data in the database is changed without using the &lt;span class="caps"&gt;UI&lt;/span&gt;.&lt;/p&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Continuing the series of React-related articles, we&amp;#8217;ll try to make a comprehensive
tutorial to the &lt;a class="reference external" href="https://github.com/rackt/redux"&gt;redux&lt;/a&gt; framework and its integrations with React, using the
&lt;a class="reference external" href="https://github.com/rackt/react-redux"&gt;react-redux&lt;/a&gt; library. Redux can be used as an alternative to Flux
(which we discussed in &lt;a class="reference external" href="https://spapas.github.io/2015/07/02/comprehensive-react-flux-tutorial-2/"&gt;a previous article&lt;/a&gt;)
to orchestrate the message passing between&amp;nbsp;ui/components/data.&lt;/p&gt;
&lt;p&gt;This tutorial will also produce as a result an opinionated (my opinion) boilerplate
project for creating react-redux Single Page Applications. I have used Django
as the back end however you could use any server-side framework you like,
Django is only used for implementing a bunch of &lt;span class="caps"&gt;REST&lt;/span&gt; APIs through django-rest-framework.
You may replace it with any other &lt;span class="caps"&gt;REST&lt;/span&gt; framework you&amp;nbsp;like.&lt;/p&gt;
&lt;p&gt;I have also used &lt;tt class="docutils literal"&gt;browserify&lt;/tt&gt; to pack the client-side code &amp;#8212; I prefer it
from webpack as I find it much easier, clear and less-magical, and, since
it fills all my needs I don&amp;#8217;t see any reason to take the webpack&amp;nbsp;pill.&lt;/p&gt;
&lt;p&gt;All client side code is written in &lt;span class="caps"&gt;ES6&lt;/span&gt; javascript using the latest trends &amp;#8212; I will
try to explain anything I feel that is not very&amp;nbsp;clear.&lt;/p&gt;
&lt;p&gt;Before continuing, I have to mention that although I will provide an
(as comprehensive as possible) introduction to redux,
I will concentrate on the correct integration between redux, react-redux and
React in a complex, production level application. I&amp;#8217;ll try to explain everything
I talk about, however, before reading the rest of
this article I recommend reading the introduction and basics sections
of &lt;a class="reference external" href="http://rackt.org/redux/index.html"&gt;redux documentation&lt;/a&gt; and watching the &lt;a class="reference external" href="https://egghead.io/series/getting-started-with-redux"&gt;getting started with redux&lt;/a&gt; from the
creator of redux &amp;#8212; I can&amp;#8217;t recommend the videos enough, they are really&amp;nbsp;great!&lt;/p&gt;
&lt;p&gt;One final thing: This is a &lt;em&gt;really long&lt;/em&gt; article (more than 100 kb). It will
require a lot of time to read and understand it, especially if you are not
familiar with the concepts described here. Please take your time when reading
it and try verifying what I say here through the project that accompanies
this article &amp;#64; &lt;a class="reference external" href="https://github.com/spapas/react-tutorial/"&gt;https://github.com/spapas/react-tutorial/&lt;/a&gt;, tag &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;react-redux&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction-to-redux"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Introduction to&amp;nbsp;redux&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have to say that I got interested in redux because of all that buzz this
framework generated. However, I got really interested in it when I
understood how close its philosophy was to functional programming -
this, when combined with the usage of react functional components will
enable you to write great code &lt;em&gt;and&lt;/em&gt; (most important for me) really
enjoy coding with it (if you like functional programming of course :)&amp;nbsp;)&lt;/p&gt;
&lt;p&gt;Redux is simpler, having fewer and less complex concepts than the original Flux
implementation and more opinionated - this is a good&amp;nbsp;thing!&lt;/p&gt;
&lt;p&gt;Here are the basic building blocks of&amp;nbsp;redux:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;One (and only one) &lt;strong&gt;state&lt;/strong&gt;: It is an object that keeps the &lt;em&gt;global&lt;/em&gt; state of your application. Everything has to be in that object, both data and&amp;nbsp;ui.&lt;/li&gt;
&lt;li&gt;A bunch of &lt;strong&gt;actions&lt;/strong&gt;: These are simple objects that are created/dispatched when something happens (ui interaction, server response etc) with a mandatory property (their type) and a number of optional properties that define the data that accompanies each&amp;nbsp;action.&lt;/li&gt;
&lt;li&gt;A bunch of &lt;strong&gt;action creators&lt;/strong&gt;: These are very simple functions that create action objects. Usually, there are as many action creators as actions (unless you use redux-thunk, we&amp;#8217;ll talk about it&amp;nbsp;later).&lt;/li&gt;
&lt;li&gt;One (and only one) &lt;strong&gt;reducer&lt;/strong&gt;: It is a function that retrieves the current state and an action and creates the resulting state. This is the central component of a redux application - every action along with the current state will be passed to the reducer and the state of the application will be the resulting, new&amp;nbsp;state.&lt;/li&gt;
&lt;li&gt;One (and only one) &lt;strong&gt;store&lt;/strong&gt;: It is an object that is created by redux and is used as a glue between the state, the reducer and the&amp;nbsp;components&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The general idea/flow&amp;nbsp;is:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Something (let&amp;#8217;s call it event) happens (i.e a user clicks a button, a timeout is fired, an ajax request&amp;nbsp;responds)&lt;/li&gt;
&lt;li&gt;An action describing that event is created by its the corresponding action creator and dispatched (i.e passed to the reducer along with the current state) through the&amp;nbsp;store&lt;/li&gt;
&lt;li&gt;The dispach calls the reducer with the current state object and the action as&amp;nbsp;parameters&lt;/li&gt;
&lt;li&gt;The reducer checks the type of the action and, depending on the action type and any other properties this action has, creates a new state&amp;nbsp;object&lt;/li&gt;
&lt;li&gt;The store applies the new state to all&amp;nbsp;components&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;One thing we can see from the above is that redux is not react-only (although its general architecture is a perfect fit to react) but
could be also used with different view frameworks, or even with &lt;em&gt;no view framework&lt;/em&gt;!&lt;/p&gt;
&lt;div class="section" id="a-simple-example"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id4"&gt;A simple&amp;nbsp;example&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;I&amp;#8217;ve implemented a very simple redux example &amp;#64; jsfiddle that increases and decreases
a number using two buttons to support the&amp;nbsp;above:&lt;/p&gt;
&lt;div class="jsfiddle"&gt;&lt;iframe width="100%" height="300" src="//jsfiddle.net/8aba3sp6/embedded/js,resources,html,css,result/light/" allowfullscreen="allowfullscreen" frameborder="0"&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;p&gt;Its html&amp;nbsp;is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;state_container&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;0&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="na"&gt;onclick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;increase()&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;+&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="na"&gt;onclick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;decrease()&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;-&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;while its javascript (es6) code&amp;nbsp;is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;reducer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;INCREASE&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DECREASE&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;Redux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createStore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;reducer&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;unsubscribe&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;subscribe&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;
  &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;state_container&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;innerHTML&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;increase&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;e&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
  &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;INCREASE&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;decrease&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;e&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
  &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DECREASE&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;span class="caps"&gt;HTML&lt;/span&gt; just displays a div which keeps the current number value
and two buttons that call the increase and decrease&amp;nbsp;functions.&lt;/p&gt;
&lt;p&gt;Now, for the javascript, we create a reducer function that
gets the previous state value (which initially is the number 0) and the
action that is dispatched. When the reducer is called it will check if the action type is &amp;#8216;&lt;span class="caps"&gt;INCREASE&lt;/span&gt;&amp;#8217;
or &amp;#8216;&lt;span class="caps"&gt;DECREASE&lt;/span&gt;&amp;#8217; and correspondigly increase or decreases the state,
which is just that number. Normally, the state will be a (rather fat)&amp;nbsp;object.&lt;/p&gt;
&lt;p&gt;We then create a store which gets the reducer as its only parameter
then and call its subscribe method passing a callback. This callback will be
called whenever the state is changed - in our case, the callback just updates
the div with the current number from the state. Finally, the increase
and decrease methods that are called when the butts are clicked
will just dispatch the corresponding&amp;nbsp;action.&lt;/p&gt;
&lt;p&gt;Please notice that in the above example I didn&amp;#8217;t use action creators for
simplicity. For completeness, the action creator for increase would be something&amp;nbsp;like&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;increaseCreator&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;INCREASE&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;i.e it would just return an &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;INCREASE&lt;/span&gt;&lt;/tt&gt; action and &lt;tt class="docutils literal"&gt;window.increase&lt;/tt&gt;
would be &lt;tt class="docutils literal"&gt;window.increase = e =&amp;gt; &lt;span class="pre"&gt;store.dispatch(increaseCreator())&lt;/span&gt;&lt;/tt&gt;. Notice that
the &lt;tt class="docutils literal"&gt;increaseCreator&lt;/tt&gt; is called (has &lt;tt class="docutils literal"&gt;()&lt;/tt&gt;) so that &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; will receive the
resulting action object as a&amp;nbsp;parameter.&lt;/p&gt;
&lt;p&gt;The flow of the data when the increase button is clicked is the&amp;nbsp;following:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;button.onClick&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;increase()&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;increaseCreator()&lt;/tt&gt; (if we used action creators - this a param to &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; so it will be called&amp;nbsp;first)&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;store.dispatch({type:&lt;/span&gt; '&lt;span class="caps"&gt;INCREASE&lt;/span&gt;' })&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;reducer(current_state, {type: &lt;span class="pre"&gt;'&lt;span class="caps"&gt;INCREASE&lt;/span&gt;'})&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Reducer returns the new state (&lt;tt class="docutils literal"&gt;state+1&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;callback()&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;value is&amp;nbsp;updated&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Having one and only one store/state makes the flow of the data crystal and
resolves some of the dillemas I had when using the original Flux architecture!
Some people may argue that although a single reducer function is nice for
the above simple demo, having a huge (spaghetti-like) switch statement in
your reducer is not a very good practice - thankfully redux has a bunch
of tools that will presented later and greatly help on this (seperating the
reducing logic, using different modules for each module&amp;nbsp;etc).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="interlude-so-what-s-a-reducer"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id5"&gt;Interlude: So what&amp;#8217;s a&amp;nbsp;reducer?&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;I&amp;#8217;d like to talk a bit about the &amp;#8220;reducer&amp;#8221;, mainly for people not familiar with
functional programming (although people writing Javascript &lt;em&gt;should&lt;/em&gt; be familiar
with functional programming since Javascript has functional features) to clarify
my statement above that the redux philosophy is close to functional&amp;nbsp;programming.&lt;/p&gt;
&lt;p&gt;One basic concept of functional programming is the concept of
&amp;#8220;map-reduce&amp;#8221;. Mapping means calling a function (let&amp;#8217;s call it mapper)
for all elements of a list and creating a new list with the output of each
individual call. So, a mapper gets only one parameter, the current value of
the list. For example the &amp;#8220;double&amp;#8221; mapper, defined like
&lt;tt class="docutils literal"&gt;let double = x =&amp;gt; x*2&lt;/tt&gt; would &amp;#8220;map&amp;#8221; the list &lt;tt class="docutils literal"&gt;[1,2,3]&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;[2,4,6]&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Reducing means calling a function (let&amp;#8217;s call it &lt;em&gt;reducer&lt;/em&gt;) for all elements
of a list and creating a single value that accumulates the result of each
individual call. This can be done because the reducer gets &lt;em&gt;two&lt;/em&gt; parameters,
the accumulated value of the list until this point and the current value of the list.
Also, when doing a reduce we need to define a starting value for the accumulator.
For example, the &amp;#8220;sum&amp;#8221; reducer, defined like &lt;tt class="docutils literal"&gt;let sum = (s=0, x) =&amp;gt; s+x&lt;/tt&gt;,
(which has an initial value of 0), would &amp;#8220;reduce&amp;#8221; the list &lt;tt class="docutils literal"&gt;[1,2,3]&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;6&lt;/tt&gt; by calling
the &lt;tt class="docutils literal"&gt;sum&lt;/tt&gt; reducer three&amp;nbsp;times:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;tmp1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// tmp1 = 1&lt;/span&gt;
&lt;span class="nx"&gt;tmp2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;tmp1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// tmp2 = 3&lt;/span&gt;
&lt;span class="nx"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;tmp2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="c1"&gt;// result = 6&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So, a redux reducer is &lt;em&gt;actually&lt;/em&gt; a (rather complex) functional reducer, getting the current
state (as the accumulated value) and each individual action as the value and
returning the new state which is the result of applying this action to the&amp;nbsp;state!&lt;/p&gt;
&lt;p&gt;Three extra things to make sure about your redux reducers are&amp;nbsp;that:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;they should have an initial value (with the initial state of the application) or know how to handle an undefined initial&amp;nbsp;state&lt;/li&gt;
&lt;li&gt;they must not not mutate (change) the state object but instead create and return a new one (not allowing object mutations is a general practice in functional programming but in redux also helps to quickly apply the changes to the&amp;nbsp;components)&lt;/li&gt;
&lt;li&gt;always return a valid state as a result (or else the application will have invalid&amp;nbsp;state)&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="what-about-react-redux"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;What about&amp;nbsp;react-redux?&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;React-redux is a rather simple framework that offers two helpful utilities for integrating
redux with&amp;nbsp;React:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt; function that &amp;#8220;connects&amp;#8221; React components to the redux store. This function (among others) retrieves a callback parameter that defines properties that will be passed to that component and each one will be (magically) mapped to state&amp;nbsp;properties.&lt;/li&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;Provider&lt;/tt&gt; component. This is a parent component that can be used to (magically) pass the store properties to its children&amp;nbsp;components.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Please notice that nothing actually magical happens when the store properties are passed to the children
components through &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;Provider&lt;/tt&gt;! this is accomplished through the &lt;a class="reference external" href="https://facebook.github.io/react/docs/context.html"&gt;react context&lt;/a&gt; feature
that allows you to &amp;#8220;pass data through the component tree without having to pass the props down manually
at every level&amp;#8221;. So &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;connect``ed&lt;/span&gt; components used context to retrieve the store properties that
have been passed to the context by the ``Provider&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;How react-redux is used be made more clear with another jsfiddle that will convert the previous example to React and&amp;nbsp;react-redux:&lt;/p&gt;
&lt;div class="jsfiddle"&gt;&lt;iframe width="100%" height="300" src="//jsfiddle.net/8aba3sp6/2/embedded/js,resources,html,css,result/light/" allowfullscreen="allowfullscreen" frameborder="0"&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;p&gt;The html is just &lt;tt class="docutils literal"&gt;&amp;lt;div &lt;span class="pre"&gt;id='container'&amp;gt;&amp;lt;/div&amp;gt;&lt;/span&gt;&lt;/tt&gt; since the components will
be rendered through react, while the es6/jsx code&amp;nbsp;is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;reducer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;INCREASE&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DECREASE&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;Redux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;createStore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;reducer&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;RootComponent&lt;/span&gt; &lt;span class="kr"&gt;extends&lt;/span&gt; &lt;span class="nx"&gt;React&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Component&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;number&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;increase&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;decrease&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;number&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
      &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;button&lt;/span&gt; &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;increase&lt;/span&gt;&lt;span class="p"&gt;()}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;+&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/button&amp;gt;&lt;/span&gt;
      &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;button&lt;/span&gt; &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;decrease&lt;/span&gt;&lt;span class="p"&gt;()}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/button&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;mapStateToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;
  &lt;span class="nx"&gt;number&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;mapDispatchToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;
  &lt;span class="nx"&gt;increase&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;INCREASE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}),&lt;/span&gt;
  &lt;span class="nx"&gt;decrease&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DECREASE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;ConnectedRootComponent&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;ReactRedux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="nx"&gt;mapStateToProps&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;mapDispatchToProps&lt;/span&gt;
&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="nx"&gt;RootComponent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nx"&gt;ReactDOM&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;ReactRedux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Provider&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;ConnectedRootComponent&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/ReactRedux.Provider&amp;gt;,&lt;/span&gt;
  &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;container&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As we can see, the reducer and store are the same as the non-react version. What is new
here is that I&amp;#8217;ve added a React &lt;tt class="docutils literal"&gt;RootComponent&lt;/tt&gt; that has two properties, one named &lt;tt class="docutils literal"&gt;number&lt;/tt&gt;
and one named &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; that can be used to dispatch an action through the&amp;nbsp;store.&lt;/p&gt;
&lt;p&gt;Using react-redux&amp;#8217;s &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt; function we create a new component, &lt;tt class="docutils literal"&gt;ConnnectedRootComponent&lt;/tt&gt;
which is a new component with the redux-enabled functionality (i.e it will have access to
store). The &lt;tt class="docutils literal"&gt;connect()&lt;/tt&gt; function takes
a bunch of optional arguments. I won&amp;#8217;t go into much detail since its a little complex
(the &lt;a class="reference external" href="https://github.com/rackt/react-redux/blob/master/docs/api.md#connectmapstatetoprops-mapdispatchtoprops-mergeprops-options"&gt;react-redux documentation&lt;/a&gt; is clear enough), however in our example we have defined
two objects named &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt;
which are passed to &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt; and define how the state and the dispatch are mapped to
the properties the connected component will&amp;nbsp;have.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; is a function that will be called whenever the store&amp;#8217;s state
changes and should return an object whose attributes will be passed to the connected component
as properties. In our example,
we return an object with a number attribute having the current state
(which don&amp;#8217;t forget that is just a number) as its value -
that&amp;#8217;s why we can extract the &lt;tt class="docutils literal"&gt;number&lt;/tt&gt; attribute from &lt;tt class="docutils literal"&gt;this.props&lt;/tt&gt; when&amp;nbsp;rendering.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; as we use it, once again returns an object
whose attributes will be passed to the connected component and will dispatch
actions when&amp;nbsp;called.&lt;/p&gt;
&lt;p&gt;Of course, in order for
the &lt;tt class="docutils literal"&gt;ConnectedRootComponent&lt;/tt&gt; to &lt;em&gt;actually&lt;/em&gt; have these properties that we passed through &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt;,
it must
be enclosed in a &lt;tt class="docutils literal"&gt;&amp;lt;Provider&amp;gt;&lt;/tt&gt; parent component (so that the correct react context will be initialized).
Notice that this is recursive so if we had&amp;nbsp;something&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;Provider&lt;/span&gt; &lt;span class="na"&gt;store&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;{store}&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;Component1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;Component2&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;ConnectedComponent&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;ConnectedComponent&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;Component2&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;Component1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;Provider&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;the &lt;tt class="docutils literal"&gt;&amp;lt;ConnectedComponent&amp;gt;&lt;/tt&gt; would still get the props (dispatch + state slice) we mentioned above
even if its parent components were not&amp;nbsp;connected.&lt;/p&gt;
&lt;p&gt;Although we could have avoided using react-redux  by passing the store directly
to &lt;tt class="docutils literal"&gt;&amp;lt;RootComponent&amp;gt;&lt;/tt&gt; and subscibing to the store changes from the &lt;tt class="docutils literal"&gt;RootComponent&lt;/tt&gt;&amp;#8216;s &lt;tt class="docutils literal"&gt;componentWillMount&lt;/tt&gt; method,
the added-value of react-redux is that using &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;Provider&lt;/tt&gt; we could pass dispatch and
state slices deep inside our component hierarchy without the need to explicitly pass the store
to each individual component and also that react-redux will make optimizations so that the
each connected component will be re-rendered only when needed (depending on the state slice it uses)
and not for every state change. Please be warned that this does not mean that you should connect everything
so that everything will have access to the global state and be able to dispatch actions. You should be very
careful to connect only the components that really need to be connected (redux calls them container components)
and pass dispatch and state as
properties to their children (which are called presentational components). Also, each connected component should receive only
the part of the global state it
needs and not everything (so that each particular component will update only when needed and not for
every state update). The above is absolutely necessary if you want to crate re-usable (&lt;span class="caps"&gt;DRY&lt;/span&gt;) and
easily testable components. I&amp;#8217;ll discuss this a little more when
describing the sample&amp;nbsp;project.&lt;/p&gt;
&lt;p&gt;Finally, notice how easy it is to create reusable container
components using &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt;:
Both the way the component gets its state and calls its actions are
defined through these two objects so you can create
as many connected objects as you want by passing different
&lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; - more on this&amp;nbsp;later.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="our-project"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;Our&amp;nbsp;project&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;After this rather lengthy introduction to redux and react-redux we may move on to our
project. First of all, let&amp;#8217;s see an example of what we&amp;#8217;ll actually build&amp;nbsp;here:&lt;/p&gt;
&lt;img alt="Our project" src="/images/demo3.gif" style="width: 600px;" /&gt;
&lt;p&gt;This is a single-page application that supports client side routing and
has four different routes: A books list, an authors list, a book editing/create
form and an author editing/create form.
The books list supports searching (with the filter field),
pagination (with 5 books per page) and per-column sorting when
clicking the column name (ascending/descending). The book form
supports validation (on the book title), cascading drop downs
(changing category limits the subcategory choices) and a
jquery ui datepicker to select the book publish date. Also,
you can delete books or authors from their corresponding
form. Notice that there&amp;#8217;s a statistics panel showing the current
number of authors and books. A nice loading spinner
will be displayed when asynchronous ajax actions are executed
and a snackbar notification will be shown when such an action
is executed. Finally, although you won&amp;#8217;t be able to see it,
the url of the application is changed according to the choices
the user&amp;nbsp;makes.&lt;/p&gt;
&lt;div class="section" id="other-libraries-used"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;Other libraries&amp;nbsp;used&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;React (and redux) have a big ecosystem of great libraries. Some of these have been used
for this project and will also be discussed in this&amp;nbsp;article:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/gaearon/redux-thunk"&gt;redux-thunk&lt;/a&gt;: This is a nice add-on for redux that generalizes action&amp;nbsp;creators.&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/erikras/redux-form"&gt;redux-form&lt;/a&gt;: A better way to use forms with react and redux. Always use it if you have non-trivial&amp;nbsp;forms.&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/rackt/react-router"&gt;react-router&lt;/a&gt;: A library to create routes for single page applications with&amp;nbsp;React.&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/rackt/react-router-redux"&gt;react-router-redux&lt;/a&gt; (ex redux-simple-router): This library will help integrating react-router with&amp;nbsp;redux.&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/rackt/history"&gt;history&lt;/a&gt;: This is used bt react-router to crete the page history (so that back forward etc&amp;nbsp;work).&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/pburtchaell/react-notification"&gt;react-notification&lt;/a&gt;: A simple react component to display&amp;nbsp;notifications.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The triplet react-router, react-router-redux and history needs to be used for projects that
enable client side routing. The redux-form is really useful if you have non-trivial forms
in your projects - you may skip it if you don&amp;#8217;t use forms or for example you use a form for
searching/filtering with a single input. react-notification just displays notifications,
you can easily exchange it with other similar components or create your&amp;nbsp;own.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="redux-thunk"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;redux-thunk?&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Now, about redux-thunk. I won&amp;#8217;t go into much detail here, you can read more about it in this &lt;a class="reference external" href="http://stackoverflow.com/a/35415559/119071"&gt;great &lt;span class="caps"&gt;SO&lt;/span&gt; answer&lt;/a&gt;,
however I&amp;#8217;d like to point out here that &lt;strong&gt;everything that can be done with redux-thunk
can also be done without it&lt;/strong&gt; so you may safely skip it if you feel that you don&amp;#8217;t really
need it in your&amp;nbsp;project.&lt;/p&gt;
&lt;p&gt;But what does it do? Well, redux-thunk allows you to create action creators that don&amp;#8217;t only return
action objects but can do various other things, like calling other actions or
dispatching actions conditionally. When using redux-thunk, an action returns a function
that can do any of the above mentioned things, something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;thunkAction&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// here you may&lt;/span&gt;
    &lt;span class="c1"&gt;// dispatch other actions (more than one) using the provided dispatch() parameter&lt;/span&gt;
    &lt;span class="c1"&gt;// or&lt;/span&gt;
    &lt;span class="c1"&gt;// check the current state using the getState() parameter and do conditional dispatches&lt;/span&gt;
    &lt;span class="c1"&gt;// or&lt;/span&gt;
    &lt;span class="c1"&gt;// call functions asynchronously so that these will use the provided&lt;/span&gt;
    &lt;span class="c1"&gt;// dispatch function when they return&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let&amp;#8217;s say that we wanted to implement an asynchronous, ajax call.
If we don&amp;#8217;t want to use redux thunk,
then we need to create a normal function that gets &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; as an argument, something
like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;showLoadingAction&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;hideLoadingAction&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;showDataAction&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;./actions&amp;#39;&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;getData&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showLoadingAction&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
  &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;hideLoadingAction&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
      &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showDataAction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
  &lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The main problem with this approach is that the getData functions &lt;em&gt;is not&lt;/em&gt;
called like a normal
action creator (like &lt;tt class="docutils literal"&gt;showLoadingAction&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;hideLoadingAction&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;showDataAction&lt;/tt&gt;)
since it actually returns nothing (so nothing will be dispatched),
so you&amp;#8217;ll need to remember to call it directly
and pass it the &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; &lt;em&gt;instead of&lt;/em&gt; passing its return value to &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt;!&lt;/p&gt;
&lt;p&gt;If however we used thunk, then we&amp;#8217;d have something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;getDataThunk&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showLoadingAction&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;hideLoadingAction&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showDataAction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="p"&gt;})&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, the above can be used like a normal action (i.e it can be called using &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;dispatch(getDataThunk())&lt;/span&gt;&lt;/tt&gt;).
That&amp;#8217;s more or less the main advantage of redux-thunk: You are able to create thunk action creators that
can be called like normal actions and can do more complex things than just returning action objects
so you don&amp;#8217;t have to remember how to call each&amp;nbsp;function.&lt;/p&gt;
&lt;p&gt;I have to repeat
again that everything that you be done with thunk action creators, can also be done with normal functions
that get &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; as a paremeter - the advantage of thunk action creators is that you don&amp;#8217;t need to
remember if an action creator needs to be called through &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;disaptch(actionCreator())&lt;/span&gt;&lt;/tt&gt;
or &lt;tt class="docutils literal"&gt;actionCreator(dispatch)&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;In this tutorial you&amp;#8217;ll see heavy use of redux-thunk. This is just my personal preference - you may
use it less or not at all (however, if you&amp;#8217;ve configured your project to use redux-thunk then I propose
to go all the way and use it all the time for those more complex action&amp;nbsp;creators).&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="explaining-the-application"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;Explaining the&amp;nbsp;application&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the following paragraphs we&amp;#8217;ll see together the structure and source code of
this application. I&amp;#8217;ll try to go into as much detail as possible in order to solve
any questions you may have (I know I had many when I tried setting up everything for
the first time). I&amp;#8217;ll skip imports and non-interesting components - after all the
complete source code can be found &amp;#64; &lt;a class="reference external" href="https://github.com/spapas/react-tutorial/"&gt;https://github.com/spapas/react-tutorial/&lt;/a&gt;,
checkout the tag &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;react-redux&lt;/span&gt;&lt;/tt&gt;.
We&amp;#8217;ll use a top down approach, starting from the main component where the
client side routing
is defined and the application is mounted to the &lt;span class="caps"&gt;DOM&lt;/span&gt;:&lt;/p&gt;
&lt;div class="section" id="main-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;main.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This module is used as an entry point for browserify (i.e we call browserify with
&lt;tt class="docutils literal"&gt;browserify main.js &lt;span class="pre"&gt;-o&lt;/span&gt; bundle.js&lt;/tt&gt; ) and uses components defined elsewhere to
create the basic structure of our application. Let&amp;#8217;s take a look at the important
part of&amp;nbsp;it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;About&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;h2&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;About&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/h2&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Link&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;Home&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Link&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Provider&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Router&lt;/span&gt; &lt;span class="nx"&gt;history&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;history&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Route&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;App&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;IndexRoute&lt;/span&gt; &lt;span class="nx"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;BookPanel&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Route&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/book_create/&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;BookForm&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Route&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/book_update/:id&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;BookForm&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;

                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Route&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/authors/&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;AuthorPanel&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Route&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/author_create/&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;AuthorForm&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Route&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/author_update/:id&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;AuthorForm&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;

                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Route&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/about&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;About&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Route&lt;/span&gt; &lt;span class="nx"&gt;path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;*&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;NoMatch&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Route&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Router&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Provider&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getElementById&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;content&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We can see the well-known &lt;tt class="docutils literal"&gt;render&lt;/tt&gt; function from ReactDOM that gets a component
and a &lt;span class="caps"&gt;DOM&lt;/span&gt; element to mount it to. The domponent we provide to render is the &lt;tt class="docutils literal"&gt;Provider&lt;/tt&gt;
from react-redux we talked about before in order to enable all children components
to use &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt; to have access to the store properties and dispatch. This is the usual
approact with react-redux: &lt;em&gt;The outer component will always be the&amp;nbsp;&amp;#8220;Provider&amp;#8220;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;Provider&lt;/tt&gt; component gets one parameter which is the store that redux will use. We
have initialized our store in a different module which I will present&amp;nbsp;below.&lt;/p&gt;
&lt;p&gt;Inside the &lt;tt class="docutils literal"&gt;Provider&lt;/tt&gt; we are defining a &lt;tt class="docutils literal"&gt;Router&lt;/tt&gt; from &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;react-router&lt;/span&gt;&lt;/tt&gt;. This should
be the parent component inside which all client-side routes of our appliccation are defined.
The &lt;tt class="docutils literal"&gt;Router&lt;/tt&gt; gets a &lt;tt class="docutils literal"&gt;history&lt;/tt&gt; parameter which is initialized elsewhere (stick with me
for now, I will talk about it&amp;nbsp;later).&lt;/p&gt;
&lt;p&gt;Now, inside &lt;tt class="docutils literal"&gt;Router&lt;/tt&gt; we are defining the actual routes of this application. As we
can see,
there&amp;#8217;s a parent &lt;tt class="docutils literal"&gt;Route&lt;/tt&gt; that is connnected to the &lt;tt class="docutils literal"&gt;App&lt;/tt&gt; component which actually
contains everything else. The parent route contains an &lt;tt class="docutils literal"&gt;IndexRoute&lt;/tt&gt; whose corresponding
component (&lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt;) is called
when no route is defined and a bunch of normal &lt;tt class="docutils literal"&gt;Route&lt;/tt&gt; components whose
components are called when the url matches their part. Notice how we pass parameters
to urls (e.g &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/book_update/:id&lt;/span&gt;&lt;/tt&gt;) and the match-all route
(&lt;tt class="docutils literal"&gt;&amp;lt;Route &lt;span class="pre"&gt;path=&amp;quot;*&amp;quot;&lt;/span&gt; &lt;span class="pre"&gt;component={NoMatch}/&amp;gt;&lt;/span&gt;&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;Finally as an example of a routed-to component, notice the &lt;tt class="docutils literal"&gt;About&lt;/tt&gt; component
which is rendered when the route is &lt;tt class="docutils literal"&gt;/about&lt;/tt&gt;. This is just a normal react component that-
will be rendered &lt;em&gt;inside&lt;/em&gt; the &lt;tt class="docutils literal"&gt;App&lt;/tt&gt; component -
the &lt;tt class="docutils literal"&gt;Link&lt;/tt&gt; is a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;react-router&lt;/span&gt;&lt;/tt&gt; component that renders a link to a defined&amp;nbsp;route.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="store-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;store.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;store.js&lt;/tt&gt; module contains the definition of the global store of our application
(which is passed to the &lt;tt class="docutils literal"&gt;Provider&lt;/tt&gt;).
Here, we also define the &lt;tt class="docutils literal"&gt;history&lt;/tt&gt; object we passed to the parent &lt;tt class="docutils literal"&gt;Router&lt;/tt&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;reducer&lt;/span&gt; &lt;span class="nx"&gt;as&lt;/span&gt; &lt;span class="nx"&gt;formReducer&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;redux-form&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;createHistory&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;history/lib/createHashHistory&amp;#39;&lt;/span&gt;

&lt;span class="c1"&gt;// Opt-out of persistent state, not recommended.&lt;/span&gt;
&lt;span class="c1"&gt;// https://github.com/reactjs/history/blob/master/docs/HashHistoryCaveats.md&lt;/span&gt;
&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;history&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;createHistory&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="nx"&gt;queryKey&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;First of all, we see that our &lt;tt class="docutils literal"&gt;history&lt;/tt&gt; object is of type &lt;tt class="docutils literal"&gt;HashHistory&lt;/tt&gt;
(&lt;a class="reference external" href="https://github.com/reactjs/react-router/blob/latest/docs/guides/Histories.md#hashhistory"&gt;more info about history types&lt;/a&gt;) and I&amp;#8217;ve also opted out of using
&lt;tt class="docutils literal"&gt;queryKey&lt;/tt&gt;. If I hadn&amp;#8217;t used the &lt;tt class="docutils literal"&gt;queryKey: false&lt;/tt&gt; configuration
then there&amp;#8217;d be a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;?_k=ckuvup&lt;/span&gt;&lt;/tt&gt; query parameter in the &lt;span class="caps"&gt;URL&lt;/span&gt;. Now, this
parameter is actually useful (it stores location state &lt;em&gt;not&lt;/em&gt; present
in the &lt;span class="caps"&gt;URL&lt;/span&gt; for example &lt;span class="caps"&gt;POST&lt;/span&gt; form data) but I don&amp;#8217;t need it for this
example (and generally I prefer cleaner &lt;span class="caps"&gt;URLS&lt;/span&gt;) - but if you don&amp;#8217;t like
the behavior of your history without it then go ahead and add&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;Also, notice that I&amp;#8217;ve used &lt;tt class="docutils literal"&gt;HashHistory&lt;/tt&gt; which will append a &lt;tt class="docutils literal"&gt;#&lt;/tt&gt;
to the &lt;span class="caps"&gt;URL&lt;/span&gt; and the client-side &lt;span class="caps"&gt;URL&lt;/span&gt; will come after that, so all
URLs will be under (for example) &lt;tt class="docutils literal"&gt;/index.html&lt;/tt&gt; like &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/index.html#/authors&lt;/span&gt;&lt;/tt&gt;.
The react-router
documentation recommends using &lt;tt class="docutils literal"&gt;BrowserHistory&lt;/tt&gt; which uses normal (clean)
urls &amp;#8212; so instead of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/index.html#/authors&lt;/span&gt;&lt;/tt&gt; we&amp;#8217;d see &lt;tt class="docutils literal"&gt;/authors&lt;/tt&gt; if we&amp;#8217;d
used &lt;tt class="docutils literal"&gt;BrowserHistory&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The problem with &lt;tt class="docutils literal"&gt;BrowserHistory&lt;/tt&gt; is that you&amp;#8217;ll need to configure correctly
your &lt;span class="caps"&gt;HTTP&lt;/span&gt; server so that it will translate every &lt;span class="caps"&gt;URL&lt;/span&gt; (/foo) to the same
&lt;span class="caps"&gt;URL&lt;/span&gt; under &lt;tt class="docutils literal"&gt;/index.html&lt;/tt&gt; (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/index.html#/foo&lt;/span&gt;&lt;/tt&gt;) - as can be understood,
without that configuration the &lt;span class="caps"&gt;HTTP&lt;/span&gt; server doesn&amp;#8217;t know anything about the
client side urls so when the webserver sees &lt;tt class="docutils literal"&gt;/authors&lt;/tt&gt; it will pass
&lt;tt class="docutils literal"&gt;/authors&lt;/tt&gt; to your server side framework (which will return a 404 error) - that&amp;#8217;s
why this translation is&amp;nbsp;needed.&lt;/p&gt;
&lt;p&gt;However, in my case, I don&amp;#8217;t think
that configuring your &lt;span class="caps"&gt;HTTP&lt;/span&gt; server to rewrite urls is worth the trouble and also I do really
prefer using &lt;tt class="docutils literal"&gt;#&lt;/tt&gt; for client-side urls! This is a common patter, recognised
by everybody and even without the &lt;span class="caps"&gt;HTTP&lt;/span&gt; server-configuration part I&amp;#8217;d still
prefer &lt;tt class="docutils literal"&gt;HashHistory&lt;/tt&gt; over &lt;tt class="docutils literal"&gt;BrowserHistory&lt;/tt&gt; - of course this is just my opinion, feel free to use
&lt;tt class="docutils literal"&gt;BrowserHistory&lt;/tt&gt; if you don&amp;#8217;t like the hash &lt;tt class="docutils literal"&gt;#&lt;/tt&gt;!&lt;/p&gt;
&lt;p&gt;The next block of code from the &lt;tt class="docutils literal"&gt;store&lt;/tt&gt; module creates the
most important thing of a redux application, its reducer
along with the global&amp;nbsp;store:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;reducer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;combineReducers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;notification&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;ui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;routing&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;routeReducer&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;form&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;formReducer&lt;/span&gt;
    &lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;reduxRouterMiddleware&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;syncHistory&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;history&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;createStore&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;reducer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;applyMiddleware&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="nx"&gt;thunk&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;reduxRouterMiddleware&lt;/span&gt;
&lt;span class="p"&gt;));&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Please notice above that the &lt;tt class="docutils literal"&gt;Object.assign&lt;/tt&gt; method is used - I&amp;#8217;ll talk about
it later &amp;#8212;  however, another common &lt;span class="caps"&gt;ES6&lt;/span&gt; idiom that I&amp;#8217;ve used here
is that when you define
an object you can change  &lt;tt class="docutils literal"&gt;{ x: x }&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;{ x }&lt;/tt&gt; (so &lt;tt class="docutils literal"&gt;{books}&lt;/tt&gt;
means &lt;tt class="docutils literal"&gt;{'books': books}&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;combineReducers&lt;/tt&gt; function is provided
by redux and is a helper function that helps you in &amp;#8230; combining reducers!
As you see, I&amp;#8217;ve combined the reducers defined in this application
&lt;tt class="docutils literal"&gt;(books, notification, ui, categories, authors)&lt;/tt&gt; with the reducers
of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;react-router-redux&lt;/span&gt;&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;redux-form&lt;/span&gt;&lt;/tt&gt;
to create &lt;em&gt;the reducer&lt;/em&gt;. We&amp;#8217;ll talk a bit in the next
interlude on what does combining reducers&amp;nbsp;is.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;routeReducer&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;formReducer&lt;/tt&gt; reducers are provided by
react-router-redux and refux-form to properly handle the routing
and form-related&amp;nbsp;actions.&lt;/p&gt;
&lt;p&gt;The remaining of the code generates the &lt;tt class="docutils literal"&gt;store&lt;/tt&gt;: First of all, a middleware
(please see next-next interlude for more)
is created with &lt;tt class="docutils literal"&gt;syncHistory&lt;/tt&gt; that allows actions to call history methods
(so that when the &lt;span class="caps"&gt;URL&lt;/span&gt; is changed through actions they will be reflected to the
history). Then, the &lt;tt class="docutils literal"&gt;createStoreWithMiddleware&lt;/tt&gt; function is called to generate
the store that will be passed to the &lt;tt class="docutils literal"&gt;Provider&lt;/tt&gt;. This function takes the
reducer as a parameter along with any store enchancers that we&amp;#8217;d like to
apply. A store enchancer is a function that modifies the store. The only
store enchanccer that we use now is the output of the
&lt;tt class="docutils literal"&gt;applyMiddleware&lt;/tt&gt; function that combines the two middlewares we&amp;#8217;ve defined (one is for
redux thunk, the other is for &lt;tt class="docutils literal"&gt;syncHistory&lt;/tt&gt;). I know, your head hurts but
I&amp;#8217;ll try to clear things out&amp;nbsp;below.&lt;/p&gt;
&lt;div class="section" id="interlude-combining-reducers"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id13"&gt;Interlude: Combining&amp;nbsp;reducers&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;So, what does the &lt;tt class="docutils literal"&gt;combineReducers&lt;/tt&gt; function do? As we&amp;#8217;ve already seen,
the reducer is a simple function that gets the current state and an
action as parameters and returns the next state (which is the result of applying
the action to the state). The reducer will have a big switch statement that
checks the type of the action and returns the correct new state. Unfortunately,
this switch statement may get way too fat and unmaintainable for large&amp;nbsp;projects.&lt;/p&gt;
&lt;p&gt;That&amp;#8217;s where combining reducers comes to the rescue: Instead of having one big,
monolithic reducer for all the parts of our application state tree, we can break it to individual
reducers depending only on specific slices of the state object. What this means is
that if we have for example a state tree like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="s1"&gt;&amp;#39;data&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{},&lt;/span&gt;
  &lt;span class="s1"&gt;&amp;#39;ui&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;with actions that manipulate either data or ui, we could create two indivdual reducers,
one for the &lt;tt class="docutils literal"&gt;data&lt;/tt&gt; slice, and one for the &lt;tt class="docutils literal"&gt;ui&lt;/tt&gt; slice of the state tree. These reducers would get &lt;em&gt;only&lt;/em&gt;
the slice of the state that they are interested in, so the &lt;tt class="docutils literal"&gt;dataReducer&lt;/tt&gt; will get
only the &lt;tt class="docutils literal"&gt;data&lt;/tt&gt; part of the state tree and the &lt;tt class="docutils literal"&gt;uiReducer&lt;/tt&gt; will get only the &lt;tt class="docutils literal"&gt;ui&lt;/tt&gt;
part of the state&amp;nbsp;tree.&lt;/p&gt;
&lt;p&gt;To &lt;em&gt;combine&lt;/em&gt; these reducers the &lt;tt class="docutils literal"&gt;combineReducers&lt;/tt&gt; function is used. This function
gets an object with the name of the state part for each sub-reducer as attribute names
and that sub-reducer
as values and returns a reducer function that passes the action along with
the correct state slice to each of the sub-reducers and creates the global state object by
combining the output of each&amp;nbsp;sub-reducer.&lt;/p&gt;
&lt;p&gt;This may be clarified more with our own version of a combine reducers&amp;nbsp;function:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;combineReducers2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;o&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{},&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;mapped&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;o&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;k&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
          &lt;span class="p"&gt;{&lt;/span&gt;
              &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
              &lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;o&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;k&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;k&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;// call k sub-reducer and get result&lt;/span&gt;
          &lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="p"&gt;))&lt;/span&gt;
      &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;reduced&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;mapped&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;reduce&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)=&amp;gt;{&lt;/span&gt;
          &lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;key&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;slice&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
          &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;s&lt;/span&gt;
      &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{})&lt;/span&gt;

      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;reduced&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above function gets an object (&lt;tt class="docutils literal"&gt;o&lt;/tt&gt;) with state slices and sub-reducers
as input and returns a function (that function is the resulting reducer)&amp;nbsp;that:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Creates an array (named &lt;tt class="docutils literal"&gt;mapped&lt;/tt&gt;) of objects with two attributes: &lt;tt class="docutils literal"&gt;key&lt;/tt&gt; for each attribute of &lt;tt class="docutils literal"&gt;o&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;slice&lt;/tt&gt; after applying the sub-reducer to the corresponding state&amp;nbsp;slice&lt;/li&gt;
&lt;li&gt;Reduces and returns the above array (&lt;tt class="docutils literal"&gt;reduced&lt;/tt&gt;) to a single object that has attributes for each state slice and the resulting state slice as values (this is actually the global&amp;nbsp;state)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To show-off the &lt;span class="caps"&gt;ES6&lt;/span&gt; code (and my most sadistic tendencies),
the above code could be also writen like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;combineReducers3&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;o&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{},&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;o&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;k&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="nx"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;o&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;k&lt;/span&gt;&lt;span class="p"&gt;](&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;k&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;]).&lt;/span&gt;&lt;span class="nx"&gt;reduce&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;}),&lt;/span&gt; &lt;span class="p"&gt;{})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I wouldn&amp;#8217;t like to explain this - its more or less a more functional version of &lt;tt class="docutils literal"&gt;combineReducers2&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="interlude-middlewares"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id14"&gt;Interlude:&amp;nbsp;Middlewares&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;A redux middleware is &lt;a class="reference external" href="http://redux.js.org/docs/advanced/Middleware.html"&gt;rather difficult to explain&lt;/a&gt; technically but easier to explain
conceptually: What it does it that it can be used to extend the store&amp;#8217;s dispatch by providing
extra functionality. We&amp;#8217;ve already seen such functionality, the ability to use
thunk action creators (for action creators that don&amp;#8217;t return the next state&amp;nbsp;object).&lt;/p&gt;
&lt;p&gt;If you take a look at the &lt;tt class="docutils literal"&gt;createStore&lt;/tt&gt; function, you&amp;#8217;ll see that
its second parameter is called &lt;tt class="docutils literal"&gt;enhancer&lt;/tt&gt;. When &lt;tt class="docutils literal"&gt;enhancer&lt;/tt&gt;
is a function (like in our case where it is the
result of &lt;tt class="docutils literal"&gt;applyMiddleware&lt;/tt&gt;) the return value of &lt;tt class="docutils literal"&gt;createStore&lt;/tt&gt;
is &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;enhancer(createStore(...))&lt;/span&gt;&lt;/tt&gt; so it will call the result of &lt;tt class="docutils literal"&gt;applyMiddleware&lt;/tt&gt;
with the store as&amp;nbsp;parameter.&lt;/p&gt;
&lt;p&gt;Now, what does &lt;tt class="docutils literal"&gt;applyMiddleware&lt;/tt&gt;? It gets a variable
number of functions (using the spread &lt;tt class="docutils literal"&gt;...&lt;/tt&gt; operator) as input arguments (let&amp;#8217;s call
them middlewares) and returns
&lt;em&gt;another&lt;/em&gt; function (this is the &lt;tt class="docutils literal"&gt;enhancer&lt;/tt&gt; we mentioned in the previous paragraph)
that gets a store as an input and
returns the same store with its &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; method modified so that it will
call each middleware and pass the result to the next. So, in our case the
resulting store&amp;#8217;s dispatch function would be something&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;reduxRouterMiddleware&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;thunk&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, a middleware function looks like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;middleware&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;next&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="c1"&gt;//&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;it returns a function that gets the &lt;tt class="docutils literal"&gt;store&lt;/tt&gt; as input
and returns another function. This returned function
gets &lt;tt class="docutils literal"&gt;next&lt;/tt&gt; as an input. What is next? It&amp;#8217;s just the
next &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; function to be called. So the first middleware will have the original
store&amp;#8217;s &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; as its &lt;tt class="docutils literal"&gt;next&lt;/tt&gt; parameter, the second middleware will have the
result of passing the store&amp;#8217;s &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; from the first middleware, etc. Something like
this: &lt;tt class="docutils literal"&gt;middleware2Dispatch(next=middleware1Dispatch(next=storeDispatch))&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Another
explanation of the above is that a&amp;nbsp;middleware:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;is a function (that gets a store to enhance as input) that&amp;nbsp;returns&lt;/li&gt;
&lt;li&gt;another function (that gets the next dispatcher to be called as input) that&amp;nbsp;returns&lt;/li&gt;
&lt;li&gt;another function (that gets an action as input) which&amp;nbsp;is&lt;/li&gt;
&lt;li&gt;the dispatcher modified by this&amp;nbsp;middleware&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let&amp;#8217;s take a look at the thunk middleware to actually see what it looks&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;thunkMiddleware&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt; &lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;next&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;
    &lt;span class="k"&gt;typeof&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;function&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt;
      &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt;
      &lt;span class="nx"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So, it gets the store (&lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;getState&lt;/tt&gt; are store attributes)
as an input and returns a function that gets &lt;tt class="docutils literal"&gt;next&lt;/tt&gt; (i.e
the next dispatcher to be called) as input. This function returns &lt;em&gt;another function&lt;/em&gt;
(the modified &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt;). Since this function is a dispatcher, it will get
an &lt;tt class="docutils literal"&gt;action&lt;/tt&gt; as an input and if that action
is a function it calls this function passing it dispatch (remember how we
said if we didn&amp;#8217;t want to use thunk then we&amp;#8217;d just create normal functions
to which we&amp;#8217;d pass the dispatch as a parameter - that&amp;#8217;s what it does here!).
If this action is not a function
(so it is a normal object) it just returns &lt;tt class="docutils literal"&gt;dispatch(action)&lt;/tt&gt; to dispatch&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;Finally, we&amp;#8217;ll create a simple middleware that will output the action type and the
state for every&amp;nbsp;dispatch:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;logStateMiddleware&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;next&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="c1"&gt;// log the action type&lt;/span&gt;
  &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
  &lt;span class="c1"&gt;// now we must call next(action) to propagate and finally dispatch the action object&lt;/span&gt;
  &lt;span class="nx"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;just put it in the applyMiddleware parameter list and observe all state&amp;nbsp;changes!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="reducers-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;reducers.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This module contains the definition for our own defined sub-reducers that we combined
in the previous paragraph (&lt;tt class="docutils literal"&gt;books, notification, ui, categories, authors&lt;/tt&gt;) to create
the global reducer of the application. I&amp;#8217;ve put everything in a single file, however
it is more common to create a &lt;tt class="docutils literal"&gt;reducers&lt;/tt&gt; directory and put every sub-reducer inside it
as a different module. Let&amp;#8217;s start reviewing the code of the &lt;tt class="docutils literal"&gt;reducers.js&lt;/tt&gt; module:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;notification&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{},&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;SHOW_NOTIFICATION&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;notification_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;message&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;notification_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="p"&gt;})&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;CLEAR_NOTIFICATION&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;ui&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{},&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;IS_LOADING&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;isLoading&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;isLoading&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;IS_SUBMITTING&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;isSubmitting&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;isSubmitting&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;notification&lt;/tt&gt; and &lt;cite&gt;ui&lt;/cite&gt; are two sub-reducers that control the state of the notification popup and if
the application is loading / is submitting. I won&amp;#8217;t go into much detail about
them, they are really simple. However, notice that they both create a new state object
for each of their actions. To achieve this, the &lt;tt class="docutils literal"&gt;Object.assign()&lt;/tt&gt; method is used.
This method is defined like this:
&lt;tt class="docutils literal"&gt;Object.assign(target, &lt;span class="pre"&gt;...sources)&lt;/span&gt;&lt;/tt&gt;. Its first parameter is an object (a new, empty object) while the rest
parameters (&lt;tt class="docutils literal"&gt;sources&lt;/tt&gt;) are other objects whose properties will be assigned &lt;tt class="docutils literal"&gt;target&lt;/tt&gt;. The rightmost members of
&lt;tt class="docutils literal"&gt;sources&lt;/tt&gt; overwrite the previous ones if they have the same names. So, for example the&amp;nbsp;code&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;results&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;creates a new object which will have all the properties of the current &lt;tt class="docutils literal"&gt;state&lt;/tt&gt; with the exception of the
&lt;tt class="docutils literal"&gt;rows&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;count&lt;/tt&gt; attributes which will get their values from the &lt;tt class="docutils literal"&gt;action&lt;/tt&gt;. This is a common idiom in
redux and you are going to see it all the time so please make sure that you grok it before continuing. Also,
notice that the new state is a new, empty object in which
all the attributes of the new state are copied - this is because
the old state cannot be&amp;nbsp;mutated.&lt;/p&gt;
&lt;p&gt;Now we&amp;#8217;ll see the reducer that handles books. Before understanding the actual reducer, I will present
the initial value of the books state&amp;nbsp;slice:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;//http://stackoverflow.com/a/5158301/119071&lt;/span&gt;
&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;getParameterByName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;match&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;RegExp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;[?&amp;amp;]&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;=([^&amp;amp;]*)&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;exec&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;location&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;hash&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;match&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nb"&gt;decodeURIComponent&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;match&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;].&lt;/span&gt;&lt;span class="nx"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sr"&gt;/\+/g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;BOOKS_INITIAL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[],&lt;/span&gt;
    &lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;getParameterByName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sorting&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;getParameterByName&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;search&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{},&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As we see, the &lt;tt class="docutils literal"&gt;BOOK_INITIAL&lt;/tt&gt;
constant is used to setup an initial state for the books slice of the global state. The &lt;tt class="docutils literal"&gt;BOOKS_INITIAL&lt;/tt&gt;
attributs&amp;nbsp;are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;rows&lt;/tt&gt;: The rows of the book&amp;nbsp;table&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;count&lt;/tt&gt;: The number of rows that are&amp;nbsp;displayed&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;page&lt;/tt&gt;: The current page we are&amp;nbsp;on&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;sorting&lt;/tt&gt;: User-defined&amp;nbsp;sorting&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;search&lt;/tt&gt;: User-search /&amp;nbsp;filtering&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;book&lt;/tt&gt;: The data of the book to be&amp;nbsp;edited/displayed&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;BOOK_INITIAL&lt;/tt&gt; constant
gets the &lt;tt class="docutils literal"&gt;sorting&lt;/tt&gt; and the &lt;tt class="docutils literal"&gt;search&lt;/tt&gt; initial values from the &lt;span class="caps"&gt;URL&lt;/span&gt; to allow these parameters
to be initialized from the &lt;span class="caps"&gt;URL&lt;/span&gt; (so that using a url like &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;#?search=foo&lt;/span&gt;&lt;/tt&gt; will show all books
containing &lt;tt class="docutils literal"&gt;foo&lt;/tt&gt;). To get the parameters from the &lt;span class="caps"&gt;URL&lt;/span&gt; I&amp;#8217;m using the &lt;tt class="docutils literal"&gt;getParameterByName&lt;/tt&gt;
function. Now, the actual reducer&amp;nbsp;is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;books&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;BOOKS_INITIAL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;SHOW_BOOKS&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;results&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;SHOW_BOOK&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;CHANGE_PAGE&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;TOGGLE_SORTING&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;CHANGE_SEARCH&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ADD_BOOK&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
                    &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="p"&gt;});&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;UPDATE_BOOK&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;findIndex&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="nx"&gt;r&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="o"&gt;==-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt;
                &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
                        &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                        &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                        &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                    &lt;span class="p"&gt;]&lt;/span&gt;
                &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DELETE_BOOK&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;findIndex&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="nx"&gt;r&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;r&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="o"&gt;==-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;undefined&lt;/span&gt;
                &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;Object&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;assign&lt;/span&gt;&lt;span class="p"&gt;({},&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                    &lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;undefined&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
                        &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                        &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                    &lt;span class="p"&gt;]&lt;/span&gt;
                &lt;span class="p"&gt;});&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The books subreducer handles the &lt;tt class="docutils literal"&gt;SHOW_BOOKS, SHOW_BOOK, CHANGE_PAGE, TOGGLE_SORTING&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;CHANGE_SEARCH&lt;/tt&gt;
actions by retrieving the paramaters of these actions and returning a new books-state-slice object
with the correct parameters using &lt;tt class="docutils literal"&gt;Object.assign&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;ADD_BOOK&lt;/tt&gt; action is a little more complicated: This action will be dispached when a new book is added with
the data of that new book as a parameter (&lt;tt class="docutils literal"&gt;action.book&lt;/tt&gt;). In order to make everything easier, I just append the new
book to the end of the books that are displayed on the
current page and increase the count number (I also set the new book to be the &lt;tt class="docutils literal"&gt;book&lt;/tt&gt; attribute
of the state). This means that the newly created book will not go to its correct place (based on the ordering) and
that the visible items will be more than the ajax page coun (also notice that if you add another book then the visible
items will also be increased by one more). This is not a problem (for me) since if the user changes page or does a search
everything will fall back to its place. However, if you don&amp;#8217;t like it there are two solutions, one easier and one more&amp;nbsp;difficult:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Easier solution: When adding a book just &lt;em&gt;invalidate&lt;/em&gt; (make undefined) the &lt;tt class="docutils literal"&gt;books&lt;/tt&gt; state attribute. This will result in an ajax call to reload the books and everything will be in place. However the user may not see the newly added book if it does not fall to the currently selected page (and there&amp;#8217;d be an extra, unnecessary ajax&amp;nbsp;call)&lt;/li&gt;
&lt;li&gt;Harder solution: Depending on the sorting you may check if the current books should be displayed or not on the current page and push it to its correct place (and remove the last item of &lt;tt class="docutils literal"&gt;rows&lt;/tt&gt; so that count is not increased). Once again, the newly book may no be displayed at all if it does not belong to the visible&amp;nbsp;page&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;UPDATE_BOOK&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;DELETE_BOOK&lt;/tt&gt; actions are even more complex. I&amp;#8217;ll only explain update, delete is more or less
the same (with the difference that update has the updated book as an action parameter while delete has only its id
as an acton parameter): First of all we check if the updated book is currently displayed (if one of the books of
&lt;tt class="docutils literal"&gt;rows&lt;/tt&gt; has the same &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; as the updated book). If the book is not displayed then only the current edited book
is set to the new state. However, if it is displayed then it would need to be updated because the &lt;tt class="docutils literal"&gt;rows&lt;/tt&gt; array
does not know anything about the updated values of the&amp;nbsp;book!&lt;/p&gt;
&lt;p&gt;So, inside the &lt;tt class="docutils literal"&gt;else&lt;/tt&gt; branch, the &lt;tt class="docutils literal"&gt;idx&lt;/tt&gt; variable will hold its current index and the
&lt;tt class="docutils literal"&gt;rows&lt;/tt&gt; attribute of the new state will get the following&amp;nbsp;value:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;slice&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;...&lt;/tt&gt; spread operator expands an array so, for example &lt;tt class="docutils literal"&gt;[ &lt;span class="pre"&gt;...[1,2,3]&lt;/span&gt; ]&lt;/tt&gt; would be like &lt;tt class="docutils literal"&gt;[1,2,3]&lt;/tt&gt;
and the &lt;tt class="docutils literal"&gt;slice&lt;/tt&gt; method gets two parameters and returns a copy of the array elements between them. Using
this knowledge, we can understand that the above code returns an array (&lt;tt class="docutils literal"&gt;[]&lt;/tt&gt;) that contains the books of
&lt;tt class="docutils literal"&gt;rows&lt;/tt&gt; from the first to the updated one (not including the updated one), the updated book
object (which we get
from &lt;tt class="docutils literal"&gt;action&lt;/tt&gt;) and the rest of the books of &lt;tt class="docutils literal"&gt;rows&lt;/tt&gt; (after the updated&amp;nbsp;one).&lt;/p&gt;
&lt;p&gt;The code for the &lt;tt class="docutils literal"&gt;authors&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;categories&lt;/tt&gt; sub-reducers does not have any surprises so I won&amp;#8217;t go
into detail about&amp;nbsp;it.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;AUTHORS_INITIAL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// ...&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;authors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;AUTHORS_INITIAL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// ...&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;CATEGORIES_INITIAL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// ...&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;categories&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;CATEGORIES_INITIAL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// ...&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="the-global-state-tree"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id16"&gt;The global state&amp;nbsp;tree&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Remember that all the above are sub-reducers, each one taking only a slice
of the global state tree. They are all combined, along with the routing and
form reducers to create the global reducer&amp;nbsp;function.&lt;/p&gt;
&lt;p&gt;This also means, that the global state object will be something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{},&lt;/span&gt;
  &lt;span class="nx"&gt;notification&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{},&lt;/span&gt;
  &lt;span class="nx"&gt;ui&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{},&lt;/span&gt;
  &lt;span class="nx"&gt;categories&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{},&lt;/span&gt;
  &lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{},&lt;/span&gt;
  &lt;span class="nx"&gt;routing&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{},&lt;/span&gt;
  &lt;span class="nx"&gt;form&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{},&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We won&amp;#8217;t see this object anywhere because each sub-reducer will get its corresponding
slice of that&amp;nbsp;object.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="actions-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;actions.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;actions.js&lt;/tt&gt; module should probably have been named &lt;tt class="docutils literal"&gt;action_creators.js&lt;/tt&gt; since
it actually contains redux action creators. Also, a common practice is create a folder
named &lt;tt class="docutils literal"&gt;actions&lt;/tt&gt; and put there individual modules that contain action creators for
the sub-reducers (in our case, for example there would be &lt;tt class="docutils literal"&gt;books.js&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;authors.s&lt;/tt&gt; etc).&lt;/p&gt;
&lt;p&gt;In any case, for simplicity I chose to just use a module named &lt;tt class="docutils literal"&gt;actions.js&lt;/tt&gt; and put
everything there. One important thing to keep in mind is that &lt;tt class="docutils literal"&gt;actions.js&lt;/tt&gt; contains both
normal action creators (i.e functions that return actions and should be &amp;#8220;dispatched&amp;#8221;)
&lt;em&gt;and&lt;/em&gt; thunk action creators (i.e
functions that not necessarily return actions but can be &amp;#8220;dispatcher&amp;#8221;) - please see the
discussion about redux-thunk on a previous&amp;nbsp;paragraph.&lt;/p&gt;
&lt;p&gt;First of all, there&amp;#8217;s a bunch of some simple action creators that just return
the corresponding action object with the correct parameters. Notice that
the action creators that end in &lt;tt class="docutils literal"&gt;*Result&lt;/tt&gt; are called when an
(async) ajax request returns, for example &lt;tt class="docutils literal"&gt;showBooksResult&lt;/tt&gt; will be
called when the book loading has returned and pass its result data to
the reducer. The other action creators change various parts of the state
object, for example &lt;tt class="docutils literal"&gt;loadingChanged&lt;/tt&gt; will create an action that when
dispatched it will set &lt;tt class="docutils literal"&gt;ui.isLoading&lt;/tt&gt; attribute
to the action&amp;nbsp;parameter.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
showBooksResult(books) for &amp;quot;SHOW_BOOKS&amp;quot;,
showBookResult(book) for &amp;quot;SHOW_BOOK&amp;quot;,
addBookResult(book) for &amp;quot;ADD_BOOK&amp;quot;,
updateBookResult(book) for &amp;quot;UPDATE_BOOK&amp;quot;,
deleteBookResult(id) for &amp;quot;DELETE_BOOK&amp;quot;,

showAuthorsResult(authors) for &amp;quot;SHOW_AUTHORS&amp;quot;,
showAuthorResult(author) for &amp;quot;SHOW_AUTHOR&amp;quot;,
addAuthorResult(author) for &amp;quot;ADD_AUTHOR&amp;quot;,
updateAuthorResult(author) for &amp;quot;UPDATE_AUTHOR&amp;quot;,
deleteAuthorResult(id) &amp;quot;DELETE_AUTHOR&amp;quot;,

showCategoriesResult(categories) for &amp;quot;SHOW_CATEGORIES&amp;quot;,
showSubCategoriesResult(subcategories) for &amp;quot;SHOW_SUBCATEGORIES&amp;quot;,
loadingChanged(isLoading) for &amp;quot;IS_LOADING&amp;quot;,
submittingChanged(isSubmitting) for &amp;quot;IS_SUBMITTING&amp;quot;,
toggleSorting(sorting) for &amp;quot;TOGGLE_SORTING&amp;quot;,
changePage(page) for &amp;quot;CHANGE_PAGE&amp;quot;,
changeSearch(search) for 'CHANGE_SEARCH',
showSuccessNotification(message) for 'SHOW_NOTIFICATION' (type: success),
showErrorNotification(message) for 'SHOW_NOTIFICATION', (type: error)
hideNotification() for 'CLEAR_NOTIFICATION'
&lt;/pre&gt;
&lt;p&gt;The following two are thunk action creators that are called when either the
user sorting or the search/filtering parameters of the displayed books are&amp;nbsp;changed:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;changeSearchAndLoadBooks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;changeSearch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="nx"&gt;history&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;formatUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;toggleSortingAndLoadBooks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;toggleSorting&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="nx"&gt;history&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;formatUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that these are thunk action creators (they return a function) and
the important thing that they do is that they call two other action creators
(&lt;tt class="docutils literal"&gt;toggleSorting&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;changeSearch&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;loadBooks&lt;/tt&gt;) and update the
&lt;span class="caps"&gt;URL&lt;/span&gt; using &lt;tt class="docutils literal"&gt;history.push&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;history&lt;/tt&gt; object is the one we had created in
the &lt;tt class="docutils literal"&gt;store.js&lt;/tt&gt; and its &lt;tt class="docutils literal"&gt;push&lt;/tt&gt; method changes the displayed &lt;span class="caps"&gt;URL&lt;/span&gt;. This
method &lt;a class="reference external" href="https://github.com/reactjs/history/blob/master/docs/Location.md#location-descriptors"&gt;uses a location descriptor&lt;/a&gt; that contains
an attribute for the path name and an attribute for the query parameters
- in or case we just want to update the query parameters (i.e &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;#/url/?search=query1&amp;amp;sorting=query2&lt;/span&gt;&lt;/tt&gt;),
so we pass an obect with only the &lt;tt class="docutils literal"&gt;search&lt;/tt&gt; attribute. The &lt;tt class="docutils literal"&gt;formatUrl&lt;/tt&gt; function, to
which the books state slice is passsed, is a rather simple function
that checks if either the sorting or the search should exist in th &lt;span class="caps"&gt;URL&lt;/span&gt; and
returns the full &lt;span class="caps"&gt;URL&lt;/span&gt;. This function is contained in the &lt;tt class="docutils literal"&gt;util/formatters.s&lt;/tt&gt; module.&lt;/p&gt;
&lt;p&gt;The following thunk action creators are used for asynchronous, ajax&amp;nbsp;queries:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;search&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;
        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sb"&gt;`//127.0.0.1:8000/api/books/?format=json&amp;amp;page=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="sb"&gt;`&amp;amp;ordering=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="sb"&gt;`&amp;amp;search=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadingChanged&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;setTimeout&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showBooksResult&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
                &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadingChanged&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
            &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;loadBookAction&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sb"&gt;`//127.0.0.1:8000/api/books/&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;/?format=json`&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadingChanged&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showBookResult&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadingChanged&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadSubCategories&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;category&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;loadAuthors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// similar to loadBooks&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;loadAuthor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// similar to loadBook&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;loadCategories&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="c1"&gt;// similar to loadBooks&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;loadSubCategories&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;category&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nx"&gt;category&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showSubCategoriesResult&lt;/span&gt;&lt;span class="p"&gt;([]));&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sb"&gt;`//127.0.0.1:8000/api/subcategories/?format=json&amp;amp;category=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;category&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showSubCategoriesResult&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;loadBooks&lt;/tt&gt; thunk action creator creates the &lt;span class="caps"&gt;URL&lt;/span&gt; parameters that should
be passed to the &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; using the &lt;tt class="docutils literal"&gt;getState()&lt;/tt&gt; method that returns the current state.
It then dispatches the &lt;tt class="docutils literal"&gt;loadingChanged&lt;/tt&gt; action so that the &lt;tt class="docutils literal"&gt;ui.isLoading&lt;/tt&gt; will be
changed to true. After that it asynchronously calls the load books &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; passing
it the created url and returns.
Since this is a thunk action there&amp;#8217;s no problem that nothing is returned. When the
ajax call returns it will dispatch the &lt;tt class="docutils literal"&gt;showBooksResult&lt;/tt&gt;, passing the book data to
change the state with the loaded book data and the &lt;tt class="docutils literal"&gt;loadingChanged&lt;/tt&gt; to hide the loading
spinner. Also, please notice that I&amp;#8217;ve put the return of the ajax call inside a &lt;tt class="docutils literal"&gt;setTimeout&lt;/tt&gt;
to emulate a 1 second delay and be able to see the loading&amp;nbsp;spinner.&lt;/p&gt;
&lt;p&gt;I may have used
setTimeout in some other places to make sure to be able to emulate server-side delays so
&lt;em&gt;please don&amp;#8217;t forget to remove these &amp;#8220;setTimeout&amp;#8220;s from your&amp;nbsp;code!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;loadBook&lt;/tt&gt; is more or less the same - however here only a single book&amp;#8217;s data will
be loaded. When this book is loaded the &lt;tt class="docutils literal"&gt;loadSubCategories&lt;/tt&gt; action will also be dispatched,
passing it the loaded book&amp;#8217;s category (so that the correct subcategories based on the category
will be displayed to the&amp;nbsp;form).&lt;/p&gt;
&lt;p&gt;I won&amp;#8217;t go into any detail about the other thunk action creators, they are simpler than those
we&amp;#8217;ve already described, except &lt;tt class="docutils literal"&gt;loadSubCategories&lt;/tt&gt;: This one, checks if there&amp;#8217;s a category
and if not it will just set the displayed subcategories to and empty list (by dispatching
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;showSubCategoriesResult([])&lt;/span&gt;&lt;/tt&gt;). If the category is not empty, it will retrieve asynchronously the
subcategories of the passed&amp;nbsp;category.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="components-app-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;components/app.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;We&amp;#8217;ll now start explaining the actual react components (modified to be used through redux of course).
The parent of all other components is the &lt;tt class="docutils literal"&gt;App&lt;/tt&gt; which, as we&amp;#8217;ve already seen in &lt;tt class="docutils literal"&gt;main.js&lt;/tt&gt;
is connected with the parent&amp;nbsp;route:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;App&lt;/span&gt; &lt;span class="kr"&gt;extends&lt;/span&gt; &lt;span class="nx"&gt;React&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Component&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

    &lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;isLoading&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ui&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;

            &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;children&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;NotificationContainer&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;LoadingContainer&lt;/span&gt; &lt;span class="nx"&gt;isLoading&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;isLoading&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;

            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;br&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;

            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;StatPanel&lt;/span&gt; &lt;span class="nx"&gt;bookLength&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;authorLength&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Link&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;Books&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Link&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Link&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/authors/&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;Authors&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Link&amp;gt;&lt;/span&gt;

        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;componentDidMount&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;loadAuthors&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;loadAuthors&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;mapStateToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;ui&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;mapDispatchToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;bindActionCreators&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;loadAuthors&lt;/span&gt;
&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="nx"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;mapStateToProps&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;mapDispatchToProps&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="nx"&gt;App&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As we can see, there&amp;#8217;s an internal component (named &lt;tt class="docutils literal"&gt;App&lt;/tt&gt;) but we export the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;connect``ed&lt;/span&gt; component.
One interesting thing to notice is that ``App&lt;/tt&gt; is an &lt;span class="caps"&gt;ES6&lt;/span&gt; class based react component (i.e it extends
&lt;tt class="docutils literal"&gt;React.Component&lt;/tt&gt; &amp;#8212; I&amp;#8217;ll talk a bit about these components while taking a look at
the &lt;tt class="docutils literal"&gt;BookSearchPanel&lt;/tt&gt; which has some more interesting&amp;nbsp;features).&lt;/p&gt;
&lt;p&gt;Concerning the exported,
connected component, it
uses &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; for defining the state attributes that should be passed as properties
to the componnt (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;state.{books,&lt;/span&gt; authors, ui}&lt;/tt&gt;) and &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; for defining the &lt;tt class="docutils literal"&gt;props&lt;/tt&gt; methods that will
dispatch actions. To make &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; more compact I&amp;#8217;ve used the &lt;tt class="docutils literal"&gt;bindActionCreators&lt;/tt&gt; method from redux.
This method gets an object whose values are action creators and the &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; (from store) and returns an object
whose values are the dispatch-enabled corresponding action creators. So, in our case
the returned object would be something&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt;
    &lt;span class="nx"&gt;loadAuthors&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadAuthors&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This object of course could be created by hand, however &lt;tt class="docutils literal"&gt;bindActionCreators&lt;/tt&gt; would be really useful if we wanted
to dispatch lots of actions in a component (or if we had seperated our action creators to different modules) &amp;#8212;
we could for example do something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="nx"&gt;as&lt;/span&gt; &lt;span class="nx"&gt;actions&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;../actions&amp;#39;&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;mapDispatchToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;bindActionCreators&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;actions&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;import *&lt;/tt&gt; statemenet will create an object named item that will have all the exported actions and then
&lt;tt class="docutils literal"&gt;bindActionCreators&lt;/tt&gt; will return an object that dispatches these actions &amp;#8212; passing this &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt;
to connect will allow your component to call every action and automatically dispatch&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;The internal component returns a &lt;tt class="docutils literal"&gt;&amp;lt;div /&amp;gt;&lt;/tt&gt; containing, among others &lt;tt class="docutils literal"&gt;{this.props.children}&lt;/tt&gt; - this
will be provided by rendering the child routes. It also renders a &lt;tt class="docutils literal"&gt;NotificationContainer&lt;/tt&gt; to render the notifications, a
&lt;tt class="docutils literal"&gt;LoadingContainer&lt;/tt&gt; to display a css &amp;#8220;loading&amp;#8221; spinner and a &lt;tt class="docutils literal"&gt;StatPanel&lt;/tt&gt; to display some stats about books and
authors. It also renders two Links one for the books table and one for the authors&amp;nbsp;table.&lt;/p&gt;
&lt;p&gt;Beyond these, when the component is mounted it checks if the authors and books have been loaded and if not, it
dispatches the &lt;tt class="docutils literal"&gt;loadBooks&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;loadAuthors&lt;/tt&gt; actions (remember, because we used &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; by
calling these methods from &lt;tt class="docutils literal"&gt;props&lt;/tt&gt; they&amp;#8217;ll be automatically dspatched when&amp;nbsp;called).&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s take a quick look at the three small components that are contained in &lt;tt class="docutils literal"&gt;App&lt;/tt&gt;&lt;/p&gt;
&lt;div class="section" id="components-notification-js"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id19"&gt;components/notification.js&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;This component is responsible for displaying a notification if there&amp;#8217;s an active one.
It also defines an internal component and exports a connected version of it, passing it the
&lt;tt class="docutils literal"&gt;notification&lt;/tt&gt; slice of the state tree and an &lt;tt class="docutils literal"&gt;onHide&lt;/tt&gt; method that dispatches the
&lt;tt class="docutils literal"&gt;hidNotification&lt;/tt&gt; action.&lt;/p&gt;
&lt;p&gt;When the internal component is rendered, it checks to see if the notification should be
displayed (&lt;tt class="docutils literal"&gt;isActive&lt;/tt&gt; will be true if there&amp;#8217;s an actual message) and select the color
of the background. Finally, it passes this information along with some styling
to the real &lt;tt class="docutils literal"&gt;Notification&lt;/tt&gt;  component from &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;react-notification&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;NotificationContainer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;notification_type&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;notification&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;onHide&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;isActive&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;color&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="k"&gt;switch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;notification_type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;SUCCESS&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;success&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ERROR&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;danger&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;INFO&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
            &lt;span class="nx"&gt;color&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;info&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Notification&lt;/span&gt;
        &lt;span class="nx"&gt;isActive&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;isActive&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="nx"&gt;dismissAfter&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="nx"&gt;onDismiss&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="p"&gt;()=&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;onHide&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;X&amp;#39;&lt;/span&gt;
        &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="p"&gt;()=&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;onHide&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="nx"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{{&lt;/span&gt;
            &lt;span class="nx"&gt;bar&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;background&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;color&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;color&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;black&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;fontSize&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;2rem&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="p"&gt;},&lt;/span&gt;
            &lt;span class="nx"&gt;active&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;left&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;3rem&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="p"&gt;},&lt;/span&gt;
            &lt;span class="nx"&gt;action&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;color&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#FFCCBC&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;fontSize&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;3rem&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="nx"&gt;border&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1 pt solid black&amp;#39;&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}}&lt;/span&gt;
    &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;mapStateToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="nx"&gt;notification&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;notification&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;mapDispatchToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="nx"&gt;onHide&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;hideNotification&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="nx"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;mapStateToProps&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;mapDispatchToProps&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="nx"&gt;NotificationContainer&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;style={{&lt;/span&gt; .. }}&lt;/tt&gt; snippet above: The external &lt;tt class="docutils literal"&gt;{}&lt;/tt&gt; are the Javascript code
inclusion tags of &lt;span class="caps"&gt;JSX&lt;/span&gt; while the internal &lt;tt class="docutils literal"&gt;{}&lt;/tt&gt; are for creating a normal javascript object
that defines the styling of the&amp;nbsp;notification.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="creating-a-re-usable-notification"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id20"&gt;Creating a re-usable&amp;nbsp;notification&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Please notice that although I&amp;#8217;ve implemented this as a connected component this is not the only
way to do it! Actually, probably my implementation is less-reusable from the others I will&amp;nbsp;propose&amp;#8230;&lt;/p&gt;
&lt;p&gt;In any case, instead of implementing &lt;tt class="docutils literal"&gt;NotificationContainer&lt;/tt&gt; as a connected component we could
have implemented it as a normal, non connected component that would receive two properties
from its parent:
the &lt;tt class="docutils literal"&gt;notification&lt;/tt&gt; slice of state and an &lt;tt class="docutils literal"&gt;onHide&lt;/tt&gt; function that would dispatch
&lt;tt class="docutils literal"&gt;hideNotification&lt;/tt&gt;. Doing this would be very easy, just change
&lt;tt class="docutils literal"&gt;App&lt;/tt&gt; so that its &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; would also return the &lt;tt class="docutils literal"&gt;notification&lt;/tt&gt; slice of
the state - and pass this slice as a property to the &lt;tt class="docutils literal"&gt;NotificationContainer&lt;/tt&gt;. Also, the
&lt;tt class="docutils literal"&gt;onHide&lt;/tt&gt; method should have been also defined in the &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; of &lt;tt class="docutils literal"&gt;App&lt;/tt&gt; and
passed as a property to &lt;tt class="docutils literal"&gt;NotificationContainer&lt;/tt&gt;. Notice that this makes &lt;tt class="docutils literal"&gt;NotificationContainer&lt;/tt&gt;
a reusable component since we could pass anything we wanted as the &lt;tt class="docutils literal"&gt;notification&lt;/tt&gt; object and
&lt;tt class="docutils literal"&gt;onHide&lt;/tt&gt; method.&lt;/p&gt;
&lt;p&gt;Also, if we needed to implement &lt;tt class="docutils literal"&gt;NotificationContainer&lt;/tt&gt; as a connected object but we still
needed it to be reusable we&amp;#8217;d then export the non-connected &lt;tt class="docutils literal"&gt;NotificationContainer&lt;/tt&gt;
and create a bunch of &lt;tt class="docutils literal"&gt;ConnectedNotificationContainer&lt;/tt&gt; that would
define &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt;
and export the connected component. This way, each &lt;tt class="docutils literal"&gt;ConnecteNotificationContainer&lt;/tt&gt; would
receive a different state slice and a different &lt;tt class="docutils literal"&gt;onHide&lt;/tt&gt; method, for example we may had
different notifications for books and different notifications for authors. Notice that this
approach, i.e create a reusable non-connected component and use it to create connected
components by defining their &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; is the
approach proposed by react-redux to create&amp;nbsp;components.&lt;/p&gt;
&lt;p&gt;Finally, one last comment on this approach that may clarify more
the purpose of  &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; and
&lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; of connected components
is that these two functions are &lt;em&gt;dual&lt;/em&gt;&amp;nbsp;(mirror):&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Using &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; we define which parts of the state will actually be passed to the component (= reading the&amp;nbsp;state).&lt;/li&gt;
&lt;li&gt;Using &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; we define the actions which will be dispatched by the component (= changing/writing the&amp;nbsp;state)&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="components-loading-js"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id21"&gt;components/loading.js&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;This is a really simple component: If the &lt;tt class="docutils literal"&gt;isLoading&lt;/tt&gt; parameter is true, display a &lt;tt class="docutils literal"&gt;div&lt;/tt&gt; with the &lt;tt class="docutils literal"&gt;loading&lt;/tt&gt; class:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;isLoading&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;isLoading&lt;/span&gt;&lt;span class="o"&gt;?&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;loading&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;Loading&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="mi"&gt;8230&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;:null}&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The important thing here is what the &lt;tt class="docutils literal"&gt;loading&lt;/tt&gt; class does to display the spinner - I&amp;#8217;m leaving it to you to check
it at &lt;tt class="docutils literal"&gt;static/cssloader.css&lt;/tt&gt; (this is not my css code - I&amp;#8217;ve copied it from &lt;a class="reference external" href="http://codepen.io/MattIn4D/pen/LiKFC"&gt;http://codepen.io/MattIn4D/pen/LiKFC&lt;/a&gt;&amp;nbsp;).&lt;/p&gt;
&lt;p&gt;Also, please notice that in this module we just export a function, taking an object which
has an &lt;tt class="docutils literal"&gt;isLoading&lt;/tt&gt; attribute as a parameter. That&amp;#8217;s a functional react component: A
function that gets a &lt;tt class="docutils literal"&gt;params&lt;/tt&gt; object as an input and implements the render method,
returning a&amp;nbsp;component.&lt;/p&gt;
&lt;p&gt;Using functional components is recommended for reasons that
are far too obvious (easy to test - just call the function, idemponent - no state
to keep track of, less code to write, easier to the eye, &lt;em&gt;functional&lt;/em&gt; )
- you should use class based components only when absolutely
necessary (i.e when the component needs to keep some local state or when it needs
to do stuff on &lt;tt class="docutils literal"&gt;componentWillMount&lt;/tt&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="components-statpanel-js"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id22"&gt;components/StatPanel.js&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Another very simple functional component - just display the number of books and authors from the passed&amp;nbsp;parameter.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="components-bookpanel-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id23"&gt;components/BookPanel.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Continuing our top-down approach on exploring the project, we&amp;#8217;ll now talk
about the &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; component which is displayed by the &lt;tt class="docutils literal"&gt;IndexRoute&lt;/tt&gt;.
Before talking about the actual component, I&amp;#8217;d like to present
the &lt;tt class="docutils literal"&gt;getCols&lt;/tt&gt; function that is used to create an array of the columns
that will be displayed by the &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; we render in this&amp;nbsp;panel.&lt;/p&gt;
&lt;p&gt;As we can see, the &lt;tt class="docutils literal"&gt;getCols&lt;/tt&gt; gets one parameter which is the sort method &amp;#8212;
this method gets a string and uses it to toggle sorting by this string.
We use a function to create the columns instead of a constant because
that &lt;tt class="docutils literal"&gt;sort_function&lt;/tt&gt; needs to &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; an action &amp;#8212; &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; is available from
the &lt;tt class="docutils literal"&gt;props&lt;/tt&gt; that the functional &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; component receives so the function
will be called from inside that functional&amp;nbsp;component.&lt;/p&gt;
&lt;p&gt;Each column, has up to four&amp;nbsp;parameters:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;key&lt;/tt&gt; which is the attribute  of the &lt;tt class="docutils literal"&gt;row&lt;/tt&gt; object to&amp;nbsp;display&lt;/li&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;title&lt;/tt&gt; which is the column&amp;nbsp;title&lt;/li&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;format&lt;/tt&gt; (optional) which may be used to display the value of that column&amp;nbsp;and&lt;/li&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;sorting&lt;/tt&gt; (optional) which is a function that will be called when the column title is clicked (so that the sorting is changed ) - this attribute is created using the &lt;tt class="docutils literal"&gt;sort_method&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We&amp;#8217;ll see how these attributes are used by the &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; in the corresponding section. Five
columns have been defined: &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; (which, when clicked will update the book
that&amp;#8217;s where &lt;tt class="docutils literal"&gt;format&lt;/tt&gt; is used), &lt;tt class="docutils literal"&gt;title&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;category_name&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;publish_date&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;author_name&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;getCols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;sort_method&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ID&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;format&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Link&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="sb"&gt;`/book_update/&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;/`&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Link&amp;gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;sort_method&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;sort_method&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;category_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Category&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;sort_method&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;subcategory__name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;publish_date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Publish date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;sort_method&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;publish_date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;sort_method&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;author__last_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)},&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The actual (exported) &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; is a connected component - we need to use connect because we can&amp;#8217;t
actually pass properties or &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; to this component since it is
rendered through a route (and not as a child of another component), so it
must be connected to the store through &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt; to be able to receive
state attributes and &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt;. We pass the &lt;tt class="docutils literal"&gt;books&lt;/tt&gt; state
slice as a property using &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; and use the same techique as
before in &lt;tt class="docutils literal"&gt;App&lt;/tt&gt;  with
&lt;tt class="docutils literal"&gt;bindActionCreators&lt;/tt&gt; to create auto-dispatchable&amp;nbsp;actions.&lt;/p&gt;
&lt;p&gt;As we can see, after retrieving the needed properties from the &lt;tt class="docutils literal"&gt;books&lt;/tt&gt; state slice
and the actions to dispatch, we define an &lt;tt class="docutils literal"&gt;onSearchChanged&lt;/tt&gt; function that will be
passed to the &lt;tt class="docutils literal"&gt;BookSearchPanel&lt;/tt&gt; to be called when the search query is&amp;nbsp;changed.&lt;/p&gt;
&lt;p&gt;Next, the &lt;tt class="docutils literal"&gt;sort_method&lt;/tt&gt; is defined. This is
a function that gets a &lt;tt class="docutils literal"&gt;key&lt;/tt&gt; parameter and returns another function that
dispatches &lt;tt class="docutils literal"&gt;toggleSortingAndLoadBooks&lt;/tt&gt; passing it that &lt;tt class="docutils literal"&gt;key&lt;/tt&gt;. This is the
parameter that is passed to &lt;tt class="docutils literal"&gt;getCols&lt;/tt&gt;. So, for example for the &lt;tt class="docutils literal"&gt;id&lt;/tt&gt;,
the result of the &lt;tt class="docutils literal"&gt;sort_method&lt;/tt&gt; would be the following function:
&lt;tt class="docutils literal"&gt;() =&amp;gt; &lt;span class="pre"&gt;toggleSortingAndLoadBooks('id')&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Finally, the &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; renders the&amp;nbsp;following:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;BookSearchPanel&lt;/tt&gt; passing it the &lt;tt class="docutils literal"&gt;search&lt;/tt&gt; property and the &lt;tt class="docutils literal"&gt;onSearchChanged&lt;/tt&gt; action&lt;/li&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;Link&lt;/tt&gt; to create a new&amp;nbsp;book&lt;/li&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; passing it the &lt;tt class="docutils literal"&gt;sorting&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;rows&lt;/tt&gt; parameters and the &lt;tt class="docutils literal"&gt;cols&lt;/tt&gt; constant we just&amp;nbsp;defined&lt;/li&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;PagingPanel&lt;/tt&gt; passing it the total number of books (&lt;tt class="docutils literal"&gt;count&lt;/tt&gt;), the current page (&lt;tt class="docutils literal"&gt;page&lt;/tt&gt;) and two methods &lt;tt class="docutils literal"&gt;onNextPage&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;onPreviousPage&lt;/tt&gt; that will be called when switch to the next or previous&amp;nbsp;page.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As we can see, the &lt;tt class="docutils literal"&gt;onNextPage&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;onPreviousPage&lt;/tt&gt; functions dispach the &lt;tt class="docutils literal"&gt;changePage&lt;/tt&gt; action passing it
the page to change to and reload the books by dispatch &lt;tt class="docutils literal"&gt;loadBooks&lt;/tt&gt;. Instead of this we could create
a &lt;tt class="docutils literal"&gt;changePageAndLoadBooks&lt;/tt&gt; thunk action creator that would call these two methods when dispatched
(similarly to how &lt;tt class="docutils literal"&gt;changeSearchAndLoadBooks&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;toggleSortingAndLoadBooks&lt;/tt&gt; have been implemented)
- I&amp;#8217;m leaving it like this to show all&amp;nbsp;possibilities:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;BookPanel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;search&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;changePage&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;toggleSortingAndLoadBooks&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;changeSearchAndLoadBooks&lt;/span&gt;  &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;onSearchChanged&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;query&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;changeSearchAndLoadBooks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;query&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;sort_method&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;toggleSortingAndLoadBooks&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;cols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;getCols&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sort_method&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;BookSearchPanel&lt;/span&gt; &lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;onSearchChanged&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;onSearchChanged&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;row&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;twelve columns&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;h3&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;Book&lt;/span&gt; &lt;span class="nx"&gt;list&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Link&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button button-primary&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{{&lt;/span&gt;&lt;span class="nx"&gt;fontSize&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1em&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/book_create/&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;+&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Link&amp;gt;&amp;lt;/h3&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Table&lt;/span&gt; &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;cols&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;PagingPanel&lt;/span&gt; &lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;onNextPage&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;changePage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="p"&gt;}}&lt;/span&gt; &lt;span class="nx"&gt;onPreviousPage&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;changePage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="p"&gt;}}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;mapStateToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;mapDispatchToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="nx"&gt;bindActionCreators&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="nx"&gt;loadBooks&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;changePage&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;toggleSortingAndLoadBooks&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;changeSearchAndLoadBooks&lt;/span&gt;
&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="nx"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;mapStateToProps&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;mapDispatchToProps&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="nx"&gt;BookPanel&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;div class="section" id="components-booksearchpanel-js"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id24"&gt;components/BookSearchPanel.js&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;BookSearchPanel&lt;/tt&gt; is a component used for searching books. What
is interesting about this component is that it has internal state (i.e
state that is not reflected to the global search tree). Notice that
&lt;tt class="docutils literal"&gt;BookSearchPanel&lt;/tt&gt; is an &lt;span class="caps"&gt;ES6&lt;/span&gt; class component. Here are some of its
characteristics as opposed to non-&lt;span class="caps"&gt;ES6&lt;/span&gt; react&amp;nbsp;components:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;It extends &lt;tt class="docutils literal"&gt;React.Component&lt;/tt&gt; instead of using &lt;tt class="docutils literal"&gt;React.CreateClass&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;It has a constructor that initializes the local state instead of implementing &lt;tt class="docutils literal"&gt;getInitialState&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;It does not automatically bind the methods to &lt;tt class="docutils literal"&gt;this&lt;/tt&gt; so we do it in the constructor (or else &lt;tt class="docutils literal"&gt;this&lt;/tt&gt; would be undefined in &lt;tt class="docutils literal"&gt;onSearchChange&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;onClearSearch&lt;/tt&gt;) - &lt;em&gt;be very careful with that, its a common&amp;nbsp;problem&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, what happens
here? We render an &lt;span class="caps"&gt;HTML&lt;/span&gt; &lt;tt class="docutils literal"&gt;input&lt;/tt&gt; element and call &lt;tt class="docutils literal"&gt;this.onSearchChange&lt;/tt&gt;
method. This method retrieves the current value of the input (using &lt;tt class="docutils literal"&gt;this.refs&lt;/tt&gt;)
and, if the previous change was more than 400 ms ago calls the provided
(through &lt;tt class="docutils literal"&gt;props&lt;/tt&gt;) &lt;tt class="docutils literal"&gt;onSearchChanged&lt;/tt&gt; method that will dispatch the
&lt;tt class="docutils literal"&gt;changeSearchAndLoadBooks&lt;/tt&gt; action with the current value as a parameter
(notice however that &lt;tt class="docutils literal"&gt;this.setState&lt;/tt&gt; is &lt;em&gt;always&lt;/em&gt; called immediately or else the
user keypresses wouldn&amp;#8217;t be reflected to the&amp;nbsp;input).&lt;/p&gt;
&lt;p&gt;The whole thing with the &lt;tt class="docutils literal"&gt;ths.promise&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;clearInterval&lt;/tt&gt; is to make
sure that the provided &lt;tt class="docutils literal"&gt;onSearchChanged&lt;/tt&gt; will not be called too often
(i.e it will be called 400 ms after the last&amp;nbsp;keypress):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;SearchPanel&lt;/span&gt; &lt;span class="kr"&gt;extends&lt;/span&gt; &lt;span class="nx"&gt;React&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Component&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;constructor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kr"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onSearchChange&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onSearchChange&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onClearSearch&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onClearSearch&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;row&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;one-fourth column&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="nx"&gt;Filter&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;nbsp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt; &lt;span class="nx"&gt;ref&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;search&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;search&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;defaultValue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;onChange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onSearchChange&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                    &lt;span class="p"&gt;{(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="o"&gt;||&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;button&lt;/span&gt; &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onClearSearch&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/button&amp;gt;:&amp;#39;&amp;#39;}&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;onSearchChange&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;query&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;ReactDOM&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;findDOMNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;refs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;promise&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;clearInterval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;promise&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setState&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
            &lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;query&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;promise&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;setTimeout&lt;/span&gt;&lt;span class="p"&gt;(()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onSearchChanged&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;query&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;onClearSearch&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setState&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
            &lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onSearchChanged&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;undefined&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let&amp;#8217;s take a closer look at the &lt;tt class="docutils literal"&gt;&amp;lt;input&amp;gt;&lt;/tt&gt; element:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt; &lt;span class="nx"&gt;ref&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;search&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;search&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;defaultValue&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;search&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;onChange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onSearchChange&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;ref&lt;/tt&gt; property is used to reference this element using &lt;tt class="docutils literal"&gt;ReactDOM.findDOMNode&lt;/tt&gt; - that&amp;#8217;s
one possible way to retrieve the value of this object. Another way would be to add an &lt;tt class="docutils literal"&gt;event&lt;/tt&gt;
parameter to &lt;tt class="docutils literal"&gt;onSearchChange&lt;/tt&gt; - this parameter would receive the &lt;span class="caps"&gt;DOM&lt;/span&gt; event of the change so
the value of the element could be retrieved using &lt;tt class="docutils literal"&gt;event.target.value&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The difference between the &lt;tt class="docutils literal"&gt;defaultValue&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;value&lt;/tt&gt; parameters is really important: The
&lt;tt class="docutils literal"&gt;defaultValue&lt;/tt&gt; is just the initial value of this specific input and it will be equal to
&lt;tt class="docutils literal"&gt;props.search&lt;/tt&gt; (so that if the user enters a &lt;span class="caps"&gt;URL&lt;/span&gt; which has a search query parameter this will
be pre-filled here). On the other hand, the &lt;tt class="docutils literal"&gt;value&lt;/tt&gt; parameter is the current value of
the element and will be equal to the &lt;tt class="docutils literal"&gt;state.search&lt;/tt&gt;. When the user types in the input,
the &lt;tt class="docutils literal"&gt;onSearchChange&lt;/tt&gt; will be called which will &lt;em&gt;always&lt;/em&gt; change the &lt;tt class="docutils literal"&gt;state.search&lt;/tt&gt;
and the &lt;tt class="docutils literal"&gt;value&lt;/tt&gt; will get the correct, new value (or
else the change wouldn&amp;#8217;t be reflected to the&amp;nbsp;user)!&lt;/p&gt;
&lt;p&gt;Finally concerning the clear search query button,
when there&amp;#8217;s a search query a  &lt;tt class="docutils literal"&gt;x&lt;/tt&gt; button will be displayed
if there&amp;#8217;s something to the input field which, when
clicked the search local state will be cleared
and the provided &lt;tt class="docutils literal"&gt;onSearchChanged&lt;/tt&gt; will be called with an empty&amp;nbsp;query.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="components-table-js"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id25"&gt;components/Table.js&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; is a reusable, functional react component that is used for both books and&amp;nbsp;authors.&lt;/p&gt;
&lt;p&gt;First of all, we define a formatHeader function that is used to format the
table header: This function gets an object with key and label as parameters (which
is the column to be formated) and a sorting parameter (which is the current table&amp;#8217;s
sorting) and returns the label with a &lt;tt class="docutils literal"&gt;'+'&lt;/tt&gt; in front of it if the sorting is ascending
by this column or a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;'-'&lt;/span&gt;&lt;/tt&gt; if the sorting is descending by this column or just the
label if this column is not used for&amp;nbsp;sorting:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;formatHeader&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;+&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt;
uses the props we mentioned before when talking about
&lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt;. When it is rendered, the headers of the table are constructed by
applying a map method on the items of the &lt;tt class="docutils literal"&gt;cols&lt;/tt&gt; attribute. Remember that map
will apply a function to all items of a list and return a new list with the results.
So this will create a list of correctly formatted &lt;tt class="docutils literal"&gt;&amp;lt;th&amp;gt;&lt;/tt&gt; elements.&lt;/p&gt;
&lt;p&gt;In our case, the mapper
checks if each column has a &lt;tt class="docutils literal"&gt;sorting&lt;/tt&gt; attribute and if yes it
creates a clickable header that calls &lt;tt class="docutils literal"&gt;sorting&lt;/tt&gt; when clicked and is
formatted with &lt;tt class="docutils literal"&gt;formatHeader&lt;/tt&gt; (remember &lt;tt class="docutils literal"&gt;sort_method&lt;/tt&gt; we talked about
in &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt;). If there&amp;#8217;s no &lt;tt class="docutils literal"&gt;sorting&lt;/tt&gt; for that column it just
displays the column&amp;nbsp;header.&lt;/p&gt;
&lt;p&gt;The rows of the table are created using two maps, one that maps the &lt;tt class="docutils literal"&gt;rows&lt;/tt&gt;
which, for each row maps &lt;tt class="docutils literal"&gt;cols&lt;/tt&gt; to get the individual values for this row and column.
So, for the rows a list of &lt;tt class="docutils literal"&gt;&amp;lt;tr&amp;gt;&lt;/tt&gt; elements each one including the correct
&lt;tt class="docutils literal"&gt;&amp;lt;td&amp;gt;&lt;/tt&gt; elements will be&amp;nbsp;created:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;th&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="o"&gt;?&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="nx"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;preventDefault&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;formatHeader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;sorting&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/a&amp;gt;:col.label&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/th&amp;gt;)&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;rows&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;row&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;tr&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;row&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;td&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="p"&gt;{(&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;format&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;row&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;row&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="p"&gt;])}&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/td&amp;gt;)&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/tr&amp;gt;)&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;table&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;thead&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;tr&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/tr&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/thead&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;tbody&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/tbody&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/table&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;key&lt;/tt&gt; property I am passing to all elements that belong to a list is to
help React identify these child elements - we&amp;#8217;d get a &lt;tt class="docutils literal"&gt;Warning: Each
child in an array or iterator should have a unique &amp;quot;key&amp;quot; prop.&lt;/tt&gt;
error without this&amp;nbsp;property.&lt;/p&gt;
&lt;p&gt;Also, please notice that the &lt;tt class="docutils literal"&gt;const headers&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;rows&lt;/tt&gt; we&amp;#8217;ve defined are there just
for clarity - we could instead put them directly inside the returned &lt;tt class="docutils literal"&gt;&amp;lt;table&amp;gt;&lt;/tt&gt;
and have a cool, totally &lt;em&gt;functional function&lt;/em&gt;!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="components-pagingpanel-js"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id26"&gt;components/PagingPanel.js&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Another functional and reusable component - this one has  params with the
attributes &lt;tt class="docutils literal"&gt;page&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;page_size&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;count&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;onNextPage&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;onPreviousPage&lt;/tt&gt; and, after finding out the total number of pages
it renders the current page number and the total pages number along
with two buttons that will execute the &lt;tt class="docutils literal"&gt;onNextPage&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;onPreviousPage&lt;/tt&gt;
that are passed as properties (these methods will dispatch the changePage and
loadBooks actions as we&amp;#8217;ve already seen in &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt;). One thing to notice
here is that the next and previous page buttons will only be rendered if
we are not in the first or last page (so if there&amp;#8217;s only one page you won&amp;#8217;t
see any&amp;nbsp;buttons).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;page_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;onNextPage&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;onPreviousPage&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;total_pages&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;count&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nx"&gt;page_size&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;row&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;:&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;button&lt;/span&gt; &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;preventDefault&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="nx"&gt;onPreviousPage&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/button&amp;gt;}&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;nbsp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;Page&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;total_pages&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;nbsp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="nx"&gt;total_pages&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;:&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;button&lt;/span&gt; &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;preventDefault&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
            &lt;span class="nx"&gt;onNextPage&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/button&amp;gt;}&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The same paging panel could be used for any table we wanted to have paging: Just pass it
the page number, page size, total number of items and what to do when next or previous page
buttons are&amp;nbsp;clicked.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="interlude-a-more-functional-component"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id27"&gt;Interlude: A more functional&amp;nbsp;component&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;How could we make &lt;tt class="docutils literal"&gt;PagingPanel&lt;/tt&gt; more functional (i.e how could we remove the
&lt;tt class="docutils literal"&gt;const total_pages&lt;/tt&gt; definition) ? The easy way would be to just substitute it
with its definition inside the returned &lt;tt class="docutils literal"&gt;&amp;lt;div&amp;gt;&lt;/tt&gt; however we&amp;#8217;d need to substitute it &lt;em&gt;two&lt;/em&gt; times
so we&amp;#8217;d loose our precious DRYness! So we&amp;#8217;d need to think of another&amp;nbsp;way.&lt;/p&gt;
&lt;p&gt;People from the django world will be familiar with the  &lt;a class="reference external" href="https://docs.djangoproject.com/es/1.9/ref/templates/builtins/#with"&gt;with template tag&lt;/a&gt;. This tag
is used in django templates to assign a complex value to a constant and use this value
instead of the complex value. Something like&amp;nbsp;this&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
{% with simple=a.complex|calculation %}
    In here I can just use {{ simple }} instead of {{ a.complex|calculation }}!
{% endwith %}
&lt;/pre&gt;
&lt;p&gt;Having such a concept in &lt;span class="caps"&gt;ES6&lt;/span&gt; would be ideal for our case! I am not sure if something
like &lt;tt class="docutils literal"&gt;with&lt;/tt&gt; actually exists, however we can really easy emulate it with a function
closure, something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;page_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;count&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;onNextPage&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;onPreviousPage&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="nx"&gt;total_pages&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;row&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;:&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;button&lt;/span&gt; &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="cm"&gt;/* ... */&lt;/span&gt; &lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;lt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/button&amp;gt;}&lt;/span&gt;
        &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;nbsp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nx"&gt;Page&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;of&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;total_pages&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;nbsp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="nx"&gt;total_pages&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="o"&gt;:&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;button&lt;/span&gt; &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="cm"&gt;/* ... */&lt;/span&gt; &lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;amp;&lt;/span&gt;&lt;span class="nx"&gt;gt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/button&amp;gt;}&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ceil&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;count&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nx"&gt;page_size&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We define a function that gets &lt;tt class="docutils literal"&gt;total_pages&lt;/tt&gt; as a parameter and returns &lt;em&gt;another function&lt;/em&gt; (
this one is the actual render method of the &lt;tt class="docutils literal"&gt;PagingPanel&lt;/tt&gt;) and &lt;em&gt;call the outer function&lt;/em&gt;
passing it the value we want to give to &lt;tt class="docutils literal"&gt;total_pages&lt;/tt&gt;. This way, the &lt;tt class="docutils literal"&gt;total_pages&lt;/tt&gt; will
have a value in the inner function! Thank you, function&amp;nbsp;closure!!!&lt;/p&gt;
&lt;p&gt;Now &lt;tt class="docutils literal"&gt;PagingPanel&lt;/tt&gt; is also a completely functional function&amp;nbsp;component!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="components-bookform"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id28"&gt;components/BookForm&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The last book-related component is &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;. This component is used to both create and update
a book. It also has a delete button for removing books. To decide if this is a create or an
update form, it relies on the parameter passed from the route - remember how the two routes have
been defined in &lt;tt class="docutils literal"&gt;main.js&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;Route&lt;/span&gt; &lt;span class="na"&gt;path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/book_create/&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;{BookForm}&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;Route&lt;/span&gt; &lt;span class="na"&gt;path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/book_update/:id&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;component&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;{BookForm}&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So, although create and update render the same component, their difference
is that update will contain the &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; of the book to be
updated in the url. This (along with any other url parameters) is passed by react-router as a property
through an object named &lt;tt class="docutils literal"&gt;params&lt;/tt&gt; to the &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; component, so, when updating a book
the &lt;tt class="docutils literal"&gt;props.params.id&lt;/tt&gt; of &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;
should have a&amp;nbsp;value.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; is a connected component (because it needs access to the state slice and dispatch and
is rendered through a route), however because it is also a redux-form, a special
method (&lt;tt class="docutils literal"&gt;reduxForm&lt;/tt&gt;) is used to connect the component and pass the form-related props to the&amp;nbsp;component:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;mapStateToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;initial&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;book&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;initial&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;book&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;books&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;categories&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;ui&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;initialValues&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;initial&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="nx"&gt;reduxForm&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="nx"&gt;form&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;bookForm&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="nx"&gt;fields&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;category&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;subcategory&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;publish_date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;],&lt;/span&gt;
    &lt;span class="nx"&gt;validate&lt;/span&gt;
&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="nx"&gt;mapStateToProps&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="nx"&gt;BookForm&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; contains a bunch of required things from the state (we need
the current &lt;tt class="docutils literal"&gt;book&lt;/tt&gt; that is edited, the &lt;tt class="docutils literal"&gt;categories&lt;/tt&gt; to select from, the &lt;tt class="docutils literal"&gt;authors&lt;/tt&gt; to also
select from and the &lt;tt class="docutils literal"&gt;ui&lt;/tt&gt; to find out if submitting has finished and render the buttons
as enabled/disabled). Beyond these, we see
that there&amp;#8217;s an &lt;tt class="docutils literal"&gt;initialValues&lt;/tt&gt; attribute to the object returned from &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt;. This
attribute is used to initialize the form fields. So if our form has
fields named &lt;tt class="docutils literal"&gt;title&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;category&lt;/tt&gt;, if the &lt;tt class="docutils literal"&gt;initial&lt;/tt&gt; object had &lt;tt class="docutils literal"&gt;title&lt;/tt&gt; and
&lt;tt class="docutils literal"&gt;category&lt;/tt&gt; attributes the form fields would be initialized by them. In our case, we just
check if the &lt;tt class="docutils literal"&gt;props.params.id&lt;/tt&gt; method is defined and the to-be-updated book has been loaded
to the state and just assign the to-be-updated &lt;tt class="docutils literal"&gt;book&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;initialValues&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;reduxForm&lt;/tt&gt; method is used to &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt; the form component: Beyond the usual
&lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; (we don&amp;#8217;t actually use &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; here
because I feel that just getting &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; is more clear),
it needs a required parameter which is the object used to initialize the redux-form form: This
object should&amp;nbsp;have&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;form&lt;/tt&gt; attribute with the name of the form. This must be unique among all forms in your application and will be used as a parameter to the actions that redux-form will&amp;nbsp;dispatch&lt;/li&gt;
&lt;li&gt;A &lt;tt class="docutils literal"&gt;fields&lt;/tt&gt; string array with the names of the form fields. For each one of them a &lt;tt class="docutils literal"&gt;field&lt;/tt&gt; will be passed to the &lt;tt class="docutils literal"&gt;props.fields&lt;/tt&gt; array in the form&amp;nbsp;component&lt;/li&gt;
&lt;li&gt;A optional &lt;tt class="docutils literal"&gt;validate&lt;/tt&gt; attribute that is a function that will be called when the form fields are&amp;nbsp;changed&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The validate function gets an object with the field names with their corresponding values as attributes and
should return another object with the field names that have an error and the error message. In our case,
we want the &lt;tt class="docutils literal"&gt;title&lt;/tt&gt; to be required and the date to be valid (if exists), so the &lt;tt class="docutils literal"&gt;validate&lt;/tt&gt; is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;validate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;values&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;errors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;title&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;errors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Required&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;publish_date&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;re&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sr"&gt;/^\d{4}-\d{2}-\d{2}$/&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nx"&gt;re&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;exec&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;publish_date&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;errors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;publish_date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Invalid&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;errors&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I just used a very simple regular expression to check the validity of
the date (it must be in the format &lt;span class="caps"&gt;YYYY&lt;/span&gt;-&lt;span class="caps"&gt;MM&lt;/span&gt;-&lt;span class="caps"&gt;DD&lt;/span&gt;) - this is just to make
a point, for normal date rendered you should use &lt;a class="reference external" href="http://momentjs.com/"&gt;moment.js&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This validate function is called &lt;em&gt;whenever a form field is changed&lt;/em&gt; so, depending on the implementation
of course, the error messages will be shown and hidden as the user types in the fields. Please notice
that when the user starts typing in a field in an empty form, this field may be valid but all other
fields will be empty - to avoid displaying an error message for fields that the user has not been yet
been able to modify, we can use the &lt;tt class="docutils literal"&gt;touched&lt;/tt&gt; property of each field &amp;#8212; only display the
field&amp;#8217;s error message if this field has been &lt;tt class="docutils literal"&gt;touched&lt;/tt&gt;. When the form is submitted all fields are
changed to &lt;tt class="docutils literal"&gt;touched&lt;/tt&gt; so all error messages will be&amp;nbsp;displayed.&lt;/p&gt;
&lt;p&gt;The internal &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; is an &lt;span class="caps"&gt;ES6&lt;/span&gt; class based component that needs to do some things
when the &lt;tt class="docutils literal"&gt;componentDidMount&lt;/tt&gt; method is&amp;nbsp;called:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Check if the categories have been loaded - if not dispatch the &lt;tt class="docutils literal"&gt;loadCategories&lt;/tt&gt; action&lt;/li&gt;
&lt;li&gt;Check if the this is an update and if yes, check to see if the to-be-updated book needs to be loaded and, if it needs dispatch &lt;tt class="docutils literal"&gt;loadBook&lt;/tt&gt; with the book&amp;#8217;s&amp;nbsp;id&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;BookForm&lt;/span&gt; &lt;span class="kr"&gt;extends&lt;/span&gt; &lt;span class="nx"&gt;React&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Component&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

    &lt;span class="nx"&gt;componentDidMount&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadCategories&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;book&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadBook&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="c1"&gt;// New book&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;fields&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;title&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;category&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;subcategory&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;publish_date&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;author&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="nx"&gt;handleSubmit&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;id&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;isSubmitting&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ui&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;subcategories&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;authors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;tsubmit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;submit&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;undefined&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;dsubmit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;del&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;undefined&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;form&lt;/span&gt; &lt;span class="nx"&gt;onSubmit&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;handleSubmit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;tsubmit&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;six columns&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Input&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Title&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;title&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;six columns&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Select&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Category&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;category&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;categories&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;onChange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;event&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                        &lt;span class="nx"&gt;category&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onChange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
                        &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadSubCategories&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;event&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;target&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
                    &lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;six columns&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Select&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Subcategory&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;subcategory&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;subcategories&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;row&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;six columns&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;DatePicker&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;u-full-width&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Publish Date&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;publish_date&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;six columns&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Select&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Author&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;author&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
                        &lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;first_name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt; &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;last_name&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="p"&gt;}))&lt;/span&gt;
                    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;button&lt;/span&gt; &lt;span class="nx"&gt;disabled&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;isSubmitting&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button button-primary&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;handleSubmit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;tsubmit&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="nx"&gt;Save&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/button&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="o"&gt;?&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;button&lt;/span&gt; &lt;span class="nx"&gt;disabled&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;isSubmitting&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button button-primary&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{{&lt;/span&gt;&lt;span class="nx"&gt;backgroundColor&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;danger&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt; &lt;span class="nx"&gt;onClick&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;dsubmit&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="nx"&gt;Delete&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/button&amp;gt;:null}&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/form&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;render&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; defines (for convenience) a bunch of constants which are
attributes of &lt;tt class="docutils literal"&gt;props&lt;/tt&gt;:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;The &lt;tt class="docutils literal"&gt;fields&lt;/tt&gt; object contains the field attributes of the form which have been defined through the &lt;tt class="docutils literal"&gt;reduxForm&lt;/tt&gt; function.&lt;/li&gt;
&lt;li&gt;The &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt; is also provided by &lt;tt class="docutils literal"&gt;reduxForm&lt;/tt&gt; and is used to submit the form - I&amp;#8217;ll explain it a bit&amp;nbsp;later&lt;/li&gt;
&lt;li&gt;The &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; is provided by &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt; (remember, &lt;tt class="docutils literal"&gt;reduxForm&lt;/tt&gt; is a special &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt;). If you don&amp;#8217;t use &lt;tt class="docutils literal"&gt;mapDispatchToProps&lt;/tt&gt; then &lt;tt class="docutils literal"&gt;connect&lt;/tt&gt; will provide &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;props&lt;/tt&gt; to use it as you&amp;nbsp;like&lt;/li&gt;
&lt;li&gt;The &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; is from the route - it will have value when updating and will be undefined when creating a new&amp;nbsp;book&lt;/li&gt;
&lt;li&gt;The &lt;tt class="docutils literal"&gt;isSubmitting&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;categories&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;subcategories&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;authors&lt;/tt&gt; are provided from the state attributes through &lt;tt class="docutils literal"&gt;mapStateToProps&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;The &lt;tt class="docutils literal"&gt;tsubmit&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;dsubmit&lt;/tt&gt; are used when the form is submitted or the Delete button is clicked. As we&amp;#8217;ll see the &lt;tt class="docutils literal"&gt;tsubmit&lt;/tt&gt; is passed as an argument to &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt; while the &lt;cite&gt;dsubmit`&lt;/cite&gt; is used as it&amp;nbsp;is.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Beyond &lt;tt class="docutils literal"&gt;fields&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt; a &lt;tt class="docutils literal"&gt;reduxForm&lt;/tt&gt; enabled form component has various other
&lt;a class="reference external" href="http://erikras.github.io/redux-form/#/api/props?_k=y5rbd2"&gt;properties that you can use&lt;/a&gt;, like &lt;tt class="docutils literal"&gt;active&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;dirty&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;error&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;pristine&lt;/tt&gt; etc.
Each &lt;tt class="docutils literal"&gt;field&lt;/tt&gt; provided from &lt;tt class="docutils literal"&gt;reduxForm&lt;/tt&gt; also has a bunch of properties, like
&lt;tt class="docutils literal"&gt;active&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;checked&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;dirty&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;error&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;onBlur&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;onChange&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;onFocus&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;pristine&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;touched&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;valid&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;value&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;visited&lt;/tt&gt;. I won&amp;#8217;t use most of these here however please make sure
that you are familiar with these when using&amp;nbsp;redux-form.&lt;/p&gt;
&lt;p&gt;After defining the constants, the &lt;tt class="docutils literal"&gt;render&lt;/tt&gt; method returns the actual component.
Here we are using a bunch of child components we&amp;#8217;ve defined to render the input
fields, like &lt;tt class="docutils literal"&gt;Input&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;DatePicker&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;Select&lt;/tt&gt; which will be explained
later. For each one of these components we pass the corresponding &lt;tt class="docutils literal"&gt;field&lt;/tt&gt;
property along with the label we want to show. There are some interesting things
in the parameters we pass to these input&amp;nbsp;components:&lt;/p&gt;
&lt;p&gt;All fields except &lt;tt class="docutils literal"&gt;category&lt;/tt&gt; use their own &lt;tt class="docutils literal"&gt;onChange&lt;/tt&gt;. For the &lt;tt class="docutils literal"&gt;category&lt;/tt&gt;
field we pass a custom &lt;tt class="docutils literal"&gt;onChange&lt;/tt&gt; function that will override the &lt;tt class="docutils literal"&gt;field&lt;/tt&gt;
onChange in order to dispatch &lt;tt class="docutils literal"&gt;loadSubCategories&lt;/tt&gt; when the &lt;tt class="docutils literal"&gt;category&lt;/tt&gt;
is changed (notice that in the custom &lt;tt class="docutils literal"&gt;onChange&lt;/tt&gt;
I actually call the &lt;tt class="docutils literal"&gt;category.onChange&lt;/tt&gt; first and then
use &lt;tt class="docutils literal"&gt;event.target.value&lt;/tt&gt; to get the current value of the dropdown to pass it
to the dispatched &lt;tt class="docutils literal"&gt;loadSubCategories&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;Select&lt;/tt&gt; fields get an &lt;tt class="docutils literal"&gt;options&lt;/tt&gt; parameter which should be an array
with &lt;tt class="docutils literal"&gt;id/name&lt;/tt&gt; objects. For &lt;tt class="docutils literal"&gt;authors&lt;/tt&gt; we create that array on the fly
using &lt;tt class="docutils literal"&gt;map&lt;/tt&gt; (since an author object has a &lt;tt class="docutils literal"&gt;first_name&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;last_name&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;The submit and delete buttons will be enabled or disabled depending on the &lt;tt class="docutils literal"&gt;isSubmitting&lt;/tt&gt; flag,
and will call &lt;tt class="docutils literal"&gt;handleClick(tsubmit)&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;dsubmit&lt;/tt&gt; correspondingly. Also, the Delete button will
be hidden if no &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; is&amp;nbsp;provided.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt; method provided by &lt;tt class="docutils literal"&gt;reduxForm&lt;/tt&gt; will run the &lt;tt class="docutils literal"&gt;validate&lt;/tt&gt; function passing it
the values from the form (notice that this is synchronous validation, we could also do asynchronous -
on the server- validation for example to immediately check if a username is already used), and if
the validation does not return any errors, it will submit the form.
Submitting the form means that &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt; will
either call &lt;tt class="docutils literal"&gt;this.props.onSubmit&lt;/tt&gt; &lt;em&gt;or&lt;/em&gt; will call the argument of &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt; (that&amp;#8217;s what
we&amp;#8217;ve done here), passing it the data of the&amp;nbsp;form.&lt;/p&gt;
&lt;p&gt;In our case, we want to pass the id of the book to be updated (or undefined when the form
is used to create a book) to the submit function, that&amp;#8217;s why I am assigning
&lt;tt class="docutils literal"&gt;submit.bind(undefined,id)&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;tsubmit&lt;/tt&gt; (which is what is passed to &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt;) - this
will return a new function with the &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; as its first argument. The &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt; also
passes the &lt;tt class="docutils literal"&gt;values&lt;/tt&gt; of the form as an object along with the &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; function, so
&lt;tt class="docutils literal"&gt;submit&lt;/tt&gt; is a function with three&amp;nbsp;arguments:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;submit&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;//127.0.0.1:8000/api/books/&amp;#39;&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;POST&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sb"&gt;`//127.0.0.1:8000/api/books/&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;/`&lt;/span&gt;
        &lt;span class="nx"&gt;type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;PUT&amp;#39;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;submittingChanged&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ajax&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
        &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;values&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;success&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;submittingChanged&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showSuccessNotification&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Success!&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;updateBookResult&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;addBookResult&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;routeActions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

        &lt;span class="p"&gt;},&lt;/span&gt;
        &lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;submittingChanged&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showErrorNotification&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sb"&gt;`Error (&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;status&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt; - &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;statusText&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;) while saving: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;responseText&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt; &lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As we can see it just checks if the &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; has a value and creates the
url and the &lt;span class="caps"&gt;HTTP&lt;/span&gt; method for the update (either a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; when creatign a new book or
a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;PUT&lt;/span&gt;&lt;/tt&gt; when updating an existing one). It will then &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; the
&lt;tt class="docutils literal"&gt;submittingChanged&lt;/tt&gt; action to change the &lt;span class="caps"&gt;UI&lt;/span&gt; (disable the buttons) and do the ajax call. When
the call returns, if everything was ok it will &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; the &lt;tt class="docutils literal"&gt;submittingChanged&lt;/tt&gt;
(with false as a parameter), the &lt;tt class="docutils literal"&gt;showSuccessNotification&lt;/tt&gt; (with success as parameter),
either &lt;tt class="docutils literal"&gt;updateBookResult&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;addBookResult&lt;/tt&gt; with the retrieved data as paramater
(depending if there was an &lt;tt class="docutils literal"&gt;id&lt;/tt&gt;) and finally it will change the &lt;span class="caps"&gt;URL&lt;/span&gt; to &lt;tt class="docutils literal"&gt;/&lt;/tt&gt; to display
the books table. If there was an error it will once again dispatch the
&lt;tt class="docutils literal"&gt;submittingChanged&lt;/tt&gt; action to turn off the submit flag of the state and
&lt;tt class="docutils literal"&gt;showErrorNotification&lt;/tt&gt; with information on the error. The url won&amp;#8217;t change
so that the user will be able to fix the error and retry&amp;nbsp;submitting.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;del&lt;/tt&gt; function is a little different. We bind not only with &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; but also
with &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; because we don&amp;#8217;t call it through &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt;
(since when deleting no validation is actually needed)
but directly as the &lt;tt class="docutils literal"&gt;onclick&lt;/tt&gt; handler of the delete button
(so we must pass dispatch&amp;nbsp;manually):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;del&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sb"&gt;`//127.0.0.1:8000/api/books/&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;/`&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DELETE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ajax&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
        &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="nx"&gt;success&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showSuccessNotification&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Success!&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;deleteBookResult&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;routeActions&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;push&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
        &lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showErrorNotification&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sb"&gt;`Error (&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;status&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt; - &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;statusText&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;) while saving: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;responseText&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt; &lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This function sends a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DELETE&lt;/span&gt;&lt;/tt&gt; method to the correct url and, if everything
was ok &lt;tt class="docutils literal"&gt;dispatches&lt;/tt&gt; the &lt;tt class="docutils literal"&gt;showSuccessNotification&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;deleteBookResult&lt;/tt&gt; and
&lt;tt class="docutils literal"&gt;routeActions.push&lt;/tt&gt;, similarly with &lt;tt class="docutils literal"&gt;submit&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;One thing that I&amp;#8217;d like to discuss here is the nature of the &lt;tt class="docutils literal"&gt;submit&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;del&lt;/tt&gt;
functions: These function do dispatch other actions but they are not implemented
as thunks so, in order
to be able to actually dispatch something they need to retrieve &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt;
as a parameter
(please remember the discussion on the redux-thunk section and the difference
between &lt;tt class="docutils literal"&gt;dispatch(actionCreator)&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;actionCreator(dispatch)&lt;/tt&gt; ). The
&lt;tt class="docutils literal"&gt;submit&lt;/tt&gt; function  receives &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; from &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt; while we pass
dispatch directly (using &lt;tt class="docutils literal"&gt;bind&lt;/tt&gt;) to the &lt;tt class="docutils literal"&gt;del&lt;/tt&gt; function.&lt;/p&gt;
&lt;p&gt;I could
have implemented them as thunks (and put them to the &lt;tt class="docutils literal"&gt;actions&lt;/tt&gt; module) however
I feel that leaving them here
will make the &lt;span class="caps"&gt;API&lt;/span&gt; of the application more compact (since if these functions
had been put in the actions module they would need to be exported so they&amp;#8217;d
be a part of the public &lt;span class="caps"&gt;API&lt;/span&gt; of this application - however these two are only
called from &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;) and also their purpose and integration with &lt;tt class="docutils literal"&gt;handleSubmit&lt;/tt&gt;
is more clear if we leave them as plain functions. This is just my personal
opinion - if for example you wanted to allow deleting a book not only from the &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;
but also from the &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; (by adding a delete button to each book row) then
you&amp;#8217;d definitely need to export &lt;tt class="docutils literal"&gt;del&lt;/tt&gt; as an action creator (preferably as a thunk action
creator to be consistent with the&amp;nbsp;others).&lt;/p&gt;
&lt;div class="section" id="components-input"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id29"&gt;components/Input&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;This is a simple functional component that gets a redux-form
text field and a label as properties and renders a text
input with a &lt;tt class="docutils literal"&gt;&amp;lt;label&amp;gt;&lt;/tt&gt; and an optional error message.
The error message will only be rendered if the field
has been touched (i.e the user has changed the field or
the form has been submitted) and there&amp;#8217;s an actual&amp;nbsp;error:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt; &lt;span class="nx"&gt;forHtml&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/label&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;u-full-width&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;touched&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{{&lt;/span&gt;&lt;span class="nx"&gt;color&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;backgroundColor&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;danger&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One thing I&amp;#8217;d like to explain is the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;{...field}&lt;/span&gt;&lt;/tt&gt; snippet
I pass to &lt;tt class="docutils literal"&gt;&amp;lt;input&amp;gt;&lt;/tt&gt;. This is the object spread operator and will
convert each attribute of the &lt;tt class="docutils literal"&gt;field&lt;/tt&gt; object to a corresponding &lt;tt class="docutils literal"&gt;attr=value&lt;/tt&gt;
pair,&amp;nbsp;i.e&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt; &lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt; &lt;span class="nx"&gt;onChange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onChange&lt;/span&gt; &lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt; &lt;span class="nx"&gt;onBlur&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;OnBlur&lt;/span&gt; &lt;span class="nx"&gt;etc&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="components-select"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id30"&gt;components/Select&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;Select&lt;/tt&gt; component renders a dropdown (select) input.
It should receive a redux-form field, a label and an array
of objects with &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;name&lt;/tt&gt; attributes that will be
rendered as the options. The &lt;tt class="docutils literal"&gt;label&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;error` will be
rendered similarly to ``Input&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt; &lt;span class="nx"&gt;forHtml&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/label&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;select&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;u-full-width&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;option&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/option&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;option&lt;/span&gt; &lt;span class="nx"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;c&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/option&amp;gt;)}&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/select&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;touched&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{{&lt;/span&gt;&lt;span class="nx"&gt;color&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;backgroundColor&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;danger&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;For the options we include an empty option (as a default value) and the other
options are created with the help of a &lt;tt class="docutils literal"&gt;map&lt;/tt&gt;. Finally, notice that I have
also used &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;...props&lt;/span&gt;&lt;/tt&gt; here in the the function parameter list to capture all parameters not
captured by &lt;tt class="docutils literal"&gt;field&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;label&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;options&lt;/tt&gt; and then pass
both &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;{...field}&lt;/span&gt;&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;{...props}&lt;/span&gt;&lt;/tt&gt; to the &lt;tt class="docutils literal"&gt;select&lt;/tt&gt; component. This is
to capture the custom &lt;tt class="docutils literal"&gt;onChange&lt;/tt&gt; (that I pass for the categories &lt;tt class="docutils literal"&gt;Select&lt;/tt&gt;)
and use that custom &lt;tt class="docutils literal"&gt;onChange&lt;/tt&gt; when the select value changes. The custom
&lt;tt class="docutils literal"&gt;onChange&lt;/tt&gt; will override the &lt;tt class="docutils literal"&gt;field.onChange&lt;/tt&gt; because the {&amp;#8230;props} is
&lt;em&gt;after&lt;/em&gt; {&amp;#8230;field}, so the resulting select will be something&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;select&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt; &lt;span class="nx"&gt;onChange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onChange&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt; &lt;span class="nx"&gt;onChange&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onChange&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is
a common idiom for overriding properties of objects that are passed
to components - for example I could pass a &lt;tt class="docutils literal"&gt;className&lt;/tt&gt; property to
&lt;tt class="docutils literal"&gt;&amp;lt;Select&amp;gt;&lt;/tt&gt; to override the default one (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;className=&amp;quot;u-full-width&amp;quot;&lt;/span&gt;&lt;/tt&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="components-datepicker"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id31"&gt;components/DatePicker&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;This component is used to render a jquery-ui datepicker. Similarly
to the other input components it receives a redux-form &lt;tt class="docutils literal"&gt;field&lt;/tt&gt;
and a &lt;tt class="docutils literal"&gt;label&lt;/tt&gt;. However, this is a
class based component because it needs to have &lt;tt class="docutils literal"&gt;this&lt;/tt&gt; for attaching
the &lt;tt class="docutils literal"&gt;datepicker&lt;/tt&gt; to an input. Beyond the normal rendering, we can
see that we have added a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;ref='date'&lt;/span&gt;&lt;/tt&gt; to the &lt;tt class="docutils literal"&gt;input&lt;/tt&gt; to allow
us to refer to it later. This ref is used by &lt;tt class="docutils literal"&gt;componentDidMount&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;handleChange&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;DatePicker&lt;/span&gt; &lt;span class="kr"&gt;extends&lt;/span&gt; &lt;span class="nx"&gt;React&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Component&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt; &lt;span class="nx"&gt;forHtml&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;name&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/label&amp;gt;&lt;/span&gt;
                &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;input&lt;/span&gt; &lt;span class="nx"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;ref&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;date&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;u-full-width&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;{...&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
                &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;touched&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{{&lt;/span&gt;&lt;span class="nx"&gt;color&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;white&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;backgroundColor&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;danger&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;}&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;componentDidMount&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ReactDOM&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;findDOMNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;refs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;date&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="nx"&gt;datepicker&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt; &lt;span class="nx"&gt;dateFormat&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;yy-mm-dd&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;});&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ReactDOM&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;findDOMNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;refs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;date&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="nx"&gt;on&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;change&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;handleChange&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;componentWillUnmount&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;handleChange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;preventDefault&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;ReactDOM&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;findDOMNode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;refs&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;date&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;value&lt;/span&gt;
        &lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;field&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;onChange&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;date&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;componentDidMount&lt;/tt&gt; retrieves the input &lt;span class="caps"&gt;DOM&lt;/span&gt; element through the &lt;tt class="docutils literal"&gt;ref&lt;/tt&gt;
and makes it a datepicker. It also sets its &lt;tt class="docutils literal"&gt;onchange&lt;/tt&gt; method to the
&lt;tt class="docutils literal"&gt;handleChange&lt;/tt&gt; method (notice the &lt;tt class="docutils literal"&gt;bind(this)&lt;/tt&gt; part &amp;#8212; this is needed
so that &lt;tt class="docutils literal"&gt;this&lt;/tt&gt; will be defined correctly inside the &lt;tt class="docutils literal"&gt;handleChange&lt;/tt&gt;). The
&lt;tt class="docutils literal"&gt;handleChange&lt;/tt&gt; retrieves the current date (once again from the &lt;tt class="docutils literal"&gt;ref&lt;/tt&gt;)
and just calls the &lt;tt class="docutils literal"&gt;onChange&lt;/tt&gt; of the provided &lt;tt class="docutils literal"&gt;field&lt;/tt&gt;, passing it the
date&amp;nbsp;value.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="should-i-create-my-own-input-components"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id32"&gt;Should I create my own input&amp;nbsp;components?&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;As you&amp;#8217;ve seen, I&amp;#8217;ve created my &lt;em&gt;own&lt;/em&gt; custom input components. These components
are created with the correct styling for the css framework I use here (&lt;tt class="docutils literal"&gt;skeleton.css&lt;/tt&gt;) but
of course with small changes could easily be modified to be used with other css frameworks
(I am using &lt;tt class="docutils literal"&gt;bootstrap 3&lt;/tt&gt; in most of my normal apps and such components work great).
They also have been created for exactly my needs (i.e get the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;redux-form&lt;/span&gt;&lt;/tt&gt; field as input,
allow overriding onChange&amp;nbsp;etc).&lt;/p&gt;
&lt;p&gt;Instead of creating your own components by hand, you could of course use some specific component
libraries like &lt;a class="reference external" href="http://www.material-ui.com/#/"&gt;material-ui&lt;/a&gt; or &lt;a class="reference external" href="https://react-bootstrap.github.io/"&gt;react-bootstrap&lt;/a&gt;. These libraries contain components
such as the &lt;tt class="docutils literal"&gt;Input&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;Select&lt;/tt&gt; we implemented here with a consistent &lt;span class="caps"&gt;API&lt;/span&gt; and
styling. Unfortunately, these components are a little more difficult to use than
just creating your&amp;nbsp;own:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;You need to learn their &lt;span class="caps"&gt;API&lt;/span&gt; (the names of the properties they get, their behavior in various conditions&amp;nbsp;etc)&lt;/li&gt;
&lt;li&gt;You need to learn their styling &lt;span class="caps"&gt;API&lt;/span&gt; (most of them make it difficult to customize their&amp;nbsp;appearence)&lt;/li&gt;
&lt;li&gt;It is not very easy to integrate them to your existing css framework (if you have one), so you&amp;#8217;ll need to go all the way to use their&amp;nbsp;styles&lt;/li&gt;
&lt;li&gt;You may need to use custom components anyway because you want to use a different javascript component that is not provided by these&amp;nbsp;libraries&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It all boils down to how big is your project and if you already have some styling for
your pages. If you want to build a rather small project or your project already has a consistent
styling then its better to create the required input components by hand. If on the other hand
you want to build a big project from scratch then probably it would be better to bite the
bullet and use a component library, but keep in mind that you may actually need to create
your own&amp;nbsp;components.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="components-authorpanel"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id33"&gt;components/AuthorPanel&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;AuthorPanel&lt;/tt&gt; uses &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; to list the authors. Since I haven&amp;#8217;t used
pagination or sorting here the component is very&amp;nbsp;simple:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;cols&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;format&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Link&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="sb"&gt;`/author_update/&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="sb"&gt;/`&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;id&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Link&amp;gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;last_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Last name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;first_name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;label&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;First name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,},&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;AuthorPanel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;row&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;div&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;twelve columns&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;h3&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;Author&lt;/span&gt; &lt;span class="nx"&gt;list&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Link&lt;/span&gt; &lt;span class="nx"&gt;className&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;button button-primary&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{{&lt;/span&gt;&lt;span class="nx"&gt;fontSize&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1em&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt; &lt;span class="nx"&gt;to&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/author_create/&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;+&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Link&amp;gt;&amp;lt;/h3&amp;gt;&lt;/span&gt;
        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Table&lt;/span&gt; &lt;span class="nx"&gt;cols&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;cols&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/div&amp;gt;&lt;/span&gt;

&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;mapStateToProps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;
    &lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nx"&gt;state&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="components-authorform"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id34"&gt;components/AuthorForm&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;AuthorForm&lt;/tt&gt; is similar to &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; and is used to
create a new author, update or delete an existing one. It uses
the &lt;tt class="docutils literal"&gt;Input&lt;/tt&gt; component to edit the first and last name
of each author. I won&amp;#8217;t go into more detail about this
component since everything must be clear by&amp;nbsp;now.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="changing-the-ui-when-the-data-is-changed"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id35"&gt;Changing the &lt;span class="caps"&gt;UI&lt;/span&gt; when the data is&amp;nbsp;changed&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Commenter Tomas Jacobsen asked for a tutorial on &lt;a class="reference external" href="http://spapas.github.io/2015/09/08/more-complex-react-flux-example/#comment-2667922265"&gt;how the &lt;span class="caps"&gt;UI&lt;/span&gt; will be updated when the data is changed in a different window&lt;/a&gt;. Well,
requirements like this is actually the reason for using react and redux I decided to add that capability to this application. If you want
to check it out, please &lt;tt class="docutils literal"&gt;git checkout&lt;/tt&gt; the tag &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;react-redux-poll-update&lt;/span&gt;&lt;/tt&gt; of the same repository (&lt;a class="reference external" href="https://github.com/spapas/react-tutorial/"&gt;https://github.com/spapas/react-tutorial/&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;This extra functionality simply checks (using polling) every few seconds if the number of authors has changed and if it has, it will reload the authors
and dispaly a notification. Beyond the &lt;span class="caps"&gt;ES6&lt;/span&gt; code, I&amp;#8217;ve added a small &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; view that returns the number of authors in the database (it just
returns a number) and a django management command that adds an author. So, to test the new functionality, run
the django application and thhen run &lt;tt class="docutils literal"&gt;python manage.py add_author&lt;/tt&gt; in a different window - after a few seconds you should see that the
authors have been updated along with a&amp;nbsp;notification.&lt;/p&gt;
&lt;p&gt;To implement the &lt;span class="caps"&gt;UI&lt;/span&gt; update in &lt;span class="caps"&gt;ES6&lt;/span&gt;, I&amp;#8217;ve added a file named &lt;tt class="docutils literal"&gt;scheduler.js&lt;/tt&gt; with the following&amp;nbsp;contents:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;./store&amp;#39;&lt;/span&gt;
&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;loadAuthors&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;showSuccessNotification&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;./actions&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kr"&gt;export&lt;/span&gt; &lt;span class="k"&gt;default&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Starting scheduler&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;window&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;setInterval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;

        &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://127.0.0.1:8000/api/authors/get_author_number/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;realAuthorNumber&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;authorNumber&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getState&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;authors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;rows&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;authorNumber&lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="nx"&gt;realAuthorNumber&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;showSuccessNotification&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Authors have changed - reloading ...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
                &lt;span class="nx"&gt;store&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;dispatch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;loadAuthors&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;
            &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;

    &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="mi"&gt;2000&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and then just import the default function from &lt;tt class="docutils literal"&gt;main.js&lt;/tt&gt; and call&amp;nbsp;it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;schedule&lt;/span&gt; &lt;span class="nx"&gt;from&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;./scheduler&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="nx"&gt;schedule&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So, we can see that every 2 seconds we retrieve (using Ajax) the number of authors and,
if their number is different than the current number of authors in the &lt;span class="caps"&gt;UI&lt;/span&gt; (which we retrieve from
the store using its &lt;tt class="docutils literal"&gt;getState&lt;/tt&gt; method) display the notification and reload the authors (by
dispatching two actions (which are created through the corresponding actions creators)! That&amp;#8217;s
all that is needed to update the &lt;span class="caps"&gt;UI&lt;/span&gt;!&lt;/p&gt;
&lt;p&gt;Notice that, although I&amp;#8217;ve used ajax and polling to find out when the &lt;span class="caps"&gt;UI&lt;/span&gt; needs to be updated
you could instead use whatever different method you like, for example&amp;nbsp;WebSockets.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id36"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the above sections we presented and explained
a more or less complete single page react / redux
application, &lt;em&gt;almost&lt;/em&gt; ready to be deployed to production.
I tried to explain every concept I came across that&amp;#8217;s why
this article became more fat that I was expecting when I
started writing it! The presented application supports nearly
everything you&amp;#8217;ll want to use when creating your own&amp;nbsp;apps:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Complex&amp;nbsp;forms&lt;/li&gt;
&lt;li&gt;Custom&amp;nbsp;components&lt;/li&gt;
&lt;li&gt;Asynchronous actions /&amp;nbsp;Ajax&lt;/li&gt;
&lt;li&gt;Creating / updating / deleting&amp;nbsp;objects&lt;/li&gt;
&lt;li&gt;Client side&amp;nbsp;routing&lt;/li&gt;
&lt;li&gt;Result lists with pagination, sorting and&amp;nbsp;filtering&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The above have been implemented using the following technologies /&amp;nbsp;libraries:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Django /&amp;nbsp;django-rest-framework&lt;/li&gt;
&lt;li&gt;&lt;span class="caps"&gt;ES6&lt;/span&gt; with&amp;nbsp;babel&lt;/li&gt;
&lt;li&gt;browserify / watchify /&amp;nbsp;babelify&lt;/li&gt;
&lt;li&gt;React / redux /&amp;nbsp;react-redux&lt;/li&gt;
&lt;li&gt;redux-thunk / redux-form / react-router-redux /&amp;nbsp;react-notification&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;What could be missing from the application we presented&amp;nbsp;here:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Tests!&lt;/li&gt;
&lt;li&gt;Integrating &lt;a class="reference external" href="https://github.com/gaearon/redux-devtools"&gt;redux-devtools&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Using envify to seperate development/production client side code (this is needeed if you actually integrate&amp;nbsp;redux-devtools)&lt;/li&gt;
&lt;li&gt;Intagration with a component&amp;nbsp;library&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I advice you to research these subjects a bit - I&amp;#8217;ll also try to
write another (hopefully thinner) post with more info
about&amp;nbsp;these.&lt;/p&gt;
&lt;p&gt;Finally, two thing I&amp;#8217;d like to point out and keep in mind are that using
redux/react-redux the flow of the data is &lt;em&gt;crystal&lt;/em&gt; and that as you&amp;#8217;ve already
seen by now, writing functional components and reducers is &lt;em&gt;pure fun&lt;/em&gt;!&lt;/p&gt;
&lt;/div&gt;
</content><category term="javascript"></category><category term="javascript"></category><category term="react"></category><category term="redux"></category><category term="react-redux"></category><category term="django"></category><category term="django-rest-framework"></category><category term="redux-thunk"></category><category term="redux-form"></category><category term="react-router"></category><category term="react-router-redux"></category><category term="react-notification"></category><category term="history"></category><category term="es6"></category><category term="babel"></category><category term="babelify"></category><category term="browserify"></category><category term="watchify"></category><category term="uglify"></category><category term="boilerplate"></category><category term="ajax"></category><category term="tutorial"></category><category term="introduction"></category></entry><entry><title>Ajax data with Fixed Data Table forÂ React</title><link href="https://spapas.github.io/2015/12/22/ajax-with-react-fixed-data-table/" rel="alternate"></link><published>2015-12-22T15:20:00+02:00</published><updated>2015-12-22T15:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-12-22:/2015/12/22/ajax-with-react-fixed-data-table/</id><summary type="html">&lt;p class="first last"&gt;A simple demonstration on using FixedDataTable with Ajax&amp;nbsp;data&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#our-project" id="id2"&gt;Our&amp;nbsp;project&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#how-fixeddatatable-gets-its-data" id="id3"&gt;How FixedDataTable gets its&amp;nbsp;data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#ajaxcell-non-working-version-1" id="id4"&gt;AjaxCell: Non working version&amp;nbsp;1&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#ajaxcell-non-working-version-2" id="id5"&gt;AjaxCell: Non working version&amp;nbsp;2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#ajaxcell-non-working-version-3" id="id6"&gt;AjaxCell: Non working version&amp;nbsp;3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#ajaxcell-final-version" id="id7"&gt;AjaxCell: Final&amp;nbsp;version&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-table-container-component" id="id8"&gt;The Table container&amp;nbsp;component&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#some-enchancements" id="id9"&gt;Some&amp;nbsp;enchancements&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conslusion" id="id10"&gt;Conslusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://facebook.github.io/fixed-data-table/"&gt;FixedDataTable&lt;/a&gt; is a nice React component from Facebook that is used to render tabular data.
Its main characteristic is that it can handle many rows without sacrificing performance, however
probably due to this fact I was not able to find any examples for loading data using Ajax - all
examples I was able to find had the data already loaded (or created on the&amp;nbsp;fly).&lt;/p&gt;
&lt;p&gt;So, although FixedDataTable is able to handle many rows, I am against transfering all of them to the user
whenever our page loads since at most one page of data will be shown on screen (30 rows or so ?) -
any other actions (filtering, sorting, aggregate calculations etc) should be done on the&amp;nbsp;server.&lt;/p&gt;
&lt;p&gt;In the following I will present a simple, react-only example with a FixedDataTable that can be
used with server-side, asynchronous, paginated&amp;nbsp;data.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="our-project"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Our&amp;nbsp;project&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Let&amp;#8217;s see an example of what we&amp;#8217;ll&amp;nbsp;build:&lt;/p&gt;
&lt;img alt="Our project" src="/images/ajax_fixed_data_tables.gif" style="width: 600px;" /&gt;
&lt;p&gt;As a source of the data I&amp;#8217;ve used the &lt;a class="reference external" href="http://swapi.co/"&gt;Star Wars &lt;span class="caps"&gt;API&lt;/span&gt;&lt;/a&gt; and specifically its &lt;a class="reference external" href="http://swapi.co/documentation#people"&gt;People &lt;span class="caps"&gt;API&lt;/span&gt;&lt;/a&gt; by issuing
requests to &lt;a class="reference external" href="http://swapi.co/api/people/?format=json"&gt;http://swapi.co/api/people/?format=json&lt;/a&gt;. This will return an array of people from the
star wars universe in &lt;span class="caps"&gt;JSON&lt;/span&gt; format - the results are paginated with a page size of 10 (and we can switch
to another page using the extra &lt;tt class="docutils literal"&gt;page=&lt;/tt&gt; request&amp;nbsp;parameter).&lt;/p&gt;
&lt;p&gt;I will use es6 with the object spread operator (as described in &lt;a class="reference external" href="https://spapas.github.io/2015/11/16/using-browserify-es6/"&gt;a previous article&lt;/a&gt;)
to write the code, using a single main.js as a source which will be transpiled to &lt;tt class="docutils literal"&gt;dist/bundle.js&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The placeholder &lt;span class="caps"&gt;HTML&lt;/span&gt; for our application&amp;nbsp;is:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;meta&lt;/span&gt; &lt;span class="na"&gt;charset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello Ajax Fixed Data Table!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;title&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;link&lt;/span&gt; &lt;span class="na"&gt;rel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;https://cdnjs.cloudflare.com/ajax/libs/fixed-data-table/0.6.0/fixed-data-table.min.css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;main&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;dist/bundle.js&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The versions that are used are react 14.3 and fixed-data-table 0.6.0. You can find this project in github &amp;#64;
&lt;a class="reference external" href="https://github.com/spapas/react-tables"&gt;https://github.com/spapas/react-tables&lt;/a&gt; &amp;#8212; tag name &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;fixed-data-table-ajax&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="how-fixeddatatable-gets-its-data"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;How FixedDataTable gets its&amp;nbsp;data&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The data of a &lt;tt class="docutils literal"&gt;FixedDataTable&lt;/tt&gt; component is defined through a number of &lt;tt class="docutils literal"&gt;Column&lt;/tt&gt; components
and specifically, the &lt;tt class="docutils literal"&gt;cell&lt;/tt&gt; attribute of that component which sould either return be a static string
to be displayed in that column or a React component (usually a &lt;tt class="docutils literal"&gt;Cell&lt;/tt&gt;) that will be displayed in
that column or even a function that returns a string or a react component. The function (or component)
passed to &lt;tt class="docutils literal"&gt;cell&lt;/tt&gt; will have an object with a &lt;tt class="docutils literal"&gt;rowIndex&lt;/tt&gt; attribute (among others) as a parameter,
for example the&amp;nbsp;following&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;Column&lt;/span&gt;
  &lt;span class="na"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;{&amp;lt;Cell&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Url&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;Cell&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;}
  cell={props =&amp;gt; props.rowIndex}
  width={200}
/&amp;gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;will just display the rowIndex for each&amp;nbsp;cell.&lt;/p&gt;
&lt;p&gt;So we can see that for each cell that FixedDataTable wants to display it will use its corresponding
&lt;tt class="docutils literal"&gt;cell&lt;/tt&gt; attribute.
So, a general though if we wanted to support asynchronous, paginated data
is to check the rowIndex and retrieve the correct page asynchronously.
This would lead to a difficulty: What should the &lt;tt class="docutils literal"&gt;cell&lt;/tt&gt; function return? We&amp;#8217;ll try to resolve this
using an &lt;tt class="docutils literal"&gt;AjaxCell&lt;/tt&gt; function that should return a react componet to put in the&amp;nbsp;cell:&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ajaxcell-non-working-version-1"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;AjaxCell: Non working version&amp;nbsp;1&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A first sketch of an &lt;tt class="docutils literal"&gt;`AjaxCell&lt;/tt&gt; component could be something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;// Careful - not working&lt;/span&gt;
&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;AjaxCell1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;rowIndex&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="nx"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://swapi.co/api/people/?format=json&amp;amp;page=&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="c1"&gt;// Here we have the result ! But where will it go ?&lt;/span&gt;
    &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="c1"&gt;/// what ?&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The col attribute will later be used to select the attribute we want to display in this cell.
The &lt;tt class="docutils literal"&gt;page&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;idx&lt;/tt&gt; will have the correct page number and idx inside that page (for example,
if &lt;tt class="docutils literal"&gt;rowIndex&lt;/tt&gt; is 33, &lt;tt class="docutils literal"&gt;page&lt;/tt&gt; will be 4 and idx will be 3. The problem with the above is that
the fetch function will be called &lt;em&gt;asynchronously&lt;/em&gt; so when the AjaxCell returns it will &lt;em&gt;not&lt;/em&gt; have
the results (yet)! So we won&amp;#8217;t be able to render anything&amp;nbsp;:(&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ajaxcell-non-working-version-2"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;AjaxCell: Non working version&amp;nbsp;2&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To be able to render &lt;em&gt;something&lt;/em&gt;, we could put the results of fetching a page to a &lt;tt class="docutils literal"&gt;cache&lt;/tt&gt; dictionary &amp;#8212; and only
fetch that page if it is not inside the &lt;tt class="docutils literal"&gt;cache&lt;/tt&gt; - if it is inside the cache then we&amp;#8217;ll just return
the correct&amp;nbsp;value:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;// Careful - not working correctly&lt;/span&gt;
&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;cache&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;AjaxCell2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;forceUpdate&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;rowIndex&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Cell&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Cell&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Loading page &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://swapi.co/api/people/?format=json&amp;amp;page=&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;results&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Cell&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;-&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Cell&amp;gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above will work, since it will return an empty (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;Cell&amp;gt;-&amp;lt;/Cell&amp;gt;&lt;/span&gt;&lt;/tt&gt;) initially but when the
&lt;tt class="docutils literal"&gt;fetch&lt;/tt&gt; returns it will set the &lt;tt class="docutils literal"&gt;cache&lt;/tt&gt; for that page and return the correct value (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;Cell&amp;gt;{cache[page][idx][col]}&amp;lt;/Cell&amp;gt;&lt;/span&gt;&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;However, as can be understood, when the page first loads it will call &lt;tt class="docutils literal"&gt;AjaxCell2&lt;/tt&gt; for all visible cells &amp;#8212;
because fetch is asynchronous and takes time until it returns (and sets the cache for that page), so the
&lt;tt class="docutils literal"&gt;fetch&lt;/tt&gt; will be called for &lt;em&gt;all&lt;/em&gt;&amp;nbsp;cells!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ajaxcell-non-working-version-3"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;AjaxCell: Non working version&amp;nbsp;3&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;fetch&lt;/tt&gt; ing each page multiple times is of course not acceptable, so we&amp;#8217;ll add a &lt;tt class="docutils literal"&gt;loading&lt;/tt&gt; flag
and &lt;tt class="docutils literal"&gt;fetch&lt;/tt&gt; will be called only when this flag is &lt;tt class="docutils literal"&gt;false&lt;/tt&gt;, like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;// Not ready yet&lt;/span&gt;
&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;cache&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;loading&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;AjaxCell2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;rowIndex&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Cell&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Cell&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nx"&gt;loading&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Loading page &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;loading&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="nx"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://swapi.co/api/people/?format=json&amp;amp;page=&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;results&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="nx"&gt;loading&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Cell&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;-&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Cell&amp;gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This works much better - the cells are rendered correctly and each page is loaded only once. However, if for example
I tried to move to the end of the table quickly, I would see some cells that are always loading (they never get their correct value). This is because
there is no way to know that the fetch function has actually completed in order to update with the latest (correct) value of that
cell and will contain the stale placeholder (&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;Cell&amp;gt;-&amp;lt;/Cell&amp;gt;&lt;/span&gt;&lt;/tt&gt;)&amp;nbsp;value.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ajaxcell-final-version"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;AjaxCell: Final&amp;nbsp;version&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To clear the stale data we need to do an update to the table data
when each fetch is finished &amp;#8212; this should be done by a callback that will be passed to the &lt;tt class="docutils literal"&gt;AjaxCell&lt;/tt&gt;, like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;cache&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{};&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;loading&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;AjaxCell&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;forceUpdate&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;props&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;Math&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;floor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;rowIndex&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nx"&gt;idx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;rowIndex&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="nx"&gt;pageSize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Cell&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;idx&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="p"&gt;]}&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Cell&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="nx"&gt;loading&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Loading page &amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;loading&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="nx"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://swapi.co/api/people/?format=json&amp;amp;page=&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;results&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
            &lt;span class="nx"&gt;loading&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="nx"&gt;forceUpdate&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
        &lt;span class="p"&gt;});&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;loadingCell&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So we pass a forceUpdate callback as a property which is called when a fetch is finished. This may
result to some not needed updates to the table (since we would do a fetch + forceUpdate for non-displayed
data) but we can now be positive that when the data is loaded the table will be updated to dispaly&amp;nbsp;it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-table-container-component"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;The Table container&amp;nbsp;component&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Finally, the component that contains the table is the&amp;nbsp;following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;class&lt;/span&gt; &lt;span class="nx"&gt;TableContainer&lt;/span&gt; &lt;span class="kr"&gt;extends&lt;/span&gt; &lt;span class="nx"&gt;React&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Component&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;render&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Table&lt;/span&gt;
            &lt;span class="nx"&gt;rowHeight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;rowsCount&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;87&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;600&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;height&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="nx"&gt;headerHeight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;

            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Column&lt;/span&gt;
              &lt;span class="nx"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Cell&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;Name&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Cell&amp;gt;}&lt;/span&gt;
              &lt;span class="nx"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;AjaxCell&lt;/span&gt; &lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;forceUpdate&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;forceUpdate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
              &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Column&lt;/span&gt;
              &lt;span class="nx"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Cell&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;Birth&lt;/span&gt; &lt;span class="nx"&gt;Year&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Cell&amp;gt;}&lt;/span&gt;
              &lt;span class="nx"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;AjaxCell&lt;/span&gt; &lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;birth_year&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;forceUpdate&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;forceUpdate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
              &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Column&lt;/span&gt;
              &lt;span class="nx"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Cell&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="nx"&gt;Url&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Cell&amp;gt;}&lt;/span&gt;
              &lt;span class="nx"&gt;cell&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;AjaxCell&lt;/span&gt; &lt;span class="nx"&gt;col&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;url&amp;#39;&lt;/span&gt; &lt;span class="nx"&gt;forceUpdate&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;forceUpdate&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;)}&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt;
              &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
            &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Table&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I&amp;#8217;ve made it a component in order to be able to bind the &lt;tt class="docutils literal"&gt;forceUpdate&lt;/tt&gt; method of the component to and
&lt;tt class="docutils literal"&gt;this&lt;/tt&gt; and pass it to the &lt;tt class="docutils literal"&gt;forceUpdate&lt;/tt&gt; parameter to the &lt;tt class="docutils literal"&gt;AjaxCell&lt;/tt&gt; component. I&amp;#8217;ve hard-coded
the rowsCount value &amp;#8212; instead we should have done an initial fetch to the first page of the &lt;span class="caps"&gt;API&lt;/span&gt; to get
the total number of rows and only after that fetch had returned display the &lt;tt class="docutils literal"&gt;&amp;lt;Table&amp;gt;&lt;/tt&gt; component (left
as an exercise to the&amp;nbsp;reader).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="some-enchancements"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;Some&amp;nbsp;enchancements&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Instead of displaying &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;Cell&amp;gt;-&amp;lt;/Cell&amp;gt;&lt;/span&gt;&lt;/tt&gt; (or &lt;tt class="docutils literal"&gt;&amp;lt;/Cell&amp;gt;&lt;/tt&gt;) when the page loads, I propose to define a
cell with an embedded spinner,&amp;nbsp;like&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;loadingCell&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;Cell&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nx"&gt;img&lt;/span&gt; &lt;span class="nx"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;16&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;height&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;16&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;alt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;star&amp;quot;&lt;/span&gt; &lt;span class="nx"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;data:image/gif;base64,R0lGODlhEAAQAPIAAP///wAAAMLCwkJCQgAAAGJiYoKCgpKSkiH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCgAAACwAAAAAEAAQAAADMwi63P4wyklrE2MIOggZnAdOmGYJRbExwroUmcG2LmDEwnHQLVsYOd2mBzkYDAdKa+dIAAAh+QQJCgAAACwAAAAAEAAQAAADNAi63P5OjCEgG4QMu7DmikRxQlFUYDEZIGBMRVsaqHwctXXf7WEYB4Ag1xjihkMZsiUkKhIAIfkECQoAAAAsAAAAABAAEAAAAzYIujIjK8pByJDMlFYvBoVjHA70GU7xSUJhmKtwHPAKzLO9HMaoKwJZ7Rf8AYPDDzKpZBqfvwQAIfkECQoAAAAsAAAAABAAEAAAAzMIumIlK8oyhpHsnFZfhYumCYUhDAQxRIdhHBGqRoKw0R8DYlJd8z0fMDgsGo/IpHI5TAAAIfkECQoAAAAsAAAAABAAEAAAAzIIunInK0rnZBTwGPNMgQwmdsNgXGJUlIWEuR5oWUIpz8pAEAMe6TwfwyYsGo/IpFKSAAAh+QQJCgAAACwAAAAAEAAQAAADMwi6IMKQORfjdOe82p4wGccc4CEuQradylesojEMBgsUc2G7sDX3lQGBMLAJibufbSlKAAAh+QQJCgAAACwAAAAAEAAQAAADMgi63P7wCRHZnFVdmgHu2nFwlWCI3WGc3TSWhUFGxTAUkGCbtgENBMJAEJsxgMLWzpEAACH5BAkKAAAALAAAAAAQABAAAAMyCLrc/jDKSatlQtScKdceCAjDII7HcQ4EMTCpyrCuUBjCYRgHVtqlAiB1YhiCnlsRkAAAOwAAAAAAAAAAAA==&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="err"&gt;/Cell&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and return this&amp;nbsp;instead.&lt;/p&gt;
&lt;p&gt;Also, if your &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; returns too fast and you&amp;#8217;d like to see what would happen if the server request took too long to return, you could
change fetch like&amp;nbsp;this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nx"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://swapi.co/api/people/?format=json&amp;amp;page=&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;json&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="p"&gt;}).&lt;/span&gt;&lt;span class="nx"&gt;then&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nx"&gt;setTimeout&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;page&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;j&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;results&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
        &lt;span class="nx"&gt;loading&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="nx"&gt;forceUpdate&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;to add a 1 second&amp;nbsp;delay.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conslusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;Conslusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The above is a just a proof of concept of using FixedDataTable with asynchronously loaded server-side data.
This of course could be used for small projects (I am already using it for an internal project) but I recommend
using the &lt;a class="reference external" href="https://spapas.github.io/2015/07/02/comprehensive-react-flux-tutorial-2/"&gt;flux architecture&lt;/a&gt; for more complex projects. What this more or
less means is that a store component
should be developed that will actually keep the data for each row, and a &lt;tt class="docutils literal"&gt;fetchCompleted&lt;/tt&gt; action should be
dispatched when the &lt;tt class="docutils literal"&gt;fetch&lt;/tt&gt; is finished instead of calling &lt;tt class="docutils literal"&gt;forceUpdate&lt;/tt&gt; directly.&lt;/p&gt;
&lt;/div&gt;
</content><category term="javascript"></category><category term="javascript"></category><category term="react"></category><category term="fixed-data-tables"></category><category term="FixedDataTable"></category></entry><entry><title>PDFs in Django: The essentialÂ guide</title><link href="https://spapas.github.io/2015/11/27/pdf-in-django/" rel="alternate"></link><published>2015-11-27T10:20:00+02:00</published><updated>2015-11-27T10:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-11-27:/2015/11/27/pdf-in-django/</id><summary type="html">&lt;p class="first last"&gt;An essential guide to creating, editing and serving &lt;span class="caps"&gt;PDF&lt;/span&gt; files in&amp;nbsp;django&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id4"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-players" id="id5"&gt;The players&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#reportlab" id="id6"&gt;ReportLab&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#xhtml2pdf" id="id7"&gt;xhtml2pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#pypdf2" id="id8"&gt;PyPDF2&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-integration" id="id9"&gt;Django integration&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-a-plain-old-view" id="id10"&gt;Using a plain old&amp;nbsp;view&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-a-cbv" id="id11"&gt;Using a &lt;span class="caps"&gt;CBV&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#how-does-django-xhtml2pdf-loads-resources" id="id12"&gt;How does django-xhtml2pdf loads&amp;nbsp;resources&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-a-common-style-for-your-pdfs" id="id13"&gt;Using a common style for your&amp;nbsp;PDFs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#changing-the-font-to-a-unicode-enabled-one" id="id14"&gt;Changing the font (to a Unicode enabled&amp;nbsp;one)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#configure-django-for-debugging-pdf-creation" id="id15"&gt;Configure Django for debugging &lt;span class="caps"&gt;PDF&lt;/span&gt;&amp;nbsp;creation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#concatenating-pdfs-in-django" id="id16"&gt;Concatenating PDFs in&amp;nbsp;Django&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#more-advanced-xhtml2pdf-features" id="id17"&gt;More advanced xhtml2pdf features&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#laying-out" id="id18"&gt;Laying&amp;nbsp;out&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#extra-stuff" id="id19"&gt;Extra&amp;nbsp;stuff&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id20"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Upgrade 23/05/2018&lt;/strong&gt; I&amp;#8217;ve upgraded the sample project (&lt;a class="reference external" href="https://github.com/spapas/django-pdf-guide"&gt;https://github.com/spapas/django-pdf-guide&lt;/a&gt;) for usage with Django 2.0 and Python 3.x.
There were very few changes between the old, Django 1.8 compatible project and the new one. To see the differences, you can just clone it
and do a &lt;tt class="docutils literal"&gt;git diff &lt;span class="pre"&gt;django-1.8&lt;/span&gt; &lt;span class="pre"&gt;django-2.0&lt;/span&gt;&lt;/tt&gt;: Most are related to changes between django 1.8 and django 2.0 (in the &lt;span class="caps"&gt;URL&lt;/span&gt; configuration use &lt;tt class="docutils literal"&gt;path&lt;/tt&gt; instead of &lt;tt class="docutils literal"&gt;url&lt;/tt&gt;,
use new style middleware etc) and between python 2.7 and 3.x (small changes in import syntax, &lt;tt class="docutils literal"&gt;StringIO&lt;/tt&gt; has been moved to the &lt;tt class="docutils literal"&gt;io&lt;/tt&gt; package). There&amp;#8217;s also
a couple of requirement upgrades, the most important are the upgrade to &lt;tt class="docutils literal"&gt;xhtml2pdf 0.2.2&lt;/tt&gt; and using my own fork of &lt;tt class="docutils literal"&gt;django_xhtml2pdf&lt;/tt&gt; since django_xhtml2pdf
does not seem to be maintained&amp;nbsp;anymore.&lt;/p&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I&amp;#8217;ve noticed that although it is easy to create PDFs with
Python, there&amp;#8217;s no complete guide on how to
integrate these tools with Django and resolve the problems
that you&amp;#8217;ll encounter when trying to actually create PDFs
from your Django web&amp;nbsp;application.&lt;/p&gt;
&lt;p&gt;In this article I will present the solution I use for
creating PDFs with Django, along with various tips on how to
solve most of your common requirements. Specifically, here
are some things that we&amp;#8217;ll&amp;nbsp;cover:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Learn how to create PDFs &amp;#8220;by&amp;nbsp;hand&amp;#8221;&lt;/li&gt;
&lt;li&gt;Create PDFs with Django using a normal Djang Template (similar to an &lt;span class="caps"&gt;HTML&lt;/span&gt;&amp;nbsp;page)&lt;/li&gt;
&lt;li&gt;Change the fonts of your&amp;nbsp;PDFs&lt;/li&gt;
&lt;li&gt;Use styling in your&amp;nbsp;output&lt;/li&gt;
&lt;li&gt;Create&amp;nbsp;layouts&lt;/li&gt;
&lt;li&gt;Embed images to your&amp;nbsp;PDFs&lt;/li&gt;
&lt;li&gt;Add page&amp;nbsp;numbers&lt;/li&gt;
&lt;li&gt;Merge (concatenate)&amp;nbsp;PDFs&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="the-players"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;The&amp;nbsp;players&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We are going to use the following main&amp;nbsp;tools:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://bitbucket.org/rptlab/reportlab"&gt;ReportLab&lt;/a&gt; is an open source python library for creating PDFs. It uses a low-level &lt;span class="caps"&gt;API&lt;/span&gt; that allows &amp;#8220;drawing&amp;#8221; strings on specific coordinates  on the &lt;span class="caps"&gt;PDF&lt;/span&gt; - for people familiar with creating PDFs in Java it is more or less &lt;a class="reference external" href="http://itextpdf.com/"&gt;iText&lt;/a&gt; for&amp;nbsp;python.&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/chrisglass/xhtml2pdf"&gt;xhtml2pdf&lt;/a&gt; (formerly named &lt;em&gt;pisa&lt;/em&gt;) is an open source library that can convert &lt;span class="caps"&gt;HTML&lt;/span&gt;/&lt;span class="caps"&gt;CSS&lt;/span&gt; pages to &lt;span class="caps"&gt;PDF&lt;/span&gt; using&amp;nbsp;ReportLab.&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/chrisglass/django-xhtml2pdf"&gt;django-xhtml2pdf&lt;/a&gt; is a wrapper around xhtml2pdf that makes integration with Django&amp;nbsp;easier.&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/mstamy2/PyPDF2"&gt;PyPDF2&lt;/a&gt; is an open source tool of that can split, merge and transform pages of &lt;span class="caps"&gt;PDF&lt;/span&gt;&amp;nbsp;files.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I&amp;#8217;ve created a &lt;a class="reference external" href="https://github.com/spapas/django-pdf-guide"&gt;django project&lt;/a&gt; &lt;a class="reference external" href="https://github.com/spapas/django-pdf-guide"&gt;https://github.com/spapas/django-pdf-guide&lt;/a&gt; with everything covered here. Please clone it,
install its requirements and play with it to see how everything works&amp;nbsp;!&lt;/p&gt;
&lt;p&gt;Before integrating the above tools to a Django project, I&amp;#8217;d like to describe them individually a bit more. Any files
I mention below will be included in this&amp;nbsp;project.&lt;/p&gt;
&lt;div class="section" id="reportlab"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;ReportLab&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;ReportLab offers a really low &lt;span class="caps"&gt;API&lt;/span&gt; for creating PDFs. It is something like having a &lt;tt class="docutils literal"&gt;canvas.drawString()&lt;/tt&gt; method (for
people familiar with drawing APIs) for your &lt;span class="caps"&gt;PDF&lt;/span&gt; page. Let&amp;#8217;s take a look at an example, creating a &lt;span class="caps"&gt;PDF&lt;/span&gt; with a simple&amp;nbsp;string:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;reportlab.pdfgen&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;canvas&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;reportlab.rl_config&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;reportlab&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rl_config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;warnOnMissingFontGlyphs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;canvas&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Canvas&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;./hello1.pdf&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawString&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Hello World&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;showPage&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Save the above in a file named testreportlab1.py. If you run python testreportlab1.py (in an environment that has
reportlab of cours) you should see no errors and a pdf named &lt;tt class="docutils literal"&gt;hello1.pdf&lt;/tt&gt; created. If you open it in your &lt;span class="caps"&gt;PDF&lt;/span&gt;
reader you&amp;#8217;ll see a blank page with &amp;#8220;Hello World&amp;#8221; written in its lower right&amp;nbsp;corner.&lt;/p&gt;
&lt;p&gt;If you try to add a unicode text, for example &amp;#8220;ÎÎ±Î»Î·Î¼Î­ÏÎ± ÎµÎ»Î»Î¬Î´Î±&amp;#8221;, you should see something like the&amp;nbsp;following:&lt;/p&gt;
&lt;img alt="Hello PDF" src="/images/hellopdf2.png" style="width: 480px;" /&gt;
&lt;p&gt;It seems that the default font that ReportLab uses does not have a good support for accented greek characters
since they are missing  (and probably for various other&amp;nbsp;characters).&lt;/p&gt;
&lt;p&gt;To resolve this, we could try changing the font to one that contains the missing symbols. You can find free
fonts on the internet (for example the &lt;cite&gt;DejaVu&lt;/cite&gt; font), or even grab one from your system fonts (in windows,
check out &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;c:\windows\fonts\&lt;/span&gt;&lt;/tt&gt;). In any case, just copy the ttf file of your font inside the folder of
your project and crate a file named testreportlab2.py with the following (I am using the DejaVuSans&amp;nbsp;font):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# -*- coding: utf-8 -*-&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;reportlab.rl_config&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;reportlab.pdfbase&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;pdfmetrics&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;reportlab.pdfbase.ttfonts&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TTFont&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;canvas&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Canvas&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;./hello2.pdf&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;
    &lt;span class="n"&gt;reportlab&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rl_config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;warnOnMissingFontGlyphs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;pdfmetrics&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;registerFont&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TTFont&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DejaVuSans&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DejaVuSans.ttf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setFont&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DejaVuSans&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drawString&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ÎÎ±Î»Î·Î¼Î­ÏÎ± ÎµÎ»Î»Î¬Î´Î±.&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;showPage&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above was just a scratch on the surface of ReportLab, mainly to be confident that
everything &lt;em&gt;will&lt;/em&gt; work fine for non-english speaking people! To find out more, you should check the  &lt;a class="reference external" href="http://www.reportlab.com/docs/reportlab-userguide.pdf"&gt;ReportLab open-source User Guide&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I also have to mention that
&lt;a class="reference external" href="http://reportlab.com/"&gt;the company behind ReportLab&lt;/a&gt; offers some great commercial solutions based on ReportLab for creating PDFs (similar to &lt;a class="reference external" href="http://community.jaspersoft.com/project/jasperreports-library"&gt;JasperReports&lt;/a&gt;) - check it out
if you need support or advanced&amp;nbsp;capabilities.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="xhtml2pdf"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;xhtml2pdf&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The xhtml2pdf is a really great library that allows you to use html files as a template
to a &lt;span class="caps"&gt;PDF&lt;/span&gt;. Of course, an html cannot always be converted to a &lt;span class="caps"&gt;PDF&lt;/span&gt; since,
unfortunately, PDFs &lt;em&gt;do&lt;/em&gt; have&amp;nbsp;pages.&lt;/p&gt;
&lt;p&gt;xhtml2pdf has a nice executable script that can be used to test its capabilities. After
you install it (either globally or to a virtual environment) you should be able to find
out the executable &lt;tt class="docutils literal"&gt;$&lt;span class="caps"&gt;PYTHON&lt;/span&gt;/scripts/xhtml2pdf&lt;/tt&gt; (or &lt;tt class="docutils literal"&gt;xhtml2pdf.exe&lt;/tt&gt; if you are in
Windows) and a corresponding python script &amp;#64; &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;$&lt;span class="caps"&gt;PYTHON&lt;/span&gt;/scripts/xhtml2pdf-script.py&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s try to use xhtml2pdf to explore some of its capabilities. Create a file named
testxhtml2pdf.html with the following contents and run &lt;tt class="docutils literal"&gt;xhtml2pdf testxhtml2pdf.html&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;meta&lt;/span&gt; &lt;span class="na"&gt;http-equiv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Testing xhtml2pdf &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;b&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello, world!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;b&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;i&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello, italics&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;i&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;ÎÎ±Î»Î·Î¼Î­ÏÎ± ÎÎ»Î»Î¬Î´Î±!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;hr&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus nulla erat, porttitor ut venenatis eget,
    tempor et purus. Nullam nec erat vel enim euismod auctor et at nisl. Integer posuere bibendum condimentum. Ut
    euismod velit ut porttitor condimentum. In ullamcorper nulla at lectus fermentum aliquam. Nunc elementum commodo
    dui, id pulvinar ex viverra id. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos
    himenaeos.&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Interdum et malesuada fames ac ante ipsum primis in faucibus. Sed aliquam vitae lectus sit amet accumsan. Morbi
    nibh urna, condimentum nec volutpat at, lobortis sit amet odio. Etiam quis neque interdum sapien cursus ornare. Cras
    commodo lacinia sapien nec porta. Suspendisse potenti. Nulla hendrerit dolor et rutrum consectetur.&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;hr&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;img&lt;/span&gt;  &lt;span class="na"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;26&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;height&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;20&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;data:image/gif;base64,R0lGODlhEAAOALMAAOazToeHh0tLS/7LZv/0jvb29t/f3//Ub//ge8WSLf/&lt;/span&gt;
&lt;span class="s"&gt;    rhf/3kdbW1mxsbP//mf///yH5BAAAAAAALAAAAAAQAA4AAARe8L1Ekyky67QZ1hLnjM5UUde0ECwLJoExKcppV0aCcGCmTIHEIUEqjgaORCMxIC6e0C&lt;/span&gt;
&lt;span class="s"&gt;    cguWw6aFjsVMkkIr7g77ZKPJjPZqIyd7sJAgVGoEGv2xsBxqNgYPj/gAwXEQA7&amp;quot;&lt;/span&gt;  &lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;hr&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;table&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;header0&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;header1&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;header2&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;header3&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;header4&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;header5&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Hello World!!!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;table&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Please notice the &lt;tt class="docutils literal"&gt;&amp;lt;meta &lt;span class="pre"&gt;http-equiv=&amp;quot;Content-Type&amp;quot;&lt;/span&gt; &lt;span class="pre"&gt;content=&amp;quot;text/html;&lt;/span&gt; &lt;span class="pre"&gt;charset=utf-8&amp;quot;&lt;/span&gt; /&amp;gt;&lt;/tt&gt; in the above &lt;span class="caps"&gt;HTML&lt;/span&gt; &amp;#8212; also it is saved as
Unicode (Encoding - Covert to &lt;span class="caps"&gt;UTF&lt;/span&gt;-8 in Notepad++). The result (&lt;tt class="docutils literal"&gt;testxhtml2pdf.pdf&lt;/tt&gt;) should&amp;nbsp;have:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A nice header&amp;nbsp;(h1)&lt;/li&gt;
&lt;li&gt;Paragraphs&lt;/li&gt;
&lt;li&gt;Horizontal&amp;nbsp;lines&lt;/li&gt;
&lt;li&gt;No support for greek characters (same problem as with&amp;nbsp;reportlab)&lt;/li&gt;
&lt;li&gt;Images (I am inlining it as a base 64&amp;nbsp;image)&lt;/li&gt;
&lt;li&gt;A&amp;nbsp;list&lt;/li&gt;
&lt;li&gt;A&amp;nbsp;table&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Before moving on, I&amp;#8217;d like to fix the problem with the greek characters. You should
set the font to one supporting greek characters, just like you did with ReportLab before.
This can be done with the help of the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;#64;font-face&lt;/span&gt;&lt;/tt&gt; &lt;a class="reference external" href="https://github.com/xhtml2pdf/xhtml2pdf/blob/master/doc/usage.rst#fonts"&gt;css directive&lt;/a&gt;. So, let&amp;#8217;s create
a file named &lt;tt class="docutils literal"&gt;testxhtml2pdf2.html&lt;/tt&gt; with the following&amp;nbsp;contents:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;meta&lt;/span&gt; &lt;span class="na"&gt;http-equiv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;

    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;font-face&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nt"&gt;font-family&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;DejaVuSans&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;src&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;c:/progr/py/django-pdf-guide/django_pdf_guide/DejaVuSans.ttf&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="nt"&gt;body&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;font-family&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;DejaVuSans&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;ÎÎ¿ÎºÎ¹Î¼Î® ÏÎ¿Ï xhtml2pdf &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;ÎÎ±Î»Î·Î¼Î­ÏÎ± ÎÎ»Î»Î¬Î´Î±!&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Before running &lt;tt class="docutils literal"&gt;xhtml2pdf testxhtml2pdf2.html&lt;/tt&gt;, please make
sure to change the url of the font file above to the absolute path of that font in your
local system . As a result, after running xhhtml2pdf
you
should see the unicode characters without&amp;nbsp;problems.&lt;/p&gt;
&lt;p&gt;I have to mention here that I wasn&amp;#8217;t able to use the font from a relative path, that&amp;#8217;s
why I used the absolute one. In case something is not right, try
running it with the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-d&lt;/span&gt;&lt;/tt&gt; option to output debugging information (something like
&lt;tt class="docutils literal"&gt;xhtml2pdf &lt;span class="pre"&gt;-d&lt;/span&gt; testxhtml2pdf2.html&lt;/tt&gt;). You must see a line like this&amp;nbsp;one:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
DEBUG [xhtml2pdf] C:\progr\py\django-pdf-guide\venv\lib\site-packages\xhtml2pdf\context.py line 857: Load font 'c:\\progr\\py\\django-pdf-guide\\django_pdf_guide\\DejaVuSans.ttf'
&lt;/pre&gt;
&lt;p&gt;to make sure that the font is actually&amp;nbsp;loaded!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pypdf2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;PyPDF2&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The PyPDF2 library can be used to extract pages from a &lt;span class="caps"&gt;PDF&lt;/span&gt; to a new one
or combine pages from different PDFs to a a new one. A common requirement is
to have the first and page of a report as static PDFs, create the contents
of this report through your app as a &lt;span class="caps"&gt;PDF&lt;/span&gt; and combine all three PDFs (front page,
content and back page) to the resulting &lt;span class="caps"&gt;PDF&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s see a quick example of combining two&amp;nbsp;PDFs:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyPDF2&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;PdfFileMerger&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;pdfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;pdfs&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pdfs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Please enter at least two pdfs for merging!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;merger&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PdfFileMerger&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;pdf&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;pdfs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;merger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fileobj&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="n"&gt;output&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;output.pdf&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;wb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;merger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;output&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above will try to open all input parameters (as files) and append them to a the&amp;nbsp;output.pdf.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="django-integration"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;Django&amp;nbsp;integration&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To integrate the &lt;span class="caps"&gt;PDF&lt;/span&gt; creation process with django we&amp;#8217;ll use a simple app with only one model about books. We are
going to use the django-xhtml2pdf library &amp;#8212; I recommend installing the latest version (from github
using something like &lt;tt class="docutils literal"&gt;pip install &lt;span class="pre"&gt;-e&lt;/span&gt; &lt;span class="pre"&gt;git+https://github.com/chrisglass/django-xhtml2pdf.git#egg=django-xhtml2pdf&lt;/span&gt;&lt;/tt&gt;
) since the pip package has not been updated in a long&amp;nbsp;time!&lt;/p&gt;
&lt;div class="section" id="using-a-plain-old-view"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;Using a plain old&amp;nbsp;view&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The simplest case is to just create plain old view to display the &lt;span class="caps"&gt;PDF&lt;/span&gt;. We&amp;#8217;ll use django-xhtml2pdf along with the
followig django&amp;nbsp;template:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;meta&lt;/span&gt; &lt;span class="na"&gt;http-equiv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Books&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;table&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;ID&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Title&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        {% for book in books %}
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ book.id }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ book.title }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        {% endfor %}
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;table&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Name it as &lt;tt class="docutils literal"&gt;books_plain_old_view.html&lt;/tt&gt; and put it on &lt;tt class="docutils literal"&gt;books/templates&lt;/tt&gt; directory. The view that
returns the above template as &lt;span class="caps"&gt;PDF&lt;/span&gt; is the&amp;nbsp;following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.http&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django_xhtml2pdf.utils&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;generate_pdf&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;books_plain_old_view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application/pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;books&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;generate_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;books_plain_old_view.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;file_object&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We just use the &lt;tt class="docutils literal"&gt;generate_pdf&lt;/tt&gt; method of django-xhtml2pdf to help us generate the &lt;span class="caps"&gt;PDF&lt;/span&gt;, passing it
our response object and a context dictionary (containing all&amp;nbsp;books).&lt;/p&gt;
&lt;p&gt;Instead of the simple &lt;span class="caps"&gt;HTTP&lt;/span&gt; response above, we could add a &amp;#8216;Content Disposition&amp;#8217; &lt;span class="caps"&gt;HTTP&lt;/span&gt; header to
our response
(or use the django-xhtml2pdf method &lt;tt class="docutils literal"&gt;render_to_pdf_response&lt;/tt&gt; instead of &lt;tt class="docutils literal"&gt;generate_pdf&lt;/tt&gt;)
to suggest a default filename for the file to be saved by adding the&amp;nbsp;line&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
resp['Content-Disposition'] = 'attachment; filename=&amp;quot;output.pdf&amp;quot;'
&lt;/pre&gt;
&lt;p&gt;after the definition of &lt;tt class="docutils literal"&gt;resp&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;This will have the extra effect, at least in Chrome and Firefox to show the &amp;#8220;Save File&amp;#8221; dialog
when clicking on the link instead of retrieving the &lt;span class="caps"&gt;PDF&lt;/span&gt; and displaying it inside* the browser&amp;nbsp;window.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-a-cbv"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;Using a &lt;span class="caps"&gt;CBV&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;I don&amp;#8217;t really recommend using plain old Django views - instead I propose to always use Class Based Views
for their DRYness. The best approach is to create a mixin that would allow any kind of &lt;span class="caps"&gt;CBV&lt;/span&gt; (at least any
kind of &lt;span class="caps"&gt;CBV&lt;/span&gt; that uses a template) to be rendered in &lt;span class="caps"&gt;PDF&lt;/span&gt;. Here&amp;#8217;s how we could implement a &lt;tt class="docutils literal"&gt;PdfResponseMixin&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PdfResponseMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_template_names&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application/pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;generate_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;file_object&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, we could use this mixin to create &lt;span class="caps"&gt;PDF&lt;/span&gt; outputting views from any other view! For example, here&amp;#8217;s how
we could create a book list in&amp;nbsp;pdf:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BookPdfListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PdfResponseMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;books&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To display it, you could use the same template as &lt;tt class="docutils literal"&gt;books_plain_old_view.html&lt;/tt&gt; (so either add a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;template_name='books_plain_old_view.html'&lt;/span&gt;&lt;/tt&gt;
property to the class or copy &lt;tt class="docutils literal"&gt;books_plain_old_view.html&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;books/book_list.html&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;Also, as another example, here&amp;#8217;s a &lt;tt class="docutils literal"&gt;BookPdfDetailView&lt;/tt&gt; that outputs &lt;span class="caps"&gt;PDF&lt;/span&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BookPdfDetailView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PdfResponseMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;DetailView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;book&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and a corresponding template (name it &lt;tt class="docutils literal"&gt;books/book_detail.html&lt;/tt&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;meta&lt;/span&gt; &lt;span class="na"&gt;http-equiv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Book Detail&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;b&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;ID&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;b&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;: &lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.id&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;b&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Title&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;b&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;: &lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.title&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To add the content-disposition header and a name for your &lt;span class="caps"&gt;PDF&lt;/span&gt;, you can use the following&amp;nbsp;mixin:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PdfResponseMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;pdf_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;output&amp;quot;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_pdf_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pdf_name&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_template_names&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application/pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-Disposition&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;attachment; filename=&amp;quot;{0}.pdf&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_pdf_name&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;generate_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;file_object&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You see that, in order to havea configurable output name for our &lt;span class="caps"&gt;PDF&lt;/span&gt; and be consistent with the other
django CBVs, a &lt;tt class="docutils literal"&gt;pdf_name&lt;/tt&gt; class attribute and a &lt;tt class="docutils literal"&gt;get_pdf_name&lt;/tt&gt; instance method are added. When
using the above mixin in your classes you can either provide a value for &lt;tt class="docutils literal"&gt;pdf_name&lt;/tt&gt; (to use the same for all
your instances), or override &lt;tt class="docutils literal"&gt;get_pdf_name&lt;/tt&gt; to have a dynamic&amp;nbsp;value!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="how-does-django-xhtml2pdf-loads-resources"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;How does django-xhtml2pdf loads&amp;nbsp;resources&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Before doing more advanced things, we need to understand how &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;django-xhtml2pdf&lt;/span&gt;&lt;/tt&gt; works and specifically
how we can refer to things like css, images, fonts etc from our &lt;span class="caps"&gt;PDF&lt;/span&gt; templates.
If you check the &lt;a class="reference external" href="https://github.com/chrisglass/django-xhtml2pdf/blob/master/django_xhtml2pdf/utils.py"&gt;utils.py of django-xhtml2pdf&lt;/a&gt; you&amp;#8217;ll see that it uses a function named &lt;tt class="docutils literal"&gt;fetch_resources&lt;/tt&gt;
for loading these resources. This function checks to see if the resource starts with &lt;tt class="docutils literal"&gt;/MEDIA_URL&lt;/tt&gt; or
&lt;tt class="docutils literal"&gt;/STATIC_URL&lt;/tt&gt; and converts it to a local (filesystem) path. For example, if you refer to a font like
&lt;tt class="docutils literal"&gt;/static/font1.ttf&lt;/tt&gt; in your &lt;span class="caps"&gt;PDF&lt;/span&gt; template, &lt;tt class="docutils literal"&gt;xhtml2pdf&lt;/tt&gt; will try to load the file &lt;tt class="docutils literal"&gt;STATIC_ROOT + /font1.ttf&lt;/tt&gt;
(and if it does not find the file you want to refer to there it will check all &lt;tt class="docutils literal"&gt;STATICFILES_DIRS&lt;/tt&gt; entries).&lt;/p&gt;
&lt;p&gt;Thus, you can just put your resources into your &lt;tt class="docutils literal"&gt;STATIC_ROOT&lt;/tt&gt; directory and use the &lt;tt class="docutils literal"&gt;{% static %}&lt;/tt&gt;
template tag to create &lt;span class="caps"&gt;URL&lt;/span&gt; paths for them &amp;#8212; django-xhtml2pdf will convert these to local paths and
everything will work&amp;nbsp;fine.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Please notice that you *need* to have configured &amp;#8220;STATIC_ROOT&amp;#8220; for this to work&lt;/strong&gt; &amp;#8212; if &lt;tt class="docutils literal"&gt;STATIC_ROOT&lt;/tt&gt; is
empty (and, for example you use &lt;tt class="docutils literal"&gt;static&lt;/tt&gt; directories in your apps) then the described substitution
mechanism will &lt;em&gt;not&lt;/em&gt; work. Also, notice that the &lt;tt class="docutils literal"&gt;/static&lt;/tt&gt; directory inside your apps &lt;em&gt;cannot be used&lt;/em&gt;
for fetch resources like this
(due to how &lt;tt class="docutils literal"&gt;fetch_resources&lt;/tt&gt; is implemented it only checks if the static resource is contained inside
the &lt;tt class="docutils literal"&gt;STATIC_ROOT&lt;/tt&gt; or in one of the the &lt;tt class="docutils literal"&gt;STATICFILES_DIRS&lt;/tt&gt;) so be careful to either put the static files
you need to load from PDFs (fonts, styles and possibly images) to either the &lt;tt class="docutils literal"&gt;STATIC_ROOT&lt;/tt&gt; or the
one of the &lt;tt class="docutils literal"&gt;STATICFILES_DIRS&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-a-common-style-for-your-pdfs"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id13"&gt;Using a common style for your&amp;nbsp;PDFs&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;If you need to create a lot of similar PDFs then you&amp;#8217;ll probably want to
use a bunch of common styles for them (same fonts, headers etc). This could be done using
the &lt;tt class="docutils literal"&gt;{% static %}&lt;/tt&gt; trick we saw on the previous section. However, if we include the
styling css as a static file then we won&amp;#8217;t be able to use the static-file-uri-to-local-path
mechanism described above (since the &lt;tt class="docutils literal"&gt;{% static %}&lt;/tt&gt; template tag won&amp;#8217;t work in static&amp;nbsp;files).&lt;/p&gt;
&lt;p&gt;Thankfully, not everything is lost &amp;#8212; Django comes to the rescue!!! We can create a single &lt;span class="caps"&gt;CSS&lt;/span&gt; file
that would be used by all our &lt;span class="caps"&gt;PDF&lt;/span&gt; templates and &lt;em&gt;include&lt;/em&gt; it in the templates using the &lt;tt class="docutils literal"&gt;{% include %}&lt;/tt&gt; Django
template tag! Django will think that this will be a normal template and paste its contents where we wanted and
also execute the templates&amp;nbsp;tags!&lt;/p&gt;
&lt;p&gt;We&amp;#8217;ll see an example of all this in the next&amp;nbsp;section.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="changing-the-font-to-a-unicode-enabled-one"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;Changing the font (to a Unicode enabled&amp;nbsp;one)&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The time has finally arrived to change the font! It&amp;#8217;s easy if you know exactly what to do. First of all
configure your &lt;tt class="docutils literal"&gt;STATIC_ROOT&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;STATIC_URL&lt;/tt&gt; setting, for example &lt;tt class="docutils literal"&gt;STATIC_ROOT = &lt;span class="pre"&gt;os.path.join(BASE_DIR,'static')&lt;/span&gt;&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;STATIC_URL = '/static/'&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Then, add a template-css file for your fonts in one of your templates directories. I am naming the
file &lt;tt class="docutils literal"&gt;pdfstylefonts.css&lt;/tt&gt; and I&amp;#8217;ve put it to &lt;tt class="docutils literal"&gt;books/templates&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="err"&gt;load&lt;/span&gt; &lt;span class="err"&gt;static&lt;/span&gt; &lt;span class="err"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;font-face&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nt"&gt;font-family&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Calibri&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;src&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="err"&gt;static&lt;/span&gt; &lt;span class="err"&gt;&amp;quot;fonts/calibri.ttf&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;font-face&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nt"&gt;font-family&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Calibri&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;src&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="err"&gt;static&lt;/span&gt; &lt;span class="err"&gt;&amp;quot;fonts/calibrib.ttf&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="nt"&gt;font-weight&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;bold&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;font-face&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nt"&gt;font-family&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Calibri&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;src&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="err"&gt;static&lt;/span&gt; &lt;span class="err"&gt;&amp;quot;fonts/calibrii.ttf&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="nt"&gt;font-style&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;italic&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;oblique&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;font-face&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="nt"&gt;font-family&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Calibri&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;src&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;url&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="err"&gt;%&lt;/span&gt; &lt;span class="err"&gt;static&lt;/span&gt; &lt;span class="err"&gt;&amp;quot;fonts/calibriz.ttf&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;%&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="o"&gt;);&lt;/span&gt;
    &lt;span class="nt"&gt;font-weight&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;bold&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;font-style&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;italic&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nt"&gt;oblique&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I am using Calibri family of fonts (copied from &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;c:\windows\fonts&lt;/span&gt;&lt;/tt&gt;) for this &amp;#8212; I&amp;#8217;ve also configured
all styles (bold, italic, bold-italic) of this font family to use the correct ttf files. All the
ttf files have been copied to the directory &lt;tt class="docutils literal"&gt;static/fonts/&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Now, add another css file that will be your global &lt;span class="caps"&gt;PDF&lt;/span&gt; styles. This should be put to the &lt;tt class="docutils literal"&gt;static&lt;/tt&gt; directory
and could be named &lt;tt class="docutils literal"&gt;pdfstyle.css&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;color&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;blue&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="o"&gt;*,&lt;/span&gt; &lt;span class="nt"&gt;html&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;font-family&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Calibri&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;font-size&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="kt"&gt;pt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;color&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;red&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next, here&amp;#8217;s a template that lists all books (and contain some greek characters &amp;#8212; the title of the books also contain
greek characters) &amp;#8212; I&amp;#8217;ve named it &lt;tt class="docutils literal"&gt;book_list_ex.html&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;load&lt;/span&gt; &lt;span class="nv"&gt;static&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;meta&lt;/span&gt; &lt;span class="na"&gt;http-equiv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;include&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;pdfstylefonts.css&amp;quot;&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;link&lt;/span&gt; &lt;span class="na"&gt;rel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;stylesheet&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;pdfstyle.css&amp;quot;&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;ÎÎ¯ÏÏÎ± Î²Î¹Î²Î»Î¯ÏÎ½&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;img&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;static&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;pony.png&amp;quot;&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;table&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;ID&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Title&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Cover&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;th&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;book&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;books&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.id&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.title&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;img&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.cover.url&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;td&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;tr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endfor&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;table&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You&amp;#8217;ll see that the &lt;tt class="docutils literal"&gt;pdfstylefonts.css&lt;/tt&gt; is included as a Django template (so that &lt;tt class="docutils literal"&gt;{% static %}&lt;/tt&gt; will
work in that file) while &lt;tt class="docutils literal"&gt;pdfstyle.css&lt;/tt&gt; is included using &lt;tt class="docutils literal"&gt;{% static %}&lt;/tt&gt;.
Als, notice that I&amp;#8217;ve also added a static image (using the &lt;tt class="docutils literal"&gt;{% static %}&lt;/tt&gt; tag) and a dynamic (media)
file to show off how great the url-to-local-path mechanism works. Please notice that for the
media files to work fine in your development environment you need to configure the
&lt;tt class="docutils literal"&gt;MEDIA_URL&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;MEDIA_ROOT&lt;/tt&gt; settigns (similar to &lt;tt class="docutils literal"&gt;STATIC_URL&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;STATIC_ROOT&lt;/tt&gt;) and follow the
&lt;a class="reference external" href="https://docs.djangoproject.com/en/1.8/howto/static-files/#serving-files-uploaded-by-a-user-during-development"&gt;serve files uploaded by a user during development&lt;/a&gt; tutorial on Django&amp;nbsp;docs.&lt;/p&gt;
&lt;p&gt;Finally, if you configure a PdfResponseMixin ListView like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BookExPdfListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PdfResponseMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;books&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
    &lt;span class="n"&gt;template_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;books/book_list_ex.html&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;you should see be able to see the correct (calibri) font (defined in &lt;tt class="docutils literal"&gt;pdfstylefonts.css&lt;/tt&gt;), with unicode characters without problems
including both the static and user uploaded images and with the styles defined in the pdf stylesheet (&lt;tt class="docutils literal"&gt;pdfstyle.css&lt;/tt&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="configure-django-for-debugging-pdf-creation"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;Configure Django for debugging &lt;span class="caps"&gt;PDF&lt;/span&gt;&amp;nbsp;creation&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;If you experience any problems, you can configure xhtml2pdf to output &lt;span class="caps"&gt;DEBUG&lt;/span&gt; information. To do this,
you may change your django logging configuration like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;LOGGING&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;disable_existing_loggers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;handlers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;console&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;logging.StreamHandler&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;loggers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;xhtml2pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;handlers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;console&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;level&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DEBUG&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This configuration will keep existing loggers (&lt;tt class="docutils literal"&gt;'disable_existing_loggers': False,&lt;/tt&gt;) and will configure
&lt;tt class="docutils literal"&gt;xhtml2pdf&lt;/tt&gt; to log its output to the console, helping us find out why some things won&amp;#8217;t be&amp;nbsp;working.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="concatenating-pdfs-in-django"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;Concatenating PDFs in&amp;nbsp;Django&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The final section of the &lt;span class="caps"&gt;PDF&lt;/span&gt;-Django-integration is to explain how we can concatenate PDFs in django using PyPDF2. There may be
some other requirements like extracting pages from PDFs however the most common one as explained before is to just append
the pages of one &lt;span class="caps"&gt;PDF&lt;/span&gt; after the other &amp;#8212; after all using PyPDF2 is really easy after you get the hang of&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;To be more &lt;span class="caps"&gt;DRY&lt;/span&gt;, I will create a &lt;tt class="docutils literal"&gt;CoverPdfResponseMixin&lt;/tt&gt; that will output a &lt;span class="caps"&gt;PDF&lt;/span&gt; &lt;em&gt;with&lt;/em&gt; a cover. To be &lt;em&gt;even more&lt;/em&gt; &lt;span class="caps"&gt;DRY&lt;/span&gt;,
I will refactor &lt;tt class="docutils literal"&gt;PdfResponseMixin&lt;/tt&gt; to put some common code in an extra method so that &lt;tt class="docutils literal"&gt;CoverPdfResponseMixin&lt;/tt&gt; could inherit from&amp;nbsp;it:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;PdfResponseMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;write_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;file_object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;context&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;template&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_template_names&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;generate_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;file_object&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;file_object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application/pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;resp&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CoverPdfResponseMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PdfResponseMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;cover_pdf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;merger&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PdfFileMerger&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;merger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cover_pdf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

        &lt;span class="n"&gt;pdf_fo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringIO&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;StringIO&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pdf_fo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;merger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pdf_fo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="n"&gt;resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application/pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;merger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;resp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So, &lt;tt class="docutils literal"&gt;PdfResponseMixin&lt;/tt&gt; now has a &lt;tt class="docutils literal"&gt;write_pdf&lt;/tt&gt; method that gets a file-like object and outputs the &lt;span class="caps"&gt;PDF&lt;/span&gt; there.
The new mixin, &lt;tt class="docutils literal"&gt;CoverPdfResponseMixin&lt;/tt&gt; has a &lt;tt class="docutils literal"&gt;cover_pdf&lt;/tt&gt; attribute that should be configured with the filesystem
path of the cover file. The &lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt; method now will create a &lt;tt class="docutils literal"&gt;PdfFileMerger&lt;/tt&gt; (which is empty
initially) to which it appends the contents &lt;tt class="docutils literal"&gt;cover_pdf&lt;/tt&gt;. After that, it creates a file-stream (using StreamIO)
and uses &lt;tt class="docutils literal"&gt;write_pdf&lt;/tt&gt; to create the &lt;span class="caps"&gt;PDF&lt;/span&gt; there and appends that file-stream to the merger. Finally, it writes
the merger contents to the &lt;tt class="docutils literal"&gt;HttpResponse&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;One thing that I&amp;#8217;ve seen is that if you want to concatenate many PDFs with many pages sometimes you&amp;#8217;ll get
a strange an error when using &lt;tt class="docutils literal"&gt;PdfFileMerger&lt;/tt&gt;. I was able to overcome this by reading and appending the pages of each
&lt;span class="caps"&gt;PDF&lt;/span&gt; to-be-appended one by one using the &lt;tt class="docutils literal"&gt;PdfFileReader&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;PdfFileWriter&lt;/tt&gt; objects. Here&amp;#8217;s a small snippet of how
this could be&amp;nbsp;done:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pdfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt; &lt;span class="c1"&gt;# List of pdfs to be concatenated&lt;/span&gt;
&lt;span class="n"&gt;writer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PdfFileWriter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;pdf&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;pdfs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;reader&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;PdfFileReader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pdf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getNumPages&lt;/span&gt;&lt;span class="p"&gt;()):&lt;/span&gt;
        &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;addPage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getPage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application/pdf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;resp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="more-advanced-xhtml2pdf-features"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;More advanced xhtml2pdf&amp;nbsp;features&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In this section I will present some information on how to use various xhtml2pdf features
to create the most common required printed document features, for example adding page
numbers, adding headers and footers&amp;nbsp;etc.&lt;/p&gt;
&lt;div class="section" id="laying-out"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;Laying&amp;nbsp;out&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To find out how you can create your pages you should read the
&lt;a class="reference external" href="https://github.com/xhtml2pdf/xhtml2pdf/blob/master/doc/usage.rst#defining-page-layouts"&gt;defining page layouts&lt;/a&gt; section of the xhtml2pdf manual. There
you&amp;#8217;ll see that the basic components of laying out in xhtml2pdf is
&amp;#64;page to create pages and &amp;#64;frames to create rectangular components
inside these pages. So each page will have a number of frames
inside it. These frames are seperated to static and dynamic. Staticsome
should be used for things like headers
and footers (so they&amp;#8217;ll be the same across all pages) and dynamic will
contain the main content of the&amp;nbsp;report.&lt;/p&gt;
&lt;p&gt;For pages you can use any page size you want, not just the specified ones. For example, in one of my
projects I wanted to create a &lt;span class="caps"&gt;PDF&lt;/span&gt; print on a normal plastic card, so I&amp;#8217;d used the
following &lt;tt class="docutils literal"&gt;size: 8.56cm 5.398cm;&lt;/tt&gt;. Also, page templates can be named
and you can use different ones in the same &lt;span class="caps"&gt;PDF&lt;/span&gt; (so you could create
a cover page with a different page template, use it first and then continue
with the normal pages). To name a tempalte you just use &amp;#64;page template_name {}
and to change the template use the combination of the following two xhtml2pdf&amp;nbsp;tags:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;pdf:nexttemplate&lt;/span&gt; &lt;span class="na"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;back_page&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;pdf:nextpage&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now, one thing I&amp;#8217;ve noticed is that you are not able to use a named template for the first
page of your &lt;span class="caps"&gt;PDF&lt;/span&gt;. So, what I&amp;#8217;ve done is that I create an anonymous (default) page for the
first page of the report. If I want to &lt;em&gt;reuse&lt;/em&gt; it in another page, I copy it and name it
accordingly. I will give an example&amp;nbsp;shortly.&lt;/p&gt;
&lt;p&gt;Now, for frames, I recommend using the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-pdf-frame-border:&lt;/span&gt; 1;&lt;/tt&gt; command for debugging where
they are actually printed. Also, I recommend using a normal ruler and measuring completely
where you want them to be. For example, for the following&amp;nbsp;frame:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;frame&lt;/span&gt; &lt;span class="nt"&gt;photo_frame&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nt"&gt;-pdf-frame-border&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;top&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;4cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;left&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;9cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;height&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I&amp;#8217;d used a ruler to find out that I want it to start 2.4 cm from the top of my page (actually a credit card)
and 6.2 cm from the left and have a width and height of 1.9 and 2.2&amp;nbsp;cm.&lt;/p&gt;
&lt;p&gt;I recommend naming all frames to be able to distinguish them however I don&amp;#8217;t think that their name plays
any other role. However, for static frames you must define the id of the content they will contain using &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-pdf-frame-content&lt;/span&gt;&lt;/tt&gt;
in the css and a div with the corresponding id in the &lt;span class="caps"&gt;PDF&lt;/span&gt; template. For example, you could define a frame header like&amp;nbsp;this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;frame&lt;/span&gt; &lt;span class="nt"&gt;header&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="nt"&gt;-pdf-frame-content&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;headerContent&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;8in&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;top&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;5cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;margin-left&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;5cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;margin-right&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;5cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
  &lt;span class="nt"&gt;height&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;2cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and its content like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;headerContent&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt; &lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    Header !
  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Please notice that if for some reason the stuff you want to put in your static frames does not fit there the frame will
be totally empty. This means that if you have size for three lines but you want to output five lines in a static frame
then you&amp;#8217;ll see no&amp;nbsp;lines!&lt;/p&gt;
&lt;p&gt;Now, for dynamic content you can expect the opposite behavior:
You &lt;em&gt;cannot&lt;/em&gt; select to which dynamic frame your content goes, instead the content just just flows to the first dynamic frame it
fits! If it does not fit in any dynamic frames in the current page then a new page will be&amp;nbsp;created.&lt;/p&gt;
&lt;p&gt;I&amp;#8217;d like to present a full example here on the already mentioned project of printing a plastic card for the books. I had two page layouts,
one for the front page having a frame with the owner&amp;#8217;s data and another frame with his photo and one for the back page having
a barcode. This is a Django template that is used to print not only but a &lt;span class="caps"&gt;PDF&lt;/span&gt; with a group of these&amp;nbsp;cards:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;meta&lt;/span&gt; &lt;span class="na"&gt;http-equiv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;include&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;pdfstylefonts.css&amp;quot;&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;text/css&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;page&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nt"&gt;size&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;8&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;56cm&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;398cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;margin&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

        &lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;frame&lt;/span&gt; &lt;span class="nt"&gt;table_frame&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="c"&gt;/* -pdf-frame-border: 1; */&lt;/span&gt;
            &lt;span class="nt"&gt;top&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;4cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;left&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;4cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;5cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;height&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;3cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;frame&lt;/span&gt; &lt;span class="nt"&gt;photo_frame&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="c"&gt;/* -pdf-frame-border: 1; */&lt;/span&gt;
            &lt;span class="nt"&gt;top&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;4cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;left&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;9cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;height&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;page&lt;/span&gt; &lt;span class="nt"&gt;front_page&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nt"&gt;size&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;8&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;56cm&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;398cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;margin&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

        &lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;frame&lt;/span&gt; &lt;span class="nt"&gt;table_frame&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="c"&gt;/* -pdf-frame-border: 1; */&lt;/span&gt;
            &lt;span class="nt"&gt;top&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;4cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;left&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;4cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;5cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;height&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;3cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;

        &lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;frame&lt;/span&gt; &lt;span class="nt"&gt;photo_frame&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="c"&gt;/* -pdf-frame-border: 1; */&lt;/span&gt;
            &lt;span class="nt"&gt;top&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;4cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;left&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;9cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;height&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;2cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;page&lt;/span&gt; &lt;span class="nt"&gt;back_page&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nt"&gt;size&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;8&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;56cm&lt;/span&gt; &lt;span class="nt"&gt;5&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;398cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;margin&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;0&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

        &lt;span class="p"&gt;@&lt;/span&gt;&lt;span class="k"&gt;frame&lt;/span&gt; &lt;span class="nt"&gt;barcode_frame&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="c"&gt;/* -pdf-frame-border: 1; */&lt;/span&gt;
            &lt;span class="nt"&gt;top&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;  &lt;span class="nt"&gt;3&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;9cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;left&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;8cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;width&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;9cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
            &lt;span class="nt"&gt;height&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nt"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1cm&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="o"&gt;*,&lt;/span&gt; &lt;span class="nt"&gt;html&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;font-family&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Calibri&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;font-size&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="kt"&gt;pt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;line-height&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="kt"&gt;%&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;bigger&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;font-size&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="kt"&gt;pt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;font-weight&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;bold&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;style&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;head&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="nv"&gt;book&lt;/span&gt; &lt;span class="k"&gt;in&lt;/span&gt; &lt;span class="nv"&gt;books&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="cp"&gt;&amp;lt;! -- Here I print the card data. It fits exactly in the table_frame so ... -&amp;gt;&lt;/span&gt;
            &lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.title&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
            Data line 2&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
            Data line 3&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
            Data line 4&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
            Data line 5&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
            Data line 6&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
            Data line 7&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
            Data line 8&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
            Data line 9&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
            Data line 10&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;br&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="cp"&gt;&amp;lt;! -- This photo here will be outputted to the photo_frame --&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;img&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.cover.url&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt; &lt;span class="na"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;width:1.9cm ; height: 2.2cm ; &amp;#39;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;

        &lt;span class="cp"&gt;&amp;lt;! -- Now the template is chaned to print the back of the card --&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;pdf:nexttemplate&lt;/span&gt; &lt;span class="na"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;back_page&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;pdf:nextpage&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;

        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;center&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
                &lt;span class="cp"&gt;&amp;lt;! -- Print the barcode to the barcode_frame --&amp;gt;&lt;/span&gt;
                &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;pdf:barcode&lt;/span&gt; &lt;span class="na"&gt;value&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;{{&lt;/span&gt; &lt;span class="nv"&gt;book.id&lt;/span&gt; &lt;span class="cp"&gt;}}&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;code128&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;humanreadable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;barwidth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;0.43mm&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;barheight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;0.6cm&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;align&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;middle&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;center&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="c"&gt;&amp;lt;!-- Use the front_page template again for the next card --&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;pdf:nexttemplate&lt;/span&gt; &lt;span class="na"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;front_page&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;pdf:nextpage&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class="cp"&gt;{%&lt;/span&gt; &lt;span class="k"&gt;endfor&lt;/span&gt; &lt;span class="cp"&gt;%}&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice that I want to print exactly 10 lines in the &lt;tt class="docutils literal"&gt;table_frame&lt;/tt&gt; (that&amp;#8217;s why I use &amp;lt;br /&amp;gt; to go to next line) &amp;#8212; if I had printed
3-4 lines (for example) then the photo &lt;em&gt;would fit&lt;/em&gt; in the &lt;tt class="docutils literal"&gt;table_frame&lt;/tt&gt; and would be printed there and &lt;em&gt;not&lt;/em&gt; in the &lt;tt class="docutils literal"&gt;photo_frame&lt;/tt&gt;! Also,
another interesting thing is that if I had
outputed 8-9 lines then the photo wouldn&amp;#8217;t fit in that small space and would also be printed to the &lt;tt class="docutils literal"&gt;photo_frame&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="extra-stuff"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;Extra&amp;nbsp;stuff&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Some extra things I want to mention concerning&amp;nbsp;xhtml2pdf:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&amp;lt;pdf:pagenumber&amp;gt;&lt;/tt&gt; to output the current page number (please end the line after this&amp;nbsp;tag)&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&amp;lt;pdf:pagecount&amp;gt;&lt;/tt&gt; to output the total page number (please end the line after this&amp;nbsp;tag)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So if you want to print a footer with the pages, I recommend something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;footerContent&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  Page &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;pdf:pagenumber&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  from &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;pdf:pagecount&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
  total
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Notice how the lines end after the&amp;nbsp;tags.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;&amp;lt;pdf:barcode&amp;gt;&lt;/tt&gt;: Output a barcode in your &lt;span class="caps"&gt;PDF&lt;/span&gt;. Here are the possible barcode types: I2of5, Standard39, Extended39, Standard93, Extended93, &lt;span class="caps"&gt;MSI&lt;/span&gt;, Codabar, Code11, &lt;span class="caps"&gt;FIM&lt;/span&gt;, &lt;span class="caps"&gt;POSTNET&lt;/span&gt;, USPS_4State, Code128, &lt;span class="caps"&gt;EAN13&lt;/span&gt;, &lt;span class="caps"&gt;EAN8&lt;/span&gt;, &lt;span class="caps"&gt;QR&lt;/span&gt;.&lt;/li&gt;
&lt;li&gt;You may add a page background image using  the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;background-image&lt;/span&gt;&lt;/tt&gt; property of &lt;tt class="docutils literal"&gt;&amp;#64;page&lt;/tt&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For example, if you want the templates you create from your development/&lt;span class="caps"&gt;UAT&lt;/span&gt; systems to be different
than the production ones you could do something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;#64;page {
    {% if DEBUG %}
        background-image: url({% static &amp;quot;debug.png&amp;quot; %});
    {% endif %}
    &amp;lt;!-- Other page properties --&amp;gt;
}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id20"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I hope that using the techniques described in this essential guide you&amp;#8217;ll
be able to create great looking &lt;span class="caps"&gt;PDF&lt;/span&gt; documents from your Django application
and overcome any difficulties that may arise. If you feel that there&amp;#8217;s something
I&amp;#8217;ve not covered properly (and is not covered by the documentation) please comment
out and I&amp;#8217;ll be happy to research it a bit and update the article with&amp;nbsp;info.&lt;/p&gt;
&lt;p&gt;I am using all the above in various production applications for a long time and everything
is smooth so don&amp;#8217;t afraid to create PDFs from&amp;nbsp;Django!&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="pdf"></category><category term="django"></category><category term="reportlab"></category><category term="python"></category><category term="xhtml2pdf"></category></entry><entry><title>Improve your client-side-javascript workflow more by using ES6</title><link href="https://spapas.github.io/2015/11/16/using-browserify-es6/" rel="alternate"></link><published>2015-11-16T14:20:00+02:00</published><updated>2015-11-16T14:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-11-16:/2015/11/16/using-browserify-es6/</id><summary type="html">&lt;p class="first last"&gt;Browserify can be used to integrate next generation javascript (es6) to your client side scripts using&amp;nbsp;babel.&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#npm-save-save-dev-and-avoiding-global-deps" id="id2"&gt;&lt;span class="caps"&gt;NPM&lt;/span&gt;, &amp;#8212;save, &amp;#8212;save-dev and avoiding global&amp;nbsp;deps&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-babel" id="id3"&gt;Using&amp;nbsp;babel&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#integrate-babel-with-browserify" id="id4"&gt;Integrate babel with&amp;nbsp;browserify&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-object-spread-operator" id="id5"&gt;The object-spread&amp;nbsp;operator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id6"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Update 22/12/2015:&lt;/strong&gt; Add section for the object-spread&amp;nbsp;operator.&lt;/p&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In a &lt;a class="reference external" href="https://spapas.github.io/2015/05/27/using-browserify-watchify/"&gt;previous article&lt;/a&gt;
we presented a simple workflow to improve your client-side (javascript) workflow
by including a bunch of tools from the node-js world i.e &lt;a class="reference external" href="http://browserify.org/"&gt;browserify&lt;/a&gt; and
its friends, &lt;a class="reference external" href="https://github.com/substack/watchify"&gt;watchify&lt;/a&gt; and &lt;a class="reference external" href="https://www.npmjs.com/package/uglify-js"&gt;uglify-js&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Using these tools we were able to properly manage our client side dependencies
(no more script tags in our html templates) and modularize our code
(so we could avoid monolithic javascript files that contained all our code).
Another great improvement to our workflow would be to include &lt;span class="caps"&gt;ES6&lt;/span&gt; to the&amp;nbsp;mix!&lt;/p&gt;
&lt;p&gt;&lt;span class="caps"&gt;ES6&lt;/span&gt; (or EcmaScript 2015) is more or less &amp;#8220;Javascript: &lt;span class="caps"&gt;TNG&lt;/span&gt;&amp;#8221;. It has many features
that greatly improve the readability and writability of javascript code - for instance,
thick arrows, better classes, better modules, iterators/generators, template strings,
default function parameters and many others!
More info on these features and how they could be used can be found on the &lt;a class="reference external" href="https://github.com/lukehoban/es6features"&gt;es6features&lt;/a&gt;&amp;nbsp;repository.&lt;/p&gt;
&lt;p&gt;Unfortunately, these features are either not supported at all, or they are partially supported
on current (November 2015) browsers. However all is &lt;em&gt;not&lt;/em&gt; lost yet: Since we already use browserify
to our client side workflow, we can easily enable it to read source files with &lt;span class="caps"&gt;ES6&lt;/span&gt; syntax
and transform them to normal javascript using a transformation through the &lt;a class="reference external" href="https://babeljs.io/"&gt;babel&lt;/a&gt;&amp;nbsp;tool.&lt;/p&gt;
&lt;p&gt;In the following, we&amp;#8217;ll talk a bit more about the node-js package manager (npm) features,
talk a little about babel and finally
modify our workflow so that it will be able to use &lt;span class="caps"&gt;ES6&lt;/span&gt;! Please notice that to properly follow this article
you need to first read the &lt;a class="reference external" href="https://spapas.github.io/2015/05/27/using-browserify-watchify/"&gt;previous one&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="npm-save-save-dev-and-avoiding-global-deps"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;&lt;span class="caps"&gt;NPM&lt;/span&gt;, &amp;#8212;save, &amp;#8212;save-dev and avoiding global&amp;nbsp;deps&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the previous article, I had recommended to install the needed tools
(needed to create the output bundle browserify, watchify, uglify) globally
using npm install -g package (of course the normal dependencies like moment.js
would be installed locally).
This has one advantage and two disadvantages: It
puts these tools to the path so they can be called immediately (i.e browserify)
but you will need root access to install a package globally and nothing is
saved on &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; so you don&amp;#8217;t know which packages must be installed
in order to start developing the&amp;nbsp;project!&lt;/p&gt;
&lt;p&gt;This could be ok for the introductionary article, however for this one I
will propose another alternative: Install all the tools &lt;em&gt;locally&lt;/em&gt; using just
&lt;tt class="docutils literal"&gt;npm install package &lt;span class="pre"&gt;--save&lt;/span&gt;&lt;/tt&gt;. These tools will be put to the &lt;tt class="docutils literal"&gt;node_modules&lt;/tt&gt; folder. They
&lt;em&gt;will not&lt;/em&gt; be put to the path, but if you want to execute a binary by yourself
to debug the output, you can find it in &lt;tt class="docutils literal"&gt;node_modules/bin&lt;/tt&gt;, for example,
for browserify you can run &lt;tt class="docutils literal"&gt;node_modules/bin/browserify&lt;/tt&gt;. Another intersting
thing is that if you create executable scripts in your &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; you
don&amp;#8217;t actually need to include the full path but the binaries will be&amp;nbsp;found.&lt;/p&gt;
&lt;p&gt;Another thing I&amp;#8217;d like to discuss here is the difference between &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--save&lt;/span&gt;&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--save-dev&lt;/span&gt;&lt;/tt&gt; options that can be passed to npm install. If you take
a look at other guides you&amp;#8217;ll see that people are using &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--save-dev&lt;/span&gt;&lt;/tt&gt; for
development dependencies (i.e testing) and &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--save&lt;/span&gt;&lt;/tt&gt; for normal dependencies.
The difference is that these dependencies are saved in different places in
&lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; and if you run &lt;tt class="docutils literal"&gt;npm install &lt;span class="pre"&gt;--production&lt;/span&gt;&lt;/tt&gt; you&amp;#8217;ll get only
the normal dependencies (while, if you run &lt;tt class="docutils literal"&gt;npm install&lt;/tt&gt; all dependencies
will be installed). In these articles, I chose to just use &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--save&lt;/span&gt;&lt;/tt&gt; everywhere,
after all the only thing that would be needed for production would be the
&lt;tt class="docutils literal"&gt;bundle.js&lt;/tt&gt; output&amp;nbsp;file.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-babel"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Using&amp;nbsp;babel&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The &lt;a class="reference external" href="https://babeljs.io/"&gt;babel&lt;/a&gt; library &amp;#8220;is a JavaScript compiler&amp;#8221;. It gets input files in a variant
of javascript (for example, &lt;span class="caps"&gt;ES6&lt;/span&gt;) and produces normal javascript files &amp;#8212; something
like what browserify transforms do. However, what babel does (and I think its
the only tool that does this) is that it allows you to use &lt;span class="caps"&gt;ES6&lt;/span&gt; features &lt;em&gt;now&lt;/em&gt; by
transpiling them to normal (&lt;span class="caps"&gt;ES5&lt;/span&gt;) javascript. Also, babel has &lt;a class="reference external" href="https://babeljs.io/docs/plugins/"&gt;various other transforms&lt;/a&gt;,
including a react transform
(so you can use this instead of the reactify&amp;nbsp;browserify-transform)!&lt;/p&gt;
&lt;p&gt;In any case, to be able to use &lt;span class="caps"&gt;ES6&lt;/span&gt;, we&amp;#8217;ll need to install babel and its es6 presets
(don&amp;#8217;t forget that you need to have a &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; for the dependencies to be
saved so either do an &lt;tt class="docutils literal"&gt;npm init&lt;/tt&gt; or create a &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; file containing only
&lt;tt class="docutils literal"&gt;{}&lt;/tt&gt;):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
npm install  babel babel-preset-es2015 --save
&lt;/pre&gt;
&lt;p&gt;If we wanted to also use babel for react we&amp;#8217;d need to install&amp;nbsp;babel-preset-react.&lt;/p&gt;
&lt;p&gt;To configure babel we can either add a &lt;tt class="docutils literal"&gt;babel&lt;/tt&gt;
section in our &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; or create a new file named .babelrc and put the configuration&amp;nbsp;there.&lt;/p&gt;
&lt;p&gt;I prefer the first one since we are already using the &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt;. So add the following attribute
to your &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;quot;babel&amp;quot;: {
  &amp;quot;presets&amp;quot;: [
    &amp;quot;es2015&amp;quot;
  ]
}
&lt;/pre&gt;
&lt;p&gt;If you wanted to configure it through &lt;tt class="docutils literal"&gt;.babelrc&lt;/tt&gt; then you&amp;#8217;d just copy to it the contents of &lt;tt class="docutils literal"&gt;&amp;quot;babel&amp;quot;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;To do some tests with babel, you can install its cli (it&amp;#8217;s not included in the babel package) through
&lt;tt class="docutils literal"&gt;npm install &lt;span class="pre"&gt;babel-cli&lt;/span&gt;&lt;/tt&gt;. Now, you can run &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;node_modules/.bin/babel&lt;/span&gt;&lt;/tt&gt;. For example, create a
file named &lt;tt class="docutils literal"&gt;testbabel.js&lt;/tt&gt; with the following contents (thick&amp;nbsp;arrow):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
[1,2,3].forEach(x =&amp;gt; console.log(x) );
&lt;/pre&gt;
&lt;p&gt;when you pass it to babel you&amp;#8217;ll see the following&amp;nbsp;output:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;gt;node_modules\.bin\babel testbabel.js
&amp;quot;use strict&amp;quot;;

[1, 2, 3].forEach(function (x) {
  return console.log(x);
});
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="integrate-babel-with-browserify"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Integrate babel with&amp;nbsp;browserify&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To call babel from browserify we&amp;#8217;re going to use the &lt;a class="reference external" href="https://github.com/babel/babelify"&gt;babelify&lt;/a&gt; browserify transform which
actually uses babel to transpile the browserify input. After installing it&amp;nbsp;with&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
npm install babelify --save
&lt;/pre&gt;
&lt;p&gt;you need to tell browserify to use it. To do this, you&amp;#8217;ll just pass a -t babelify parameter to
browserify. So if you run it with the &lt;tt class="docutils literal"&gt;testbabel.js&lt;/tt&gt; file as input you&amp;#8217;ll see the following&amp;nbsp;output:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;gt;node_modules\.bin\browserify -t babelify testbabel.js
[...] browserify gibberish
&amp;quot;use strict&amp;quot;;

[1, 2, 3].forEach(function (x) {
  return console.log(x);
});

[...] more browserify gibberish
&lt;/pre&gt;
&lt;p&gt;yey &amp;#8212; the code is transpiled to &lt;span class="caps"&gt;ES5&lt;/span&gt;!&lt;/p&gt;
&lt;p&gt;To create a complete project, let&amp;#8217;s add a normal requirement&amp;nbsp;(moment.js):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
npm install moment --save
&lt;/pre&gt;
&lt;p&gt;and a file named &lt;tt class="docutils literal"&gt;src\main.js&lt;/tt&gt; that uses it with &lt;span class="caps"&gt;ES6&lt;/span&gt;&amp;nbsp;syntax:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
import moment from 'moment';

const arr = [1,2,3,4,5];
arr.forEach(x =&amp;gt; setTimeout(() =&amp;gt; console.log(`Now: ${moment().format(&amp;quot;HH:mm:ss&amp;quot;)}, Later: ${moment().add(x, &amp;quot;days&amp;quot;).format(&amp;quot;L&amp;quot;)}...`), x*1000));
&lt;/pre&gt;
&lt;p&gt;To create the output javascript file, we&amp;#8217;ll use the browserify and watchify commands with the
addition of the -t babelify switch. Here&amp;#8217;s the complete &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; for this&amp;nbsp;project:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
{
  &amp;quot;dependencies&amp;quot;: {
    &amp;quot;babel&amp;quot;: &amp;quot;^6.1.18&amp;quot;,
    &amp;quot;babel-preset-es2015&amp;quot;: &amp;quot;^6.1.18&amp;quot;,
    &amp;quot;babelify&amp;quot;: &amp;quot;^7.2.0&amp;quot;,
    &amp;quot;browserify&amp;quot;: &amp;quot;^12.0.1&amp;quot;,
    &amp;quot;moment&amp;quot;: &amp;quot;^2.10.6&amp;quot;,
    &amp;quot;uglify-js&amp;quot;: &amp;quot;^2.6.0&amp;quot;,
    &amp;quot;watchify&amp;quot;: &amp;quot;^3.6.1&amp;quot;
  },
  &amp;quot;scripts&amp;quot;: {
    &amp;quot;watch&amp;quot;: &amp;quot;watchify src/main.js -o dist/bundle.js -v -t babelify&amp;quot;,
    &amp;quot;build&amp;quot;: &amp;quot;browserify src/main.js -t babelify | uglifyjs -mc warnings=false &amp;gt; dist/bundle.js&amp;quot;
  },
  &amp;quot;babel&amp;quot;: {
    &amp;quot;presets&amp;quot;: [
      &amp;quot;es2015&amp;quot;
    ]
  }
}
&lt;/pre&gt;
&lt;p&gt;Running &lt;tt class="docutils literal"&gt;npm run build&lt;/tt&gt; should create a &lt;tt class="docutils literal"&gt;dist/bundle.js&lt;/tt&gt; file. If you include this in an html,
you should see something like this in the&amp;nbsp;console:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
Now: 13:52:09, Later: 11/17/2015...
Now: 13:52:10, Later: 11/18/2015...
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="the-object-spread-operator"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;The object-spread&amp;nbsp;operator&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Many examples in the internet use the &lt;a class="reference external" href="https://facebook.github.io/react/docs/jsx-spread.html#spread-attributes"&gt;object spread operator&lt;/a&gt; which is &lt;a class="reference external" href="http://stackoverflow.com/questions/31115276/ecmascript-6-spread-operator-in-object-deconstruction-support-in-typescript-and"&gt;not part of es6&lt;/a&gt; so our
proposed babel configuration does not support it!
To be able to use this syntax, we&amp;#8217;ll need to install the corresponding babel plugin by using
&lt;tt class="docutils literal"&gt;npm install &lt;span class="pre"&gt;babel-plugin-transform-object-rest-spread&lt;/span&gt; &lt;span class="pre"&gt;--save&lt;/span&gt;&lt;/tt&gt; and add it to our babel configuration
in the plugins section, something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;quot;presets&amp;quot;: [
  &amp;quot;es2015&amp;quot;,
  &amp;quot;react&amp;quot;
],
&amp;quot;plugins&amp;quot;: [
  &amp;quot;transform-object-rest-spread&amp;quot;
]
&lt;/pre&gt;
&lt;p&gt;If everything is ok this should be transpiled without errors using &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;node_modules\.bin\browserify&lt;/span&gt; testbabe.js &lt;span class="pre"&gt;-t&lt;/span&gt; babelify&lt;/tt&gt;&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
let x = {a:1 , b:2 };
let y = {...x, c: 3};
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using the combination of babel and javascript we can easily write &lt;span class="caps"&gt;ES6&lt;/span&gt; code in our modules! This,
along with the modularization of our code and the management of client-side dependencies should
make client side development a&amp;nbsp;breeze!&lt;/p&gt;
&lt;p&gt;Please notice that to keep the presented workflow simple and easy to
replicate and configure, we have not used any external
task runners (like gulp or grunt) &amp;#8212; all configuration is kept in a single file (package.json) and
the whole environment can be replicated just by doing a &lt;tt class="docutils literal"&gt;npm install&lt;/tt&gt;. Of course, the capabilities of
browserify are not unlimited, so if you wanted to do something more complicated
(for instance, lint your code before passing it to browserify) you&amp;#8217;d need to use the mentioned
task runners (or webpack which is the current trend in javascript bundlers and actually replaces
the task&amp;nbsp;runners).&lt;/p&gt;
&lt;/div&gt;
</content><category term="javascript"></category><category term="javascript"></category><category term="browserify"></category><category term="node"></category><category term="npm"></category><category term="watchify"></category><category term="generic"></category><category term="uglify"></category><category term="babel"></category><category term="es6"></category></entry><entry><title>Django dynamic tables and filters for similarÂ models</title><link href="https://spapas.github.io/2015/10/05/django-dynamic-tables-similar-models/" rel="alternate"></link><published>2015-10-05T14:20:00+03:00</published><updated>2015-10-05T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-10-05:/2015/10/05/django-dynamic-tables-similar-models/</id><summary type="html">&lt;p class="first last"&gt;Creating &lt;span class="caps"&gt;DRY&lt;/span&gt; and dynamic tables and forms for similar models in&amp;nbsp;django&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-problem-we-ll-solve" id="id2"&gt;The problem we&amp;#8217;ll&amp;nbsp;solve&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#adding-the-dynamic-table" id="id3"&gt;Adding the dynamic&amp;nbsp;table&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#creating-a-dynamic-form-for-filtering" id="id4"&gt;Creating a dynamic form for&amp;nbsp;filtering&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#creating-the-dynamic-cbv" id="id5"&gt;Creating the dynamic &lt;span class="caps"&gt;CBV&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id6"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One of my favorite django apps is &lt;a class="reference external" href="https://github.com/bradleyayers/django-tables2"&gt;django-tables2&lt;/a&gt;: It allows you to
easily create pagination and sorting enabled &lt;span class="caps"&gt;HTML&lt;/span&gt; tables to represent
your model data using the usual djangonic technique (similar to how
you &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.8/topics/forms/modelforms/#modelform"&gt;create ModelForms&lt;/a&gt;). I use it to almost all my projects to
represent the data, along with &lt;a class="reference external" href="https://github.com/alex/django-filter"&gt;django-filter&lt;/a&gt; to create forms
to filter my model data. I&amp;#8217;ve written &lt;a class="reference external" href="http://stackoverflow.com/questions/13611741/django-tables-column-filtering/15129259#15129259"&gt;a nice &lt;span class="caps"&gt;SO&lt;/span&gt; answer&lt;/a&gt; with
instructions on how to use django-filter along with django-tables2.
This article will describe a technique that allows you to generate
tables and filters for your models in the most &lt;span class="caps"&gt;DRY&lt;/span&gt;&amp;nbsp;way!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-problem-we-ll-solve"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;The problem we&amp;#8217;ll&amp;nbsp;solve&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The main tool django-tables2 offers is a template tag called &lt;tt class="docutils literal"&gt;render_table&lt;/tt&gt;
that gets an instance of a subclass of &lt;tt class="docutils literal"&gt;django_tables2.Table&lt;/tt&gt;
which contains a description of the table (columns, style etc) along
with a queryset with the table&amp;#8217;s data and outputs it to the page. A nice
extra feature of render_table is that you could pass it just a simple
django queryset and it will output it without the need to create the
custom Table class. So you can do something like {% render_table User.objects.all() %}
and get a quick output of your Users&amp;nbsp;table.&lt;/p&gt;
&lt;p&gt;In one of my projects I had three models that
were used for keeping a different type of business log in the database (for auditing reasons)
and was using the above feature to display these logs to the administrators, just by
creating a very simple &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt; (a different one for each Log type) and using the
&lt;tt class="docutils literal"&gt;render_table&lt;/tt&gt; to display the data. So I&amp;#8217;d created three views limilar to&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AuditLogListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;AuditLog&lt;/span&gt;
  &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;logs&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;which all used a single template that contained a line &lt;tt class="docutils literal"&gt;{% render_table logs %}&lt;/tt&gt; to display
the table (the &lt;tt class="docutils literal"&gt;logs&lt;/tt&gt; context variable contains the list/queryset of &lt;tt class="docutils literal"&gt;AuditLog&lt;/tt&gt; s)
so &lt;tt class="docutils literal"&gt;render_table&lt;/tt&gt; will just output that list in a page. Each view of course had a different
&lt;tt class="docutils literal"&gt;model&lt;/tt&gt; attribute.&lt;/p&gt;
&lt;p&gt;This was a nice &lt;span class="caps"&gt;DRY&lt;/span&gt; (but quick and dirty solution) that soon was not enough to fulfill the
needs of the administrators since they neeeded to have default sorting, filtering, hide
the primary key-id column etc. The obvious solution for that would be to just create three different
&lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; subclasses that
would more or less have the same options with only their &lt;tt class="docutils literal"&gt;model&lt;/tt&gt; attributte different. I didn&amp;#8217;t
like this solution that much since it seemed non-&lt;span class="caps"&gt;DRY&lt;/span&gt; to me and I would instead prefer to
create a generic &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; (that wouldn&amp;#8217;t have a &lt;tt class="docutils literal"&gt;model&lt;/tt&gt; attributte) and would just output
its data with the correct options &amp;#8212; so instead of three &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; classes I&amp;#8217;d like to create
just a single one with common options that would display its data (what &lt;tt class="docutils literal"&gt;render_table&lt;/tt&gt; does).&lt;/p&gt;
&lt;p&gt;Unfortunately, I couldn&amp;#8217;t find a solution to this, since when I ommited the &lt;tt class="docutils literal"&gt;model&lt;/tt&gt; attribute
from the &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; subclass nothing was outputed (there is no way to define fields to
display in a &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; without also defining the model). An obvious (and &lt;span class="caps"&gt;DRY&lt;/span&gt;) resolution would be to create
a base &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; subclass that would define the needed options and create three subclasses
that would inherit from this class and override only the &lt;tt class="docutils literal"&gt;model&lt;/tt&gt; attribute. This unfortunately was not
possible becase &lt;a class="reference external" href="http://stackoverflow.com/questions/16696066/django-tables2-dynamically-adding-columns-to-table-not-adding-attrs-to-table/16741665#16741665"&gt;inheritance does not work well with django-tables2&lt;/a&gt;!&lt;/p&gt;
&lt;p&gt;Furthermore, there&amp;#8217;s the extra hurdle of adding filtering to the above tables so that
the admin&amp;#8217;s would be able to quickly find a log message - if we wanted to use django-filter
we&amp;#8217;d need again to create three different subclasses (one for each log model type)
of &lt;tt class="docutils literal"&gt;django_filter.FilterSet&lt;/tt&gt; since
django-filter requires you to define the model for which the filter will be&amp;nbsp;created!&lt;/p&gt;
&lt;p&gt;One cool way to resolve such problems is to create your classes dynamically when
you need &amp;#8216;em. I&amp;#8217;ve already described a way to &lt;a class="reference external" href="https://spapas.github.io/2013/12/24/django-dynamic-forms/"&gt;dynamically create forms in django
in a previous post&lt;/a&gt;. Below, I&amp;#8217;ll describe
a similar technique which can be used to create both dynamic tables and filters. Using
this methodology, you&amp;#8217;ll be able to add a new &lt;span class="caps"&gt;CBV&lt;/span&gt; that displays a table with
pagination, order and filtering for your model by just inheriting from a base&amp;nbsp;class!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="adding-the-dynamic-table"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Adding the dynamic&amp;nbsp;table&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To create the &lt;span class="caps"&gt;DRY&lt;/span&gt; &lt;span class="caps"&gt;CBV&lt;/span&gt; we&amp;#8217;ll use the &lt;a class="reference external" href="http://django-tables2.readthedocs.org/en/latest/pages/generic-mixins.html?highlight=singletableview"&gt;SingleTableView&lt;/a&gt; (&lt;tt class="docutils literal"&gt;django_tables2.SingleTableView&lt;/tt&gt;)
as a base and override its &lt;tt class="docutils literal"&gt;get_table_class&lt;/tt&gt; method to dynamically create our table class
using &lt;tt class="docutils literal"&gt;type&lt;/tt&gt;.
Here&amp;#8217;s how it could be done using a mixin (notice that this mixin should be used in a
&lt;tt class="docutils literal"&gt;SingleTableView&lt;/tt&gt; to override its &lt;tt class="docutils literal"&gt;get_table_class&lt;/tt&gt; method):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AddTableMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;table_pagination&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;per_page&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_table_class&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_table_column&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
          &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;field&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;django&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
              &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateColumn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;d/m/Y H:i&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
          &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
              &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Column&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

      &lt;span class="n"&gt;attrs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
          &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;get_table_column&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt;
          &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;model&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_meta&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;
      &lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Meta&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Meta&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;attrs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;class&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;table&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;order_by&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;-created_on&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;klass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DTable&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Table&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;klass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let&amp;#8217;s try to explain the &lt;tt class="docutils literal"&gt;get_table_class&lt;/tt&gt; method: First of all, we&amp;#8217;ve defined a local &lt;tt class="docutils literal"&gt;get_table_column&lt;/tt&gt;
function that will return a django-tables2 column depending on the field of the model. For example, in
our case I wanted to use a &lt;tt class="docutils literal"&gt;django_tables2.DateColumn&lt;/tt&gt; with a specific format when a &lt;tt class="docutils literal"&gt;DateTimeField&lt;/tt&gt; is
encountered and for all other model fields just use the stock &lt;tt class="docutils literal"&gt;Column&lt;/tt&gt;. You may add other overrides here,
for example add a &lt;tt class="docutils literal"&gt;TemplateColumn&lt;/tt&gt; to properly render some&amp;nbsp;data.&lt;/p&gt;
&lt;p&gt;After that, we create a dictionary with all the attributes of the dynamic table model.
The &lt;tt class="docutils literal"&gt;self.model&lt;/tt&gt; field will contain
the model Class of this &lt;tt class="docutils literal"&gt;SingleTableView&lt;/tt&gt;, so using its &lt;tt class="docutils literal"&gt;_meta.fields&lt;/tt&gt; will return
the defined fields of that model. As we can see, I just use
a generator expression to create a tuple with the name of the field and its column type (using &lt;tt class="docutils literal"&gt;get_table_column&lt;/tt&gt;)
excluding the &amp;#8216;id&amp;#8217; column. So, attrs will be a dictionary of field names and column types. Here you may
also exclude other columns you don&amp;#8217;t want to&amp;nbsp;display.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;Meta&lt;/tt&gt; class of this table is crated using &lt;tt class="docutils literal"&gt;type&lt;/tt&gt; which creates a parentless class by
defining all its attributes in a dictionary
and set it as the &lt;tt class="docutils literal"&gt;Meta&lt;/tt&gt; key in the previously defined &lt;tt class="docutils literal"&gt;attrs&lt;/tt&gt; dict.
Finally, we create the actual &lt;tt class="docutils literal"&gt;django_tables2.Table&lt;/tt&gt; subclass by
inheriting from it and passing the &lt;tt class="docutils literal"&gt;attrs&lt;/tt&gt; dict. We&amp;#8217;ll see an example of what &lt;tt class="docutils literal"&gt;get_table_class&lt;/tt&gt; returns&amp;nbsp;later.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="creating-a-dynamic-form-for-filtering"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Creating a dynamic form for&amp;nbsp;filtering&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Let&amp;#8217;s create another mixin that could be used to create a dynamic &lt;tt class="docutils literal"&gt;django.Form&lt;/tt&gt; subclass to the &lt;span class="caps"&gt;CBV&lt;/span&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AddFormMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;define_form&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_form_field_type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
          &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="n"&gt;attrs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
          &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;get_form_field_type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt;
          &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_form_fields&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="n"&gt;klass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;DForm&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;attrs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;klass&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="n"&gt;form_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;define_form&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form_class&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form_class&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

      &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AddFormMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_queryset&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_valid&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
          &lt;span class="n"&gt;q_objects&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Q&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_form_fields&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
              &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                  &lt;span class="n"&gt;q_objects&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;=&lt;/span&gt; &lt;span class="n"&gt;Q&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;__icontains&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;]})&lt;/span&gt;

          &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;q_objects&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AddFormMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;form&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The first method that will be called is the &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt; method that will generate the dynamic form
using &lt;tt class="docutils literal"&gt;define_form&lt;/tt&gt;. This method has a &lt;tt class="docutils literal"&gt;get_form_field_type&lt;/tt&gt; local function (similar to get_table_fields)
that can be used to override the types of the fields (or just fallback to a normal &lt;tt class="docutils literal"&gt;CharField&lt;/tt&gt;) and
then create the &lt;tt class="docutils literal"&gt;attrs&lt;/tt&gt; dictionary and &lt;tt class="docutils literal"&gt;forms.Form&lt;/tt&gt; subclass in a similar way as the &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; subclass. Here,
we don&amp;#8217;t want to create a filter form from all fields of the model as we did on table, so instead
we&amp;#8217;ll use a &lt;tt class="docutils literal"&gt;get_form_fields&lt;/tt&gt; (don&amp;#8217;t confuse it with the local &lt;tt class="docutils literal"&gt;get_form_field_type&lt;/tt&gt;)
method that returns the name of the fields that we want to
use in the filtering form and needs to be defined in each &lt;span class="caps"&gt;CBV&lt;/span&gt; &amp;#8212; the &lt;tt class="docutils literal"&gt;get_form_fields&lt;/tt&gt; must
be defined in classes that use this&amp;nbsp;mixin.&lt;/p&gt;
&lt;p&gt;After defining the form, we need to check if there&amp;#8217;s anything to the &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; dict &amp;#8212; since we are just filtering the
queryset we&amp;#8217;d need to submit the form with a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; (and not a &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt;). We see that if we have
data to our &lt;tt class="docutils literal"&gt;request.&lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; dictionary we&amp;#8217;ll instantiate the form using this data (or else we&amp;#8217;ll just
create an empty form). To do the actual filtering, we check if the form is valid and create a &lt;tt class="docutils literal"&gt;django.models.db.Q&lt;/tt&gt; object
that is used to combine (by &lt;span class="caps"&gt;AND&lt;/span&gt;) the conditions. Each of the individual Q objects that will be combined
(&lt;tt class="docutils literal"&gt;&amp;amp;=&lt;/tt&gt;)
to create the complete one will be created using the line &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;Q(**{f+'__icontains':self.form.cleaned_data.get(f,&lt;/span&gt; &lt;span class="pre"&gt;'')})&lt;/span&gt;&lt;/tt&gt;
(where f will be the name of the field) which is a nice trick: It will create a
dictionary of the form &lt;tt class="docutils literal"&gt;{'action__icontains': 'test text'}&lt;/tt&gt; and then pass this as a keyword
argument to the Q (using the &lt;tt class="docutils literal"&gt;**&lt;/tt&gt; mechanism), so &lt;tt class="docutils literal"&gt;Q&lt;/tt&gt; will be called like
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;Q(action__icontains='test&lt;/span&gt; text')&lt;/tt&gt; - this (using the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;**{key:val}&lt;/span&gt;&lt;/tt&gt; trick) is
the only way to pass dynamic kwargs to a&amp;nbsp;function!&lt;/p&gt;
&lt;p&gt;Finally, the queryset will be filtered using the combined &lt;tt class="docutils literal"&gt;Q&lt;/tt&gt; object we just&amp;nbsp;described.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="creating-the-dynamic-cbv"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Creating the dynamic &lt;span class="caps"&gt;CBV&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using the above mixins, we can easily create a dynamic &lt;span class="caps"&gt;CBV&lt;/span&gt; with a table and a filter form only by inheriting
from the mixins
and &lt;tt class="docutils literal"&gt;SingleTableView&lt;/tt&gt; and defining the &lt;tt class="docutils literal"&gt;get_form_fields&lt;/tt&gt; method:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AuditLogListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AddTableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;AddFormMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;SingleTableView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;AuditLog&lt;/span&gt;
  &lt;span class="n"&gt;context_object_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;logs&amp;#39;&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_form_fields&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;action&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user__username&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let&amp;#8217;s suppose that the &lt;tt class="docutils literal"&gt;AuditLog&lt;/tt&gt; is defined as&amp;nbsp;following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AuditLog&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;created_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;auto_now_add&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;editable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;
  &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AUTH_USER_MODEL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;editable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;
  &lt;span class="n"&gt;action&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;editable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using the above &lt;tt class="docutils literal"&gt;AuditLogListView&lt;/tt&gt;, a dynamic table and a dynamic form will be automaticall created whenever the view is visited.
The &lt;tt class="docutils literal"&gt;Table&lt;/tt&gt; class will be like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DTable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Table&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;created_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateColumn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;d/m/Y H:i&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Column&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
  &lt;span class="n"&gt;action&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tables&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Column&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

  &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="n"&gt;attrs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;class&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;table&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
      &lt;span class="n"&gt;order_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;-created_on&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and the &lt;tt class="docutils literal"&gt;Form&lt;/tt&gt; class like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;user__username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
  &lt;span class="n"&gt;action&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;An interesting thing to notice is that we can drill down to foreign keys (f.e. &lt;tt class="docutils literal"&gt;user__username&lt;/tt&gt;) to create more interesting filters.
Also we could add some more
methods to be overriden by the implementing class beyond
the &lt;tt class="docutils literal"&gt;get_form_fields&lt;/tt&gt;. For example, instead of using &lt;tt class="docutils literal"&gt;self.model._meta.fields&lt;/tt&gt;
to generate the fields of the table, we
could instead use a &lt;tt class="docutils literal"&gt;get_table_fields&lt;/tt&gt; (similar to the &lt;tt class="docutils literal"&gt;get_form_fields&lt;/tt&gt;)
method that would be overriden in the implementing
classes (and even drill down on foreign keys to display more data on the table using &lt;a class="reference external" href="http://django-tables2.readthedocs.org/en/latest/pages/accessors.html"&gt;accessors&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Or, we could also define the form field types and lookups (instead of always using &lt;tt class="docutils literal"&gt;CharField&lt;/tt&gt; and
&lt;tt class="docutils literal"&gt;icontains&lt;/tt&gt; ) in the &lt;tt class="docutils literal"&gt;get_form_fields&lt;/tt&gt; &amp;#8212; similar to&amp;nbsp;django-filter.&lt;/p&gt;
&lt;p&gt;Please notice that instead of creating a django form instance for filtering, we could instead create a django-filter instance with
a similar methodology. However, I preferred to just use a normal django form because it makes the whole process more clear and removes
a level of abstraction (we just create a &lt;tt class="docutils literal"&gt;django.Form&lt;/tt&gt; subclass while, if we used django-filter we&amp;#8217;d need to create
a django-filter subclass which would create a &lt;tt class="docutils literal"&gt;django.Form&lt;/tt&gt; subclass)!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using the above technique we can quickly create a table and filter for a number of Models that all share
the same properties in the most &lt;span class="caps"&gt;DRY&lt;/span&gt;. This technique of course is useful only for quick CBVs that
are more or less the same and require little customization. Another interesting thing is that instead of
creating different &lt;tt class="docutils literal"&gt;SingleTableView&lt;/tt&gt; s we could instead create a single &lt;span class="caps"&gt;CBV&lt;/span&gt; that will get the content type
of the Model to be viewed as a parameter and retrieve the model (and queryset) from the content type - so
we could have a single &lt;span class="caps"&gt;CBV&lt;/span&gt; for all our table/filtering views&amp;nbsp;!&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="python"></category><category term="forms"></category><category term="tables"></category></entry><entry><title>A (little more) complex react and fluxÂ example</title><link href="https://spapas.github.io/2015/09/08/more-complex-react-flux-example/" rel="alternate"></link><published>2015-09-08T12:55:00+03:00</published><updated>2015-09-08T12:55:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-09-08:/2015/09/08/more-complex-react-flux-example/</id><summary type="html">&lt;p class="first last"&gt;A (little more) complex React and Flux example, continuing from the previous&amp;nbsp;posts.&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id2"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#more-about-flux-components" id="id3"&gt;More about Flux&amp;nbsp;components&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#explaining-the-application-components" id="id4"&gt;Explaining the application&amp;nbsp;components&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#reusable-application-components" id="id5"&gt;Reusable application components&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#dropdown-react-js" id="id6"&gt;DropDown.react.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#datepicker-react-js" id="id7"&gt;DatePicker.react.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#pagingpanel-react-js" id="id8"&gt;PagingPanel.react.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#searchpanel-react-js" id="id9"&gt;SearchPanel.react.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#messagepanel" id="id10"&gt;MessagePanel&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#messagepanel-react-js" id="id11"&gt;MessagePanel.react.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#messagestore-js" id="id12"&gt;MessageStore.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#messageactions" id="id13"&gt;MessageActions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#non-reusable-application-components" id="id14"&gt;Non-reusable application components&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#booktable-react-js" id="id15"&gt;BookTable.react.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#authordialog-react-js" id="id16"&gt;AuthorDialog.react.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#authorpanel-react-js" id="id17"&gt;AuthorPanel.react.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#statpanel-react-js" id="id18"&gt;StatPanel.react.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#bookform-react-js" id="id19"&gt;BookForm.react.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#bookpanel-react-js" id="id20"&gt;BookPanel.react.js&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-actions" id="id21"&gt;The&amp;nbsp;Actions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-stores" id="id22"&gt;The Stores&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#id1" id="id23"&gt;MessageStore.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#authorstore-js" id="id24"&gt;AuthorStore.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#categorystore-js" id="id25"&gt;CategoryStore.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#bookstore-js" id="id26"&gt;BookStore.js&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id27"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In &lt;a class="reference external" href="https://spapas.github.io/2015/06/05/comprehensive-react-flux-tutorial/"&gt;previous&lt;/a&gt;
&lt;a class="reference external" href="https://spapas.github.io/2015/07/02/comprehensive-react-flux-tutorial-2/"&gt;two&lt;/a&gt; parts of this series, we have seen
how we could implement a
not-so-simple single page application with full &lt;span class="caps"&gt;CRUD&lt;/span&gt; capabilities
using react only (in the &lt;a class="reference external" href="https://spapas.github.io/2015/06/05/comprehensive-react-flux-tutorial/"&gt;first part&lt;/a&gt; ) and then how to
change it to use the flux architecture (in the &lt;a class="reference external" href="https://spapas.github.io/2015/07/02/comprehensive-react-flux-tutorial-2/"&gt;second part&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;In this, third, part, we will
add some more capabilities to the previous app
to prove how easy it is to create complex apps
and continue the discussion on
the Flux architecture. The source code of this project
can
be found at &lt;a class="reference external" href="https://github.com/spapas/react-tutorial"&gt;https://github.com/spapas/react-tutorial&lt;/a&gt; (tag name&amp;nbsp;react-flux-complex).&lt;/p&gt;
&lt;p&gt;Here&amp;#8217;s a demo of the final&amp;nbsp;application:&lt;/p&gt;
&lt;img alt="Our project" src="/images/demo2.gif" style="width: 780px;" /&gt;
&lt;p&gt;We can see that, when compared to the previous version this one&amp;nbsp;has:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Sorting by table&amp;nbsp;columns&lt;/li&gt;
&lt;li&gt;Pagination&lt;/li&gt;
&lt;li&gt;Message for&amp;nbsp;loading&lt;/li&gt;
&lt;li&gt;Client side url updating (with&amp;nbsp;hashes)&lt;/li&gt;
&lt;li&gt;Cascading drop downs (selecting category will filter out&amp;nbsp;subcategories)&lt;/li&gt;
&lt;li&gt;Integration with jquery-ui&amp;nbsp;datepicker&lt;/li&gt;
&lt;li&gt;Add a child object&amp;nbsp;(author)&lt;/li&gt;
&lt;li&gt;Add authors with a modal dialog&amp;nbsp;(popup)&lt;/li&gt;
&lt;li&gt;Delete authors (using the &amp;#8220;-&amp;#8221;&amp;nbsp;button)&lt;/li&gt;
&lt;li&gt;Colored ajax result messages (green when all is ok, red with&amp;nbsp;error)&lt;/li&gt;
&lt;li&gt;A statistics panel (number of books /&amp;nbsp;authors)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In the paragraphs below, beyond the whole architecture, we&amp;#8217;ll see
a bunch of techniques such&amp;nbsp;as:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Creating reusable flux&amp;nbsp;components&lt;/li&gt;
&lt;li&gt;Integrating react with&amp;nbsp;jquery&lt;/li&gt;
&lt;li&gt;Creating cascading&amp;nbsp;dropdowns&lt;/li&gt;
&lt;li&gt;Updating URLs with&amp;nbsp;hashes&lt;/li&gt;
&lt;li&gt;Adding pagination/sorting/querying to a table of&amp;nbsp;results&lt;/li&gt;
&lt;li&gt;Displaying pop&amp;nbsp;ups&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="more-about-flux-components"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;More about Flux&amp;nbsp;components&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Before delving into the source code of the above application, I&amp;#8217;d like to
make crystal what is the proposed way to call methods in the flux chain
and which types of components can include other types of components. Let&amp;#8217;s
take a look at the following&amp;nbsp;diagram:&lt;/p&gt;
&lt;img alt="flux dependencies" src="/images/react_flux_deps1.png" style="width: 480px;" /&gt;
&lt;p&gt;The arrows display the dependencies of the Flux architecture - an arrow
from X to Y means that a component of type Y could depend on an Component
of type X (of example, a store could depend on an action or another store
but not on a&amp;nbsp;panel).&lt;/p&gt;
&lt;p&gt;In more detail, we can see that in the top of the hierarchy,
having no dependencies are the
Dispatcher and the Constants. The Dispatcher is just a single component
(which actually is a singleton - only one dispatcher exists in each
single page react-flux application)
that inherits from the Facebook&amp;#8217;s dispatcher and is imported by the
action components (since action methods defined in action components
call the &lt;tt class="docutils literal"&gt;dispatch&lt;/tt&gt; method of the dispatcher passing the correct
parameters) and the stores which do the real actions when an action
is dispatched, depending on the action type. The Constant components
define constant values for the action types and are used by both
the actions (to set the action types to the dispatch calls) and by
the stores to be used on the switch statement when an action is
dispatched. As an example, for BookActions we have the&amp;nbsp;following&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var BookConstants = require('../constants/BookConstants')
var AppDispatcher = require('../dispatcher/AppDispatcher').AppDispatcher;

var BookActions = {
    change_book: function(book) {
        AppDispatcher.dispatch({
            actionType: BookConstants.BOOK_CHANGE,
            book: book
        });
    },
// Other book actions [...]
&lt;/pre&gt;
&lt;p&gt;and for&amp;nbsp;BookStore&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var $ = require('jquery');
var AppDispatcher = require('../dispatcher/AppDispatcher').AppDispatcher;
var BookConstants = require('../constants/BookConstants')

// [...]

BookStore.dispatchToken = AppDispatcher.register(function(action) {
    switch(action.actionType) {
        case BookConstants.BOOK_EDIT:
            _editBook(action.book);
        break;
// [...] other switch branches
&lt;/pre&gt;
&lt;p&gt;An interesting thing to see is that the actions depend only on the Dispatcher
and on the Constants, while the stores also depend on actions (not only
from the same action types as the store type, for example AuthorStore depends
on both AuthorActions and MessageActions) and on &lt;em&gt;other&lt;/em&gt; stores. This means
that the actions should be a &amp;#8220;clean&amp;#8221; component: Just declare your action methods
whose only purpose is to pass the action type along with the required parameters
to the&amp;nbsp;dispatcher.&lt;/p&gt;
&lt;p&gt;On the other hand, the stores are depending on both actions and other stores.
The action dependency is because sometimes when something is done in a store
we need to notify another store to do something as a response to that. For
example, in our case, when a book is updated we need to notify the message
store to show the &amp;#8220;Book updated ok&amp;#8221; message. This preferrably should not be done by
directly calling the corresponding method on the message store but instead
by calling the corresponding action of MessageAction and passing the correct
parameters (actually, the method that updates the message in MessageStore
should be a private method that is called &lt;em&gt;only&lt;/em&gt; through the&amp;nbsp;action).&lt;/p&gt;
&lt;p&gt;One thing to notice here is that you &lt;em&gt;cannot&lt;/em&gt; call (and dispatch) an action in the
same call stack (meaning it is directly called) as of another dispatch or you&amp;#8217;ll get a
&lt;tt class="docutils literal"&gt;Invariant Violation: &lt;span class="pre"&gt;Dispatch.dispatch(...):&lt;/span&gt; Cannot dispatch in the middle of a dispatch.&lt;/tt&gt;
error in your javascript console. Let&amp;#8217;s see an example of what this means and how
to avoid it because its a common error. Let&amp;#8217;s say that we have the following
code to a&amp;nbsp;store:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
AppDispatcher.register(function(action) {
    switch(action.actionType) {
        case Constants.TEST_ERR:
            TestActions.action1();
        break;
        case Constants.TEST_OK1:
            setTimeout(function() {
                TestActions.action1();
            }, 0);

        break;
        case Constants.TEST_OK2:
            $.get('/get/', function() {
                TestActions.action1();
            });

        break;
    }
    return true;
});
&lt;/pre&gt;
&lt;p&gt;Here, the &lt;tt class="docutils literal"&gt;TEST_ERR&lt;/tt&gt; branch will throw an error because the &lt;tt class="docutils literal"&gt;TestAction.action1&lt;/tt&gt; is &lt;em&gt;in the same call stack&lt;/em&gt;
as this dispatch! On the other hand, both &lt;tt class="docutils literal"&gt;TEST_OK1&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;TEST_OK2&lt;/tt&gt; will work: &lt;tt class="docutils literal"&gt;TEST_OK2&lt;/tt&gt; is the most
usual, since most of the times we want to call an action as a result of an ajax call - however, sometimes we
want to call an action without any ajax &amp;#8212; in this case we use the setTimeout (with a timeout of 0 ms) in
order to move the call to &lt;tt class="docutils literal"&gt;TestActions.action1()&lt;/tt&gt; to a different call&amp;nbsp;stack.&lt;/p&gt;
&lt;p&gt;Now, as I mentioned before, there&amp;#8217;s also a &lt;em&gt;different-store&lt;/em&gt; dependency on stores.
This dependency is needed because some stores may offer public methods for other stores to use
(methods that don&amp;#8217;t actually need to be dispatched through the dispatcher) and
for the &lt;tt class="docutils literal"&gt;waitFor&lt;/tt&gt; method , in case there are two different
stores that respond to a single action and want to have one store executing
its dispatch method before the other.
(the waitFor method takes the dispatchToken, which is the result of &lt;tt class="docutils literal"&gt;Dispatcher.register&lt;/tt&gt; of
a different store as a parameter in order to wait for that action to&amp;nbsp;finish).&lt;/p&gt;
&lt;p&gt;Finally, the Panels depend on both actions (to initiate an action as a response
to user input) and stores (to read the state of the each required store when it
is changed). Of course, not all panels actually depend on stores, since as we
already know the state of a React app should be kept as high in the hierarchy
as possible, so a central component will get the state of a store and pass the
required state attributes to its children through parameters. On the other
hand, every component that responds to user input will have to import
am action object and call the corresponding method &amp;#8212; we should never pass
callbacks from a parent to a child component as a parameter anymore &lt;em&gt;unless&lt;/em&gt;
we want to make the component reusable (more on this&amp;nbsp;later).&lt;/p&gt;
&lt;p&gt;Finally, as expected, because of their hierarchy the compoents depend on their
child components (a BookTable depends on a BookTableRow&amp;nbsp;etc).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="explaining-the-application-components"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Explaining the application&amp;nbsp;components&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;There are a lot of components that are needed for
the above application. A bird&amp;#8217;s eye view of the components
and their hierarchies can be seen on the following&amp;nbsp;figure:&lt;/p&gt;
&lt;img alt="Our components" src="/images/complex_react_components.png" style="width: 780px;" /&gt;
&lt;p&gt;We will first explain a bit the components that could be easily reused
by other applications and after that the components that are specifically
implemented for our book/author single page&amp;nbsp;application.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="reusable-application-components"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Reusable application&amp;nbsp;components&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We can see that beyond the specific components (&lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;BookTable&lt;/tt&gt; etc)
there&amp;#8217;s a bunch of more general components (&lt;tt class="docutils literal"&gt;DropDown&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;DatePicker&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;PagingPanel&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;SearchPanel&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;MessagePanel&lt;/tt&gt;) that have names like they could be used by other applications (for example every application
that wants to implement a DropDown could use our component) and not only by the
Book-Author application. Let&amp;#8217;s take a quick look at these components and if they
are actually&amp;nbsp;reusable:&lt;/p&gt;
&lt;div class="section" id="dropdown-react-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;DropDown.react.js&lt;/a&gt;&lt;/h3&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');

var DropDown = React.createClass({
    render: function() {
        var options = [];
        options.push(&amp;lt;option key='-1' value='' &amp;gt;---&amp;lt;/option&amp;gt;);
        if(this.props.options) {
            this.props.options.forEach(function(option) {
                options.push(&amp;lt;option key={option.id} value={option.id}&amp;gt;{option.name}&amp;lt;/option&amp;gt;);
            });
        }

        return(
            &amp;lt;select ref='dropdown' value={this.props.value?this.props.value:''} onChange={this.onFormChange} &amp;gt;
                {options}
            &amp;lt;/select&amp;gt;
        );
    },
    onFormChange: function() {
        var val = React.findDOMNode(this.refs.dropdown).value
        this.props.dropDownValueChanged(val);
    }
});

module.exports.DropDown = DropDown;
&lt;/pre&gt;
&lt;p&gt;What we see here is that this component does not actually have a local state and will need three&amp;nbsp;parameters:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;the list of options (&lt;tt class="docutils literal"&gt;props.options&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;the curently selected option (&lt;tt class="docutils literal"&gt;props.value&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;a callback to be called when the dropdown is changed (&lt;tt class="docutils literal"&gt;props.dropDownValueChanged&lt;/tt&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;By passing the above three parameters this dropdown component can be reused whenever a dropdown is needed!
As we can see here we need to pass a callback function to this dropdown and call the corresponding action
directly. This is important to have a reusable component: The component that includes each dropdown decides
which should be the action on the dropdown value change. Another option if we wanted to avoid callbacks
would be to pass an identifier as a property for each dropdown and the dropdown would call a generic
dropdown action and passing this identifier &amp;#8212; however I think that actually passing the callback is
easier and makes the code much more&amp;nbsp;readable.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="datepicker-react-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;DatePicker.react.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The datepicker component has more or less the same structure as with the dropdown: It needs one parameter
for its current value (&lt;tt class="docutils literal"&gt;props.value&lt;/tt&gt;) and another as the callback to the function when the date is
changed (once again this is required to have a reusable&amp;nbsp;component):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');

var DatePicker = React.createClass({
    render: function() {
        return(
            &amp;lt;input type='text' ref='date' value={this.props.value} onChange={this.handleChange} /&amp;gt;
        );
    },
    componentDidMount: function() {
        $(React.findDOMNode(this)).datepicker({ dateFormat: 'yy-mm-dd' });
        $(React.findDOMNode(this)).on('change', this.handleChange);
    },
    componentWillUnmount: function() {

    },
    handleChange: function() {
        var date = React.findDOMNode(this.refs.date).value
        this.props.onChange(date);
    }
});

module.exports.DatePicker = DatePicker ;
&lt;/pre&gt;
&lt;p&gt;Another thing we can see here is how can integrate jquery components with react: When
the component is mounted, we get its &lt;span class="caps"&gt;DOM&lt;/span&gt; component using &lt;tt class="docutils literal"&gt;React.findDomNode(this)&lt;/tt&gt; and
convert it to a datepicker. We also set its change function to be the passed&amp;nbsp;callback.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pagingpanel-react-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;PagingPanel.react.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The paging panel is not actually a reusable component because it requires BookActions
(to handle next and previous page clicks) - so
it can&amp;#8217;t be used by Authors (if authors was a table that is). However, we can easily
change it to be reusable if we passed callbacks for next and previous page so that
the component including PagingPanel would call the correct action on each click. Having
a reusable PagingPangel is not needed for our application since only books have a&amp;nbsp;table.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var BookActions = require('../actions/BookActions').BookActions;

var PagingPanel = React.createClass({
    render: function() {
        return(
            &amp;lt;div className=&amp;quot;row&amp;quot;&amp;gt;
                {this.props.page==1?'':&amp;lt;button onClick={this.onPreviousPageClick}&amp;gt;&amp;amp;lt;&amp;lt;/button&amp;gt;}
                &amp;amp;nbsp; Page {this.props.page} of {this.getTotalPages()} &amp;amp;nbsp;
                {this.props.page==this.getTotalPages()?'':&amp;lt;button onClick={this.onNextPageClick} &amp;gt;&amp;amp;gt;&amp;lt;/button&amp;gt;}
            &amp;lt;/div&amp;gt;
        );
    },
    onNextPageClick: function(e) {
        e.preventDefault();
        BookActions.change_page(this.props.page+1)
    },
    onPreviousPageClick: function(e) {
        e.preventDefault();
        BookActions.change_page(this.props.page-1)
    },
    getTotalPages: function() {
        return Math.ceil(this.props.total / this.props.page_size);
    }
})

module.exports.PagingPanel = PagingPanel;
&lt;/pre&gt;
&lt;p&gt;The component is very simple, it needs three&amp;nbsp;parameters:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;the current page (&lt;tt class="docutils literal"&gt;props.page&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;the page size (&lt;tt class="docutils literal"&gt;props.page_size&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;the total pages number (&lt;tt class="docutils literal"&gt;props.total&lt;/tt&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;and just displayd the current page along with buttons to go to the next or previous page (if these buttons should be visible of&amp;nbsp;course).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="searchpanel-react-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;SearchPanel.react.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The SearchPanel is another panel that could be reusable if we&amp;#8217;d passed a callbeck instead of calling the &lt;tt class="docutils literal"&gt;BookActions.search&lt;/tt&gt;
action directly. The promise behavior has been explained in the previous posts and is needed to buffer the queries to the
server when a user types his search&amp;nbsp;query.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var BookActions = require('../actions/BookActions').BookActions;

var SearchPanel = React.createClass({
    getInitialState: function() {
        return {
            search: this.props.query,
        }
    },
    componentWillReceiveProps: function(nextProps) {
      this.setState({
            search: nextProps.query
      });
    },
    render: function() {
        return (
            &amp;lt;div className=&amp;quot;row&amp;quot;&amp;gt;
                &amp;lt;div className=&amp;quot;one-fourth column&amp;quot;&amp;gt;
                    Filter: &amp;amp;nbsp;
                    &amp;lt;input ref='search' name='search' type='text' value={this.state.search} onChange={this.onSearchChange} /&amp;gt;
                    {this.state.search?&amp;lt;button onClick={this.onClearSearch} &amp;gt;x&amp;lt;/button&amp;gt;:''}
                &amp;lt;/div&amp;gt;
            &amp;lt;/div&amp;gt;
        )
    },
    onSearchChange: function() {
        var query = React.findDOMNode(this.refs.search).value;
        if (this.promise) {
            clearInterval(this.promise)
        }
        this.setState({
            search: query
        });
        this.promise = setTimeout(function () {
            BookActions.search(query);
        }.bind(this), 400);
    },
    onClearSearch: function() {
        this.setState({
            search: ''
        });
        BookActions.search('');
    }
});

module.exports.SearchPanel = SearchPanel;
&lt;/pre&gt;
&lt;p&gt;As we can see, this panel is a little different than the previous ones because it actually handles its
own local state: When the component should get properties from its parent compoent, its state will
be updated to the &lt;tt class="docutils literal"&gt;query&lt;/tt&gt; attribute - so the current value of the search query gets updated through
properties. However, when the value of the search input is changed, we see that the local state is
changed immediately but the &lt;tt class="docutils literal"&gt;BookActions.search&lt;/tt&gt; (or the corresponding callback) gets called &lt;em&gt;only&lt;/em&gt;
when the timeout has&amp;nbsp;passed!&lt;/p&gt;
&lt;p&gt;The above means that we can type whatever we want on the search input, but it at first it will be used
only locally to immediately update the value of the input and, only after the timeout has fired the
search action will be called. If we hadn&amp;#8217;t used the local state it would be much more difficult to have
this consistent behavior (we&amp;#8217;d need to add two actions, one to handle the search query value change
and another to handle the timeout firing &amp;#8212; making everythimg much more&amp;nbsp;complicated).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="messagepanel"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;MessagePanel&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The MessagePanel is really interesting because it is a reusable component that actually has its own action and store module! This
component can be reused in &lt;em&gt;different&lt;/em&gt; applications that need to display message but &lt;em&gt;not&lt;/em&gt; on the same application (because a single state
is kept for all messages). If we wanted to use a different MessagePanel for Books or Authors then we&amp;#8217;d need to keep both in the
state &lt;em&gt;and&lt;/em&gt; also it to the action to differentiate between messages for author and for book. Instead, by keeping a single Messages
state for both Books and Authors we have a much more simple&amp;nbsp;version.&lt;/p&gt;
&lt;div class="section" id="messagepanel-react-js"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id11"&gt;MessagePanel.react.js&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The MessagePanel component has a local state which responds to changes on MessageStore. When the
state of MessageStore is changed the MessagePanel will be re-rendered with the new&amp;nbsp;message.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var MessageStore = require('../stores/MessageStore').MessageStore;

var MessagePanel = React.createClass({
    getInitialState: function() {
        return {

        };
    },
    render: function() {
        return(
            &amp;lt;div className=&amp;quot;row&amp;quot;&amp;gt;
                {this.state.message?&amp;lt;div className={this.state.message.color}&amp;gt;{this.state.message.text}&amp;lt;/div&amp;gt;:&amp;quot;&amp;quot;}
            &amp;lt;/div&amp;gt;
        );
    },
    _onChange: function() {
        this.setState(MessageStore.getState());
    },
    componentWillUnmount: function() {
        MessageStore.removeChangeListener(this._onChange);
    },
    componentDidMount: function() {
        MessageStore.addChangeListener(this._onChange);
    }
})

module.exports.MessagePanel = MessagePanel;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="messagestore-js"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id12"&gt;MessageStore.js&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The MessageStore has a (private) state containing a &lt;tt class="docutils literal"&gt;message&lt;/tt&gt; that gets updated
only when the ccorresponding action is dispached. The store has a single state
for all messages - it doesn&amp;#8217;t care if the messages are for books or&amp;nbsp;authors.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var $ = require('jquery');
var EventEmitter = require('events').EventEmitter;
var AppDispatcher = require('../dispatcher/AppDispatcher').AppDispatcher;
var BookConstants = require('../constants/BookConstants')

var _state = {
    message: {}
};

var MessageStore = $.extend({}, EventEmitter.prototype, {
    getState: function() {
        return _state;
    },
    emitChange: function() {
        this.emit('change');
    },
    addChangeListener: function(callback) {
        this.on('change', callback);
    },
    removeChangeListener: function(callback) {
        this.removeListener('change', callback);
    }
});

MessageStore.dispatchToken = AppDispatcher.register(function(action) {
    switch(action.actionType) {
        case BookConstants.MESSAGE_ADD:
            _state.message = action.message;
            MessageStore.emitChange();
        break;
    }
    return true;
});

module.exports.MessageStore = MessageStore;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="messageactions"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id13"&gt;MessageActions&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Finally, there are two actions that are defined for the MessageStore: One for adding
an ok message and one for adding an error message - both of which have the same
message type (but pass a different color&amp;nbsp;parameter).&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var AppDispatcher = require('../dispatcher/AppDispatcher').AppDispatcher;
var BookConstants = require('../constants/BookConstants')

var MessageActions = {
    add_message_ok: function(msg) {
        AppDispatcher.dispatch({
            actionType: BookConstants.MESSAGE_ADD,
            message: {
                color: 'green',
                text: msg
            }
        });
    },
    add_message_error: function(msg) {
        AppDispatcher.dispatch({
            actionType: BookConstants.MESSAGE_ADD,
            message: {
                color: 'green',
                text: msg
            }
        });
    }
};

module.exports.MessageActions = MessageActions;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="non-reusable-application-components"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;Non-reusable application&amp;nbsp;components&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I don&amp;#8217;t want to discuss the source code for all the non-reusable components since some of them
are more or less the same with the previous version and are easy to understand just by
checking the source code (BookTableRow and ButtonPanel). However, I&amp;#8217;ll
discuss the other, more complex components starting from the inside of the&amp;nbsp;react-onion:&lt;/p&gt;
&lt;div class="section" id="booktable-react-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;BookTable.react.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;I want to display this component to discuss how sorting is implemented: Each column has a key which,
when passed to django-rest-framework will sort the results based on that key (the &lt;tt class="docutils literal"&gt;__&lt;/tt&gt; does a
join so by &lt;tt class="docutils literal"&gt;author__last_name&lt;/tt&gt; we mean that we want to sort by the last_name field of the author
of each book. Also, you can pass the key as it is to sort ascending or with a minus (-) in front
(for example &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-author__last_name&lt;/span&gt;&lt;/tt&gt;).&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var BookTableRow = require('./BookTableRow.react').BookTableRow;
var BookActions = require('../actions/BookActions').BookActions;

var BookTable = React.createClass({
    render: function() {
        var rows = [];
        this.props.books.forEach(function(book) {
            rows.push(&amp;lt;BookTableRow key={book.id} book={book} /&amp;gt;);
        });
        return (
            &amp;lt;table&amp;gt;
                &amp;lt;thead&amp;gt;
                    &amp;lt;tr&amp;gt;
                        &amp;lt;th&amp;gt;&amp;lt;a href='#' onClick={this.onClick.bind(this, 'id')}&amp;gt;{this.showOrdering('id')} Id&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;
                        &amp;lt;th&amp;gt;&amp;lt;a href='#' onClick={this.onClick.bind(this, 'title')}&amp;gt;{this.showOrdering('title')} Title&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;
                        &amp;lt;th&amp;gt;&amp;lt;a href='#' onClick={this.onClick.bind(this, 'subcategory__name')}&amp;gt;{this.showOrdering('subcategory__name')} Category&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;
                        &amp;lt;th&amp;gt;&amp;lt;a href='#' onClick={this.onClick.bind(this, 'publish_date')}&amp;gt;{this.showOrdering('publish_date')} Publish date&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;
                        &amp;lt;th&amp;gt;&amp;lt;a href='#' onClick={this.onClick.bind(this, 'author__last_name')}&amp;gt;{this.showOrdering('author__last_name')} Author&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;
                        &amp;lt;th&amp;gt;Edit&amp;lt;/th&amp;gt;
                    &amp;lt;/tr&amp;gt;
                &amp;lt;/thead&amp;gt;
                &amp;lt;tbody&amp;gt;{rows}&amp;lt;/tbody&amp;gt;
            &amp;lt;/table&amp;gt;
        );
    },
    onClick: function(v, e) {
        e.preventDefault();
        BookActions.sort_books(v);
    },
    showOrdering: function(v) {
        if (v==this.props.ordering) {
            return '+'
        } else if ('-'+v==this.props.ordering) {
            return '-'
        }
    }
});

module.exports.BookTable = BookTable ;
&lt;/pre&gt;
&lt;p&gt;The only thing that needs explaining in this module is the line of the&amp;nbsp;form&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;lt;th&amp;gt;&amp;lt;a href='#' onClick={this.onClick.bind(this, 'id')}&amp;gt;{this.showOrdering('id')} Id&amp;lt;/a&amp;gt;&amp;lt;/th&amp;gt;
&lt;/pre&gt;
&lt;p&gt;that creates the title of each column and triggers ascending or descending sorting on this column by
clicking on it. So, we can see that we&amp;#8217;ve create an onClick function that actually expects a value - the key
to that column. To allow passing that value, we use the bind method of the function object which will
create new a function that has this key as its first parameter. If we didn&amp;#8217;t want to use bind, we&amp;#8217;d need to
creatre 5 different function (onIdClick, onTitleClick etc)! The most common usage of &lt;tt class="docutils literal"&gt;bind&lt;/tt&gt; is to actually &lt;em&gt;bind&lt;/em&gt;
a function to an object (that&amp;#8217;s what the first parameter to this function does)
so that calling this inside that function will refer to that object - here we leave the binding
of the function to the same object and only do the parameter&amp;nbsp;passing.&lt;/p&gt;
&lt;p&gt;Also, the showOrdering checks if the current ordering is the same as that column&amp;#8217;s key and displays
either a + (for ascending) or - (for descending) in front of the column&amp;nbsp;title.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="authordialog-react-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;AuthorDialog.react.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This is a handmade pop-up dialog that gets displayed when a new author is added (the + button is clicked)
using only css to center it on the screen when it is displayed.
We can see that it is either visible on invisible based on the &lt;tt class="docutils literal"&gt;showDialog&lt;/tt&gt; input property which actually
is the only input this component requires. When it is visible and the ok or cancel button are pressed
the corresponding action will be dispatched (which will actually close this popup by setting the &lt;tt class="docutils literal"&gt;showDialog&lt;/tt&gt;
to&amp;nbsp;false):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var AuthorActions = require('../actions/AuthorActions').AuthorActions;

var AuthorDialog = React.createClass({

    render: function() {
        if (!this.props.showDialog) {
            return (
                &amp;lt;div /&amp;gt;
            )
        } else {
            return(
                &amp;lt;div className='modal-dialog' id=&amp;quot;dialog-form&amp;quot;  &amp;gt;
                    &amp;lt;label htmlFor=&amp;quot;first_name&amp;quot;&amp;gt;First name:&amp;lt;/label&amp;gt; &amp;lt;input type='text' ref='first_name' name='first_name' /&amp;gt; &amp;lt;br /&amp;gt;
                    &amp;lt;label htmlFor=&amp;quot;last_name&amp;quot;&amp;gt;Last name:&amp;lt;/label&amp;gt; &amp;lt;input type='text' ref='last_name' name='last_name' /&amp;gt; &amp;lt;br /&amp;gt;
                    &amp;lt;button onClick={this.onOk}&amp;gt;Ok&amp;lt;/button&amp;gt;
                    &amp;lt;button onClick={this.onCancel} &amp;gt;Cancel&amp;lt;/button&amp;gt;
                &amp;lt;/div&amp;gt;

            );
        }
    },
    onCancel: function(e) {
        e.preventDefault();
        AuthorActions.hide_add_author();
    },
    onOk: function(e) {
        e.preventDefault();
        first_name = React.findDOMNode(this.refs.first_name).value;
        last_name = React.findDOMNode(this.refs.last_name).value;
        AuthorActions.add_author_ok({
            first_name: first_name,
            last_name: last_name
        });
    }
});

module.exports.AuthorDialog = AuthorDialog ;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="authorpanel-react-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id17"&gt;AuthorPanel.react.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The AuthorPanel displays the author select DropDown along with the + (add author) and
- (delete author) buttons. It also contains the AuthorDialog which will be displayed
or not depending on the value of the &lt;tt class="docutils literal"&gt;showDialog&lt;/tt&gt; property.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var DropDown = require('./DropDown.react').DropDown;
var AuthorDialog = require('./AuthorDialog.react').AuthorDialog;
var AuthorActions = require('../actions/AuthorActions').AuthorActions;

var AuthorPanel = React.createClass({
    getInitialState: function() {
        return {};
    },
    render: function() {
        var authorExists = false ;
        if(this.props.authors) {
            var ids = this.props.authors.map(function(x) {
                return x.id*1;
            });

            if(ids.indexOf(1*this.props.author)&amp;gt;=0 ) {
                authorExists = true;
            }
        }

        return(
            &amp;lt;div className='one-half column'&amp;gt;
                &amp;lt;AuthorDialog showDialog={this.props.showDialog} /&amp;gt;
                &amp;lt;label forHtml='date'&amp;gt;Author&amp;lt;/label&amp;gt;
                &amp;lt;DropDown options={this.props.authors} dropDownValueChanged={this.props.onAuthorChanged} value={authorExists?this.props.author:''} /&amp;gt;
                &amp;lt;button onClick={this.addAuthor} &amp;gt;+&amp;lt;/button&amp;gt;
                {authorExists?&amp;lt;button onClick={this.deleteAuthor}&amp;gt;-&amp;lt;/button&amp;gt;:&amp;quot;&amp;quot;}
            &amp;lt;/div&amp;gt;
        );
    },
    addAuthor: function(e) {
        e.preventDefault();
        console.log(&amp;quot;ADD AUTHOR&amp;quot;);
        AuthorActions.show_add_author();
    },
    deleteAuthor: function(e) {
        e.preventDefault();
        AuthorActions.delete_author(this.props.author);
        console.log(&amp;quot;DELETE AUTHOR&amp;quot;);
        console.log(this.props.author);
    },
});

module.exports.AuthorPanel = AuthorPanel;
&lt;/pre&gt;
&lt;p&gt;As we can see, there are three properties that are passed to this&amp;nbsp;component:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;props.author&lt;/tt&gt;: The currently selected&amp;nbsp;author&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;props.authors&lt;/tt&gt;: The list of all&amp;nbsp;authors&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;props.onAuthorChanged&lt;/tt&gt;: A callback that is called when the author is changed. Here, we could have used an action (just like for add/delete author) instead of a callback, however its not actually required. When the author is changed, it means that the currently edited book&amp;#8217;s author is changed. So we could propagate the change to the parent (form) component that handles the book change along with the other changes (i.e title, publish date&amp;nbsp;etc).&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="statpanel-react-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;StatPanel.react.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The StatPanel is an interesting, read-only component that displays the number of
authors and books. This component requests updates from both the &lt;tt class="docutils literal"&gt;BookStore&lt;/tt&gt; and
&lt;tt class="docutils literal"&gt;AuthorStore&lt;/tt&gt; - when their state is updated the component will be re-rendered
with the number of books and&amp;nbsp;authors:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var BookStore = require('../stores/BookStore').BookStore;
var AuthorStore = require('../stores/AuthorStore').AuthorStore;

var StatPanel = React.createClass({
    getInitialState: function() {
        return {};
    },
    render: function() {
        var book_len = '-';
        var author_len = '-';
        if(this.state.books) {
            book_len = this.state.books.length
        }
        if(this.state.authors) {
            author_len = this.state.authors.length
        }
        return(
            &amp;lt;div className=&amp;quot;row&amp;quot;&amp;gt;
                &amp;lt;div className=&amp;quot;one-half column&amp;quot;&amp;gt;
                    Books number: {book_len}
                &amp;lt;/div&amp;gt;
                &amp;lt;div className=&amp;quot;one-half column&amp;quot;&amp;gt;
                    Authors number: {author_len}
                &amp;lt;/div&amp;gt;
                &amp;lt;br /&amp;gt;
            &amp;lt;/div&amp;gt;
        );
    },
    _onBookChange: function() {
        this.setState({
            books:BookStore.getState().books
        });
    },
    _onAuthorChange: function() {
        this.setState({
            authors: AuthorStore.getState().authors
        });
    },
    componentWillUnmount: function() {
        AuthorStore.removeChangeListener(this._onAuthorChange);
        BookStore.removeChangeListener(this._onBookChange);
    },
    componentDidMount: function() {
        AuthorStore.addChangeListener(this._onAuthorChange);
        BookStore.addChangeListener(this._onBookChange);
    }
});

module.exports.StatPanel = StatPanel ;
&lt;/pre&gt;
&lt;p&gt;We&amp;#8217;ve added different change listeners in case we wanted to do
some more computations for book or author change (instead of just
getting their books / authors property). Of course the same behavior
could be achieved with just a single change listener that would
get both the books and&amp;nbsp;authors.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="bookform-react-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;BookForm.react.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The BookForm is one of the most complex panels of this application (along with BookPanel) because
it actually contains a bunch of other panels and has some callbacks for them to&amp;nbsp;use.&lt;/p&gt;
&lt;p&gt;We can see that, as explained before, when the current book form values are changed (through callbacks) the change_book action will be&amp;nbsp;called.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var BookActions = require('../actions/BookActions').BookActions;
var DropDown = require('./DropDown.react.js').DropDown;
var StatPanel = require('./StatPanel.react.js').StatPanel;
var MessagePanel = require('./MessagePanel.react.js').MessagePanel;
var DatePicker = require('./DatePicker.react.js').DatePicker;
var ButtonPanel = require('./ButtonPanel.react.js').ButtonPanel;
var AuthorPanel = require('./AuthorPanel.react.js').AuthorPanel;
var CategoryStore = require('../stores/CategoryStore').CategoryStore;
var AuthorStore = require('../stores/AuthorStore').AuthorStore;
var loadCategories = require('../stores/CategoryStore').loadCategories;
var loadAuthors = require('../stores/AuthorStore').loadAuthors;

var BookForm = React.createClass({
    getInitialState: function() {
        return {};
    },
    render: function() {
        return(
            &amp;lt;form onSubmit={this.onSubmit}&amp;gt;
                &amp;lt;div className='row'&amp;gt;
                    &amp;lt;div className='one-half column'&amp;gt;
                        &amp;lt;label forHtml='title'&amp;gt;Title&amp;lt;/label&amp;gt;
                        &amp;lt;input ref='title' name='title' type='text' value={this.props.book.title} onChange={this.onTitleChange} /&amp;gt;
                    &amp;lt;/div&amp;gt;
                    &amp;lt;div className='one-half column'&amp;gt;
                        &amp;lt;label forHtml='date'&amp;gt;Publish date&amp;lt;/label&amp;gt;
                        &amp;lt;DatePicker ref='date' onChange={this.onDateChange} value={this.props.book.publish_date} /&amp;gt;
                    &amp;lt;/div&amp;gt;
                &amp;lt;/div&amp;gt;
                &amp;lt;div className='row'&amp;gt;
                    &amp;lt;div className='one-half column'&amp;gt;
                        &amp;lt;label forHtml='category'&amp;gt;Category&amp;lt;/label&amp;gt;
                        &amp;lt;DropDown options={this.state.categories} dropDownValueChanged={this.onCategoryChanged} value={this.props.book.category} /&amp;gt;
                        &amp;lt;DropDown options={this.state.subcategories} dropDownValueChanged={this.onSubCategoryChanged} value={this.props.book.subcategory} /&amp;gt;
                    &amp;lt;/div&amp;gt;
                    &amp;lt;AuthorPanel authors={this.state.authors} author={this.props.book.author} onAuthorChanged={this.onAuthorChanged} showDialog={this.state.showDialog} /&amp;gt;
                &amp;lt;/div&amp;gt;

                &amp;lt;ButtonPanel book={this.props.book}  /&amp;gt;
                &amp;lt;MessagePanel /&amp;gt;
                &amp;lt;StatPanel  /&amp;gt;
            &amp;lt;/form&amp;gt;
        );
    },
    onSubmit: function(e) {
        e.preventDefault();
        BookActions.save(this.props.book)
    },
    onTitleChange: function() {
        this.props.book.title = React.findDOMNode(this.refs.title).value;
        BookActions.change_book(this.props.book);
    },
    onDateChange: function(date) {
        this.props.book.publish_date = date;
        BookActions.change_book(this.props.book);
    },
    onCategoryChanged: function(cat) {
        this.props.book.category = cat;
        this.props.book.subcategory = '';
        BookActions.change_book(this.props.book);
    },
    onSubCategoryChanged: function(cat) {
        this.props.book.subcategory = cat;
        BookActions.change_book(this.props.book);
    },
    onAuthorChanged: function(author) {
        this.props.book.author = author;
        BookActions.change_book(this.props.book);
    },
    _onChangeCategories: function() {
        this.setState(CategoryStore.getState());
    },
    _onChangeAuthors: function() {
        this.setState(AuthorStore.getState());
    },
    componentWillUnmount: function() {
        CategoryStore.removeChangeListener(this._onChangeCategories);
        AuthorStore.removeChangeListener(this._onChangeAuthors);
    },
    componentDidMount: function() {
        CategoryStore.addChangeListener(this._onChangeCategories);
        AuthorStore.addChangeListener(this._onChangeAuthors);
        loadCategories();
        loadAuthors();
    }
});

module.exports.BookForm = BookForm;
&lt;/pre&gt;
&lt;p&gt;The above component listens for updates on both Category and Author store to update
when the authors (when an author is added or deleted) and the categories are changed (for example to implement the cascading dropdown
functionality), so the list of authors and the list of categories and subcategoreis are all stored in
the local state. The book that is edited is just passed as a property - actually, this is the only
property that this component needs to&amp;nbsp;work.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="bookpanel-react-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;BookPanel.react.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Finally, BookPanel is the last component we&amp;#8217;ll talk about. This is the central component
of the application - however we&amp;#8217;ll see that it is not very complex (since most user interaction
is performed in other components). This component just listens on changes in the BookStore state
and depending on the parameters either displays the &amp;#8220;Loading&amp;#8221; message or the table of books
(depending on the state of ajax calls that load the books). The other parameters like the
list of books, the ordering of the books etc are passed to the child&amp;nbsp;components.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var BookStore = require('../stores/BookStore').BookStore;
var BookActions = require('../actions/BookActions').BookActions;
var SearchPanel = require('./SearchPanel.react').SearchPanel;
var BookTable = require('./BookTable.react').BookTable;
var PagingPanel = require('./PagingPanel.react').PagingPanel;
var BookForm = require('./BookForm.react').BookForm;

var reloadBooks = require('../stores/BookStore').reloadBooks;

var BookPanel = React.createClass({
    getInitialState: function() {
        return BookStore.getState();
    },
    render: function() {
        return(
            &amp;lt;div className=&amp;quot;row&amp;quot;&amp;gt;
                &amp;lt;div className=&amp;quot;one-half column&amp;quot;&amp;gt;
                    {
                        this.state.loading?
                        &amp;lt;div class='loading' &amp;gt;Loading...&amp;lt;/div&amp;gt;:
                        &amp;lt;div&amp;gt;
                            &amp;lt;SearchPanel query={this.state.query} &amp;gt;&amp;lt;/SearchPanel&amp;gt;
                            &amp;lt;BookTable books={this.state.books} ordering={this.state.ordering} /&amp;gt;
                            &amp;lt;PagingPanel page_size='5' total={this.state.total} page={this.state.page} /&amp;gt;
                        &amp;lt;/div&amp;gt;
                    }
                &amp;lt;/div&amp;gt;
                &amp;lt;div className=&amp;quot;one-half column&amp;quot;&amp;gt;
                    &amp;lt;BookForm
                        book={this.state.editingBook}
                    /&amp;gt;
                &amp;lt;/div&amp;gt;
                &amp;lt;br /&amp;gt;
            &amp;lt;/div&amp;gt;
        );
    },
    _onChange: function() {
        this.setState( BookStore.getState() );
    },
    componentWillUnmount: function() {
        BookStore.removeChangeListener(this._onChange);
    },
    componentDidMount: function() {
        BookStore.addChangeListener(this._onChange);
        reloadBooks();
    }
});

module.exports.BookPanel = BookPanel ;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="the-actions"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id21"&gt;The&amp;nbsp;Actions&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;All actions are rather simple components without other dependencies as we&amp;#8217;ve already discussed. They
just define &amp;#8220;actions&amp;#8221; (which are simple functions) that create the correct parameter object type and pass it
to the dispatcher. The only attribute that is required for this object is the &lt;tt class="docutils literal"&gt;actionType&lt;/tt&gt; that
should get a value from the constants. I won&amp;#8217;t go into any more detail about the actions &amp;#8212; please check
the source code and all your questions will be&amp;nbsp;resolved.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-stores"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;The&amp;nbsp;Stores&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;First of all, all stores are defined through the following code that is already discussed in the previous&amp;nbsp;part:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var MessageStore = $.extend({}, EventEmitter.prototype, {
    getState: function() {
        return _state;
    },
    emitChange: function() {
        this.emit('change');
    },
    addChangeListener: function(callback) {
        this.on('change', callback);
    },
    removeChangeListener: function(callback) {
        this.removeListener('change', callback);
    }
});
&lt;/pre&gt;
&lt;p&gt;When the state of a store is changed its &lt;tt class="docutils literal"&gt;emitChange&lt;/tt&gt; function will be called (I mean
called manually from the code that actually changes the state and knows that it has
actually been changed - nothing will be called automatically). When &lt;tt class="docutils literal"&gt;emitChange&lt;/tt&gt; is called,
all the components that listen for changes for this component (that have called &lt;tt class="docutils literal"&gt;addChangeListener&lt;/tt&gt;
of the store with a callback)
will be notified (their callback will be called) and will use
&lt;tt class="docutils literal"&gt;getState&lt;/tt&gt; of the store to get its current state - after that, these components will set their own state
to re-render and display the changes to the&amp;nbsp;store.&lt;/p&gt;
&lt;p&gt;Let&amp;#8217;s now discuss the four stores defined &amp;#8212; I will include only the parts of each file that are
actually interesting, for everything else &lt;em&gt;use the source Luke&lt;/em&gt;!&lt;/p&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id23"&gt;MessageStore.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A very simple store that goes together with MessagePanel and MessageActions. It just keeps a state with
the current message object and just changes this message when the MESSAGE_ADD message
type is dispatched. After changing the message, the listeners (only one in this case) will be notified to
update the displayed&amp;nbsp;message:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var _state = {
    message: {}
};

MessageStore.dispatchToken = AppDispatcher.register(function(action) {
    switch(action.actionType) {
        case BookConstants.MESSAGE_ADD:
            _state.message = action.message;
            MessageStore.emitChange();
        break;
    }
    return true;
});
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="authorstore-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id24"&gt;AuthorStore.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Here we see that the local state has an array of the authors and a &lt;tt class="docutils literal"&gt;showDialog&lt;/tt&gt; flag that
controls the state of the add author popup. For the &lt;tt class="docutils literal"&gt;AUTHOR_ADD&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;HIDE_ADD_AUTHOR&lt;/tt&gt;
cases of the dispatch we just change the state of this flag and emit the change; the &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;
listens for changes to the &lt;tt class="docutils literal"&gt;AuthorStore&lt;/tt&gt; and will pass the &lt;tt class="docutils literal"&gt;showDialog&lt;/tt&gt; to the &lt;tt class="docutils literal"&gt;AuthorPanel&lt;/tt&gt;
as a property which in turn will pass it to &lt;tt class="docutils literal"&gt;AuthorDialog&lt;/tt&gt; and it will display the panel (or not)
depending on the value of that flag. This flag will also take a false value when the add author
ajax call&amp;nbsp;returns.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;showDialog&lt;/tt&gt; flag is not related to the actual data but is &lt;span class="caps"&gt;UI&lt;/span&gt;-related. This
is something that we should keep in mind when creating stores: Stores don&amp;#8217;t only contain the actual
data (like models in an &lt;span class="caps"&gt;MVC&lt;/span&gt; application) but they should also contain &lt;span class="caps"&gt;UI&lt;/span&gt; (controller/view in an &lt;span class="caps"&gt;MVC&lt;/span&gt;
architecture) related information since that is &lt;em&gt;also&lt;/em&gt; part of the&amp;nbsp;state!&lt;/p&gt;
&lt;p&gt;We can see that the ajax calls just issue the corresponding &lt;span class="caps"&gt;HTTP&lt;/span&gt; method to the &lt;tt class="docutils literal"&gt;authors_url&lt;/tt&gt; and
when they return the &lt;tt class="docutils literal"&gt;add_message_ok&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;add_message_error&lt;/tt&gt; methods of
&lt;tt class="docutils literal"&gt;MessageActions&lt;/tt&gt; will be called. These calls are in a different call stack so everything will work fine
(please remember the discussion about dispatches in different call stacks&amp;nbsp;before).&lt;/p&gt;
&lt;p&gt;Finally, on the success of &lt;tt class="docutils literal"&gt;_load_authors&lt;/tt&gt; the map array method is called to transform the returned data
as we want&amp;nbsp;it:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var $ = require('jquery');

var _state = {
    authors: [],
    showDialog: false
}

var _load_authors = function() {
    $.ajax({
        url: _props.authors_url,
        dataType: 'json',
        cache: false,
        success: function(data) {
            _state.authors = data.map(function(a){
                return {
                    id: a.id,
                    name: a.last_name+' '+a.first_name
                }
            });
            AuthorStore.emitChange();
        },
        error: function(xhr, status, err) {
            MessageActions.add_message_error(err.toString());
        }
    });
};

var _deleteAuthor = function(authorId) {
    $.ajax({
        url: _props.authors_url+authorId,
        method: 'DELETE',
        cache: false,
        success: function(data) {
            _load_authors();
            MessageActions.add_message_ok(&amp;quot;Author delete ok&amp;quot;);
            AuthorActions.delete_author_ok();
        },
        error: function(xhr, status, err) {
            MessageActions.add_message_error(err.toString());
        }
    });
};

var _addAuthor = function(author) {
    $.ajax({
        url: _props.authors_url,
        dataType: 'json',
        method: 'POST',
        data:author,
        cache: false,
        success: function(data) {
            MessageActions.add_message_ok(&amp;quot;Author add  ok&amp;quot;);
            _state.showDialog = false;
            _load_authors();
        },
        error: function(xhr, status, err) {
            MessageActions.add_message_error(err.toString());
        }
    });

};

AuthorStore.dispatchToken = AppDispatcher.register(function(action) {
    switch(action.actionType) {
        case BookConstants.SHOW_ADD_AUTHOR:
            _state.showDialog = true;
            AuthorStore.emitChange();
        break;
        case BookConstants.HIDE_ADD_AUTHOR:
            _state.showDialog = false;
            AuthorStore.emitChange();
        break;
        case BookConstants.AUTHOR_ADD:
            _addAuthor(action.author);
        break;
        case BookConstants.AUTHOR_DELETE:
            _deleteAuthor(action.authorId);
        break;
    }
    return true;
});
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="categorystore-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id25"&gt;CategoryStore.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The CategoryStore has an interesting functionality concerning the load_subcategory
function. This function is called whenever a book is changed (so its category form field
may be changed and the subcategories may be reloaded based on this category) or is edited
(so the category is that of the new book and once again the subcategories may need to because
rerendered). It is important that we &lt;em&gt;actually&lt;/em&gt; pass the current category to the book to the
action. If for example we wanted to retrieve that from the state of the BookStore then we&amp;#8217;d
need to use the &lt;tt class="docutils literal"&gt;waitFor&lt;/tt&gt; functionality of the dispatcher so that the category of the
current book would be changed first then the load_category (that would read that value to
read the subcategoreis) would be called after&amp;nbsp;that.&lt;/p&gt;
&lt;p&gt;Also, another thing to notice here is that there&amp;#8217;s a simple subcat_cache that for each category
contains the subcategories of that category so that we won&amp;#8217;t do repeated ajax calls to reload
the subcategories each time the category is&amp;nbsp;changed.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var _state = {
    categories: [],
    subcategories: []
}

var _current_cat = ''
var _subcat_cache = []

var _load_categories = function() {
    $.ajax({
        url: _props.categories_url,
        dataType: 'json',
        cache: false,
        success: function(data) {
            _state.categories = data;
            CategoryStore.emitChange();
        },
        error: function(xhr, status, err) {
            console.error(this.props.url, status, err.toString());
        }
    });
};

var _load_subcategories = function(cat) {

    if(!cat) {
        _state.subcategories = [];
        CategoryStore.emitChange();
        return ;
    }
    if(_subcat_cache[cat]) {
        _state.subcategories = _subcat_cache[cat] ;
        CategoryStore.emitChange();
    }
    $.ajax({
        url: _props.subcategories_url+'?category='+cat,
        dataType: 'json',
        cache: false,
        success: function(data) {
            _state.subcategories = data;
            _subcat_cache[cat] = data;
            CategoryStore.emitChange();
        },
        error: function(xhr, status, err) {
            console.error(this.props.url, status, err.toString());
        }
    });
};

CategoryStore.dispatchToken = AppDispatcher.register(function(action) {
    switch(action.actionType) {
        case BookConstants.BOOK_EDIT:
        case BookConstants.BOOK_CHANGE:
            _load_subcategories(action.book.category);
        break;
        case BookConstants.BOOK_EDIT_CANCEL:
            _state.subcategories = [];
            CategoryStore.emitChange();
        break;
    }
    return true;
});
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="bookstore-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id26"&gt;BookStore.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Here, beyond the book-related functionality we have also implemented the
&lt;span class="caps"&gt;URL&lt;/span&gt; updating. The getUrlParameter that returns the value of a &lt;span class="caps"&gt;URL&lt;/span&gt; parameter has been taken from
&lt;a class="reference external" href="http://stackoverflow.com/questions/19491336/get-url-parameter-jquery"&gt;http://stackoverflow.com/questions/19491336/get-url-parameter-jquery&lt;/a&gt;. Depending on the url parameters, we set some initial properties of
the local state and, on the other hand, when the search query, ordering or page are changed,
the &lt;tt class="docutils literal"&gt;_update_href&lt;/tt&gt; function is called to update the url parameters. This is not really related
to the flux architecture beyond the initialization of&amp;nbsp;state.&lt;/p&gt;
&lt;p&gt;Another thing to notice is that the when the &lt;tt class="docutils literal"&gt;_search&lt;/tt&gt; is executed whenever there&amp;#8217;s
a change in the list of books (query is updated, sorting is changed, page is changed or
when an author is deleted since the books that have that author should now display an
empty field). The setTimeout in the _search ajax return is to simulate a 400ms delay (in order for the &amp;#8220;Loading&amp;#8221; text to
be&amp;nbsp;visible).&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
function getUrlParameter(sParam) {
    var sPageURL = $(location).attr('hash');
    sPageURL = sPageURL.substr(1)
    var sURLVariables = sPageURL.split('&amp;amp;');
    for (var i = 0; i &amp;lt; sURLVariables.length; i++)  {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == sParam)  {
            return sParameterName[1];
        }
    }
}

var _page_init = 1*getUrlParameter('page');
if(!_page_init) _page_init = 1 ;
var _ordering_init = getUrlParameter('ordering');
if(!_ordering_init) _ordering_init = '' ;
var _query_init = getUrlParameter('query');
if(!_query_init) _query_init = ''

var _state = {
    loading: false,
    books: [],
    message:{},
    page: _page_init,
    total: 0,
    editingBook: {},
    query: _query_init,
    ordering: _ordering_init
}


var _search = function() {
    _state.loading = true;
    BookStore.emitChange();

    $.ajax({
        url: _props.url+'?search='+_state.query+&amp;quot;&amp;amp;ordering=&amp;quot;+_state.ordering+&amp;quot;&amp;amp;page=&amp;quot;+_state.page,
        dataType: 'json',
        cache: false,
        success: function(data) {
            // Simulate a small delay in server response
            setTimeout(function() {
                _state.books = data.results;
                _state.total = data.count;
                _state.loading = false;
                BookStore.emitChange();
            }, 400);
        },
        error: function(xhr, status, err) {
            _state.loading = false;
            MessageActions.add_message_error(err.toString());
            BookStore.emitChange();
        }
    });
};

var _reloadBooks = function() {
    _search('');
};


var _clearEditingBook = function() {
    _state.editingBook = {};
};

var _editBook = function(book) {
    _state.editingBook = book;
    BookStore.emitChange();
};

var _cancelEditBook = function() {
    _clearEditingBook();
    BookStore.emitChange();
};

var _update_href = function() {
    var hash = 'page='+_state.page;
    hash += '&amp;amp;ordering='+_state.ordering;
    hash += '&amp;amp;query='+_state.query;
    $(location).attr('hash', hash);
}

BookStore.dispatchToken = AppDispatcher.register(function(action) {
    switch(action.actionType) {
        case BookConstants.BOOK_EDIT:
            _editBook(action.book);
        break;
        case BookConstants.BOOK_EDIT_CANCEL:
            _cancelEditBook();
        break;
        case BookConstants.BOOK_SAVE:
            _saveBook(action.book);
        break;
        case BookConstants.BOOK_SEARCH:
            _state.query = action.query
            _state.page = 1;
            _update_href();
            _search();
        break;
        case BookConstants.BOOK_DELETE:
            _deleteBook(action.bookId);
        break;
        case BookConstants.BOOK_CHANGE:
            _state.editingBook = action.book;
            BookStore.emitChange();
        break;
        case BookConstants.BOOK_PAGE:
            _state.page = action.page;
            _update_href();
            _search();
        break;
        case BookConstants.AUTHOR_DELETE_OK:
            _search();
        break;
        case BookConstants.BOOK_SORT:
            _state.page = 1;
            if(_state.ordering == action.field) {
                _state.ordering = '-'+_state.ordering
            } else {
                _state.ordering = action.field;
            }
            _update_href();
            _search();
        break;
    }
    return true;
});
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id27"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The application presented here has a number of techniques that will help
you when you actually try to create a more complex react flux application.
I hope that in the whole three part series I&amp;#8217;ve thoroughly explained the
flux architecture and how each
part of (actions, stores, components) it works. Also, I tried to cover
almost anything that somebody creating react/flux application
will need to use &amp;#8212; if you feel that something is not covered and
could be integrated to the authors/book application I&amp;#8217;d be happy
to research and implement&amp;nbsp;it!&lt;/p&gt;
&lt;/div&gt;
</content><category term="javascript"></category><category term="javascript"></category><category term="python"></category><category term="django"></category><category term="react"></category><category term="flux"></category></entry><entry><title>django-rq redux: advanced techniques andÂ tools</title><link href="https://spapas.github.io/2015/09/01/django-rq-redux/" rel="alternate"></link><published>2015-09-01T14:20:00+03:00</published><updated>2015-09-01T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-09-01:/2015/09/01/django-rq-redux/</id><summary type="html">&lt;p class="first last"&gt;Another article about django-rq with some more advanced techniques and&amp;nbsp;tools!&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#displaying-your-task-progress" id="id2"&gt;Displaying your task&amp;nbsp;progress&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#displaying-your-queue-statistics" id="id3"&gt;Displaying your queue&amp;nbsp;statistics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#making-sure-that-workers-for-your-queue-are-actually-running" id="id4"&gt;Making sure that workers for your queue are actually&amp;nbsp;running&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#checking-how-many-jobs-are-in-the-queue" id="id5"&gt;Checking how many jobs are in the&amp;nbsp;queue&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#better-exception-handling" id="id6"&gt;Better exception&amp;nbsp;handling&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#multiple-django-apps-single-redis-db" id="id7"&gt;Multiple django-apps, single redis&amp;nbsp;db&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#low-level-debugging" id="id8"&gt;Low level&amp;nbsp;debugging&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id9"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the &lt;a class="reference external" href="https://spapas.github.io/2015/01/27/async-tasks-with-django-rq/"&gt;previous django-rq article&lt;/a&gt;
we presented a quick introduction to asynchronous job queues and created a
small (but complete) project that used rq and django-rq to implement asynchronous
job queues in a django&amp;nbsp;project.&lt;/p&gt;
&lt;p&gt;In this article, we will present some more advanced techniques and tools
for improving the capabilities of our asynchronous tasks and
integrate them to the &lt;a class="reference external" href="https://github.com/spapas/django-test-rq"&gt;https://github.com/spapas/django-test-rq&lt;/a&gt; project (please
checkout tag django-rq-redux
&lt;tt class="docutils literal"&gt;git checkout &lt;span class="pre"&gt;django-rq-redux&lt;/span&gt;&lt;/tt&gt;)&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="displaying-your-task-progress"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Displaying your task&amp;nbsp;progress&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Sometimes, especially for long-running tasks it is useful to let
the user (task initiator) know what is the status of each task he&amp;#8217;s started. For this,
I recommend creating a task-description model that will hold the required information for this
task with more or less the following fields (please also check &lt;tt class="docutils literal"&gt;LongTask&lt;/tt&gt; model of&amp;nbsp;django-test-rq):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class LongTask(models.Model):
  created_on = models.DateTimeField(auto_now_add=True)
  name = models.CharField(max_length=128, help_text='Enter a unique name for the task',)
  progress = models.PositiveIntegerField(default=0)
  result = models.CharField(max_length=128, blank=True, null=True)
&lt;/pre&gt;
&lt;p&gt;Now, when the view that starts the task is &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; ed, you&amp;#8217;ll first create
the &lt;tt class="docutils literal"&gt;LongTask&lt;/tt&gt; model instance with a result of &lt;tt class="docutils literal"&gt;'&lt;span class="caps"&gt;QUEUED&lt;/span&gt;'&lt;/tt&gt; and a progress
of 0 (and a name that identifies your task) and then you&amp;#8217;ll start the real task
asynchronously by passing the LongTask instance, something like this (also check
&lt;tt class="docutils literal"&gt;LongTaskCreateView&lt;/tt&gt;):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
long_task = LongTask.objects.create(...)
long_runnig_task.delay(long_task)
&lt;/pre&gt;
&lt;p&gt;In your asynchronous job, the first thing you&amp;#8217;ll need to do is to set its result
to &amp;#8216;&lt;span class="caps"&gt;STARTED&lt;/span&gt;&amp;#8217; and save it so that the user will immediately see when he&amp;#8217;s job is
actually started. Also, if you can estimate its progress, you can update its
progress value with the current value so that the user will know how close he
is to finishing. Finally, when the job finished (or if it throws an expectable
exception) you&amp;#8217;ll update its status accordingly. Here&amp;#8217;s an example of my
long_running_task that just waits for the specifid amount of&amp;nbsp;seconds:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;#64;job('django-test-rq-low')
def long_runnig_task(task):
  job = get_current_job()
  task.job_id = job.get_id()

  task.result = 'STARTED'

  duration_in_second_persentages = task.duration*1.0 / 100
  for i in range(100):
      task.progress = i
      task.save()
      print task.progress
      time.sleep(duration_in_second_persentages)

  task.result = 'FINISHED'
  task.save()
  return task.result
&lt;/pre&gt;
&lt;p&gt;To have proper feedback I propose to have your task-description model instance
created by the view that starts the asynchronous task and &lt;em&gt;not&lt;/em&gt; by the
actual task! This is important since the worker may be full so the asynchronous
task will need a lot of time until is actually started (or maybe there are no
running workers - more on this later) and the user will not be able to see
his task instance anywhere (unless of course you provide him access to the actual task
queue but I don&amp;#8217;t recommend&amp;nbsp;this).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="displaying-your-queue-statistics"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Displaying your queue&amp;nbsp;statistics&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;django-rq has a really nice dashboard with a lot of queue statistics (
instructions here
&lt;a class="reference external" href="https://github.com/ui/django-rq#queue-statistics"&gt;https://github.com/ui/django-rq#queue-statistics&lt;/a&gt; and also on django-test-rq
project) which I recommend to always&amp;nbsp;enable.&lt;/p&gt;
&lt;p&gt;Also, there&amp;#8217;s the individual use &lt;a class="reference external" href="https://github.com/brutasse/django-rq-dashboard"&gt;django-rq-dashboard&lt;/a&gt; project that could
be installed to display some more statistics, however the only extra
statistic that you can see throuh django-rq-dashboard is the status of
your scheduled jobs so I don&amp;#8217;t recommend installing it if you don&amp;#8217;t
use&amp;nbsp;scheduling.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="making-sure-that-workers-for-your-queue-are-actually-running"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Making sure that workers for your queue are actually&amp;nbsp;running&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using the django-rq dashboard you can make sure that all queues
have at least one worker. However, sometimes workers fail, or
maybe you&amp;#8217;ve forgotten to start your workers or not configured
your application correctly (this happens to me all the time for
test/uat projects). So, for tasks that you want to display feedback
to the user, you can easily add a check to make sure that there are
active workers using the following&amp;nbsp;code:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
from rq import Worker
import django_rq

redis_conn = django_rq.get_connection('default')
if len([
    x for x in Worker.all(connection=redis_conn)
        if 'django-test-rq-low' in x.queue_names()
]) == 0:
    # Error -- no workers
&lt;/pre&gt;
&lt;p&gt;With &lt;tt class="docutils literal"&gt;Worker.all()&lt;/tt&gt; you get all workers for a connection and the &lt;tt class="docutils literal"&gt;queue_names()&lt;/tt&gt;
method returns the names that each worker serves. So we check that we have at least one
worker for that&amp;nbsp;queue.&lt;/p&gt;
&lt;p&gt;This check can be added when the job is started and display a feedback error
to the user (check example in&amp;nbsp;django-test-rq).&lt;/p&gt;
&lt;p&gt;For quick tasks (for example sending emails etc) you should not display anything
to the user even if no workers are running (since the task &lt;em&gt;will&lt;/em&gt; be queued and
will be executed eventually when the workers are started) but instead send an email to the administrators
so that they will start the&amp;nbsp;workers.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="checking-how-many-jobs-are-in-the-queue"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Checking how many jobs are in the&amp;nbsp;queue&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To find out programatically how many jobs are actually in the queue (and display a message
if the queue has too many jobs etc) you&amp;#8217;ll need to use the &lt;tt class="docutils literal"&gt;Queue&lt;/tt&gt; class, something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
from rq import Queue

redis_conn = django_rq.get_connection('default')
queue = Queue('django-test-rq-default', connection=redis_conn)
print queue.name
print len(queue.jobs)
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="better-exception-handling"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Better exception&amp;nbsp;handling&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;When a job fails, rq will put it in a failed jobs queue and finish with it. You (as administrator)
won&amp;#8217;t get any feedback and the user (unless he has access to that failed jobs queue) won&amp;#8217;t be
able to do anything aboutt this&amp;nbsp;job.&lt;/p&gt;
&lt;p&gt;In almost all cases you can&amp;#8217;t rely only on this behavior but instead you have to
&lt;a class="reference external" href="http://python-rq.org/docs/exceptions/"&gt;install a custom exception handler&lt;/a&gt;. Using the custom exception handler you can
do whatever you want for each failed job. For instance, you can create a new instance
of a &lt;tt class="docutils literal"&gt;FailedTask&lt;/tt&gt; model which will have information about the failure and the
original task allow the user (or administrator) to restart the failed task after
he&amp;#8217;s fixed the error&amp;nbsp;conditions.&lt;/p&gt;
&lt;p&gt;Or, if you want to be informed when a job is failed, you can just send an email
to &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;ADMINS&lt;/span&gt;&lt;/tt&gt; and fall back to the default behavior to enqueue the failed task the
failed jobs queue (since job exception handlers can be&amp;nbsp;chained).&lt;/p&gt;
&lt;p&gt;A simple management command that starts a worker for a specific queue and installs
a custom exception handler&amp;nbsp;follows:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
from django.conf import settings
from django.core.management.base import BaseCommand

import django_rq
from rq import Queue, Worker

def my_handler(job, *exc_info):
    print &amp;quot;FAILURE&amp;quot;
    print job
    print exc_info

class Command(BaseCommand):
    def handle(self, *args, **options):
        redis_conn = django_rq.get_connection('default')

        q = Queue(settings.DJANGO_TEST_RQ_LOW_QUEUE, connection=redis_conn)
        worker = Worker([q], exc_handler=my_handler, connection=redis_conn)
        worker.work()
&lt;/pre&gt;
&lt;p&gt;This handler is for demonstration purposes since it just prints a message to the console
(so please do not use&amp;nbsp;it)!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="multiple-django-apps-single-redis-db"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;Multiple django-apps, single redis&amp;nbsp;db&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One thing to keep in mind is that the only thing that seperates the queues are
their name. If you have many django applications that define a &amp;#8220;default&amp;#8221; (or &amp;#8220;low&amp;#8221;, &amp;#8220;hight&amp;#8221; etc)
and they all use the &lt;em&gt;same&lt;/em&gt; redis database to store their queue, the workers
of each application won&amp;#8217;t know which jobs belong to them and they&amp;#8217;ll end up
dequeuing the wrong job types. This will lead to an exception or, if you
are really unlucky to a very nasty&amp;nbsp;bug!&lt;/p&gt;
&lt;p&gt;To avoid this, you can either use a different redis database (not database server)
for each of your apps or add a prefix with the name of your app to your queue&amp;nbsp;names:&lt;/p&gt;
&lt;p&gt;Each redis database server can host a number of databases that are identified
by a number (that&amp;#8217;s what the /0 you see in &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;redis://127.0.0.1:6379/0&lt;/span&gt;&lt;/tt&gt; means)
and each one of them has a totally different keyspace. So, if you use /0 in an
application and /1 in another application, you&amp;#8217;ll have no problems. This solution
has the disadvantage that you need to be really careful to use different database
numbers for your projects and also the number of possible databases that redis
can use is limited by a configuration file (so if you reach the maximum you&amp;#8217;ll
need to also increase that&amp;nbsp;number)!&lt;/p&gt;
&lt;p&gt;Instead of this, you can avoid using the &amp;#8216;default&amp;#8217; queue, and use queues that
contain your application name in their name, for example, for the sample project
you could create something like &amp;#8216;django-test-rq-default&amp;#8217;, &amp;#8216;django-test-rq-low&amp;#8217;,
&amp;#8216;django-test-rq-high&amp;#8217; etc. You need to configure the extra queues by adding them
to the &lt;tt class="docutils literal"&gt;RQ_QUEUES&lt;/tt&gt; dictionary (check settings.py of django-test-rq) and then
put the jobs to these queues using for example the job decorator
(&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;#64;job('django-test-rq-default')&lt;/span&gt;&lt;/tt&gt;)
and run your workers so that they will retrieve jobs from these queues
(&lt;tt class="docutils literal"&gt;python manage.py rqworker &lt;span class="pre"&gt;django-test-rq-default&lt;/span&gt;&lt;/tt&gt;) and not the
default one (which may contain jobs of other&amp;nbsp;applications).&lt;/p&gt;
&lt;p&gt;If you use the default queue, and because you&amp;#8217;ll need to use its name to
many places, I recommend to add a (f.i) &lt;tt class="docutils literal"&gt;QUEUE_NAME = &lt;span class="pre"&gt;'django-test-rq-default'&lt;/span&gt;&lt;/tt&gt;
setting and use this instead of just a string to be totally &lt;span class="caps"&gt;DRY&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update 13/09/2015&lt;/strong&gt;: Please notice that using a &lt;em&gt;single&lt;/em&gt; redis database server
(either with multiple numeric databases or in the same database using a keyword
in keys to differentiate the apps) &lt;a class="reference external" href="https://redislabs.com/blog/benchmark-shared-vs-dedicated-redis-instances#.VfUl0xHtmko"&gt;is not recommended&lt;/a&gt; as commenter
Itamar Haber pointed out to&amp;nbsp;me!&lt;/p&gt;
&lt;p&gt;This is because for speed reasons redis uses a single thread to handle all requests
(regardless if they are in the same or different numerical databases), so all
resources may be used by a single, redis hungry, application and leave all others to&amp;nbsp;starve!&lt;/p&gt;
&lt;p&gt;Therefore, the recommended solution is to have a &lt;em&gt;different redis&lt;/em&gt; server for each different
application. This does not mean that you need to have different servers, just to run
different instances of redis binding to different &lt;span class="caps"&gt;IP&lt;/span&gt; ports. Redis uses very little
resourecs when it is idle (&lt;a class="reference external" href="http://redis.io/topics/faq"&gt;empty instance uses ~ 1 &lt;span class="caps"&gt;MB&lt;/span&gt; &lt;span class="caps"&gt;RAM&lt;/span&gt;&lt;/a&gt;) so you can run a lot
of instances in a single&amp;nbsp;server.&lt;/p&gt;
&lt;p&gt;Long story short, my proposal is to have a redis.conf &lt;em&gt;inside&lt;/em&gt; your application root tree
(next to manage.py and requirements.txt) which has the redis options for each
application. The options in redis.conf that need to be changed per application
is the port that this redis instance will bind (this port also needs to be passed to
django settings.py) and the pid filename if you daemonize redis &amp;#8212; I recommend using
a tool like &lt;a class="reference external" href="http://supervisord.org/"&gt;supervisord&lt;/a&gt; instead so that you won&amp;#8217;t need any daemonizing and pid files for
each&amp;nbsp;per-app-redis-instance!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="low-level-debugging"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;Low level&amp;nbsp;debugging&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In this section I&amp;#8217;ll present some commands that you can issue to your redis
server using a simple telnet connection to get various info about your queues. You
probably will never need to issue these commands to actually debug, but they
will answer some of your (scientific) questions! In the following, &lt;tt class="docutils literal"&gt;&amp;gt;&lt;/tt&gt; is
things I type, &lt;tt class="docutils literal"&gt;#&lt;/tt&gt; are comments, &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;[...]&lt;/span&gt;&lt;/tt&gt; is more output and everything else is the output I&amp;nbsp;get:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;gt; telnet 127.0.0.1 6379

# You won't see anything at first but you'll be connected and you can try typing things

&amp;gt; INFO

$1020
redis_version:2.4.10
redis_git_sha1:00000000
# [...]
db0:keys=83,expires=2
db1:keys=26,expires=1 # My redis server has two databases

# Now you'll see what you type!

&amp;gt; SELECT 1
+ OK # Now queries will be issued to database 1
&amp;gt; SELECT 0
+ OK # Now queries will be issued to database 0

KEYS rq* # List all rq related queues
*25
$43
rq:job:1d7afa32-3f90-4502-912f-d58eaa049fb1
$43
rq:queue:django-test-rq-low
$43
[...]

&amp;gt; SMEMBERS rq:workers # See workers
*1
$26
rq:worker:SERAFEIM-PC.6892

&amp;gt; LRANGE rq:queue:django-test-rq-low 0 100 # Check queued jobs
*2
$36
def896f4-84cb-4833-be6a-54d917f05271
$36
53cb1367-2fb5-46b3-99b2-7680397203b9

&amp;gt; HGETALL rq:job:def896f4-84cb-4833-be6a-54d917f05271 # Get info about this job
*16
$6
status
$6
queued
$11
description
$57
tasks.tasks.long_runnig_task(&amp;lt;LongTask: LongTask object&amp;gt;)
$10
created_at
$20
2015-09-01T09:04:38Z
$7
timeout
$3
180
$6
origin
$18
django-test-rq-low
$11
enqueued_at
$20
2015-09-01T09:04:38Z
$4
data
$409
[...] # data is the pickled parameters passed to the job !

&amp;gt; HGET rq:job:def896f4-84cb-4833-be6a-54d917f05271 status # Get only status
$6
queued
&lt;/pre&gt;
&lt;p&gt;For more info on querying redis you can check the &lt;a class="reference external" href="http://redis.io/documentation"&gt;redis documentation&lt;/a&gt; and especially
&lt;a class="reference external" href="http://redis.io/topics/data-types"&gt;http://redis.io/topics/data-types&lt;/a&gt; and &lt;a class="reference external" href="http://redis.io/commands"&gt;http://redis.io/commands&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using some of the above techniques will help you in your asynchronous
task adventures with rq. I&amp;#8217;ll try to keep this article updated with
any new techniques or tools I find in the&amp;nbsp;future!&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="python"></category><category term="tasks"></category><category term="jobs"></category><category term="rq"></category><category term="django-rq"></category><category term="asynchronous"></category><category term="scheduling"></category><category term="redis"></category></entry><entry><title>A comprehensive React and Flux tutorial part 2:Â Flux</title><link href="https://spapas.github.io/2015/07/02/comprehensive-react-flux-tutorial-2/" rel="alternate"></link><published>2015-07-02T14:20:00+03:00</published><updated>2015-07-02T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-07-02:/2015/07/02/comprehensive-react-flux-tutorial-2/</id><summary type="html">&lt;p class="first last"&gt;A React and Flux tutorial that tries to be as comprehensive as possible! Part 2 is about&amp;nbsp;Flux.&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#flux-components" id="id2"&gt;Flux&amp;nbsp;components&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-react-flux-version" id="id3"&gt;The react-flux version&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#main-js" id="id4"&gt;main.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#constants-js" id="id5"&gt;constants.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#actions-js" id="id6"&gt;actions.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#stores-js" id="id7"&gt;stores.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#components-js" id="id8"&gt;components.js&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#explaining-the-data-flow" id="id9"&gt;Explaining the data&amp;nbsp;flow&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-better-code-organization" id="id10"&gt;A better code&amp;nbsp;organization&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id11"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the &lt;a class="reference external" href="https://spapas.github.io/2015/06/05/comprehensive-react-flux-tutorial/"&gt;first part of this series&lt;/a&gt; we implemented a
not-so-simple one page application with full &lt;span class="caps"&gt;CRUD&lt;/span&gt; capabilities. In this part, we will
modify that application to make it use the Flux architecture. The full source code can
be found at &lt;a class="reference external" href="https://github.com/spapas/react-tutorial"&gt;https://github.com/spapas/react-tutorial&lt;/a&gt; (tag name react-flux). In the
&lt;a class="reference external" href="https://spapas.github.io/2015/09/08/more-complex-react-flux-example/"&gt;next part,&lt;/a&gt; we will create an even more complex application
using&amp;nbsp;react/flux!&lt;/p&gt;
&lt;p&gt;I recommend reading Facebook&amp;#8217;s &lt;a class="reference external" href="https://facebook.github.io/flux/docs/overview.html"&gt;Flux overview&lt;/a&gt; before reading this article &amp;#8212; please
read it even if you find some concepts difficult to grasp (I know I found it difficult
the first time I read it), I will try to explain everything here. Also,
because a rather large number of extra components will need to be created, we are
going to split our javascript code to different files using &lt;a class="reference external" href="http://browserify.org/"&gt;browserify&lt;/a&gt; - you can
learn &lt;a class="reference external" href="https://spapas.github.io/2015/05/27/using-browserify-watchify/"&gt;how to use browserify here&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="flux-components"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Flux&amp;nbsp;components&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To implement the Flux architecture, an application needs to have at least a store and a&amp;nbsp;dispatcher.&lt;/p&gt;
&lt;p&gt;The store is the central place of truth for the application and the dispacher is the central
place of communications. The store should hold the
state (and any models/DAOs) of the application and notify the react components when this state is changed. Also,
the store will be notified by the dispatcher when an action happens (for example a button is clicked)
so that it will change the state. As a flow, we can think of something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
a ui action on a component (click, change, etc) -&amp;gt;
 ^   dispatcher is notified -&amp;gt;
 |   store is notified (by the dispacher)-&amp;gt;
 |   store state is changed -&amp;gt;
 ââ  component is notified (by the store) and updated to reflect the change
&lt;/pre&gt;
&lt;p&gt;One thing to keep in mind is that although each flux application will have only one dispatcher, it may
have more stores, depending on the application&amp;#8217;s architecture and separation of concerns. If there are
more than store, all will be notified by the dispatcher and change their state (if needed of course).
The ui will pass the action type and any optional parameters to the dispatcher and the dispatcher
will notify all stores with these&amp;nbsp;parameters.&lt;/p&gt;
&lt;p&gt;An optional component in the Flux architecture is the Action. An action is a store related class that
acts as an intermediate between the ui and the dispatcher. So, when a user clicks a button, an action
will be called that will notify the dispatcher. As we will see we can just call the dispatcher directly
from the components ui, but calling it through the Action makes the calls more consistent and creates
an&amp;nbsp;interface.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-react-flux-version"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;The react-flux&amp;nbsp;version&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Since we are using browserify, we will include a single file in our html file with a &lt;tt class="docutils literal"&gt;&amp;lt;script&amp;gt;&lt;/tt&gt; tag
and everything else will be included through the &lt;tt class="docutils literal"&gt;require&lt;/tt&gt; function. We have the following packages
as requirements for&amp;nbsp;browserify:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;quot;dependencies&amp;quot;: {
  &amp;quot;flux&amp;quot;: &amp;quot;^2.0.3&amp;quot;,
  &amp;quot;jquery&amp;quot;: &amp;quot;^2.1.4&amp;quot;,
  &amp;quot;react&amp;quot;: &amp;quot;^0.13.3&amp;quot;,
  &amp;quot;reactify&amp;quot;: &amp;quot;^1.1.1&amp;quot;
}
&lt;/pre&gt;
&lt;p&gt;Also, in order to be able to use &lt;span class="caps"&gt;JSX&lt;/span&gt; with browserify, will use the &lt;a class="reference external" href="https://github.com/andreypopp/reactify"&gt;reactify&lt;/a&gt; transform. To apply it to
your project, change the &lt;tt class="docutils literal"&gt;scripts&lt;/tt&gt; of your &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; to:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;quot;scripts&amp;quot;: {
  &amp;quot;watch&amp;quot;: &amp;quot;watchify -v -d static/main.js -t reactify -o static/bundle.js&amp;quot;,
  &amp;quot;build&amp;quot;: &amp;quot;browserify static/main.js -t reactify  | uglifyjs -mc warnings=false &amp;gt; static/bundle.js&amp;quot;
},
&lt;/pre&gt;
&lt;div class="section" id="main-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id4"&gt;main.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;main.js&lt;/tt&gt; file will
just render the BookPanel component (the &lt;tt class="docutils literal"&gt;components.js&lt;/tt&gt; file contains the source for all React components) and call
the &lt;tt class="docutils literal"&gt;reloadBooks&lt;/tt&gt; function from &lt;tt class="docutils literal"&gt;stores.js&lt;/tt&gt; that will reload all books from the &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var components = require('./components');
var stores = require('./stores');

React.render(&amp;lt;components.BookPanel url='/api/books/' /&amp;gt;, document.getElementById('content'));

stores.reloadBooks();
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="constants-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id5"&gt;constants.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Before going into more complex modules, let&amp;#8217;s present the &lt;tt class="docutils literal"&gt;constants.js&lt;/tt&gt; which just
exports some strings that will be passed to the dispatcher to differentiate between each
ui&amp;nbsp;action:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
module.exports = {
    BOOK_EDIT: 'BOOK_EDIT',
    BOOK_EDIT_CANCEL: 'BOOK_EDIT_CANCEL',
    BOOK_SAVE: 'BOOK_SAVE',
    BOOK_SEARCH: 'BOOK_SEARCH',
    BOOK_DELETE: 'BOOK_DELETE',
};
&lt;/pre&gt;
&lt;p&gt;As we can see, these constants are exported as a single object so when we do something like
&lt;tt class="docutils literal"&gt;var BookConstants = &lt;span class="pre"&gt;require('./constants')&lt;/span&gt;&lt;/tt&gt; we&amp;#8217;ll the be able to refer to each constant
through &lt;tt class="docutils literal"&gt;BookConstants.CONSTANT_NAME&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="actions-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;actions.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;actions.js&lt;/tt&gt; creates the dispatcher singleton and a BookActions object that defines the
actions for&amp;nbsp;books.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var BookConstants = require('./constants')
var Dispatcher = require('flux').Dispatcher;
var AppDispatcher = new Dispatcher();

var BookActions = {
    search: function(query) {
        AppDispatcher.dispatch({
            actionType: BookConstants.BOOK_SEARCH,
            query: query
        });
    },
    save: function(book) {
        AppDispatcher.dispatch({
            actionType: BookConstants.BOOK_SAVE,
            book: book
        });
    },
    edit: function(book) {
        AppDispatcher.dispatch({
            actionType: BookConstants.BOOK_EDIT,
            book: book
        });
    },
    edit_cancel: function() {
        AppDispatcher.dispatch({
            actionType: BookConstants.BOOK_EDIT_CANCEL
        });
    },
    delete: function(bookId) {
        AppDispatcher.dispatch({
            actionType: BookConstants.BOOK_DELETE,
            bookId: bookId
        });
    }
};

module.exports.BookActions = BookActions;
module.exports.AppDispatcher = AppDispatcher;
&lt;/pre&gt;
&lt;p&gt;As we can see, the BookActions is just a collection of methods that will
be called from the ui. Instead of calling BookActions.search() we could
just call the dispatch method with the correct parameter object (actionType
and optional parameter), both the BookActions object and the AppDispatcher
singleton are&amp;nbsp;exported.&lt;/p&gt;
&lt;p&gt;The dispatcher is imported from the flux requirement: It offers a functionality
to register callbacks for the various actions as we will see in the
next module. This is a rather simple class that we could implement ourselves
(each store passes a callback to the dispatcher that is called on the dispatch
method, passing actionType and any other parameters). The dispatcher also
offers a &lt;tt class="docutils literal"&gt;waitFor&lt;/tt&gt; method that can be used to ensure that the dispatch callback
for a store will be finished before another store&amp;#8217;s dispatch callback (
when the second store uses the state of the first store &amp;#8212; for example
when implementing a series of related dropdowns&amp;nbsp;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="stores-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;stores.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The next module we will discuss is the &lt;tt class="docutils literal"&gt;stores.js&lt;/tt&gt; that contains the
&lt;tt class="docutils literal"&gt;BookStore&lt;/tt&gt; object.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var $ = require('jquery');
var EventEmitter = require('events').EventEmitter;
var AppDispatcher = require('./actions').AppDispatcher;
var BookConstants = require('./constants')

var _state = {
    books: [],
    message:&amp;quot;&amp;quot;,
    editingBook: null
}

var _props = {
    url: '/api/books/'
}

var _search = function(query) {
    $.ajax({
        url: _props.url+'?search='+query,
        dataType: 'json',
        cache: false,
        success: function(data) {
            _state.books = data;
            BookStore.emitChange();
        },
        error: function(xhr, status, err) {
            console.error(this.props.url, status, err.toString());
            _state.message = err.toString();
            BookStore.emitChange();
        }
    });
};

var _reloadBooks = function() {
    _search('');
};

var _deleteBook = function(bookId) {
    $.ajax({
        url: _props.url+bookId,
        method: 'DELETE',
        cache: false,
        success: function(data) {
            _state.message = &amp;quot;Successfully deleted book!&amp;quot;
            _clearEditingBook();
            _reloadBooks();
        },
        error: function(xhr, status, err) {
            console.error(this.props.url, status, err.toString());
            _state.message = err.toString();
            BookStore.emitChange();
        }
    });
};

var _saveBook = function(book) {
    if(book.id) {
        $.ajax({
            url: _props.url+book.id,
            dataType: 'json',
            method: 'PUT',
            data:book,
            cache: false,
            success: function(data) {
                _state.message = &amp;quot;Successfully updated book!&amp;quot;
                _clearEditingBook();
                _reloadBooks();
            },
            error: function(xhr, status, err) {
                _state.message = err.toString()
                BookStore.emitChange();
            }
        });
    } else {
        $.ajax({
            url: _props.url,
            dataType: 'json',
            method: 'POST',
            data:book,
            cache: false,
            success: function(data) {
                _state.message = &amp;quot;Successfully added book!&amp;quot;
                _clearEditingBook();
                _reloadBooks();
            },
            error: function(xhr, status, err) {
                _state.message = err.toString()
                BookStore.emitChange();
            }
        });
    }
};

var _clearEditingBook = function() {
    _state.editingBook = null;
};

var _editBook = function(book) {
    _state.editingBook = book;
    BookStore.emitChange();
};

var _cancelEditBook = function() {
    _clearEditingBook();
    BookStore.emitChange();
};

var BookStore = $.extend({}, EventEmitter.prototype, {
    getState: function() {
        return _state;
    },
    emitChange: function() {
        this.emit('change');
    },
    addChangeListener: function(callback) {
        this.on('change', callback);
    },
    removeChangeListener: function(callback) {
        this.removeListener('change', callback);
    }
});

AppDispatcher.register(function(action) {
    switch(action.actionType) {
        case BookConstants.BOOK_EDIT:
            _editBook(action.book);
        break;
        case BookConstants.BOOK_EDIT_CANCEL:
            _cancelEditBook();
        break;
        case BookConstants.BOOK_SAVE:
            _saveBook(action.book);
        break;
        case BookConstants.BOOK_SEARCH:
            _search(action.query);
        break;
        case BookConstants.BOOK_DELETE:
            _deleteBook(action.bookId);
        break;
    }
    return true;
});

module.exports.BookStore = BookStore;
module.exports.reloadBooks = _reloadBooks;
&lt;/pre&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;stores.js&lt;/tt&gt; module exports only the &lt;tt class="docutils literal"&gt;BookStore&lt;/tt&gt; object and the &lt;tt class="docutils literal"&gt;reloadBooks&lt;/tt&gt; method (that could also be
called from inside the module since it&amp;#8217;s just called when the application is loaded to load the books for the
first time). All other objects/funtions are private to the&amp;nbsp;module.&lt;/p&gt;
&lt;p&gt;As we saw, the &lt;tt class="docutils literal"&gt;_state&lt;/tt&gt; objects keep the global state of the application which are the list of books, the book
that is edited right now and the result message for any update we are doing. The ajax methods are more or less
the same as the ones in the react-only version of the application. However, please notice that when the ajax methods
return and have to set the result, instead of setting the state of a React object they are just calling the
&lt;tt class="docutils literal"&gt;emitChange&lt;/tt&gt; method of the &lt;tt class="docutils literal"&gt;BookStore&lt;/tt&gt; that will notify all react objects that &amp;#8220;listen&amp;#8221; to this store.
This is possible because the ajax (&lt;span class="caps"&gt;DAO&lt;/span&gt;) methods are in the same module with the store - if we wanted instead
to put them in different modules, we&amp;#8217;d just need to add another action (e.g &lt;tt class="docutils literal"&gt;ReloadBooks&lt;/tt&gt;) that would
be called when the ajax method returns &amp;#8212; this action would call the dispatcher which would in turn update the
state of the&amp;nbsp;store.&lt;/p&gt;
&lt;p&gt;We can see that we are importing the
AppDispatcher singleton and, depending on the action type we call the correct method that changes the state. So
when a BookActions action is called it will call the corresponding &lt;tt class="docutils literal"&gt;AppDispatcher.register&lt;/tt&gt; case branch which
will call the corresponding state-changing&amp;nbsp;function.&lt;/p&gt;
&lt;p&gt;The  BookStore extends the &lt;tt class="docutils literal"&gt;EventEmitter&lt;/tt&gt; object (so we need to &lt;tt class="docutils literal"&gt;require&lt;/tt&gt; the &lt;tt class="docutils literal"&gt;events&lt;/tt&gt; module) in order to
notify the React components when the state of the store is changed. Instead of using &lt;tt class="docutils literal"&gt;EventEmitter&lt;/tt&gt; we could
just implement the emit change logic ourselves by saving all the listener callbacks to an array and calling them
all when there&amp;#8217;s a state change (if we wanted to also add the &amp;#8216;change&amp;#8217; parameter to group the listener
callbacks we&amp;#8217;d just make the complex more complex, something not needed for our&amp;nbsp;case):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var BookStore = {
    listeners: [],
    getState: function() {
        return _state;
    },
    emitChange: function() {
        var i;
        for(i=0;i&amp;lt;this.listeners.length;i++) {
            this.listeners[i]();
        }
    },
    addChangeListener: function(callback) {
        this.listeners.push(callback);
    },
    removeChangeListener: function(callback) {
        this.listeners.splice(this.listeners.indexOf(callback), 1);
    }
};
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="components-js"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;components.js&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Finally, the &lt;tt class="docutils literal"&gt;components.js&lt;/tt&gt; module contains all the React components. These are more
or less the same with the react-only version with three&amp;nbsp;differences:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;When something happens in the ui, the corresponding &lt;tt class="docutils literal"&gt;BookAction&lt;/tt&gt; action is called with the needed parameter &amp;#8212; no callbacks are passed between the&amp;nbsp;components&lt;/li&gt;
&lt;li&gt;The &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; component registers with the &lt;tt class="docutils literal"&gt;BookStore&lt;/tt&gt; in order to be notified when the state changes and just gets its state from the store &amp;#8212; these values are propagated to all other components through&amp;nbsp;properties&lt;/li&gt;
&lt;li&gt;The &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;SearcchPanel&lt;/tt&gt; now hold their own temporary state instead of using the global state &amp;#8212; notice that when a book is edited this book will be propagated to the &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; through the book property, however &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; needs to update its state through the &lt;tt class="docutils literal"&gt;componentWillReceiveProps&lt;/tt&gt; method.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code literal-block"&gt;
var React = require('react');
var BookStore = require('./stores').BookStore;
var BookActions = require('./actions').BookActions;

var BookTableRow = React.createClass({
    render: function() {
        return (
            &amp;lt;tr&amp;gt;
                &amp;lt;td&amp;gt;{this.props.book.id}&amp;lt;/td&amp;gt;
                &amp;lt;td&amp;gt;{this.props.book.title}&amp;lt;/td&amp;gt;
                &amp;lt;td&amp;gt;{this.props.book.category}&amp;lt;/td&amp;gt;
                &amp;lt;td&amp;gt;&amp;lt;a href='#' onClick={this.onClick}&amp;gt;Edit&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;
            &amp;lt;/tr&amp;gt;
        );
    },
    onClick: function(e) {
        e.preventDefault();
        BookActions.edit(this.props.book);
    }
});

var BookTable = React.createClass({
    render: function() {
        var rows = [];
        this.props.books.forEach(function(book) {
            rows.push(&amp;lt;BookTableRow key={book.id} book={book} /&amp;gt;);
        });
        return (
            &amp;lt;table&amp;gt;
                &amp;lt;thead&amp;gt;
                    &amp;lt;tr&amp;gt;
                        &amp;lt;th&amp;gt;Id&amp;lt;/th&amp;gt;
                        &amp;lt;th&amp;gt;Title&amp;lt;/th&amp;gt;
                        &amp;lt;th&amp;gt;Category&amp;lt;/th&amp;gt;
                        &amp;lt;th&amp;gt;Edit&amp;lt;/th&amp;gt;
                    &amp;lt;/tr&amp;gt;
                &amp;lt;/thead&amp;gt;
                &amp;lt;tbody&amp;gt;{rows}&amp;lt;/tbody&amp;gt;
            &amp;lt;/table&amp;gt;
        );
    }
});

var BookForm = React.createClass({
    getInitialState: function() {
        if (this.props.book) {
            return this.props.book;
        } else {
            return {};
        }
    },
    componentWillReceiveProps: function(props) {
        if (props.book) {
            this.setState(props.book);
        } else {
            this.replaceState({});
        }
    },
    render: function() {
        return(
            &amp;lt;form onSubmit={this.onSubmit}&amp;gt;
                &amp;lt;label forHtml='title'&amp;gt;Title&amp;lt;/label&amp;gt;&amp;lt;input ref='title' name='title' type='text' value={this.state.title} onChange={this.onFormChange} /&amp;gt;
                &amp;lt;label forHtml='category'&amp;gt;Category&amp;lt;/label&amp;gt;
                &amp;lt;select ref='category' name='category' value={this.state.category} onChange={this.onFormChange} &amp;gt;
                    &amp;lt;option value='CRIME' &amp;gt;Crime&amp;lt;/option&amp;gt;
                    &amp;lt;option value='HISTORY'&amp;gt;History&amp;lt;/option&amp;gt;
                    &amp;lt;option value='HORROR'&amp;gt;Horror&amp;lt;/option&amp;gt;
                    &amp;lt;option value='SCIFI'&amp;gt;SciFi&amp;lt;/option&amp;gt;
                &amp;lt;/select&amp;gt;
                &amp;lt;br /&amp;gt;
                &amp;lt;input type='submit' value={this.state.id?&amp;quot;Save (id = &amp;quot; +this.state.id+ &amp;quot;)&amp;quot;:&amp;quot;Add&amp;quot;} /&amp;gt;
                {this.state.id?&amp;lt;button onClick={this.onDeleteClick}&amp;gt;Delete&amp;lt;/button&amp;gt;:&amp;quot;&amp;quot;}
                {this.state.id?&amp;lt;button onClick={this.onCancelClick}&amp;gt;Cancel&amp;lt;/button&amp;gt;:&amp;quot;&amp;quot;}
                {this.props.message?&amp;lt;div&amp;gt;{this.props.message}&amp;lt;/div&amp;gt;:&amp;quot;&amp;quot;}
            &amp;lt;/form&amp;gt;
        );
    },
    onFormChange: function() {
        this.setState({
            title: React.findDOMNode(this.refs.title).value,
            category: React.findDOMNode(this.refs.category).value
        })
    },
    onSubmit: function(e) {
        e.preventDefault();
        BookActions.save(this.state)
    },
    onCancelClick: function(e) {
        e.preventDefault();
        BookActions.edit_cancel()
    },
    onDeleteClick: function(e) {
        e.preventDefault();
        BookActions.delete(this.state.id)
    }
});

var SearchPanel = React.createClass({
    getInitialState: function() {
        return {
            search: '',
        }
    },
    render: function() {
        return (
            &amp;lt;div className=&amp;quot;row&amp;quot;&amp;gt;
                &amp;lt;div className=&amp;quot;one-fourth column&amp;quot;&amp;gt;
                    Filter: &amp;amp;nbsp;
                    &amp;lt;input ref='search' name='search' type='text' value={this.state.search} onChange={this.onSearchChange} /&amp;gt;
                    {this.state.search?&amp;lt;button onClick={this.onClearSearch} &amp;gt;x&amp;lt;/button&amp;gt;:''}
                &amp;lt;/div&amp;gt;
            &amp;lt;/div&amp;gt;
        )
    },
    onSearchChange: function() {
        var query = React.findDOMNode(this.refs.search).value;
        if (this.promise) {
            clearInterval(this.promise)
        }
        this.setState({
            search: query
        });
        this.promise = setTimeout(function () {
            BookActions.search(query);
        }.bind(this), 200);
    },
    onClearSearch: function() {
        this.setState({
            search: ''
        });
        BookActions.search('');
    }
});

var BookPanel = React.createClass({
    getInitialState: function() {
        return BookStore.getState();
    },
    render: function() {
        return(
            &amp;lt;div className=&amp;quot;row&amp;quot;&amp;gt;
                &amp;lt;div className=&amp;quot;one-half column&amp;quot;&amp;gt;
                    &amp;lt;SearchPanel&amp;gt;&amp;lt;/SearchPanel&amp;gt;
                    &amp;lt;BookTable books={this.state.books} /&amp;gt;
                &amp;lt;/div&amp;gt;
                &amp;lt;div className=&amp;quot;one-half column&amp;quot;&amp;gt;
                    &amp;lt;BookForm
                        book={this.state.editingBook}
                        message={this.state.message}
                    /&amp;gt;
                &amp;lt;/div&amp;gt;
                &amp;lt;br /&amp;gt;
            &amp;lt;/div&amp;gt;
        );
    },
    _onChange: function() {
        this.setState( BookStore.getState() );
    },
    componentWillUnmount: function() {
        BookStore.removeChangeListener(this._onChange);
    },
    componentDidMount: function() {
        BookStore.addChangeListener(this._onChange);
    }
});

module.exports.BookPanel = BookPanel ;
&lt;/pre&gt;
&lt;p&gt;Only the &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; is exported &amp;#8212; all other react components will be private to the&amp;nbsp;module.&lt;/p&gt;
&lt;p&gt;We can see that, beyond BookPanel, the code of all other components
are more or less the same. However, &lt;em&gt;not&lt;/em&gt; having to pass callbacks for state upddates
is a huge win for readability and&amp;nbsp;DRYness.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="explaining-the-data-flow"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;Explaining the data&amp;nbsp;flow&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I&amp;#8217;ve added a bunch of console.log statements to see how the data/actions flow between
all the components when the &amp;#8220;Edit&amp;#8221; book is clicked. So, when we click &amp;#8220;Edit&amp;#8221; we see
the following messages to our&amp;nbsp;console:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
Inside BookTableRow.onClick
Inside BookActions.edit
Inside AppDispatcher.register
Inside AppDispatcher.register case BookConstants.BOOK_EDIT
Inside _editBook
Inside BookStore.emitChange
Inside BookPanel._onChange
Inside BookForm.componentWillReceiveProps
Inside BookForm.render
&lt;/pre&gt;
&lt;p&gt;First of all the &lt;tt class="docutils literal"&gt;onClick&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;BookTableRow&lt;/tt&gt; will be called (which is the onClick property of the
a href link) which will call &lt;tt class="docutils literal"&gt;BookActions.edit&lt;/tt&gt; and pass it the book of that specific row. The &lt;tt class="docutils literal"&gt;edit&lt;/tt&gt;
method will create a new dispatcher object by setting the &lt;tt class="docutils literal"&gt;actionType&lt;/tt&gt; and passing the &lt;tt class="docutils literal"&gt;book&lt;/tt&gt; and
pass it to &lt;tt class="docutils literal"&gt;AppDispatcher.register&lt;/tt&gt;. &lt;tt class="docutils literal"&gt;register&lt;/tt&gt; will go to the &lt;tt class="docutils literal"&gt;BookConstants.BOOK_EDIT&lt;/tt&gt; case branch
which will call the private &lt;tt class="docutils literal"&gt;_editBook&lt;/tt&gt; function. &lt;tt class="docutils literal"&gt;_editBook&lt;/tt&gt; will update the state of the store (by
setting the &lt;tt class="docutils literal"&gt;_state.editingBook&lt;/tt&gt; property and will call the &lt;tt class="docutils literal"&gt;BookStore.emitChange&lt;/tt&gt; method
which calls the dispatcher&amp;#8217;s emit method, so all listening components will update. We only have one
component that listens to this emit, &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; whose &lt;tt class="docutils literal"&gt;_onChange&lt;/tt&gt; method is called. This method
gets the application state from the &lt;tt class="docutils literal"&gt;BookStore&lt;/tt&gt; and updates its own state. Now, the state will be
propagated through properties - for example, for &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;, first its &lt;tt class="docutils literal"&gt;componentWillReceiveProps&lt;/tt&gt;
method will be called (with the new properties) and finally its &lt;tt class="docutils literal"&gt;render&lt;/tt&gt; method!&lt;/p&gt;
&lt;p&gt;So the full data flow is something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
user action/callback etc -&amp;gt;
  component calls action -&amp;gt;
    dispatcher informes stores -&amp;gt;
      stores set their state -&amp;gt;
        state holding components are notified and update their state -&amp;gt;
          all other components are updated through properties
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="a-better-code-organization"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;A better code&amp;nbsp;organization&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As you&amp;#8217;ve seen, I&amp;#8217;ve only created four javascript modules (components, stores, actions and constants)
and put them all in the same folder. I did this for clarity and to keep everything together since
our tutorial is a very small project. Facebook proposes a much better organization that what I did
as can be seen in the &lt;a class="reference external" href="https://facebook.github.io/flux/docs/todo-list.html"&gt;TodoMVC tutorial&lt;/a&gt;: Instead of putting everything to a single folder, create
a different foloder for each type of object: actions (for all your actions), components (for all
your React components), constants and stores and put inside the objects each in a different javascript
module, for example, the components folder should contain the following&amp;nbsp;files:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;BookTable.react.js&lt;/li&gt;
&lt;li&gt;BookTableRow.react.js&lt;/li&gt;
&lt;li&gt;BookForm.react.js&lt;/li&gt;
&lt;li&gt;BookPanel.react.js&lt;/li&gt;
&lt;li&gt;SearchPanel.react.js&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Each one will export only the same-named React component and &lt;tt class="docutils literal"&gt;require&lt;/tt&gt; only the components that it&amp;nbsp;uses.&lt;/p&gt;
&lt;p&gt;If you want to see the code of this tutorial organized like this go to the tag &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;react-flux-better-organization&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In this two-part series we saw how we can create a full &lt;span class="caps"&gt;CRUD&lt;/span&gt; application with React.js and how can
we enable it with the Facebook proposed Flux architecture. Comparing the react-only with the react-flux
version we can see that we added a number of objects in the second version (dispatcher, store, actions, constants)
whose usefulness may not be obvious from our example. However, our created application (and especially
the better organized version) is war-ready and can easily fight any complexities that we throw to it!
Unfortunately, if we really wanted to show the usefulness of the Flux architecture we&amp;#8217;d need to create
a really complex application that won&amp;#8217;t be suitable for a&amp;nbsp;tutorial.&lt;/p&gt;
&lt;p&gt;However, we can already understand the obvious advantages of the React / Flux&amp;nbsp;architecture:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Components can easily be re-used by changing their properties - &lt;span class="caps"&gt;DRY&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;Easy to grasp (but a little complex) data flow between components and&amp;nbsp;stores&lt;/li&gt;
&lt;li&gt;Separation of concerns - react components for the view, stores to hold the state/models, dispatcher to handle the data&amp;nbsp;flow&lt;/li&gt;
&lt;li&gt;Really easy to test - all components are simple objects and can be easily created fom&amp;nbsp;tests&lt;/li&gt;
&lt;li&gt;Works well for complex architectures - one dispatcher, multiple stores/action collections, react components only interact with actions and get their state from&amp;nbsp;stores&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;I&amp;#8217;ve tried to make the above as comprehensive as possible for the readers of these posts
(and also resolve some of my own questions). I have to mention again that although React/Flux may
seem complex at a first glance, when it is used in a complex architecture it will shine and
make everything much easier. Everything is debuggable and we can always understand what&amp;#8217;s
really going on! This is in contrast with more complex frameworks that do various hidden
stuff (two way data binding, magic in the &lt;span class="caps"&gt;REST&lt;/span&gt; etc) where, although it is easier to
create a simple app, moving to something more complex (and especially debugging it) is a real&amp;nbsp;nightmare!&lt;/p&gt;
&lt;/div&gt;
</content><category term="javascript"></category><category term="javascript"></category><category term="python"></category><category term="django"></category><category term="react"></category><category term="flux"></category></entry><entry><title>A comprehensive React and Flux tutorial part 1:Â React</title><link href="https://spapas.github.io/2015/06/05/comprehensive-react-flux-tutorial/" rel="alternate"></link><published>2015-06-05T14:20:00+03:00</published><updated>2015-06-05T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-06-05:/2015/06/05/comprehensive-react-flux-tutorial/</id><summary type="html">&lt;p class="first last"&gt;A React and Flux tutorial that tries to be as comprehensive as possible! Part 1 is about&amp;nbsp;React.&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#our-project" id="id2"&gt;Our&amp;nbsp;project&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-top-level-view-of-the-components" id="id3"&gt;A top-level view of the&amp;nbsp;components&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-react-only-version" id="id4"&gt;The react-only version&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#searchpanel" id="id5"&gt;&lt;tt class="docutils literal"&gt;SearchPanel&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#booktablerow" id="id6"&gt;&lt;tt class="docutils literal"&gt;BookTableRow&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#booktable" id="id7"&gt;&lt;tt class="docutils literal"&gt;BookTable&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#interlude-the-bind-function-method" id="id8"&gt;Interlude: The &lt;tt class="docutils literal"&gt;bind&lt;/tt&gt; function&amp;nbsp;method&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#bookform" id="id9"&gt;&lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#bookpanel" id="id10"&gt;&lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt;&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#component-methods" id="id11"&gt;Component&amp;nbsp;methods&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#non-ajax-object-methods" id="id12"&gt;Non-ajax object&amp;nbsp;methods&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#ajax-object-methods" id="id13"&gt;Ajax object&amp;nbsp;methods&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#local-state" id="id14"&gt;Local&amp;nbsp;state&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#adding-form-validation" id="id15"&gt;Adding form&amp;nbsp;validation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion-to-the-first-part" id="id16"&gt;Conclusion to the first&amp;nbsp;part&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Update 15/12/2015&lt;/strong&gt;: Added some insights for form&amp;nbsp;validation.&lt;/p&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://facebook.github.io/react/"&gt;React&lt;/a&gt; is a rather new library from Facebook for building dynamic components for web pages.
It introduces a really simple, fresh approach to javascript user interface building. React
allows you to define composable and self-contained &lt;span class="caps"&gt;HTML&lt;/span&gt; components through Javascript (or a special syntax that compiles
to javascript named &lt;span class="caps"&gt;JSX&lt;/span&gt;) and that&amp;#8217;s all &amp;#8212; it doesn&amp;#8217;t force you into any specific
framework or architecture, you may use whatever you like. It&amp;#8217;s like writing pure
&lt;span class="caps"&gt;HTML&lt;/span&gt; but you have the advantage of using classes with all their advantages for your
components (self-contained, composable, reusable, mixins&amp;nbsp;etc).&lt;/p&gt;
&lt;p&gt;Although React components can be used however you like in your client-side applications, Facebook proposes a specific
architecture for the data flow of your events/data between the components called &lt;a class="reference external" href="https://facebook.github.io/flux/docs/overview.html"&gt;Flux&lt;/a&gt;.
It&amp;#8217;s important to keep in your mind that Flux is not a
specific framework but a way to organize the flow of events and data in your applicition.
Unfortunately, although Flux is a rather simple architecture it is a little difficult to understand
without a proper example (at least it was difficult for me to understand by reading the
Facebook documentation and some tutorials I&amp;nbsp;found).&lt;/p&gt;
&lt;p&gt;So, in this two-part tutorial we are going to build a (not-so-simple) single page &lt;span class="caps"&gt;CRUD&lt;/span&gt; application using
React and Flux. Two versions of the same application will be built and explained: One with
React (this part) only and one with React and Flux (part two). This will help us understand how
Flux architecture fits to our project and why it greatly improves the experience with&amp;nbsp;React.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Warning&lt;/strong&gt;: This is not an introduction to react. Before reading this you need
to be familiar with basic react usage, having read  at least the following three
pages from react&amp;nbsp;documentation:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://facebook.github.io/react/docs/getting-started.html"&gt;https://facebook.github.io/react/docs/getting-started.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://facebook.github.io/react/docs/tutorial.html"&gt;https://facebook.github.io/react/docs/tutorial.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://facebook.github.io/react/docs/thinking-in-react.html"&gt;https://facebook.github.io/react/docs/thinking-in-react.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="our-project"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Our&amp;nbsp;project&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We are going to built a &lt;span class="caps"&gt;CRUD&lt;/span&gt; single-page application for editing views, let&amp;#8217;s take a look at how it&amp;nbsp;works:&lt;/p&gt;
&lt;img alt="Our project" src="/images/demo.gif" style="width: 780px;" /&gt;
&lt;p&gt;Our application will be seperated to two panels: In  the left one the user will be able to filter (search) for
a book and in the right panel she&amp;#8217;ll be able to add / edit / delete a book. Everything is supported by
a &lt;a class="reference external" href="http://www.django-rest-framework.org/"&gt;django-rest-framework&lt;/a&gt; implemented &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt;. You can find the complete source code at
&lt;a class="reference external" href="https://github.com/spapas/react-tutorial"&gt;https://github.com/spapas/react-tutorial&lt;/a&gt;. I&amp;#8217;ve added a couple of git tags to the source history in
order to help us identify the differences between variou stages of the project (before and
after integrating the Flux&amp;nbsp;architecture).&lt;/p&gt;
&lt;p&gt;Django-rest-framework is used in the server-side back-end to create a really simple &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; - I won&amp;#8217;t
provide any tutorial details on that (unless somebody wants it !), however
you may either use the source code as is or create it from scratch using a different language/framework
or even just a static json file (however you won&amp;#8217;t see any changes to the data this&amp;nbsp;way).&lt;/p&gt;
&lt;p&gt;For styling (mainly to have a simple grid) we&amp;#8217;ll use &lt;a class="reference external" href="http://getskeleton.com/"&gt;skeleton&lt;/a&gt;. For the ajax calls and some utils we&amp;#8217;ll
use &lt;a class="reference external" href="https://jquery.com/"&gt;jquery&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;All client-side code will be contained in the file static/main.js. The placeholder &lt;span class="caps"&gt;HTML&lt;/span&gt; for our
application&amp;nbsp;is:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;lt;html&amp;gt;
  &amp;lt;!-- styling etc ignored --&amp;gt;
&amp;lt;body&amp;gt;
  &amp;lt;h1&amp;gt;Hello, React!&amp;lt;/h1&amp;gt;
  &amp;lt;div class=&amp;quot;container&amp;quot;&amp;gt;&amp;lt;div id=&amp;quot;content&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;script src=&amp;quot;//fb.me/react-0.13.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script src=&amp;quot;//fb.me/JSXTransformer-0.13.3.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script src=&amp;quot;//code.jquery.com/jquery-2.1.3.min.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;script type=&amp;quot;text/jsx&amp;quot; src=&amp;quot;{% static 'main.js' %}&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/pre&gt;
&lt;p&gt;We are using the version 0.13.3 of react and the same version of the JSXTransformer to translate &lt;span class="caps"&gt;JSX&lt;/span&gt;
code to pure&amp;nbsp;javascript.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="a-top-level-view-of-the-components"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;A top-level view of the&amp;nbsp;components&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The following image shows how our components are&amp;nbsp;composed:&lt;/p&gt;
&lt;img alt="Our components" src="/images/components.png" style="width: 780px;" /&gt;
&lt;p&gt;So, the main component of our application is &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; which contains three&amp;nbsp;components:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;SearchPanel&lt;/tt&gt;: To allow search (filtering) books based on their&amp;nbsp;title/category&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;: To add/update/delete&amp;nbsp;books&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;BookTable&lt;/tt&gt;: To display all available books - each book is displayed in a &lt;tt class="docutils literal"&gt;BookTableRow&lt;/tt&gt; component.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; is the only component having state &amp;#8212; all other components will be initialized by property
passing. The &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; element will be mounted to the &lt;tt class="docutils literal"&gt;#content&lt;/tt&gt; element when the page&amp;nbsp;loads.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-react-only-version"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;The react-only&amp;nbsp;version&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The first version, using only react (and not flux) will use &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; as a central information &lt;span class="caps"&gt;HUB&lt;/span&gt;.&lt;/p&gt;
&lt;div class="section" id="searchpanel"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id5"&gt;&lt;tt class="docutils literal"&gt;SearchPanel&lt;/tt&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;SearchPanel&lt;/tt&gt; renders an input element with a value defined by the &lt;tt class="docutils literal"&gt;search&lt;/tt&gt; key of this component&amp;#8217;same
properties. When this is changed the &lt;tt class="docutils literal"&gt;onSearchChanged&lt;/tt&gt; method of the component will be called, which in turn,
retrieves the value of the input (using refs) and passes it to the properties &lt;tt class="docutils literal"&gt;onSearchChanged&lt;/tt&gt; callback function.
Finally, with the line &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;{this.props.search?&amp;lt;button&lt;/span&gt; &lt;span class="pre"&gt;onClick={this.props.onClearSearch}&lt;/span&gt; &lt;span class="pre"&gt;&amp;gt;x&amp;lt;/button&amp;gt;:null}&lt;/span&gt;&lt;/tt&gt;
we check if the search property contains any text and if yes, we display a clear filter button that will call
properties onClearSearch&amp;nbsp;method:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var SearchPanel = React.createClass({
  render: function() {
    return (
      &amp;lt;div className=&amp;quot;row&amp;quot;&amp;gt;
        &amp;lt;div className=&amp;quot;one-fourth column&amp;quot;&amp;gt;
          Filter: &amp;amp;nbsp;
          &amp;lt;input ref='search' type='text' value={this.props.search} onChange={this.onSearchChanged} /&amp;gt;
          {this.props.search?&amp;lt;button onClick={this.props.onClearSearch} &amp;gt;x&amp;lt;/button&amp;gt;:null}
        &amp;lt;/div&amp;gt;
      &amp;lt;/div&amp;gt;
    )
  },
  onSearchChanged: function() {
    var query = React.findDOMNode(this.refs.search).value;
    this.props.onSearchChanged(query);
  }
});
&lt;/pre&gt;
&lt;p&gt;So, this component has three&amp;nbsp;properties:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;search which is the text to display in the input&amp;nbsp;box&lt;/li&gt;
&lt;li&gt;onSearchChanged (callback) which is called when the contents of the input box are&amp;nbsp;changed&lt;/li&gt;
&lt;li&gt;onClearSearch (callback) which is called when the button is&amp;nbsp;pressed&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Notice that this component doesn&amp;#8217;t do anything - for all actions it uses the callbacks passed to it &amp;#8212;this
means that exactly the same component would easily be reused in a totally different application or could
be duplicated if we wanted to have a different search component for the book title and&amp;nbsp;category.&lt;/p&gt;
&lt;p&gt;Another thing to notice is that the local &lt;tt class="docutils literal"&gt;onSearchChanged&lt;/tt&gt; method is defined only to help us retrieve the
value of the input and use it to call the &lt;tt class="docutils literal"&gt;onSearchChanged&lt;/tt&gt; callback. Instead, we could just call the
passed
&lt;tt class="docutils literal"&gt;this.props.onSearchChanged&lt;/tt&gt; &amp;#8212; however to do this we&amp;#8217;d need a way to find the value of the input. This
could be done if we added a ref to the included &lt;tt class="docutils literal"&gt;SearchPanel&lt;/tt&gt; from the parent component, so
we&amp;#8217;d be able to use something like
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;React.findDOMNode(this.refs.searchPanel.refs.search).value&lt;/span&gt;&lt;/tt&gt; to find out the value of the input
(see that we use a ref to go to the searchPanel component and another ref to go to input&amp;nbsp;component).&lt;/p&gt;
&lt;p&gt;Both versions (getting the value directly from the child component or using the callback) could be used, however I
believe that the callback version defines a more clear interface since the parent component shouldn&amp;#8217;t need
to know the implementation details of its&amp;nbsp;children.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="booktablerow"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;&lt;tt class="docutils literal"&gt;BookTableRow&lt;/tt&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;BookTableRow&lt;/tt&gt; will render a table row by creating a simple table row that will contain the &lt;tt class="docutils literal"&gt;title&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;category&lt;/tt&gt; attributes of the passed book property and an edit link that will call the &lt;tt class="docutils literal"&gt;handleEditClickPanel&lt;/tt&gt;
property by passing the id of that&amp;nbsp;book:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var BookTableRow = React.createClass({
  render: function() {
    return (
      &amp;lt;tr&amp;gt;
        &amp;lt;td&amp;gt;{this.props.book.title}&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;{this.props.book.category}&amp;lt;/td&amp;gt;
        &amp;lt;td&amp;gt;&amp;lt;a href='#' onClick={this.onClick}&amp;gt;Edit&amp;lt;/a&amp;gt;&amp;lt;/td&amp;gt;
      &amp;lt;/tr&amp;gt;
    );
  },
  onClick: function(id) {
    this.props.handleEditClickPanel(this.props.book.id);
  }
});
&lt;/pre&gt;
&lt;p&gt;This component is used by &lt;tt class="docutils literal"&gt;BookTable&lt;/tt&gt; to render each one of the&amp;nbsp;books.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="booktable"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;&lt;tt class="docutils literal"&gt;BookTable&lt;/tt&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This component create the left-side table using an array of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;BookTableRow``s&lt;/span&gt; by passing it each one of the
books of the ``books&lt;/tt&gt; array property. The &lt;tt class="docutils literal"&gt;handleEditClickPanel&lt;/tt&gt;
property is retrieved from the parent of the component and passed as is to the&amp;nbsp;row.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var BookTable = React.createClass({
  render: function() {
    var rows = [];
    this.props.books.forEach(function(book) {
      rows.push(&amp;lt;BookTableRow key={book.id} book={book} handleEditClickPanel={this.props.handleEditClickPanel}  /&amp;gt;);
    }.bind(this));
    return (
      &amp;lt;table&amp;gt;
        &amp;lt;thead&amp;gt;
          &amp;lt;tr&amp;gt;
            &amp;lt;th&amp;gt;Title&amp;lt;/th&amp;gt;
            &amp;lt;th&amp;gt;Category&amp;lt;/th&amp;gt;
            &amp;lt;th&amp;gt;Edit&amp;lt;/th&amp;gt;
          &amp;lt;/tr&amp;gt;
        &amp;lt;/thead&amp;gt;
        &amp;lt;tbody&amp;gt;{rows}&amp;lt;/tbody&amp;gt;
      &amp;lt;/table&amp;gt;
    );
  }
});
&lt;/pre&gt;
&lt;p&gt;The key attribute is used by React to uniquely identify each component - we are using the id (primary key)
of each book. Before continuing with the other components, I&amp;#8217;d like to explain what is the purpose of that
strange &lt;tt class="docutils literal"&gt;bind&lt;/tt&gt; call!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="interlude-the-bind-function-method"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;Interlude: The &lt;tt class="docutils literal"&gt;bind&lt;/tt&gt; function&amp;nbsp;method&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind"&gt;bind&lt;/a&gt; is a method of the function javascript object, since in javascript &lt;a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function"&gt;functions are objects&lt;/a&gt;! This
method is useful for a number of things, however here we use it to set the &lt;tt class="docutils literal"&gt;this&lt;/tt&gt; keyword of the
anonymous function that is passed to foreach to the &lt;tt class="docutils literal"&gt;this&lt;/tt&gt; keyword of the &lt;tt class="docutils literal"&gt;render&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;BookTable&lt;/tt&gt;,
which will be the current BookTable&amp;nbsp;instance.&lt;/p&gt;
&lt;p&gt;To make things crystal: Since we are using an anonymous function to pass to &lt;tt class="docutils literal"&gt;forEach&lt;/tt&gt;, this anonymous
function won&amp;#8217;t have a &lt;tt class="docutils literal"&gt;this&lt;/tt&gt; keyword set to the current &lt;tt class="docutils literal"&gt;BookTable&lt;/tt&gt; object so we will get an error
that &lt;tt class="docutils literal"&gt;this.props&lt;/tt&gt; is undefined. That&amp;#8217;s why we use bind to set &lt;tt class="docutils literal"&gt;this&lt;/tt&gt; to the current &lt;tt class="docutils literal"&gt;BookTable&lt;/tt&gt;. If
instead of using the anonymous function we had created a &lt;tt class="docutils literal"&gt;createBookTableRow&lt;/tt&gt; method inside the
&lt;tt class="docutils literal"&gt;BookTable&lt;/tt&gt; object that returned the &lt;tt class="docutils literal"&gt;BookTableRow&lt;/tt&gt; and passed &lt;tt class="docutils literal"&gt;this.createBookTableRow&lt;/tt&gt; to
&lt;tt class="docutils literal"&gt;forEach&lt;/tt&gt;, we wouldn&amp;#8217;t have to use bind (notice that we&amp;#8217;d also need to make rows a class attribute
and  refer to it through &lt;tt class="docutils literal"&gt;this.rows&lt;/tt&gt; for this to&amp;nbsp;work).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="bookform"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;&lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; will create a form to either create a new book or update/delete an existing one. It has a &lt;tt class="docutils literal"&gt;book&lt;/tt&gt; object
property - when this object has an &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; (so it is saved to the database) the update/delete/cancel buttons will be shown,
when it doesn&amp;#8217;t have an id the add button will be&amp;nbsp;shown.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var BookForm = React.createClass({
  render: function() {
    return(
      &amp;lt;form onSubmit={this.props.handleSubmitClick}&amp;gt;
        &amp;lt;label forHtml='title'&amp;gt;Title&amp;lt;/label&amp;gt;&amp;lt;input ref='title' name='title' type='text' value={this.props.book.title} onChange={this.onChange}/&amp;gt;
        &amp;lt;label forHtml='category'&amp;gt;Category&amp;lt;/label&amp;gt;
        &amp;lt;select ref='category' name='category' value={this.props.book.category} onChange={this.onChange} &amp;gt;
          &amp;lt;option value='CRIME' &amp;gt;Crime&amp;lt;/option&amp;gt;
          &amp;lt;option value='HISTORY'&amp;gt;History&amp;lt;/option&amp;gt;
          &amp;lt;option value='HORROR'&amp;gt;Horror&amp;lt;/option&amp;gt;
          &amp;lt;option value='SCIFI'&amp;gt;SciFi&amp;lt;/option&amp;gt;
        &amp;lt;/select&amp;gt;
        &amp;lt;br /&amp;gt;
        &amp;lt;input type='submit' value={this.props.book.id?&amp;quot;Save (id = &amp;quot; +this.props.book.id+ &amp;quot;)&amp;quot;:&amp;quot;Add&amp;quot;} /&amp;gt;
        {this.props.book.id?&amp;lt;button onClick={this.props.handleDeleteClick}&amp;gt;Delete&amp;lt;/button&amp;gt;:null}
        {this.props.book.id?&amp;lt;button onClick={this.props.handleCancelClick}&amp;gt;Cancel&amp;lt;/button&amp;gt;:null}
        {this.props.message?&amp;lt;div&amp;gt;{this.props.message}&amp;lt;/div&amp;gt;:null}
      &amp;lt;/form&amp;gt;
    );
  },
  onChange: function() {
    var title = React.findDOMNode(this.refs.title).value;
    var category = React.findDOMNode(this.refs.category).value;
    this.props.handleChange(title, category);
  }
});
&lt;/pre&gt;
&lt;p&gt;As we can see, this component uses many properties &amp;#8212; most are passed callbacks functions for various&amp;nbsp;actions:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;book&lt;/tt&gt;: This will either be a new book object (without and id) when adding one or an existing (from the database) book when updating&amp;nbsp;one.&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;message&lt;/tt&gt;: To display the result of the last operation (save/delete) &amp;#8212; this is passed by the parent and probably it would be better if I had put it in a different component (and added styling&amp;nbsp;etc).&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;handleSubmitClick&lt;/tt&gt;: Will be called when the submit button is pressed to save the form (either by adding or&amp;nbsp;updating).&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;handleCancelClick&lt;/tt&gt;: Will be called when the cancel button is pressed &amp;#8212; we decide that we want actually want to edit a&amp;nbsp;book.&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;handleDeleteClick&lt;/tt&gt;: Will be called when the delete button is&amp;nbsp;pressed.&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;handleChange&lt;/tt&gt;: Will be called whenever the title or the category of the currently edited book is changed through the local onChange method. The onChange will retrieve that values of title and category and pass them to handleChange to do the state update. As already discussed, we could retrieve the values immediately from the parent but this creates a better interface to our&amp;nbsp;component.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="bookpanel"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;&lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; component will contain all other components, will keep the global state
and will also act as a central communications &lt;span class="caps"&gt;HUB&lt;/span&gt; between the components and the server. Because
it is rather large class, I will explain it in three&amp;nbsp;parts:&lt;/p&gt;
&lt;div class="section" id="component-methods"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id11"&gt;Component&amp;nbsp;methods&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;In the first part of &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt;, its react component methods will be&amp;nbsp;presented:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var BookPanel = React.createClass({
  getInitialState: function() {
    return {
      books: [],
      editingBook: {
        title:&amp;quot;&amp;quot;,
        category:&amp;quot;&amp;quot;,
      },
      search:&amp;quot;&amp;quot;,
      message:&amp;quot;&amp;quot;
    };
  },
  render: function() {
    return(
      &amp;lt;div className=&amp;quot;row&amp;quot;&amp;gt;
        &amp;lt;div className=&amp;quot;one-half column&amp;quot;&amp;gt;
          &amp;lt;SearchPanel
            search={this.state.search}
            onSearchChanged={this.onSearchChanged}
            onClearSearch={this.onClearSearch}
          /&amp;gt;
          &amp;lt;BookTable books={this.state.books} handleEditClickPanel={this.handleEditClickPanel} /&amp;gt;
        &amp;lt;/div&amp;gt;
        &amp;lt;div className=&amp;quot;one-half column&amp;quot;&amp;gt;
          &amp;lt;BookForm
            book={this.state.editingBook}
            message={this.state.message}
            handleChange={this.handleChange}
            handleSubmitClick={this.handleSubmitClick}
            handleCancelClick={this.handleCancelClick}
            handleDeleteClick={this.handleDeleteClick}
          /&amp;gt;
        &amp;lt;/div&amp;gt;
      &amp;lt;/div&amp;gt;
    );
  },
  componentDidMount: function() {
    this.reloadBooks('');
  },
  // To be continued ...
&lt;/pre&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;getInitialState&lt;/tt&gt; is called the first time the component is created or mounted (attached to an &lt;span class="caps"&gt;HTML&lt;/span&gt; component in the page
and should return the initial values of the state - here we return an object with empty placeholders. &lt;tt class="docutils literal"&gt;componentDidMount&lt;/tt&gt;
will be called &lt;em&gt;after&lt;/em&gt; the component is mounted and that&amp;#8217;s the place we should do any initializationn &amp;#8212; here we call the
&lt;tt class="docutils literal"&gt;reloadBooks&lt;/tt&gt; method (with an empty search string) to just retrieve all books. Finally, the &lt;tt class="docutils literal"&gt;render&lt;/tt&gt; method creates a
&lt;tt class="docutils literal"&gt;div&lt;/tt&gt; that will contain all other components and initializes their properties with either state variables or object methods
(these are the callbacks that were used in all other&amp;nbsp;components).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="non-ajax-object-methods"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id12"&gt;Non-ajax object&amp;nbsp;methods&lt;/a&gt;&lt;/h4&gt;
&lt;pre class="code literal-block"&gt;
// Continuing from above
onSearchChanged: function(query) {
  if (this.promise) {
    clearInterval(this.promise)
  }
  this.setState({
    search: query
  });
  this.promise = setTimeout(function () {
    this.reloadBooks(query);
  }.bind(this), 200);
},
onClearSearch: function() {
  this.setState({
    search: ''
  });
  this.reloadBooks('');
},
handleEditClickPanel: function(id) {
  var book = $.extend({}, this.state.books.filter(function(x) {
    return x.id == id;
  })[0] );

  this.setState({
    editingBook: book,
    message: ''
  });
},
handleChange: function(title, category) {
  this.setState({
    editingBook: {
      title: title,
      category: category,
      id: this.state.editingBook.id
    }
  });
},
handleCancelClick: function(e) {
  e.preventDefault();
  this.setState({
    editingBook: {}
  });
},
// to be continued ...
&lt;/pre&gt;
&lt;p&gt;All the above function change the &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; state so that the properties of the child components will
also be&amp;nbsp;updated:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;onSearchChanged&lt;/tt&gt; is called when the search text is changed. The behavior here is interesting: Instead of immediately reloading the books, we create a timeout to be executed after 200 ms (also notice the usage of the &lt;tt class="docutils literal"&gt;bind&lt;/tt&gt; function method to allow us call the &lt;tt class="docutils literal"&gt;reloadBooks&lt;/tt&gt; method). If the user presses a key before these 200 ms, we cancel the previous timeout (using &lt;tt class="docutils literal"&gt;clearInterval&lt;/tt&gt;) and create a new one. This technique greatly reduces ajax calls to the server when the user is just typing something in the search box &amp;#8212; we could even increase the delay to reduce even more the ajax calls (but hurt the user experience a bit since the user will notice that his search results won&amp;#8217;t be updated&amp;nbsp;immediately).&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;onClearSearch&lt;/tt&gt; is called when the clear filter button is pressed and removes the search text and reloads all&amp;nbsp;books.&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;handleEditClickPanel&lt;/tt&gt; is called when the edit link of a &lt;tt class="docutils literal"&gt;BookTableRow&lt;/tt&gt; is clicked. The book with the passed &lt;tt class="docutils literal"&gt;id&lt;/tt&gt; will be found (using filter) and then a clone of it will be created with (&lt;tt class="docutils literal"&gt;$.extend&lt;/tt&gt;) and will be used to set the &lt;tt class="docutils literal"&gt;editingBook&lt;/tt&gt; state attribute. If instead of the clone we passed the filtered book object we&amp;#8217;d see that when the title or category in the &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; were changed they&amp;#8217;d also be changed in the &lt;tt class="docutils literal"&gt;BookTableRow&lt;/tt&gt;!&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;handleChange&lt;/tt&gt; just changes the state of the currently edited book based on the values passed (it does not modify the id of the&amp;nbsp;book)&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;handleCancelClick&lt;/tt&gt; when the cancel editing is pressed we clear the &lt;tt class="docutils literal"&gt;editingBook&lt;/tt&gt; state attribute. Notice the &lt;tt class="docutils literal"&gt;e.preventDefault()&lt;/tt&gt; method that needs to be there in order to prevent the form from submitting since the form submitting would result in an undesirable full page&amp;nbsp;reload!&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="ajax-object-methods"&gt;
&lt;h4&gt;&lt;a class="toc-backref" href="#id13"&gt;Ajax object&amp;nbsp;methods&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Finally, we need a buncch of object methods that use ajax calls to retrieve or update&amp;nbsp;books:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
  // Continuing from above
  reloadBooks: function(query) {
    $.ajax({
      url: this.props.url+'?search='+query,
      dataType: 'json',
      cache: false,
      success: function(data) {
        this.setState({
          books: data
        });
      }.bind(this),
      error: function(xhr, status, err) {
        console.error(this.props.url, status, err.toString());
        this.setState({
          message: err.toString(),
          search: query
        });
      }.bind(this)
    });
  },
  handleSubmitClick: function(e) {
    e.preventDefault();
    if(this.state.editingBook.id) {
      $.ajax({
        url: this.props.url+this.state.editingBook.id,
        dataType: 'json',
        method: 'PUT',
        data:this.state.editingBook,
        cache: false,
        success: function(data) {
          this.setState({
            message: &amp;quot;Successfully updated book!&amp;quot;
          });
          this.reloadBooks('');
        }.bind(this),
        error: function(xhr, status, err) {
          console.error(this.props.url, status, err.toString());
          this.setState({
            message: err.toString()
          });
        }.bind(this)
      });
    } else {
      $.ajax({
        url: this.props.url,
        dataType: 'json',
        method: 'POST',
        data:this.state.editingBook,
        cache: false,
        success: function(data) {
          this.setState({
            message: &amp;quot;Successfully added book!&amp;quot;
          });
          this.reloadBooks('');
        }.bind(this),
        error: function(xhr, status, err) {
          console.error(this.props.url, status, err.toString());
          this.setState({
            message: err.toString()
          });
        }.bind(this)
      });
    }
    this.setState({
      editingBook: {}
    });
  },
  handleDeleteClick: function(e) {
  e.preventDefault();
  $.ajax({
    url: this.props.url+this.state.editingBook.id,
    method: 'DELETE',
    cache: false,
    success: function(data) {
      this.setState({
          message: &amp;quot;Successfully deleted book!&amp;quot;,
          editingBook: {}
      });
      this.reloadBooks('');
    }.bind(this),
    error: function(xhr, status, err) {
      console.error(this.props.url, status, err.toString());
      this.setState({
          message: err.toString()
      });
    }.bind(this)
    });
  },
});
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;reloadBooks&lt;/tt&gt; will try to load the books using an ajax &lt;span class="caps"&gt;GET&lt;/span&gt; and pass its query parameter to filter the books (or get all books if query is an empty string). If the ajax call was successfull the state will be updated with the retrieved books and the search text (to clear the  search text when we reload because of a save/edit/delete) while if there was an error the state will be updated with the error message. The books will be returned as a json array of book&amp;nbsp;objects.&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;handleSubmitClick&lt;/tt&gt; checks if the state&amp;#8217;s &lt;tt class="docutils literal"&gt;editingBook&lt;/tt&gt; has an id and  will do either a &lt;span class="caps"&gt;POST&lt;/span&gt; to create a new book or a &lt;span class="caps"&gt;PUT&lt;/span&gt; to update the existing one. Depending on the result of the operation will either reload books and clear the editingBook or set the error&amp;nbsp;message.&lt;/li&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;handleDeleteClick&lt;/tt&gt; will do a &lt;span class="caps"&gt;DELETE&lt;/span&gt; to delete the state&amp;#8217;s &lt;tt class="docutils literal"&gt;editingBook&lt;/tt&gt; and clear&amp;nbsp;it.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Notice that all success and error functions above were binded to &lt;tt class="docutils literal"&gt;this&lt;/tt&gt; so that they could update the state of the current &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; object.&lt;/p&gt;
&lt;p&gt;After each succesfull ajax call we do a reload to the books to keep the state between server and client side consistent. We could
instead update the book array immediately before doing the ajax call - however this would increase complexity
(what should happen if an error happens at the ajax call) without improving the &lt;span class="caps"&gt;UX&lt;/span&gt; that much. A better solution
would be to add a loading css&amp;nbsp;animation.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="local-state"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id14"&gt;Local&amp;nbsp;state&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One thing to keep in mind is that there should only be one place of truth for the state and
that the state should be as high in the component hierarch as possible. All changes should
be propagated to thhe child components through properties.
That&amp;#8217;s the only way to be sure of the your data flow: When a change should happen
(either because of a user action or an asynchronous call e.g ajax or timeout) just
go to the state-holding component up in the hierarchy and change its state. Then the
changes will be propagated in a top-down fashion from that component to its&amp;nbsp;children.&lt;/p&gt;
&lt;p&gt;The above paragraph does not mean that the state should be contained in just a single
component! For example, let&amp;#8217;s say that we had an &lt;tt class="docutils literal"&gt;AuthorPanel&lt;/tt&gt; in the same web application
and both &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;AuthorPanel&lt;/tt&gt; would be contained in a &lt;tt class="docutils literal"&gt;BookAuthorPanel&lt;/tt&gt;.
In this case, we should keep a different state object for &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;AuthorPanel&lt;/tt&gt;,
we wouldn&amp;#8217;t need to combine them into a single object contained in the &lt;tt class="docutils literal"&gt;BookAuthorPanel&lt;/tt&gt;
since they are&amp;nbsp;unrelated!&lt;/p&gt;
&lt;p&gt;One decision that we took in &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; (and also to the &lt;tt class="docutils literal"&gt;SearchPanel&lt;/tt&gt; before) is to &lt;em&gt;not&lt;/em&gt; keep a local state for the
book that is edited but move it to &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt;. This means that whenever the value of the &lt;tt class="docutils literal"&gt;title&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;category&lt;/tt&gt; is changed the parent
component will be informed (through &lt;tt class="docutils literal"&gt;handleChange&lt;/tt&gt;) so that it will change its state and the new values will
be passed down to &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; as properties so our changes will be reflected to the inputs. To make it more
clear, when you press a letter on the &lt;tt class="docutils literal"&gt;title&lt;/tt&gt; input:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;the &lt;tt class="docutils literal"&gt;onChange&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; will be&amp;nbsp;called,&lt;/li&gt;
&lt;li&gt;it will get the values of both &lt;tt class="docutils literal"&gt;title&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;category&lt;/tt&gt; fields&lt;/li&gt;
&lt;li&gt;and call &lt;tt class="docutils literal"&gt;handleChange&lt;/tt&gt; with these&amp;nbsp;values.&lt;/li&gt;
&lt;li&gt;The &lt;tt class="docutils literal"&gt;handleChange&lt;/tt&gt; method of  &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; will update the &lt;tt class="docutils literal"&gt;editingBook&lt;/tt&gt; state&amp;nbsp;attribute,&lt;/li&gt;
&lt;li&gt;so the &lt;tt class="docutils literal"&gt;book&lt;/tt&gt; property of &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; will be also&amp;nbsp;updated&lt;/li&gt;
&lt;li&gt;and the new value of the &lt;tt class="docutils literal"&gt;title&lt;/tt&gt; will be displayed (since the components will be re-rendered due to the state&amp;nbsp;update)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Conceptually, the above seems like a lot of work for just pressing a simple key! However, due to how react
is implemented (virtual &lt;span class="caps"&gt;DOM&lt;/span&gt;) it won&amp;#8217;t actually introduce any performance problems in our application.
If nevertheless we wanted to have a local state of the currently edited book inside the &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; then we&amp;#8217;d need to use
&lt;tt class="docutils literal"&gt;state.book&lt;/tt&gt; and update the state using the &lt;tt class="docutils literal"&gt;componentWillReceiveProps&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;: If we
have a book to edit in the properties then copy it to the state or else just create an empty book. Also,
the &lt;tt class="docutils literal"&gt;onChange&lt;/tt&gt; method of the &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; won&amp;#8217;t need to notify the parent component that there is a
state change (but only update the local state) and of course when the submit button is pressed the
current book should be passed to the parent component (to either save it or delete it) since it won&amp;#8217;t
know the book that is currently&amp;nbsp;edited.&lt;/p&gt;
&lt;p&gt;So we could either have a local state object for the edited book in the &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; or
just save it as a property of the global state object in &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; &amp;#8212; both solutions are
correct. What wouldn&amp;#8217;t be correct is if we had two copies of the same information in both the
states of &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;, for example the book id that is&amp;nbsp;edited.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="adding-form-validation"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id15"&gt;Adding form&amp;nbsp;validation&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Commenter Nitish Kumar made a nice comment about how we could do some validating to our form&amp;nbsp;fields.&lt;/p&gt;
&lt;p&gt;First of all, this adds to the complexity of the application so maybe it would be better to do it in
the &lt;a class="reference external" href="https://spapas.github.io/2015/07/02/comprehensive-react-flux-tutorial-2/"&gt;flux-architectured version&lt;/a&gt;. However, it&amp;#8217;s not really difficult
to also have form validation using&amp;nbsp;react-only:&lt;/p&gt;
&lt;p&gt;Here&amp;#8217;s what we&amp;nbsp;need:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;A property (or properties) to pass the errors for each form field to the &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; component&lt;/li&gt;
&lt;li&gt;A way to display the form errors if they exist in &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Execute an error handler when the form contents change and update the state if there&amp;#8217;s an&amp;nbsp;error&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As an example, I&amp;#8217;d like to check that the book title is not written in uppercase, so I will add another
attribute to the &lt;tt class="docutils literal"&gt;book&lt;/tt&gt; propery of &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; called &lt;tt class="docutils literal"&gt;titleError&lt;/tt&gt; and display it if it is defined,
something like&amp;nbsp;this:&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;{this.props.book.titleError?&amp;lt;div&amp;gt;{this.props.book.titleError}&amp;lt;/div&amp;gt;:null}&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;Now, the &lt;tt class="docutils literal"&gt;handleChange&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; should do the actual check and change the sate, so I&amp;#8217;m
changing it like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
handleChange: function(title, category) {
    var titleError = undefined;
    if(title.length &amp;gt; 1 &amp;amp;&amp;amp; title === title.toUpperCase()) {
        titleError='Please don\'t use only capital letters for book titles';
    }
    this.setState({
        editingBook: {
            title: title,
            titleError: titleError,
            category: category,
            id: this.state.editingBook.id
        }
    });
},
&lt;/pre&gt;
&lt;p&gt;So, the titleError attribute of editingBook will be defined only if there&amp;#8217;s an&amp;nbsp;error.&lt;/p&gt;
&lt;p&gt;Finally, we must remember to &lt;em&gt;not&lt;/em&gt; create/update the book if there&amp;#8217;s an error so
we add the following check to the &lt;tt class="docutils literal"&gt;handleSubmitClick&lt;/tt&gt; method:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
if(this.state.editingBook.titleError) {
    this.setState({
        message: &amp;quot;Please fix errors!&amp;quot;
    });
    return ;
}
&lt;/pre&gt;
&lt;p&gt;The above could be easily generalized for checks on multiple fields. I am not really fond
of doing the form validation in the &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt; component (I&amp;#8217;d prefer to do it on &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt;
or even better on the corresponding field - if it was a component) however this would mean that
I&amp;#8217;d need to keep a local state with the error to the &lt;tt class="docutils literal"&gt;BookForm&lt;/tt&gt; (please see the discussion of
the previous&amp;nbsp;paragraph).&lt;/p&gt;
&lt;p&gt;I&amp;#8217;ve added a new tag named &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;react-only-validation&lt;/span&gt;&lt;/tt&gt; to the &lt;a class="reference external" href="https://github.com/spapas/react-tutorial/"&gt;https://github.com/spapas/react-tutorial/&lt;/a&gt;
repository that contains the changes to have the&amp;nbsp;validation.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion-to-the-first-part"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id16"&gt;Conclusion to the first&amp;nbsp;part&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We just created a not-so-simple React single page application offering &lt;span class="caps"&gt;CRUD&lt;/span&gt; for an object.
This application of course could be improved by adding a pagination component to the table,
but I&amp;#8217;m going to leave that as an excersie to the reader: To do that, I propose to create
another component named &lt;tt class="docutils literal"&gt;TablePager&lt;/tt&gt; that would have two properties: &lt;tt class="docutils literal"&gt;currentPage&lt;/tt&gt; and
a &lt;tt class="docutils literal"&gt;changePageTo&lt;/tt&gt; callback. The &lt;tt class="docutils literal"&gt;currentPage&lt;/tt&gt; would also be needed to added to the global
state. When the &lt;tt class="docutils literal"&gt;changePageTo` is called by the ``TablePager&lt;/tt&gt; it would update the global
&lt;tt class="docutils literal"&gt;currentPage&lt;/tt&gt; and will do a &lt;tt class="docutils literal"&gt;reloadBooks&lt;/tt&gt; that will use the &lt;tt class="docutils literal"&gt;currentPage&lt;/tt&gt; to fetch
the correct&amp;nbsp;page.&lt;/p&gt;
&lt;p&gt;For application state keeping, we have selected to store all state attributes in &lt;tt class="docutils literal"&gt;BookPanel&lt;/tt&gt;,
for every state changing action we create a method that we pass in the child components
so that the children can call it when the state needs to be&amp;nbsp;updated.&lt;/p&gt;
&lt;p&gt;As we will see &lt;a class="reference external" href="https://spapas.github.io/2015/07/02/comprehensive-react-flux-tutorial-2/"&gt;in the next part&lt;/a&gt;, with Flux, Facebook proposes a design pattern for
where to store the state and how to update it. We&amp;#8217;ll see how to convert our React
application to also use Flux and find out how Flux will help us when developing
complex client-side&amp;nbsp;applications!&lt;/p&gt;
&lt;/div&gt;
</content><category term="javascript"></category><category term="javascript"></category><category term="python"></category><category term="django"></category><category term="react"></category><category term="flux"></category></entry><entry><title>Using browserify and watchify to improve your client-side-javascriptÂ workflow</title><link href="https://spapas.github.io/2015/05/27/using-browserify-watchify/" rel="alternate"></link><published>2015-05-27T14:20:00+03:00</published><updated>2015-05-27T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-05-27:/2015/05/27/using-browserify-watchify/</id><summary type="html">&lt;p class="first last"&gt;Using browserify and watchify you can greatly improve the workflow of your client-side&amp;nbsp;javascript.&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-problem" id="id1"&gt;The&amp;nbsp;problem&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-solution" id="id2"&gt;The&amp;nbsp;solution&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#installing-required-tools" id="id3"&gt;Installing required&amp;nbsp;tools&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#starting-your-node-js-project" id="id4"&gt;Starting your (node.js)&amp;nbsp;project&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#running-browserify-for-the-first-time" id="id5"&gt;Running browserify for the first&amp;nbsp;time&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-external-libraries" id="id6"&gt;Using external&amp;nbsp;libraries&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introducing-watchify" id="id7"&gt;Introducing&amp;nbsp;watchify&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#creating-your-own-modules" id="id8"&gt;Creating your own&amp;nbsp;modules&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#uglifying-your-bundle" id="id9"&gt;Uglifying your&amp;nbsp;bundle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#the-client-side-javascript-workflow" id="id10"&gt;The client-side javascript&amp;nbsp;workflow&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conlusion" id="id11"&gt;Conlusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="the-problem"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;The&amp;nbsp;problem&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Once upon a time, when people started using client-side code to their projects they (mainly
due to the lack of decent client-side libraries but also because of the &lt;a class="reference external" href="http://en.wikipedia.org/wiki/Not_invented_here"&gt;&lt;span class="caps"&gt;NIH&lt;/span&gt; syndrome&lt;/a&gt;)
were just adding their own code in script nodes or .js files using &lt;tt class="docutils literal"&gt;document.getElementById&lt;/tt&gt; to manipulate
the &lt;span class="caps"&gt;DOM&lt;/span&gt; (good luck checking for all possible browser-edge cases)
and &lt;tt class="docutils literal"&gt;window.XMLHttpRequest&lt;/tt&gt; to try doing &lt;span class="caps"&gt;AJAX&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;After these dark-times, the
age of javascript-framework came: prototype, jquery, dojo. These were (and still are)
some great libraries (even &lt;span class="caps"&gt;NIH&lt;/span&gt;-sick people used them to handle browser incompatibilities):
You just downloaded the .js file with the framework, put it inside your project
static files and added it to your page with a script tag and then filled your client-side
code with funny $(&amp;#8216;#id&amp;#8217;)&amp;nbsp;symbols!&lt;/p&gt;
&lt;p&gt;Coming to the modern age in client-side development, the number of decent libraries has greatly increased
and instead of monolithic frameworks there are different libraries for different needs. So instead of
just downloading a single file and adding the script node for that file to your &lt;span class="caps"&gt;HTML&lt;/span&gt;, you need to
download the required javascript files, put them all in your static files directory and then micro-manage
the script nodes for each of your pages depending on which libraries each page needs! So if you want
to use (for example) moment.js to your client-side code you need to go to &lt;em&gt;all&lt;/em&gt; &lt;span class="caps"&gt;HTML&lt;/span&gt; pages that use that
specific client-side code and add a moment.js-script&amp;nbsp;element!&lt;/p&gt;
&lt;p&gt;As can be understood this leads to really ugly situations like people avoiding refactoring their code to use
external libraries, using a single-global module  with all their client side code, using &lt;span class="caps"&gt;CDN&lt;/span&gt; to avoid
downloading the javascript libraries and of course never upgrade their javascript&amp;nbsp;libraries!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-solution"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;The&amp;nbsp;solution&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://browserify.org/"&gt;browserify&lt;/a&gt; and &lt;a class="reference external" href="https://github.com/substack/watchify"&gt;watchify&lt;/a&gt; are two sister tools from the server-side-javascript (node.js and friends)
world that greatly improve your javascript workflow: Using them, you no longer need to micro-manage
your script tags but instead you just declare the libraries each of your client-side modules is
using - or you can even create your own reusable modules! Also, installing (or updating) javascript
libraries is as easy as running a single&amp;nbsp;command!&lt;/p&gt;
&lt;p&gt;How are they working? With browserify you create a single &lt;tt class="docutils literal"&gt;main.js&lt;/tt&gt; for each of your &lt;span class="caps"&gt;HTML&lt;/span&gt;
pages and in it you declare its requirements using &lt;a class="reference external" href="https://github.com/substack/browserify-handbook#require"&gt;require&lt;/a&gt;. You&amp;#8217;ll then pass your &lt;tt class="docutils literal"&gt;main.js&lt;/tt&gt;
through browserify and it will create a single file (e.g &lt;tt class="docutils literal"&gt;bundle.js&lt;/tt&gt;) that contains all the requirements
(of course each requirement could have other requirements - they&amp;#8217;ll be automatically also
included in the resulting .js file). That&amp;#8217;s the &lt;em&gt;only&lt;/em&gt; file you need to put to the script tag of
your &lt;span class="caps"&gt;HTML&lt;/span&gt;! Using watchify, you can &lt;em&gt;watch&lt;/em&gt; your &lt;tt class="docutils literal"&gt;main.js&lt;/tt&gt; for changes (the changes may also
be in the files included from main.js) and automatically generate the resulting &lt;tt class="docutils literal"&gt;bundle.js&lt;/tt&gt; so that
you&amp;#8217;ll just need to hit F5 to refresh and get the new&amp;nbsp;version!&lt;/p&gt;
&lt;p&gt;browserify not only concatenates your javascript libraries to a single bundle but can also transform
your coffesscript, typescript, jsx etc files to javascrpt and &lt;em&gt;then&lt;/em&gt; also add them to the bundle. This
is possible through a concept called transforms &amp;#8212; there are &lt;a class="reference external" href="https://github.com/substack/node-browserify/wiki/list-of-transforms"&gt;a lot of transforms&lt;/a&gt; that you can&amp;nbsp;use.&lt;/p&gt;
&lt;p&gt;Below, I will propose a really simple and generic workflow that should cover most of your javascript needs.
I should mention that I mainly develop django apps and my development machine is running windows, however you
can easily use exactly the  same workflow from any kind of server-side technology (ruby, python, javascript,
java, php or even static &lt;span class="caps"&gt;HTML&lt;/span&gt; pages!) or development machine (windows, linux, osx) - it&amp;#8217;s exactly the&amp;nbsp;same!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="installing-required-tools"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Installing required&amp;nbsp;tools&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As already mentioned, you need two node.js tools. Just install them globally using npm (installing
node.js and npm is really easy - there&amp;#8217;s even &lt;a class="reference external" href="https://nodejs.org/download/"&gt;a package for windows&lt;/a&gt;):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
npm install -g browserify watchify
&lt;/pre&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-g&lt;/span&gt;&lt;/tt&gt; switch installs the packages globally so you can use the browserify and watchify commands from
your command prompt - after that entering &lt;tt class="docutils literal"&gt;browserify&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;watchify&lt;/tt&gt; from your command prompt should be&amp;nbsp;working.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="starting-your-node-js-project"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Starting your (node.js)&amp;nbsp;project&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Although you may already have a project structure, in order to use browserify you&amp;#8217;ll need to
create a node.js project (project from now on) that needs just two&amp;nbsp;things:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;a &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; that lists various options for your&amp;nbsp;project&lt;/li&gt;
&lt;li&gt;a &lt;tt class="docutils literal"&gt;node_modules&lt;/tt&gt; directory that contains the packages that your project&amp;nbsp;uses&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To create the &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; you can either copy paste a simple one or run &lt;tt class="docutils literal"&gt;npm init&lt;/tt&gt; inside
a folder of your project. After &lt;tt class="docutils literal"&gt;npm init&lt;/tt&gt; you&amp;#8217;ll need to answer a bunch of questions and then
a &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; will be created to the same folder. If you don&amp;#8217;t want to answer these questions
(most probably you only want to use node.js for browserify - instead you wouldn&amp;#8217;t be reading
this) then just put an empty json string &lt;tt class="docutils literal"&gt;{}&lt;/tt&gt; in &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;I recommend adding &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; to the top-level folder of your version-controlled souce-code tree -
please put this file in your version control - the &lt;tt class="docutils literal"&gt;node_modules&lt;/tt&gt; directory will be be created
to the same directory with &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; and should be ignored by your version&amp;nbsp;control.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="running-browserify-for-the-first-time"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Running browserify for the first&amp;nbsp;time&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Not the time has come to create a &lt;tt class="docutils literal"&gt;main.js&lt;/tt&gt; file. This could be put anywhere you like (based on your project structure) -
I&amp;#8221; suppose that &lt;tt class="docutils literal"&gt;main.js&lt;/tt&gt; is inside the &lt;tt class="docutils literal"&gt;src/&lt;/tt&gt;  folder of your project.
Just put a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;console.log(&amp;quot;Hello,&lt;/span&gt; world&amp;quot;)&lt;/tt&gt; to the &lt;tt class="docutils literal"&gt;main.js&lt;/tt&gt; for now. To test that everything is working,&amp;nbsp;run:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
browserify src/main.js
&lt;/pre&gt;
&lt;p&gt;You should see some minified-js gibberish to your console (something like &lt;tt class="docutils literal"&gt;(function &lt;span class="pre"&gt;e(t,n,r){function&lt;/span&gt; &lt;span class="pre"&gt;s(o,u){if(!n[o]){if(!t[o]){var&lt;/span&gt; a=typeof &lt;span class="pre"&gt;...)&lt;/span&gt;&lt;/tt&gt;
) which means that everything works fine. Now, create a &lt;tt class="docutils literal"&gt;dist&lt;/tt&gt; directory which would contain your bundle files and&amp;nbsp;run&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
browserify src/main.js -o dist/bundle.js
&lt;/pre&gt;
&lt;p&gt;the -o switch will put the the same minified-js gibberish output to the  &lt;tt class="docutils literal"&gt;dist/bundle.js&lt;/tt&gt; file instead of stdout.
Finally, include a script element with that file to your &lt;span class="caps"&gt;HTML&lt;/span&gt; and you
should see &amp;#8220;Hello, world&amp;#8221; to your javascript console when opening the &lt;span class="caps"&gt;HTML&lt;/span&gt;&amp;nbsp;file!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="using-external-libraries"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Using external&amp;nbsp;libraries&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To use a library from your main.js you need to install it and get a reference to it through require. Let&amp;#8217;s try to use &lt;a class="reference external" href="http://momentjs.com/"&gt;moment.js&lt;/a&gt;:
To install the library&amp;nbsp;run&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
npm install moment --save
&lt;/pre&gt;
&lt;p&gt;This will create a moment directory inside node_modules that will contain the moment.js library. It will also add a
dependency to your &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; (that&amp;#8217;s what the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;--save&lt;/span&gt;&lt;/tt&gt; switch does), something like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;quot;dependencies&amp;quot;: {
  &amp;quot;moment&amp;quot;: &amp;quot;^2.10.3&amp;quot;
}
&lt;/pre&gt;
&lt;p&gt;Whenever you install more client-side libraries they&amp;#8217;ll be saved there. When you want to re-install everything (for instance
when you clone your project) you can just do&amp;nbsp;a&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
npm install
&lt;/pre&gt;
&lt;p&gt;and all dependencies of &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; will be installed in &lt;tt class="docutils literal"&gt;node_modules&lt;/tt&gt; (that&amp;#8217;s why &lt;tt class="docutils literal"&gt;node_modules&lt;/tt&gt; should not be&amp;nbsp;tracked).&lt;/p&gt;
&lt;p&gt;After you&amp;#8217;ve installed moment.js to your project change &lt;tt class="docutils literal"&gt;src/main.js&lt;/tt&gt; to:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
moment = require('moment')
console.log(moment() );
&lt;/pre&gt;
&lt;p&gt;and rerun &lt;tt class="docutils literal"&gt;browserify src/main.js &lt;span class="pre"&gt;-o&lt;/span&gt; dist/bundle.js&lt;/tt&gt;. When you reload your &lt;span class="caps"&gt;HTML&lt;/span&gt; you&amp;#8217;ll see the that you are able to use
moment - all this without changing your &lt;span class="caps"&gt;HTML&lt;/span&gt;!!!&lt;/p&gt;
&lt;p&gt;As you can understand, in order to use a library with browserify, this library must support it by having an npm package. The nice thing is that
most libraries already support it &amp;#8212; let&amp;#8217;s try for another example to use &lt;a class="reference external" href="http://underscorejs.org/"&gt;underscore.js&lt;/a&gt; and (for some reason) we need version underscore 1.7&amp;nbsp;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
npm install underscore&amp;#64;1.7--save
&lt;/pre&gt;
&lt;p&gt;you&amp;#8217;ll se that your package.json dependencies will also contain underscore.js&amp;nbsp;1.7:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
{
  &amp;quot;dependencies&amp;quot;: {
    &amp;quot;moment&amp;quot;: &amp;quot;^2.10.3&amp;quot;,
    &amp;quot;underscore&amp;quot;: &amp;quot;^1.7.0&amp;quot;
  }
}
&lt;/pre&gt;
&lt;p&gt;If you want to upgrade underscore to the latest version run&amp;nbsp;a:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
npm install underscore --upgrade --save
&lt;/pre&gt;
&lt;p&gt;and you&amp;#8217;ll see that your &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt; will contan the latest version of&amp;nbsp;underscore.js.&lt;/p&gt;
&lt;p&gt;Finally, let&amp;#8217;s change our &lt;tt class="docutils literal"&gt;src/man.js&lt;/tt&gt; to use&amp;nbsp;underscore:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
moment = require('moment')
_ = require('underscore')

_([1,2,3]).map(function(x) {
  console.log(x+1);
});
&lt;/pre&gt;
&lt;p&gt;After you create your bundle you should se 2 3 4 in your&amp;nbsp;console!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="introducing-watchify"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;Introducing&amp;nbsp;watchify&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Running browserify &lt;em&gt;every&lt;/em&gt; time you change your js files to create the &lt;tt class="docutils literal"&gt;bundle.js&lt;/tt&gt; feels
like doing repetitive work - this is where wachify comes to the rescue; watchify is a
tool that watches your source code and dependencies and when a change is detected it will
recreate the bundle&amp;nbsp;automagically!&lt;/p&gt;
&lt;p&gt;To run it, you can&amp;nbsp;use:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
watchify src/main.js -o dist/bundle.js -v
&lt;/pre&gt;
&lt;p&gt;and you&amp;#8217;ll see something like: &lt;tt class="docutils literal"&gt;155544 bytes written to dist/bundle.js (0.57 seconds)&lt;/tt&gt; &amp;#8212; try
changing main.js and you&amp;#8217;ll see that bundle.js will also be&amp;nbsp;re-written!&lt;/p&gt;
&lt;p&gt;Some things to keep in mind with watchify&amp;nbsp;usage:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;The -v flag outputs the verbose text (or else you won&amp;#8217;t se any postive messages) - I like using it to be sure that everything is&amp;nbsp;ok.&lt;/li&gt;
&lt;li&gt;You need to use the -o flag with watchify &amp;#8212; you can&amp;#8217;t output to stdout(we&amp;#8217;ll see that this will change our workflow for production a bit&amp;nbsp;later)&lt;/li&gt;
&lt;li&gt;watchify takes the same parameters with browserify &amp;#8212; so if you do any transformations with browserify you can also do them with&amp;nbsp;watchify&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In the following, I&amp;#8217;ll assume that you are running the &lt;tt class="docutils literal"&gt;watchify src/main.js &lt;span class="pre"&gt;-o&lt;/span&gt; dist/bundle.js &lt;span class="pre"&gt;-d&lt;/span&gt;&lt;/tt&gt; so your bundles will
always be re-created when changes are&amp;nbsp;found.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="creating-your-own-modules"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;Creating your own&amp;nbsp;modules&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using browserify we can create our own modules and &lt;em&gt;require&lt;/em&gt; them in other modules using the &lt;tt class="docutils literal"&gt;module.exports&lt;/tt&gt; mechanism!&lt;/p&gt;
&lt;p&gt;Creating a module is really simple: In a normal javascript file either assign directly to module.exports or
include all local objects you want to be visible as an attribute to &lt;tt class="docutils literal"&gt;module.exports&lt;/tt&gt; &amp;#8212; everything
else will be private to the&amp;nbsp;module.&lt;/p&gt;
&lt;p&gt;As an example, let&amp;#8217;s create an &lt;tt class="docutils literal"&gt;src/modules&lt;/tt&gt; folder and put a file module1.js inside it, containing the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var variable = 'variable'
var variable2 = 'variable2'
var funct = function(x) {
  return x+1;
}
var funct2 = function(x) {
  return x+1;
}

module.exports['variable'] = variable
module.exports['funct'] = funct
&lt;/pre&gt;
&lt;p&gt;As you see, although we&amp;#8217;ve defined a number of things in that module, only the variable and funct attributes
of module.exports will be visible when the module is used. To use the module, change main.js like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
module1 = require('./modules/module1')
console.log(module1.funct(9))
&lt;/pre&gt;
&lt;p&gt;When you refresh your &lt;span class="caps"&gt;HTML&lt;/span&gt; you&amp;#8217;ll see 10 in the console. So, require will return the &lt;tt class="docutils literal"&gt;module.exports&lt;/tt&gt; objects
of each module. It will either search in your project&amp;#8217;s &lt;tt class="docutils literal"&gt;node_modules&lt;/tt&gt; (when you use just the modfule name,
for example &lt;tt class="docutils literal"&gt;moment&lt;/tt&gt;, or locally (when you start a path with either &lt;tt class="docutils literal"&gt;./&lt;/tt&gt; or &lt;tt class="docutils literal"&gt;../&lt;/tt&gt; &amp;#8212; in our case we required
the module &lt;tt class="docutils literal"&gt;module1.js&lt;/tt&gt; from the folder &lt;tt class="docutils literal"&gt;modules&lt;/tt&gt;).&lt;/p&gt;
&lt;p&gt;As a final example, we&amp;#8217;ll create another module that is used by module1: Create a file named &lt;tt class="docutils literal"&gt;module2.js&lt;/tt&gt; inside the
&lt;tt class="docutils literal"&gt;modules&lt;/tt&gt; folder and the following&amp;nbsp;contents:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
var funct = function(x) {
    return x+1;
}

module.exports = funct
&lt;/pre&gt;
&lt;p&gt;After that, change &lt;tt class="docutils literal"&gt;module1.js&lt;/tt&gt; to&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
module2 = require('./module2')

var variable = 'variable'
var funct = function(x) {
    return module2(x)+1;
}

module.exports['variable'] = variable
module.exports['funct'] = funct
&lt;/pre&gt;
&lt;p&gt;So &lt;tt class="docutils literal"&gt;module1&lt;/tt&gt; will import the &lt;tt class="docutils literal"&gt;module2&lt;/tt&gt; module (from the same directory) and call it (since a function is assignedd to module.exports).
When you refresh your &lt;span class="caps"&gt;HTML&lt;/span&gt; you should see&amp;nbsp;11!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="uglifying-your-bundle"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;Uglifying your&amp;nbsp;bundle&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;If had taken a look at the file size of your &lt;tt class="docutils literal"&gt;bundle.js&lt;/tt&gt; when you&amp;#8217;d included moment.js or underscore.js you&amp;#8217;d see
that the file size has been greatly increased. Take a peek at &lt;tt class="docutils literal"&gt;bundle.js&lt;/tt&gt; and you&amp;#8217;ll see why: The contents of the module files
will be concatenated as they are, without any changes! This may be nice for development / debugging, however for production
we&amp;#8217;d like our bundle.js to be minified &amp;#8212; or uglyfied as it&amp;#8217;s being said in the javascript&amp;nbsp;world.&lt;/p&gt;
&lt;p&gt;To help us with this, uglifying we&amp;#8217;ll use &lt;a class="reference external" href="https://www.npmjs.com/package/uglify-js"&gt;uglify-js&lt;/a&gt;. First of all, please install it&amp;nbsp;globally&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
npm install uglify-js -g
&lt;/pre&gt;
&lt;p&gt;and you&amp;#8217;ll be able to use the &lt;tt class="docutils literal"&gt;uglifyjs&lt;/tt&gt; command to uglify your bundles! To use the &lt;tt class="docutils literal"&gt;uglifyjs&lt;/tt&gt; command for your &lt;tt class="docutils literal"&gt;bundle.js&lt;/tt&gt;
try&amp;nbsp;this&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
uglifyjs dist\bundle.js  &amp;gt; dist\bundle.min.js
&lt;/pre&gt;
&lt;p&gt;and you&amp;#8217;ll see the size of the bundle.min.js greatly reduced! To achieve even better minification (and code mangling as an added
bonus) you could pass the -mc options to&amp;nbsp;uglify:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
uglifyjs dist\bundle.js -mc &amp;gt; dist\bundle.min.js
&lt;/pre&gt;
&lt;p&gt;and you&amp;#8217;ll see an even smaller&amp;nbsp;bundle.min.js!&lt;/p&gt;
&lt;p&gt;As a final step, we can combine the output of browserify and uglify to a single command using a&amp;nbsp;pipe:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
browserify src/main.js | uglifyjs -mc &amp;gt; dist/bundle.js
&lt;/pre&gt;
&lt;p&gt;this will create the uglified bundle.js! Using the pipe to output to uglifyjs is not possible
with watchify since watchify cannot output to stdout &amp;#8212; however, as we&amp;#8217;ll see in the next section
this is not a real&amp;nbsp;problem.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-client-side-javascript-workflow"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;The client-side javascript&amp;nbsp;workflow&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The proposed client-side javascript workflow uses two commands, one for the development and one
for creating the production&amp;nbsp;bundle.&lt;/p&gt;
&lt;p&gt;For the development, we&amp;#8217;ll use watchify since we need to immediately re-create the bundle when a
javascript source file is changed and we don&amp;#8217;t want any&amp;nbsp;uglification:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
watchify src/main.js -o dist/bundle.js -v
&lt;/pre&gt;
&lt;p&gt;For creating our production bundle, we&amp;#8217;ll use browserify and&amp;nbsp;uglify:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
browserify src/main.js  | uglifyjs -mc warnings=false &amp;gt; dist/bundle.js
&lt;/pre&gt;
&lt;p&gt;(i&amp;#8217;ve added warnings=false to uglfiyjs to suppress&amp;nbsp;warnings).&lt;/p&gt;
&lt;p&gt;The above two commands can either be put to batch files or added to your existing workflow (for example
as &lt;a class="reference external" href="http://www.fabfile.org/"&gt;fabric&lt;/a&gt; commands if you use fabric). However, since we already have a javascrpt project (i.e a &lt;tt class="docutils literal"&gt;package.json&lt;/tt&gt;)
we can use that to run these commands. Just add a &lt;tt class="docutils literal"&gt;scripts&lt;/tt&gt; section to your package.json like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
{
  &amp;quot;dependencies&amp;quot;: {
    &amp;quot;moment&amp;quot;: &amp;quot;^2.10.3&amp;quot;,
    &amp;quot;underscore&amp;quot;: &amp;quot;^1.8.3&amp;quot;
  },
  &amp;quot;scripts&amp;quot;: {
    &amp;quot;watch&amp;quot;: &amp;quot;watchify src/main.js -o dist/bundle.js -v&amp;quot;,
    &amp;quot;build&amp;quot;: &amp;quot;browserify src/main.js  | uglifyjs -mc warnings=false &amp;gt; dist/bundle.js&amp;quot;
  }
}
&lt;/pre&gt;
&lt;p&gt;and you&amp;#8217;ll be able to run &lt;tt class="docutils literal"&gt;npm run watch&lt;/tt&gt; to start watchifying for changes and &lt;tt class="docutils literal"&gt;npm run build&lt;/tt&gt; to
create your production&amp;nbsp;bundle!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conlusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;Conlusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the above we saw two (three if we include uglifyjs) javascript tools that will greatly improve our
javascript workflow. Using these we can easily &lt;em&gt;require&lt;/em&gt; (import) external javascript libraries to
our project without any micromanagement of script tags in html files. We also can seperate our own
client-side code to self-contained modules that will only export interfaces and not pollute the global
namespace. The resulting production client-side javascript file will be output minimized and ready to
be used by the users&amp;#8217;&amp;nbsp;browsers.&lt;/p&gt;
&lt;p&gt;All the above are possible with minimal changes to our code and development&amp;nbsp;workflow:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;create a package.json and install your&amp;nbsp;dependencies&lt;/li&gt;
&lt;li&gt;require the external libraries (instead of using them off the global&amp;nbsp;namespace)&lt;/li&gt;
&lt;li&gt;define your module&amp;#8217;s interace through module.exports (instead of polluting the global&amp;nbsp;namespace)&lt;/li&gt;
&lt;li&gt;change your client javascript files to &lt;tt class="docutils literal"&gt;bundle.js&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;run &lt;tt class="docutils literal"&gt;npm run watch&lt;/tt&gt; when developing and &lt;tt class="docutils literal"&gt;npm run build&lt;/tt&gt; before&amp;nbsp;deploying&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</content><category term="javascript"></category><category term="javascript"></category><category term="browserify"></category><category term="node"></category><category term="npm"></category><category term="watchify"></category><category term="generic"></category><category term="uglify"></category></entry><entry><title>Show 404 page on django when DEBUG=True</title><link href="https://spapas.github.io/2015/04/29/django-show-404-page/" rel="alternate"></link><published>2015-04-29T10:20:00+03:00</published><updated>2015-04-29T10:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-04-29:/2015/04/29/django-show-404-page/</id><summary type="html">&lt;p class="first last"&gt;How to display the 404 error page on django when &lt;span class="caps"&gt;DEBUG&lt;/span&gt;=True&lt;/p&gt;
</summary><content type="html">&lt;p&gt;The default 404 error page on django can be &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.8/topics/http/views/#the-http404-exception"&gt;easily overriden&lt;/a&gt; by adding
a template named &lt;tt class="docutils literal"&gt;404.html&lt;/tt&gt; to the top level directory of your templates.
However, on your development environment you&amp;#8217;ll never be able to see this
template because when &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;DEBUG&lt;/span&gt;=True&lt;/tt&gt; django will render the debug not found
page to help you debug your url&amp;nbsp;configuration.&lt;/p&gt;
&lt;p&gt;If you want to display that page in your development environment you can always
change the &lt;span class="caps"&gt;DEBUG&lt;/span&gt; setting to False, however there&amp;#8217;s a better way: Add a url
pattern for django&amp;#8217;s default 404 view - just  add the following to your &lt;tt class="docutils literal"&gt;urls.py&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;django.views.defaults&lt;/span&gt;

&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="c1"&gt;# Other url patterns ...&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^404/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;django&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;defaults&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;page_not_found&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You&amp;#8217;ll then be able to see your 404 page by visiting the defined &lt;span class="caps"&gt;URL&lt;/span&gt;!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Upgrade for newer Django&amp;nbsp;versions&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;I&amp;#8217;ve recently found out that for newer Django versions the &lt;tt class="docutils literal"&gt;page_not_found&lt;/tt&gt; view needs a second
parameter (beyond &lt;tt class="docutils literal"&gt;request&lt;/tt&gt;) named &lt;tt class="docutils literal"&gt;exception&lt;/tt&gt; (&lt;a class="reference external" href="https://docs.djangoproject.com/el/2.1/ref/views/#django.views.defaults.page_not_found"&gt;see here&lt;/a&gt;). Thus
if you just add the view to your urls as I propose you&amp;#8217;ll get an exception. To fix it, you can do something&amp;nbsp;like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;django&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;custom_page_not_found&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;django&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;defaults&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;page_not_found&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;404/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;custom_page_not_found&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This creates a simple view that calls the builtin &lt;tt class="docutils literal"&gt;page_not_found&lt;/tt&gt; passing it &lt;tt class="docutils literal"&gt;None&lt;/tt&gt; as the &lt;tt class="docutils literal"&gt;exception&lt;/tt&gt; parameter.&lt;/p&gt;
</content><category term="django"></category><category term="django"></category><category term="debug"></category><category term="404"></category><category term="error"></category><category term="python"></category></entry><entry><title>Calling the REST API of Pusher fromÂ python</title><link href="https://spapas.github.io/2015/02/06/python-pusher-rest/" rel="alternate"></link><published>2015-02-06T12:20:00+02:00</published><updated>2015-02-06T12:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-02-06:/2015/02/06/python-pusher-rest/</id><summary type="html">&lt;p class="first last"&gt;How to call the &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; of Pusher from&amp;nbsp;python&lt;/p&gt;
</summary><content type="html">&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://pusher.com/"&gt;Pusher&lt;/a&gt; is one of the best real time frameworks right now. Using it you can add real time
events in your projects without the need to configure and use &lt;span class="caps"&gt;HTTP&lt;/span&gt; servers that support
real-time events in your environment. I used it recently in a project and it worked really
good, having a very simple &lt;span class="caps"&gt;API&lt;/span&gt; and a nice interface for debugging your&amp;nbsp;requests.&lt;/p&gt;
&lt;p&gt;The only problem I&amp;#8217;ve found was that the &lt;a class="reference external" href="https://github.com/pusher/pusher_client_python"&gt;Pusher python &lt;span class="caps"&gt;API&lt;/span&gt;&lt;/a&gt; misses some features that
the APIs for other languages have, specifically finding out the users on a presence&amp;nbsp;channel.&lt;/p&gt;
&lt;p&gt;Pusher supports real-time events through the use of &amp;#8220;channels&amp;#8221;. Each pusher client will
subscribe to a channel and receive messages that are sent to that channel. A special kind
of channel are presence channels which keep a list of their subscribers. You can query the
&lt;a class="reference external" href="https://pusher.com/docs/rest_api"&gt;Pusher &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt;&lt;/a&gt; (or f.e the Pusher Javascript &lt;span class="caps"&gt;API&lt;/span&gt;) to find out the names of the users
in a presence channel - however this is &lt;em&gt;not&lt;/em&gt; currently possible with the python &lt;span class="caps"&gt;API&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Unfortuanately, calling the Pusher &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; is &lt;em&gt;not&lt;/em&gt; so easy, since it needs a complicated
singining of each request, so I&amp;#8217;ve written this post to help developers that need to call
this &lt;span class="caps"&gt;API&lt;/span&gt; from python (to get the users of a presence channel or for any other method the
&lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt;&amp;nbsp;supports).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="signing-the-request"&gt;
&lt;h2&gt;Signing the&amp;nbsp;request&lt;/h2&gt;
&lt;p&gt;Quoting from the &lt;a class="reference external" href="https://pusher.com/docs/rest_api"&gt;Pusher &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt;&lt;/a&gt;, to sign a request we need a signature,&amp;nbsp;which:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The signature is a &lt;span class="caps"&gt;HMAC&lt;/span&gt; &lt;span class="caps"&gt;SHA256&lt;/span&gt; hex digest. This is generated by signing a string made up of the following components concatenated with newline characters&amp;nbsp;\n:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;The uppercase request method (e.g. &lt;span class="caps"&gt;POST&lt;/span&gt;)&lt;/li&gt;
&lt;li&gt;The request path (e.g.&amp;nbsp;/some/resource)&lt;/li&gt;
&lt;li&gt;The query parameters sorted by key, with keys converted to lowercase, then joined as in the query string. Note that the string must not be url escaped (e.g. given the keys auth_key: foo, Name: Something else, you get auth_key=foo&amp;amp;name=Something&amp;nbsp;else)&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;So, we need to create a string and then sign it using our Pusher api_key and secret. To help with this, we create a &lt;tt class="docutils literal"&gt;Token&lt;/tt&gt;
class which will be initialzed with out pusher key/secret and correctly sign a&amp;nbsp;string:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Token&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;secret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;secret&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;hmac&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hashlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sha256&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It uses the &lt;tt class="docutils literal"&gt;hmac&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;hashlib&lt;/tt&gt; python&amp;nbsp;modules.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="generating-the-complete-query-string"&gt;
&lt;h2&gt;Generating the complete query&amp;nbsp;string&lt;/h2&gt;
&lt;p&gt;We can now create a function that will sign a request using an instance of the above&amp;nbsp;token:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;create_signed_query_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;partial_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request_params&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;auth_key&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;auth_timestamp&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;auth_version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1.0&amp;#39;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request_params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;keys&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;params_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;params_list&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{0}={1}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;query_string&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;amp;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params_list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;sign_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;partial_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;query_string&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;query_string&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;amp;auth_signature=&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sign_data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;query_string&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;create_signed_query_string&lt;/tt&gt; receives an instance of a &lt;tt class="docutils literal"&gt;Token&lt;/tt&gt;, the path that we want to request
without the server part (for example &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/apps/33/users/my-channel&lt;/span&gt;&lt;/tt&gt;)  and a dictionary of
request parameters. It then adds three extra fields to the request parameters (&lt;tt class="docutils literal"&gt;auth_key, auth_timestamp, auth_version&lt;/tt&gt;)
and creates a list of these parameters in the &lt;tt class="docutils literal"&gt;key=value&lt;/tt&gt; form, where the keys are alphabetically sorted.
After that it joins the above &lt;tt class="docutils literal"&gt;key=value&lt;/tt&gt; parameters using &lt;tt class="docutils literal"&gt;&amp;amp;&lt;/tt&gt; to create the &lt;tt class="docutils literal"&gt;query_string&lt;/tt&gt; and then it creates the string to be signed (&lt;tt class="docutils literal"&gt;sign_data&lt;/tt&gt;)
by concatenating the &lt;span class="caps"&gt;HTTP&lt;/span&gt; methdo (&lt;span class="caps"&gt;GET&lt;/span&gt;) with the path and the &lt;tt class="docutils literal"&gt;query_string&lt;/tt&gt;. Finally, it appends the signing result as an extra
query parameter named (&lt;tt class="docutils literal"&gt;auth_signature&lt;/tt&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="requesting-the-users-of-the-presence-channel"&gt;
&lt;h2&gt;Requesting the users of the presence&amp;nbsp;channel&lt;/h2&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;create_signed_query_string&lt;/tt&gt; can now be used to get the users of a presence channel like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_users&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;partial_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="s1"&gt;&amp;#39;/apps/{0}/channels/{1}/users&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;token&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Token&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;create_signed_query_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;partial_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{})&lt;/span&gt;
    &lt;span class="n"&gt;full_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://api.pusherapp.com/{0}?{1}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;partial_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;full_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;get_users&lt;/tt&gt; function will generate the path of the pusher &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; (using
our pusher app_id and channel name) and initialize a signing &lt;tt class="docutils literal"&gt;Token&lt;/tt&gt; using
the pusher key and secret. It will then pass the previous to &lt;tt class="docutils literal"&gt;create_signed_query_string&lt;/tt&gt;
to generate the complete &lt;tt class="docutils literal"&gt;query_string&lt;/tt&gt; and generate the &lt;tt class="docutils literal"&gt;full_path&lt;/tt&gt; to which
a simple &lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;GET&lt;/span&gt; request is issued. The result will be a &lt;span class="caps"&gt;JSON&lt;/span&gt; list of the users in the
presence&amp;nbsp;channel.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="complete-example"&gt;
&lt;h2&gt;Complete&amp;nbsp;example&lt;/h2&gt;
&lt;p&gt;A complete example of getting the presence users of a channel is the&amp;nbsp;following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;hashlib&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;hmac&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;

&lt;span class="n"&gt;app_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pusher_app_id&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pusher_key&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;secret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pusher_secret&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;channel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pusher_presence_channel&amp;#39;&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Token&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;secret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;secret&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;hmac&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hashlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sha256&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hexdigest&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;create_signed_query_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;partial_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request_params&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;auth_key&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;auth_timestamp&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()),&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;auth_version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1.0&amp;#39;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request_params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;keys&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;params_list&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;params_list&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;{0}={1}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;query_string&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;amp;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;params_list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;sign_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;partial_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;query_string&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="n"&gt;query_string&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;amp;auth_signature=&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sign&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sign_data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;query_string&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_users&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;partial_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="s1"&gt;&amp;#39;/apps/{0}/channels/{1}/users&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;token&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Token&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;qs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;create_signed_query_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;token&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;partial_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;{})&lt;/span&gt;
    &lt;span class="n"&gt;full_path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://api.pusherapp.com/{0}?{1}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;partial_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;qs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;full_path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;get_users&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;With the above we are able to not only easily get the users of a Pusher presence
channel in python but to also call any method we want from the Pusher &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; by implementing a function
similar to  &lt;tt class="docutils literal"&gt;get_users&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
</content><category term="python"></category><category term="pusher"></category><category term="python"></category><category term="rest"></category></entry><entry><title>Asynchronous tasks in django withÂ django-rq</title><link href="https://spapas.github.io/2015/01/27/async-tasks-with-django-rq/" rel="alternate"></link><published>2015-01-27T14:20:00+02:00</published><updated>2015-01-27T14:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-01-27:/2015/01/27/async-tasks-with-django-rq/</id><summary type="html">&lt;p class="first last"&gt;Using django-rq to add queuing jobs (asynchronous tasks) and scheduling (cron-like) capabilities to a django&amp;nbsp;project.&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#job-queues-in-python" id="id2"&gt;Job queues in&amp;nbsp;python&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#django-test-rq" id="id3"&gt;django-test-rq&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#models-py" id="id4"&gt;models.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#forms-py" id="id5"&gt;forms.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#views-py" id="id6"&gt;views.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#tasks-py" id="id7"&gt;tasks.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#settings-py" id="id8"&gt;settings.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#running-the-project" id="id9"&gt;Running the&amp;nbsp;project&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#rqworker-and-rqscheduler" id="id10"&gt;rqworker and rqscheduler&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#for-development" id="id11"&gt;For&amp;nbsp;development&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#for-production" id="id12"&gt;For&amp;nbsp;production&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id13"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Update 01/09/15&lt;/strong&gt;: I&amp;#8217;ve written a new post about rq and django with some
&lt;a class="reference external" href="https://spapas.github.io/2015/09/01/django-rq-redux/"&gt;more advanced techniques&lt;/a&gt;&amp;nbsp;!&lt;/p&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Job queuing (asynchronous tasks) is a common requirement for non-trivial django projects. Whenever an operation
can take more than half a second it should be put to a job queue in order to be run asynchronously by a
seperate worker. This is really important since the response to a user request needs to be immediate
or else the users will experience laggy behavior and start complaining!
Even for fairly quick tasks (like sending email through an &lt;span class="caps"&gt;SMTP&lt;/span&gt; server) you need to use an asynchronous task
if you care about your users since
the time required for such a task is not really&amp;nbsp;limited.&lt;/p&gt;
&lt;p&gt;Using job queues is involved not only for the developers of the application (who need to create the
asynchronous tasks and give feedback to the users when the&amp;#8217;ve finished since they can&amp;#8217;t use the normal
&lt;span class="caps"&gt;HTTP&lt;/span&gt; response) and but also for the administrators, since, in order to support job queues at least two
more componets will be&amp;nbsp;needed:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;One job queue that will store the jobs to be executed next in a first in first queue. This could be the normal database of the project however it&amp;#8217;s not recommended for performance reasons and most of thetimes it is a specific component called &amp;#8220;Message&amp;nbsp;Broker&amp;#8221;&lt;/li&gt;
&lt;li&gt;One (or more) workers that will monitor the job queue and when there is work to do they will dequeue and execute&amp;nbsp;it&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These can all run in the same server but if it gets saturated they can easily be seperated (even more work for&amp;nbsp;administrators).&lt;/p&gt;
&lt;p&gt;Beyond job queuing, another relative requirement for many projects is to schedule a task to be run in the future
(similar to the &lt;tt class="docutils literal"&gt;at&lt;/tt&gt; unix command) or at specific time intervals (similar to the &lt;tt class="docutils literal"&gt;cron&lt;/tt&gt; unix command). For
instance, if a user is registered today we may need to check after one or two days if he&amp;#8217;s logged in and used our application -
if he hasn&amp;#8217;t then probably he&amp;#8217;s having problems and we can call him to help him. Also, we could check every night
to see if any users that have registered to our application don&amp;#8217;t have activated their account through email activation
and delete these accounts. Scheduled tasks should be also run by the workers mentioned&amp;nbsp;above.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="job-queues-in-python"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Job queues in&amp;nbsp;python&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The most known application for using job queues in python is &lt;a class="reference external" href="http://www.celeryproject.org/"&gt;celery&lt;/a&gt; which is a really great project that supports
many brokers,  integrates nicely
with python/django (but can be used even with other languages) and has
many more features (most of them are only useful on really big, enterprise projects). I&amp;#8217;ve already used
it in a previous application, however, because celery is really complex I found it rather difficult to
configure it successfully and I never was perfectly sure that my asynchronous task would actually work or
that I&amp;#8217;d used the correct configuration for my&amp;nbsp;needs!&lt;/p&gt;
&lt;p&gt;Celery also has &lt;a class="reference external" href="http://celery.readthedocs.org/en/latest/faq.html#does-celery-have-many-dependencies"&gt;many dependencies&lt;/a&gt; in order to be able to talk with the different broker backends it supports,
improve multithreading support etc. They may be required in enterprise apps but not for most Django web based&amp;nbsp;projects.&lt;/p&gt;
&lt;p&gt;So, for small-to-average projects I recommend using a different asynchronous task solution instead of celery, particularly
(as you&amp;#8217;ve already guessed from the title of this post) &lt;a class="reference external" href="http://python-rq.org/"&gt;&lt;span class="caps"&gt;RQ&lt;/span&gt;&lt;/a&gt;. &lt;span class="caps"&gt;RQ&lt;/span&gt; is simpler than celery, it integrates great with django
using the excellent &lt;a class="reference external" href="https://github.com/ui/django-rq"&gt;django-rq&lt;/a&gt; package and doesn&amp;#8217;t actually have any more dependencies beyond redis support which is
used as a broker (however most modern django projects already use redis for their caching needs as an  alternative
to&amp;nbsp;memcached).&lt;/p&gt;
&lt;p&gt;It even supports supports job scheduling through the &lt;a class="reference external" href="https://github.com/ui/rq-scheduler"&gt;rq-scheduler&lt;/a&gt; package (celery also supports
job scheduling through celery beat): Run a different process (scheduler) that polls the job
scheduling queue for any jobs that need to be run because of scheduling and if yes put them to
the normal job&amp;nbsp;queue.&lt;/p&gt;
&lt;p&gt;Although &lt;span class="caps"&gt;RQ&lt;/span&gt; and frieds are really easy to use (and have nice documentation) I wasn&amp;#8217;t able to find
a &lt;em&gt;complete&lt;/em&gt; example of using it with django, so I&amp;#8217;ve implemented one
(found at &lt;a class="reference external" href="https://github.com/spapas/django-test-rq"&gt;https://github.com/spapas/django-test-rq&lt;/a&gt; &amp;#8212; since I&amp;#8217;ve updated this project a bit
with new stuff,
please checkout tag django-test-rq-simple &lt;tt class="docutils literal"&gt;git checkout &lt;span class="pre"&gt;django-test-rq-simple&lt;/span&gt;&lt;/tt&gt;) mainly for my own testing
purposes. To help others that want to also use &lt;span class="caps"&gt;RQ&lt;/span&gt; in their project but don&amp;#8217;t know from where
to start, I&amp;#8217;ll present it in the following paragraphs, along with some comments on
how to actually use &lt;span class="caps"&gt;RQ&lt;/span&gt; in your production&amp;nbsp;environment.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-test-rq"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;django-test-rq&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This is a simple django project that can be used to asynchronously
run and schedule jobs and examine their behavior. The job to be scheduled just downloads a provided
&lt;span class="caps"&gt;URL&lt;/span&gt; and counts its length. There is only one django application (tasks) that contains two views, one
to display existing tasks and create new ones and one to display some info for the&amp;nbsp;jobs.&lt;/p&gt;
&lt;div class="section" id="models-py"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id4"&gt;models.py&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Two models (&lt;tt class="docutils literal"&gt;Task&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;ScheduledTask&lt;/tt&gt;) for saving individual tasks and
scheduled tasks and one model (&lt;tt class="docutils literal"&gt;ScheduledTaskInstance&lt;/tt&gt;) to save scheduled
instances of each scheduled&amp;nbsp;task.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rq&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_current_job&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Task&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# A model to save information about an asynchronous task&lt;/span&gt;
    &lt;span class="n"&gt;created_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;auto_now_add&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;job_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;null&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ScheduledTask&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# A model to save information about a scheduled task&lt;/span&gt;
    &lt;span class="n"&gt;created_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;auto_now_add&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# A scheduled task has a common job id for all its occurences&lt;/span&gt;
    &lt;span class="n"&gt;job_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ScheduledTaskInstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# A model to save information about instances of a scheduled task&lt;/span&gt;
    &lt;span class="n"&gt;scheduled_task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ScheduledTask&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;created_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;auto_now_add&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;null&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="forms-py"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id5"&gt;forms.py&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A very simple form to create a new&amp;nbsp;task.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TaskForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; A simple form to read a url from the user in order to find out its length&lt;/span&gt;
&lt;span class="sd"&gt;    and either run it asynchronously or schedule it schedule_times times,&lt;/span&gt;
&lt;span class="sd"&gt;    every schedule_interval seconds.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;URL&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;help_text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Enter a url (starting with http/https) to start a job that will download it and count its words&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;schedule_times&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;IntegerField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;help_text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;How many times to run this job. Leave empty or 0 to run it only once.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;schedule_interval&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;forms&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;IntegerField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;help_text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;How much time (in seconds) between runs of the job. Leave empty to run it only once.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;clean&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TaskForm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clean&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;schedule_times&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;schedule_times&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;schedule_interval&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;schedule_interval&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;schedule_times&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;schedule_interval&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;schedule_times&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;schedule_interval&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Please fill both schedule_times and schedule_interval to schedule a job or leave them both empty&amp;#39;&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;schedule_times&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_error&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;schedule_interval&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="views-py"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;views.py&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This is actually very simple if you&amp;#8217;re familiar with Class Based Views. Two CBVs
are defined, one for the Task form + Task display and another for the Job&amp;nbsp;display.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic.edit&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;FormView&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TemplateView&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;forms&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TaskForm&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tasks&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_url_words&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;scheduled_get_url_words&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;ScheduledTask&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rq.job&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Job&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;django_rq&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TasksHomeFormView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;FormView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    A class that displays a form to read a url to read its contents and if the job&lt;/span&gt;
&lt;span class="sd"&gt;    is to be scheduled or not and information about all the tasks and scheduled tasks.&lt;/span&gt;

&lt;span class="sd"&gt;    When the form is submitted, the task will be either scheduled based on the&lt;/span&gt;
&lt;span class="sd"&gt;    parameters of the form or will be just executed asynchronously immediately.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;form_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TaskForm&lt;/span&gt;
    &lt;span class="n"&gt;template_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;tasks_home.html&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;success_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;url&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;schedule_times&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;schedule_times&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;schedule_interval&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cleaned_data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;schedule_interval&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;schedule_times&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;schedule_interval&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c1"&gt;# Schedule the job with the form parameters&lt;/span&gt;
            &lt;span class="n"&gt;scheduler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;django_rq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_scheduler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;job&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;scheduler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;schedule&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
                &lt;span class="n"&gt;scheduled_time&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
                &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;scheduled_get_url_words&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                &lt;span class="n"&gt;interval&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;schedule_interval&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="n"&gt;repeat&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;schedule_times&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c1"&gt;# Just execute the job asynchronously&lt;/span&gt;
            &lt;span class="n"&gt;get_url_words&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TasksHomeFormView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TasksHomeFormView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tasks&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-created_on&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;scheduled_tasks&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ScheduledTask&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-created_on&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;JobTemplateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TemplateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    A simple template view that gets a job id as a kwarg parameter&lt;/span&gt;
&lt;span class="sd"&gt;    and tries to fetch that job from RQ. It will then print all attributes&lt;/span&gt;
&lt;span class="sd"&gt;    of that object using __dict__.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;template_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;job.html&amp;#39;&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;JobTemplateView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_context_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;redis_conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;django_rq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;job&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Job&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;job&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;redis_conn&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;job&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;job&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__dict__&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;job&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

        &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;job&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;job&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="tasks-py"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;tasks.py&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Here two jobs are defined: One to be used for simple asynchronous tasks and the
other to be used for scheduled asynchronous tasks (since for asynchronous tasks
we wanted to group their runs per job&amp;nbsp;id).&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;&amp;#64;job&lt;/tt&gt; decorator will add the &lt;tt class="docutils literal"&gt;delay()&lt;/tt&gt; method (used in &lt;tt class="docutils literal"&gt;views.py&lt;/tt&gt;) to
the function. It&amp;#8217;s not really required for &lt;tt class="docutils literal"&gt;scheduled_get_url_words&lt;/tt&gt; since
it&amp;#8217;s called through the &lt;tt class="docutils literal"&gt;scheduled.schedule&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;When a task is finished, it can return a value (like we do in &lt;tt class="docutils literal"&gt;return task.result&lt;/tt&gt;)
which will be saved for a limited amount of time (500 seconds by default - could be
even saved for ever) to redis.
This may be useful in some cases, however, I think that for normal web applications it&amp;#8217;s
not that useful, and since here we use normal django models
for each task, we can save it to that model&amp;#8217;s instance&amp;nbsp;instead.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ScheduledTask&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ScheduledTaskInstance&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rq&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_current_job&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django_rq&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;job&lt;/span&gt;


&lt;span class="nd"&gt;@job&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_url_words&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# This creates a Task instance to save the job instance and job result&lt;/span&gt;
    &lt;span class="n"&gt;job&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_current_job&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;job_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;job&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_id&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;


&lt;span class="nd"&gt;@job&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;scheduled_get_url_words&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    This creates a ScheduledTask instance for each group of&lt;/span&gt;
&lt;span class="sd"&gt;    scheduled task - each time this scheduled task is run&lt;/span&gt;
&lt;span class="sd"&gt;    a new instance of ScheduledTaskInstance will be created&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;job&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_current_job&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;created&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ScheduledTask&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_or_create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;job_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;job&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_id&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
        &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;response_len&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;ScheduledTaskInstance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;scheduled_task&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;response_len&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response_len&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="settings-py"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;settings.py&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="n"&gt;BASE_DIR&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dirname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dirname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__file__&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;SECRET_KEY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;123&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;DEBUG&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;TEMPLATE_DEBUG&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;ALLOWED_HOSTS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

&lt;span class="n"&gt;INSTALLED_APPS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.admin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.auth&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.contenttypes&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.sessions&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.messages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.staticfiles&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;

    &lt;span class="s1"&gt;&amp;#39;django_extensions&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django_rq&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;

    &lt;span class="s1"&gt;&amp;#39;tasks&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;MIDDLEWARE_CLASSES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.sessions.middleware.SessionMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.middleware.common.CommonMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.middleware.csrf.CsrfViewMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.auth.middleware.AuthenticationMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.auth.middleware.SessionAuthenticationMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.messages.middleware.MessageMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.middleware.clickjacking.XFrameOptionsMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;ROOT_URLCONF&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django_test_rq.urls&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;WSGI_APPLICATION&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django_test_rq.wsgi.application&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;DATABASES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;ENGINE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django.db.backends.sqlite3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;NAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BASE_DIR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;db.sqlite3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;LANGUAGE_CODE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;en-us&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;TIME_ZONE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;UTC&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;USE_I18N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;USE_L10N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;USE_TZ&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

&lt;span class="n"&gt;STATIC_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/static/&amp;#39;&lt;/span&gt;

&lt;span class="c1"&gt;# Use redis for caches&lt;/span&gt;
&lt;span class="n"&gt;CACHES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;BACKEND&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;django_redis.cache.RedisCache&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;LOCATION&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;redis://127.0.0.1:6379/0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;OPTIONS&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;CLIENT_CLASS&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;django_redis.client.DefaultClient&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;# Use the same redis as with caches for RQ&lt;/span&gt;
&lt;span class="n"&gt;RQ_QUEUES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;USE_REDIS_CACHE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;SESSION_ENGINE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;django.contrib.sessions.backends.cache&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;SESSION_CACHE_ALIAS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;RQ_SHOW_ADMIN_LINK&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

&lt;span class="c1"&gt;# Add a logger for rq_scheduler in order to display when jobs are queueud&lt;/span&gt;
&lt;span class="n"&gt;LOGGING&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;disable_existing_loggers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;formatters&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;simple&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;format&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%(asctime)s&lt;/span&gt;&lt;span class="s1"&gt; &lt;/span&gt;&lt;span class="si"&gt;%(levelname)s&lt;/span&gt;&lt;span class="s1"&gt; &lt;/span&gt;&lt;span class="si"&gt;%(message)s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;handlers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;console&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;level&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DEBUG&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;logging.StreamHandler&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;formatter&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;simple&amp;#39;&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;

    &lt;span class="s1"&gt;&amp;#39;loggers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;django.request&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;handlers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;console&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;level&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DEBUG&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;propagate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;rq_scheduler&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;handlers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;console&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;level&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;DEBUG&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;propagate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;By default, rq_scheduler won&amp;#8217;t log anything so we won&amp;#8217;t be able to see
any output when new instances of each scheduled task are queued for execution.
That&amp;#8217;s why we&amp;#8217;ve overriden the &lt;span class="caps"&gt;LOGGING&lt;/span&gt; setting in order to actually log
rq_scheduler output to the&amp;nbsp;console.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="running-the-project"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;Running the&amp;nbsp;project&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;I recommend using &lt;a class="reference external" href="https://www.vagrantup.com/"&gt;Vagrant&lt;/a&gt; to start a stock ubuntu/trusty32 box. After that, install redis, virtualenv and virtualenvwrapper
and create/activate a virtualenv named &lt;tt class="docutils literal"&gt;rq&lt;/tt&gt;. You can go to the home directory of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;django-test-rq&lt;/span&gt;&lt;/tt&gt;
and install requirements through &lt;tt class="docutils literal"&gt;pip install requirements.txt&lt;/tt&gt; and create the database tables with
&lt;tt class="docutils literal"&gt;python manage.py migrate&lt;/tt&gt;. Finally you may run the project with &lt;tt class="docutils literal"&gt;python manage.py runserver_plus&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="rqworker-and-rqscheduler"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id10"&gt;rqworker and&amp;nbsp;rqscheduler&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Before scheduling any tasks we need to run two more&amp;nbsp;processes:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;rqworker: This is a worker that dequeues jobs from the queue and executes them. We could run more than one onstance of this job if we need&amp;nbsp;it.&lt;/li&gt;
&lt;li&gt;rqscheduler: This is a process that runs every one minute and checks if there are scheduled jobs that have to be executed. If yes, it will add them to the queue in order to be executed by a&amp;nbsp;worker.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="for-development"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;For&amp;nbsp;development&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;If you want to run rqworker and rqscheduler for your development environment you can just do it with
running &lt;tt class="docutils literal"&gt;python manage.py rqworker&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;python mange.py rqscheduler&lt;/tt&gt; through screen/tmux. If everything
is allright you should see tasks being added to the queue and scheduled (you may need to refresh the
homepage before seeing everything since a task may be executed after the response is&amp;nbsp;created).&lt;/p&gt;
&lt;p&gt;Also, keep in mind that rqscheduler runs once every minute by default so you may need to wait up to
minute to see a &lt;tt class="docutils literal"&gt;ScheduledTask&lt;/tt&gt; instance. Also, this means that you can&amp;#8217;t run more than one scheduled
task instance per&amp;nbsp;minute.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="for-production"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;For&amp;nbsp;production&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Trying to create daemons through screen is not
sufficient for a production envornment since we&amp;#8217;d like to actually have logging, monitoring and of course
automatically start rqworker and rqscheduler when the server&amp;nbsp;boots.&lt;/p&gt;
&lt;p&gt;For this, I recommend using the &lt;a class="reference external" href="http://supervisord.org/"&gt;supervisord&lt;/a&gt; tool which
can be used to monitor and control a number of processes. There are other similar tools, however I&amp;#8217;ve
found supervisord the easier to&amp;nbsp;use.&lt;/p&gt;
&lt;p&gt;In order to monitor/control a process through supervisord you need to add a &lt;tt class="docutils literal"&gt;[program:progrname]&lt;/tt&gt; section in
supervisord&amp;#8217;s configuration and pass a number of parameters. The &lt;tt class="docutils literal"&gt;progname&lt;/tt&gt; is the name of the monitoring
process. Here&amp;#8217;s how rqworker can be configured using&amp;nbsp;supervisord:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
[program:rqworker]
command=python manage.py rqworker
directory=/vagrant/progr/py/rq/django-test-rq
environment=PATH=&amp;quot;/home/vagrant/.virtualenvs/rq/bin&amp;quot;
user=vagrant
&lt;/pre&gt;
&lt;p&gt;The options used will chdir to &lt;tt class="docutils literal"&gt;directory&lt;/tt&gt; and execute &lt;tt class="docutils literal"&gt;command&lt;/tt&gt; as &lt;tt class="docutils literal"&gt;user&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;environment&lt;/tt&gt;
option can be used to set envirotnment variables - here we set &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;PATH&lt;/span&gt;&lt;/tt&gt; in order to use a specific
virtual environment. This will allow you to monitor rqworker through supervisord and log its
output to a file in &lt;tt class="docutils literal"&gt;/var/log/supervisor&lt;/tt&gt; (by default). A similar entry needs to be added for
rqscheduler of course. If everything has been configured correctly, when you reload the supervisord
settings you can run &lt;tt class="docutils literal"&gt;sudo /usr/bin/supervisorctl&lt;/tt&gt; and should see something&amp;nbsp;like&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
rqscheduler                      RUNNING    pid 1561, uptime 0:00:03
rqworker                         RUNNING    pid 1562, uptime 0:00:03
&lt;/pre&gt;
&lt;p&gt;Also, tho log files should contain some debug&amp;nbsp;info.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Although using job queues makes it more difficult for the developer and adds at least one
(and probably more) points of failure to a project (the workers, the broker etc) their
usage, even for very simple projects is&amp;nbsp;unavoidable.&lt;/p&gt;
&lt;p&gt;Unless a complex, enterprise solution like celery is really required for a project
I recommend using the much simpler and easier to configure &lt;span class="caps"&gt;RQ&lt;/span&gt; for all your
asynchronous and scheduled task needs. Using &lt;span class="caps"&gt;RQ&lt;/span&gt; (and the relative projects django-rq
and rq-scheduler) we can easily add production ready queueued and scheduled jobs to
any django&amp;nbsp;project.&lt;/p&gt;
&lt;p&gt;In this article we presented a small introduction to &lt;span class="caps"&gt;RQ&lt;/span&gt; and its friends and saw how
to configure django to use it in a production ready environment using a small
django project (&lt;a class="reference external" href="https://github.com/spapas/django-test-rq"&gt;https://github.com/spapas/django-test-rq&lt;/a&gt;) which was implemented as a companion
to help readers quickly test the concepts presented&amp;nbsp;here.&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="python"></category><category term="tasks"></category><category term="jobs"></category><category term="rq"></category><category term="django-rq"></category><category term="asynchronous"></category><category term="scheduling"></category><category term="redis"></category></entry><entry><title>Django modelÂ auditing</title><link href="https://spapas.github.io/2015/01/21/django-model-auditing/" rel="alternate"></link><published>2015-01-21T14:20:00+02:00</published><updated>2015-01-21T14:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2015-01-21:/2015/01/21/django-model-auditing/</id><summary type="html">&lt;p class="first last"&gt;Model auditing (who-did-what) with&amp;nbsp;Django&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id5"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#adding-simple-auditing-functionality-ourselves" id="id6"&gt;Adding simple auditing functionality&amp;nbsp;ourselves&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#example" id="id7"&gt;Example&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#models-py" id="id8"&gt;models.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#forms-py" id="id9"&gt;forms.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#views-py" id="id10"&gt;views.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#urls-py" id="id11"&gt;urls.py&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#templates" id="id12"&gt;templates&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-django-simple-history" id="id13"&gt;Using django-simple-history&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#installation" id="id14"&gt;Installation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#id1" id="id15"&gt;Example&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#usage" id="id16"&gt;Usage&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-django-reversion" id="id17"&gt;Using django-reversion&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#id2" id="id18"&gt;Installation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#id3" id="id19"&gt;Example&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#id4" id="id20"&gt;Usage&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#comparing-versions-with-django-reversion-compare" id="id21"&gt;Comparing versions with&amp;nbsp;django-reversion-compare&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id22"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;An auditing trail is a common requirement in most non-trivial applications. Organizations
need to know &lt;em&gt;who&lt;/em&gt; did the change, &lt;em&gt;when&lt;/em&gt; it was done and &lt;em&gt;what&lt;/em&gt; was actually changed.
In this post we will see three
different solution in order to add this functionality in Django: doing it ourselves,
using django-simple-history and using&amp;nbsp;django-reversion.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Update 24/09/2015:&lt;/em&gt; Added a paragraph describing the django-reversion-compare which is
a great addon for django-reversion that makes finding differences between versions a&amp;nbsp;breeze!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="adding-simple-auditing-functionality-ourselves"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Adding simple auditing functionality&amp;nbsp;ourselves&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A simple way to actually do auditing is to keep four extra fields in our models:
&lt;tt class="docutils literal"&gt;created_by&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;created_on&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;modified_by&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;modified_on&lt;/tt&gt;. The first two
will be filled when the model instance is created while the latter two will be
changed whenever the model instance is saved. So we only have &lt;em&gt;who&lt;/em&gt; and &lt;em&gt;whe&lt;/em&gt;.
Sometimes, these are enough so let&amp;#8217;s see how easy it is to implement it in&amp;nbsp;django.&lt;/p&gt;
&lt;p&gt;We&amp;#8217;ll need an abstract model that could be used as a base class for models that need&amp;nbsp;auditing:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Auditable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;created_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;auto_now_add&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;created_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AUTH_USER_MODEL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;related_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;created_by&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;modified_on&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;auto_now&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;modified_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AUTH_USER_MODEL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;related_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;modified_by&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;abstract&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Models inheriting from &lt;tt class="docutils literal"&gt;Auditable&lt;/tt&gt; will contain their datetime of creation and modification
which will be automatically filled using the very usefull &lt;tt class="docutils literal"&gt;auto_now_add_&lt;/tt&gt; (which will
set the current datetime when the model instance is created) and &lt;tt class="docutils literal"&gt;auto_now_&lt;/tt&gt; (which will
set the current datetime when the model instance is&amp;nbsp;modified).&lt;/p&gt;
&lt;p&gt;Such models will also have two foreign keys to &lt;tt class="docutils literal"&gt;User&lt;/tt&gt;, one for the user
that created the and one of the user that modified them. The problem with these two fields
is that they cannot be filled automatically (like the datetimes) because the user that
actually did create/change the objects must be&amp;nbsp;provided!&lt;/p&gt;
&lt;p&gt;Since I am really fond of CBVs I will present a simple mixin that can be used with CreateView
and UpdateView and does exactly&amp;nbsp;that:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;,):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;created_by&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;created_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;
        &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;modified_by&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_valid&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above mixin overrides the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt;:
First it checks if the object is created (if it is created it won&amp;#8217;t be saved in the
database yet thus it won&amp;#8217;t have an id) in order to set the &lt;tt class="docutils literal"&gt;created_by&lt;/tt&gt; attribute to
the current user. After that it will set the &lt;tt class="docutils literal"&gt;modified_by&lt;/tt&gt; attribute of the object to
the current user. Finally, it will call the next &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; method to do whatever
is required (save the model instance and redirect to &lt;tt class="docutils literal"&gt;success_url&lt;/tt&gt; by&amp;nbsp;default).&lt;/p&gt;
&lt;p&gt;The views using &lt;tt class="docutils literal"&gt;AuditableMixin&lt;/tt&gt; should allow only logged in users (or else an
exception will be thrown). Also, don&amp;#8217;t forget to exclude the &lt;tt class="docutils literal"&gt;created_by&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;modified_by&lt;/tt&gt;
fields from your model form (&lt;tt class="docutils literal"&gt;created_on&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;modified_on&lt;/tt&gt; will automatically be&amp;nbsp;excluded).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="example"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;Example&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Let&amp;#8217;s see a simple example of creating a small django application using the previously defined abstract model and&amp;nbsp;mixin:&lt;/p&gt;
&lt;div class="section" id="models-py"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;models.py&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.core.urlresolvers&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;auditable.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Auditable&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Book&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Auditable&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;author&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;128&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_absolute_url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;book_list&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In the above we suppose that the &lt;tt class="docutils literal"&gt;Auditable&lt;/tt&gt; abstract model is imported from the
&lt;tt class="docutils literal"&gt;auditable.models&lt;/tt&gt; module and that a view named &lt;tt class="docutils literal"&gt;book_list&lt;/tt&gt; that shows all books&amp;nbsp;exists.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="forms-py"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;forms.py&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.forms&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ModelForm&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BookForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ModelForm&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
        &lt;span class="n"&gt;fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;author&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Show only &lt;tt class="docutils literal"&gt;name&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;author&lt;/tt&gt; fields (and not the auditable fields) in the &lt;tt class="docutils literal"&gt;Book ModelForm&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="views-py"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;views.py&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic.edit&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;CreateView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UpdateView&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ListView&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;auditable.views&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;AuditableMixin&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;forms&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;BookForm&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BookCreateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CreateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
    &lt;span class="n"&gt;form_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;BookForm&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BookUpdateView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AuditableMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;UpdateView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
    &lt;span class="n"&gt;form_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;BookForm&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BookListView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ListView&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;model&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Book&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We import the &lt;tt class="docutils literal"&gt;AuditableMixin&lt;/tt&gt; from &lt;tt class="docutils literal"&gt;auditable.views&lt;/tt&gt; and make our Create and Update views
inherit from this mixin also in addition to &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt;. Pay attention that our
mixin is placed &lt;em&gt;before&lt;/em&gt; CreateView in order to call &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; in the proper order: When multiple
inheritance is used like this python will check each class from left to right to find the proper method
and call it. For example, in our &lt;tt class="docutils literal"&gt;BookCreateView&lt;/tt&gt;, when the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; method is called, python
will first check if &lt;tt class="docutils literal"&gt;BookCreateView&lt;/tt&gt; has a &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; method. Since it does not, it will check
if &lt;tt class="docutils literal"&gt;AuditableMixin&lt;/tt&gt; has a &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; method and call it. Now, we are calling the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;super(...).form_valid()&lt;/span&gt;&lt;/tt&gt; in the
&lt;tt class="docutils literal"&gt;AuditableMixin&lt;/tt&gt; &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt;, so the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; of &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt; will &lt;em&gt;also&lt;/em&gt; be&amp;nbsp;called.&lt;/p&gt;
&lt;p&gt;A simple &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt; is also added to just show the info on all&amp;nbsp;books.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="urls-py"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id11"&gt;urls.py&lt;/a&gt;&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf.urls&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;views&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;BookCreateView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BookUpdateView&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BookListView&lt;/span&gt;

&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^accounts/login/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django.contrib.auth.views.login&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^accounts/logout/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django.contrib.auth.views.logout&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt;

    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^create/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BookCreateView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;create_book&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^update/(?P&amp;lt;pk&amp;gt;\d+)/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BookUpdateView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;update_book&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;BookListView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;book_list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Just add the previously defined Create/Update/List views along with a login/logout&amp;nbsp;views.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="templates"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id12"&gt;templates&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;You&amp;#8217;ll need four&amp;nbsp;templates:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;books/book_list.html: Show the list of&amp;nbsp;books&lt;/li&gt;
&lt;li&gt;books/book_form.html: Show the book editing&amp;nbsp;form&lt;/li&gt;
&lt;li&gt;registration/login.html: Login&amp;nbsp;form&lt;/li&gt;
&lt;li&gt;registration/logout.html: Logout&amp;nbsp;message&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="using-django-simple-history"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id13"&gt;Using&amp;nbsp;django-simple-history&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/treyhunner/django-simple-history"&gt;django-simple-history&lt;/a&gt;  can be used to not only store the user and date of each modification
but a different version for each modification. To do that, for every model that is registered
to be used with django-simple-history, it wil create a second table in
the database hosting all versions (historical records) of that model. As we can understand this is really powerfull
since we can see exactly what was changed and also do normal &lt;span class="caps"&gt;SQL&lt;/span&gt; queries on&amp;nbsp;that!&lt;/p&gt;
&lt;div class="section" id="installation"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id14"&gt;Installation&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To use django-simple-history in a project, after we do a &lt;tt class="docutils literal"&gt;pip install &lt;span class="pre"&gt;django-simple-history&lt;/span&gt;&lt;/tt&gt;,
we just need to add it to &lt;tt class="docutils literal"&gt;INSTALLED_APPS&lt;/tt&gt; and
add the &lt;tt class="docutils literal"&gt;simple_history.middleware.HistoryRequestMiddleware&lt;/tt&gt; to the &lt;tt class="docutils literal"&gt;MIDDLEWARE_CLASSES&lt;/tt&gt; list.&lt;/p&gt;
&lt;p&gt;Finally, to keep the historical records for a model, just add an instace of &lt;tt class="docutils literal"&gt;HistoricalRecords&lt;/tt&gt; to this&amp;nbsp;model.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id1"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id15"&gt;Example&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;For example, our previously defined &lt;tt class="docutils literal"&gt;Book&lt;/tt&gt; model will be modified like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;class SHBook(models.Model):
    name = models.CharField(max_length=128)
    author = models.CharField(max_length=128)

    def get_absolute_url(self):
        return reverse(&amp;quot;shbook_list&amp;quot;)

    history = HistoricalRecords()
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When we run &lt;tt class="docutils literal"&gt;python manage.py makemigrations&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;migrate&lt;/tt&gt; this, we&amp;#8217;ll see that beyond the table for SHBook, a table for HistoricalSHBook will be&amp;nbsp;created:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
Migrations for 'sample':
  0002_historicalshbook_shbook.py:
    - Create model HistoricalSHBook
    - Create model SHBook
&lt;/pre&gt;
&lt;p&gt;Let&amp;#8217;s see the schema of&amp;nbsp;historicalshbook:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
CREATE TABLE &amp;quot;sample_historicalshbook&amp;quot; (
    &amp;quot;id&amp;quot; integer NOT NULL,
    &amp;quot;name&amp;quot; varchar(128) NOT NULL,
    &amp;quot;author&amp;quot; varchar(128) NOT NULL,
    &amp;quot;history_id&amp;quot; integer NOT NULL PRIMARY KEY AUTOINCREMENT,
    &amp;quot;history_date&amp;quot; datetime NOT NULL,
    &amp;quot;history_type&amp;quot; varchar(1) NOT NULL,
    &amp;quot;history_user_id&amp;quot; integer NULL REFERENCES &amp;quot;auth_user&amp;quot; (&amp;quot;id&amp;quot;)
);
&lt;/pre&gt;
&lt;p&gt;So we see that it has the &lt;em&gt;same&lt;/em&gt; fields as with &lt;tt class="docutils literal"&gt;SHBook&lt;/tt&gt; (&lt;tt class="docutils literal"&gt;id, name, author&lt;/tt&gt;) with the addition of
the primary key (&lt;tt class="docutils literal"&gt;history_id&lt;/tt&gt;) of this historical record, the date and user that did the change
(&lt;tt class="docutils literal"&gt;history_date&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;history_user_id&lt;/tt&gt;) and the type of the record (created / update /&amp;nbsp;delete).&lt;/p&gt;
&lt;p&gt;So, just by adding a &lt;tt class="docutils literal"&gt;HistoricalRecords()&lt;/tt&gt; attribute to our model definition we&amp;#8217;ll get complete auditing
for the instance of that&amp;nbsp;model&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="usage"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id16"&gt;Usage&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To find out information about the historical records we&amp;#8217;ll just use the &lt;tt class="docutils literal"&gt;HistoricalRecords()&lt;/tt&gt; attribute
of that&amp;nbsp;model:&lt;/p&gt;
&lt;p&gt;For example, running &lt;tt class="docutils literal"&gt;SHBook.history.filter(id=1)&lt;/tt&gt; will return all historical records of the book with
&lt;tt class="docutils literal"&gt;id = 1&lt;/tt&gt;. For each one of them we have can use the&amp;nbsp;following:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;get the user that made the change through the &lt;tt class="docutils literal"&gt;history_user&lt;/tt&gt; attribute&lt;/li&gt;
&lt;li&gt;get the date of the change through the &lt;tt class="docutils literal"&gt;history_date&lt;/tt&gt; attribute&lt;/li&gt;
&lt;li&gt;get the type of the change through the &lt;tt class="docutils literal"&gt;history_type&lt;/tt&gt; attribute (and the corresponding &lt;tt class="docutils literal"&gt;get_history_type_dispaly&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;get a model instance as it was then through the &lt;tt class="docutils literal"&gt;history_object&lt;/tt&gt; attribute (in order to &lt;tt class="docutils literal"&gt;save()&lt;/tt&gt; it and revert to this&amp;nbsp;version)&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="using-django-reversion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id17"&gt;Using&amp;nbsp;django-reversion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/etianen/django-reversion"&gt;django-reversion&lt;/a&gt;  offers more or less the same functionality of django-simple-history by following a different philosophy:
Instead of creating an extra table holding the history records for each model, it insteads converts all the fields of each model
to json and stores that &lt;span class="caps"&gt;JSON&lt;/span&gt; in the database in a text&amp;nbsp;field.&lt;/p&gt;
&lt;p&gt;This has the advantage that no extra tables are created to the database but the disadvantage that you can&amp;#8217;t easily query
your historical records. So you may choose one or the other depending on your actual&amp;nbsp;requirements.&lt;/p&gt;
&lt;div class="section" id="id2"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id18"&gt;Installation&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To use django-reversion in a project, after we do a &lt;tt class="docutils literal"&gt;pip install &lt;span class="pre"&gt;django-reversion&lt;/span&gt;&lt;/tt&gt;,
we just need to add it to &lt;tt class="docutils literal"&gt;INSTALLED_APPS&lt;/tt&gt; and
add the &lt;tt class="docutils literal"&gt;reversion.middleware.RevisionMiddleware&lt;/tt&gt; to the &lt;tt class="docutils literal"&gt;MIDDLEWARE_CLASSES&lt;/tt&gt; list.&lt;/p&gt;
&lt;p&gt;In order to save the revisions of a model, you need to register this model to django-reversion. This can be
done either through the django-admin, by inheriting the admin class of that model from &lt;tt class="docutils literal"&gt;reversion.VersionAdmin&lt;/tt&gt;
or, if you don&amp;#8217;t want to use the admin by &lt;tt class="docutils literal"&gt;reversion.register&lt;/tt&gt; decorator.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id3"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id19"&gt;Example&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To use django-reversion to keep track of changes to &lt;tt class="docutils literal"&gt;Book&lt;/tt&gt; we can modify it like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;@reversion.register
class RBook(models.Model):
    name = models.CharField(max_length=128)
    author = models.CharField(max_length=128)

    def get_absolute_url(self):
        return reverse(&amp;quot;rbook_list&amp;quot;)
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;django-reversion uses two tables in the database to keep track of revisions: &lt;tt class="docutils literal"&gt;revision&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;version&lt;/tt&gt;. Let&amp;#8217;s
take a look at their&amp;nbsp;schemata:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
.schema reversion_revision
CREATE TABLE &amp;quot;reversion_revision&amp;quot; (
    &amp;quot;id&amp;quot; integer NOT NULL PRIMARY KEY AUTOINCREMENT,
    &amp;quot;manager_slug&amp;quot; varchar(200) NOT NULL,
    &amp;quot;date_created&amp;quot; datetime NOT NULL,
    &amp;quot;comment&amp;quot; text NOT NULL,
    &amp;quot;user_id&amp;quot; integer NULL REFERENCES &amp;quot;auth_user&amp;quot; (&amp;quot;id&amp;quot;)
);

.schema reversion_version
CREATE TABLE &amp;quot;reversion_version&amp;quot; (
    &amp;quot;id&amp;quot; integer NOT NULL PRIMARY KEY AUTOINCREMENT,
    &amp;quot;object_id&amp;quot; text NOT NULL,
    &amp;quot;object_id_int&amp;quot; integer NULL,
    &amp;quot;format&amp;quot; varchar(255) NOT NULL,
    &amp;quot;serialized_data&amp;quot; text NOT NULL,
    &amp;quot;object_repr&amp;quot; text NOT NULL,
    &amp;quot;content_type_id&amp;quot; integer NOT NULL REFERENCES &amp;quot;django_content_type&amp;quot; (&amp;quot;id&amp;quot;),
    &amp;quot;revision_id&amp;quot; integer NOT NULL REFERENCES &amp;quot;reversion_revision&amp;quot; (&amp;quot;id&amp;quot;)
);
&lt;/pre&gt;
&lt;p&gt;As we can understand, the &lt;tt class="docutils literal"&gt;revision&lt;/tt&gt; table holds information like who created this
revison (&lt;tt class="docutils literal"&gt;user_id&lt;/tt&gt;) and when (&lt;tt class="docutils literal"&gt;date_created&lt;/tt&gt;) while the &lt;tt class="docutils literal"&gt;version&lt;/tt&gt; stores
a reference to the object that was modified (through a GenericForeignKey) and
the actual data (in the &lt;tt class="docutils literal"&gt;serialized_data&lt;/tt&gt; field). By default it uses &lt;span class="caps"&gt;JSON&lt;/span&gt;
to serialize the data (the serialization format is in the &lt;tt class="docutils literal"&gt;format&lt;/tt&gt; field). There&amp;#8217;s
an one-to-one relation between &lt;tt class="docutils literal"&gt;revision&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;version&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;If we create an instance of &lt;tt class="docutils literal"&gt;RBook&lt;/tt&gt; we&amp;#8217;ll see the following in the&amp;nbsp;database:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
sqlite&amp;gt; select * from reversion_revision;
1|default|2015-01-21 10:31:25.233000||1

sqlite&amp;gt; select * from reversion_version;
1|1|1|json|[{&amp;quot;fields&amp;quot;: {&amp;quot;name&amp;quot;: &amp;quot;asdasdasd&amp;quot;, &amp;quot;author&amp;quot;: &amp;quot;asdasd&amp;quot;}, &amp;quot;model&amp;quot;: &amp;quot;sample.rbook&amp;quot;, &amp;quot;pk&amp;quot;: 1}]|RBook object|12|1
&lt;/pre&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;date_created&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;user_id&lt;/tt&gt; are stored on &lt;tt class="docutils literal"&gt;revision&lt;/tt&gt; while &lt;tt class="docutils literal"&gt;format&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;serialized_data&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;content_type_id&lt;/tt&gt; and
&lt;tt class="docutils literal"&gt;object_id_int&lt;/tt&gt; (the &lt;tt class="docutils literal"&gt;GenericForeignKey&lt;/tt&gt;) are stored in &lt;tt class="docutils literal"&gt;version&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="id4"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id20"&gt;Usage&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;To find out information about an object you have to use the &lt;tt class="docutils literal"&gt;reversion.get_for_object(object)&lt;/tt&gt; method. In order to be
easily used in templates I recommend creating the following &lt;tt class="docutils literal"&gt;get_versions()&lt;/tt&gt; method in each model that is registered with&amp;nbsp;django-reversion&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
def get_versions(self):
    return reversion.get_for_object(self)
&lt;/pre&gt;
&lt;p&gt;Now, each version has a &lt;tt class="docutils literal"&gt;revision&lt;/tt&gt; attribute for the corresponding revision and can be used to do the&amp;nbsp;following:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;get the user that made the change through the &lt;tt class="docutils literal"&gt;revision.user&lt;/tt&gt; attribute&lt;/li&gt;
&lt;li&gt;get the date of the change through the &lt;tt class="docutils literal"&gt;revision.date_created&lt;/tt&gt; attribute&lt;/li&gt;
&lt;li&gt;get the values of the object fields as they were in this revision using the &lt;tt class="docutils literal"&gt;field_dict&lt;/tt&gt; attribute&lt;/li&gt;
&lt;li&gt;get a model instance as it was on that revision using the &lt;tt class="docutils literal"&gt;object_version.object&lt;/tt&gt; attribute&lt;/li&gt;
&lt;li&gt;revert to that previous version of that object using the &lt;tt class="docutils literal"&gt;revert()&lt;/tt&gt; method&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="comparing-versions-with-django-reversion-compare"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id21"&gt;Comparing versions with&amp;nbsp;django-reversion-compare&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;A great addon for django-version is &lt;a class="reference external" href="github.com/jedie/django-reversion-compare"&gt;django-reversion-compare&lt;/a&gt; which helps you find out differences
between versions of your objects. When you use django-reversion-compare, you&amp;#8217;ll be able to select
two (different) versions of your object and you&amp;#8217;ll be presented with a list of all the differences
found in the fields of that object between the two versions. The diff algorithm is smart, so you&amp;#8217;ll
be able to easily recognise the&amp;nbsp;changes.&lt;/p&gt;
&lt;p&gt;To use django-reversion-compare, after installing it you should just inherit your admin views from
&lt;tt class="docutils literal"&gt;reversion_compare.admin.CompareVersionAdmin&lt;/tt&gt; (instead of &lt;tt class="docutils literal"&gt;reversion.VersionAdmin&lt;/tt&gt;) and you&amp;#8217;ll
get the reversion-compare views instead of reversion views in the admin for the history of the&amp;nbsp;object.&lt;/p&gt;
&lt;p&gt;Also, in case you need to give access to normal, non-admin users to the history of an object (this is
useful for auditing reasons), you can use the &lt;tt class="docutils literal"&gt;reversion_compare.views.HistoryCompareDetailView&lt;/tt&gt;
as a normal &lt;tt class="docutils literal"&gt;DetailView&lt;/tt&gt; to create a non-admin history and compare diff&amp;nbsp;view.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id22"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the above we say that it is really easy to add basic (&lt;em&gt;who&lt;/em&gt; and &lt;em&gt;when&lt;/em&gt;) auditing capabilities to your models: You just need to
inherit your models from the &lt;tt class="docutils literal"&gt;Auditable&lt;/tt&gt; abstract class and inherit your Create and Update CBVs from &lt;tt class="docutils literal"&gt;AuditableMixin&lt;/tt&gt;.
If you want to know exactly &lt;em&gt;what&lt;/em&gt; was changed then you have two solutions: django-simple-history to create an extra table for
each of your models so you&amp;#8217;ll be able to query your historical records (and easily extra aggregates, statistics etc) and
django-reversion to save each version as a json object, so no extra tables will be&amp;nbsp;created.&lt;/p&gt;
&lt;p&gt;All three solutions for auditing have been implemented in a sample project at &lt;a class="reference external" href="https://github.com/spapas/auditing-sample"&gt;https://github.com/spapas/auditing-sample&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;You can clone the project and, preferrably in a virtual environment, install requirements (&lt;tt class="docutils literal"&gt;pip install &lt;span class="pre"&gt;-r&lt;/span&gt; requirements.txt&lt;/tt&gt;),
do a migrate (&lt;tt class="docutils literal"&gt;python manage.py migrate&lt;/tt&gt; &amp;#8212; uses sqlite3 by default) and run the local development
server (&lt;tt class="docutils literal"&gt;python manage.py ruinserver&lt;/tt&gt;).&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="python"></category><category term="auditing"></category></entry><entry><title>Change the primary color of bootstrap materialÂ design</title><link href="https://spapas.github.io/2014/12/16/change-bootstrap-material-primary-color/" rel="alternate"></link><published>2014-12-16T16:20:00+02:00</published><updated>2014-12-16T16:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2014-12-16:/2014/12/16/change-bootstrap-material-primary-color/</id><summary type="html">&lt;p class="first last"&gt;A tutorial to help users change the primary color of Bootstrap material&amp;nbsp;design&lt;/p&gt;
</summary><content type="html">&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/FezVrasta/bootstrap-material-design"&gt;Bootstrap Material Design&lt;/a&gt; is a great theme that sits on top of &lt;a class="reference external" href="http://getbootstrap.com/"&gt;Bootstrap&lt;/a&gt; and transforms it to
&lt;a class="reference external" href="http://www.google.com/design/spec/material-design/introduction.html"&gt;Material Design&lt;/a&gt;! The great thing about Bootstrap Material Design is that you just need to include
its css and js files after your Bootstrap files and&amp;nbsp;&amp;#8230;&lt;/p&gt;
&lt;p&gt;boom! Your page is Material Design&amp;nbsp;compatible!&lt;/p&gt;
&lt;object data="https://google.github.io/material-design-icons/action/svg/ic_thumb_up_24px.svg" type="image/svg+xml"&gt;
&lt;/object&gt;
&lt;p&gt;A nice feature of Bootstrap Material Design is that you can change its default color to a new one (I
don&amp;#8217;t really like the current - greenish one). This is easy for people with less skills however I
found it rather challenging when I tried it. That&amp;#8217;s why I will present a step by step tutorial on
changing the default primary color of the Bootstrap Material Design&amp;nbsp;theme:&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="step-1-get-the-code"&gt;
&lt;h2&gt;Step 1: Get the&amp;nbsp;code&lt;/h2&gt;
&lt;p&gt;Use git to make a local clone of the project with &lt;tt class="docutils literal"&gt;git clone &lt;span class="pre"&gt;https://github.com/FezVrasta/bootstrap-material-design.git&lt;/span&gt;&lt;/tt&gt;. This will create a directory
named &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;bootstrap-material-design&lt;/span&gt;&lt;/tt&gt;. Or you can download the latest version of the code using (&lt;a class="reference external" href="https://github.com/FezVrasta/bootstrap-material-design/archive/master.zip"&gt;https://github.com/FezVrasta/bootstrap-material-design/archive/master.zip&lt;/a&gt;)
and unzip it to the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;bootstrap-material-design&lt;/span&gt;&lt;/tt&gt; directory.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="step-2-install-node-js-and-npm"&gt;
&lt;h2&gt;Step 2: Install node.js and&amp;nbsp;npm&lt;/h2&gt;
&lt;p&gt;You need to have &lt;a class="reference external" href="http://nodejs.org/"&gt;node.js&lt;/a&gt; and npm installed in your system - this is something very easy so I won&amp;#8217;t go into any details about this. After you have installed
both node.js and npm you need to put them in your path so that you&amp;#8217;ll be able to run &lt;tt class="docutils literal"&gt;npm &lt;span class="pre"&gt;-v&lt;/span&gt;&lt;/tt&gt; without errors and receive something like &lt;tt class="docutils literal"&gt;1.4.14&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="step-3-install-less"&gt;
&lt;h2&gt;Step 3: Install&amp;nbsp;less&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://lesscss.org/"&gt;less&lt;/a&gt; is a &lt;span class="caps"&gt;CSS&lt;/span&gt; preprocessor in which Bootstrap Material Design has been written. To install it, just enter the command &lt;tt class="docutils literal"&gt;npm install &lt;span class="pre"&gt;-g&lt;/span&gt; less&lt;/tt&gt;. After that
you should have a command named &lt;tt class="docutils literal"&gt;lessc&lt;/tt&gt; which, when run would output something like: &lt;tt class="docutils literal"&gt;lessc 2.1.1 (Less Compiler) [JavaScript]&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="step-4-create-the-customizations-files"&gt;
&lt;h2&gt;Step 4: Create the customizations&amp;nbsp;files&lt;/h2&gt;
&lt;p&gt;Go to the directory where you cloned (or unzipped) the Bootstrap Material Design code and create a file named &lt;tt class="docutils literal"&gt;custom.less&lt;/tt&gt; (so, that file should be
in the same folder as with &lt;tt class="docutils literal"&gt;bower.json&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;Gruntfile.js&lt;/tt&gt; etc) with the following&amp;nbsp;contents:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;#64;import &amp;quot;less/material.less&amp;quot;;

// Override &amp;#64;primary color with one took from _colors.less
&amp;#64;primary: &amp;#64;indigo;
&lt;/pre&gt;
&lt;p&gt;(I wanted to use the indigo color as my primary one - you may of course use whichever color from the ones defined in &lt;tt class="docutils literal"&gt;less/_variables.less&lt;/tt&gt; you&amp;nbsp;like)&lt;/p&gt;
&lt;p&gt;This file may contain other default values for variables - if I find anything useful I will add it to this post (also please reply with any&amp;nbsp;recommendations).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update 13/10/2015&lt;/strong&gt; After a request from commenter Jofferson Ramirez Tiquez, here&amp;#8217;s a custom.less that overrides more colors from &lt;tt class="docutils literal"&gt;_variables.css&lt;/tt&gt;
(beyond the primary color, it changes the success color to teal and info and warning to the corresponding hex color&amp;nbsp;values):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;#64;import &amp;quot;less/material.less&amp;quot;;

&amp;#64;primary: &amp;#64;indigo;
&amp;#64;success: &amp;#64;teal;
&amp;#64;info: #CFD8DC;
&amp;#64;warning:#455A64;
&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Update 08/02/2017&lt;/strong&gt; Commenter Enrique SIlva informed me that the names of these color variables have been changed to
&lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;#64;brand-primary&lt;/span&gt;&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;#64;brand-success&lt;/span&gt;&lt;/tt&gt; etc (as can be seen on &lt;tt class="docutils literal"&gt;less/_variables.less&lt;/tt&gt;) so you must change them accordingly when overriding&amp;nbsp;them!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="step-5-create-your-custom-material-css-file"&gt;
&lt;h2&gt;Step 5: Create your custom material css&amp;nbsp;file&lt;/h2&gt;
&lt;p&gt;Finally, run the following command: &lt;tt class="docutils literal"&gt;lessc custom.less&amp;nbsp; &amp;gt; &lt;span class="pre"&gt;material-custom.css&lt;/span&gt;&lt;/tt&gt;. This will create a file named &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;material-custom.css&lt;/span&gt;&lt;/tt&gt; that contains your
custom version of Bootstrap Material Design! If you want your &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;material-custom.css&lt;/span&gt;&lt;/tt&gt; to be compressed, add the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;-x&lt;/span&gt;&lt;/tt&gt; option like this:  &lt;tt class="docutils literal"&gt;lessc &lt;span class="pre"&gt;-x&lt;/span&gt; custom.less&amp;nbsp; &amp;gt; &lt;span class="pre"&gt;material-custom.css&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;You may now include &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;material-custom.css&lt;/span&gt;&lt;/tt&gt; instead of &lt;tt class="docutils literal"&gt;material.css&lt;/tt&gt; (or the minified version of it) to your projects and you&amp;#8217;ll have your own primary&amp;nbsp;color!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update 09/06/2016&lt;/strong&gt;: After some comments I returned to this blog post and tried to re-create the custom
css file. Unfortunately, for the latest versions of the bootstrap-material-design, the above step by step instructions need to be changed in two&amp;nbsp;places:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Step 1: Instead of only the bootstrap-material-design code, you also need to retrieve the code of the original bootstrap. To do that you can do a &lt;tt class="docutils literal"&gt;git clone &lt;span class="pre"&gt;https://github.com/twbs/bootstrap.git&lt;/span&gt;&lt;/tt&gt; so that you&amp;#8217;ll have the bootstrap directory next to the bootstrap-material-design directory. Be careful on that, you should have two directories side by side, one containing the bootstrap code and another containing the bootstrap-material-design code. This is required because bootstrap-material-design references some bootstrap variables (from &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;less/_import-bs-less.less&lt;/span&gt;&lt;/tt&gt;).&lt;/li&gt;
&lt;li&gt;Step 4: For the customizations file (&lt;tt class="docutils literal"&gt;custom.less&lt;/tt&gt;), you should change the line &lt;tt class="docutils literal"&gt;&amp;#64;import &amp;quot;less/material.less&amp;quot;;&lt;/tt&gt; to &lt;tt class="docutils literal"&gt;&amp;#64;import &lt;span class="pre"&gt;&amp;quot;less/bootstrap-material-design.less&amp;quot;;&lt;/span&gt;&lt;/tt&gt; because the name of that file has been&amp;nbsp;changed.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;After these two changes you should once again be able to create your custom css&amp;nbsp;file!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update 03/07/2017&lt;/strong&gt; Commenter Nuraan Bader informed of an &lt;cite&gt;NameError: variable &amp;#64;line-height-base is undefined&lt;/cite&gt; error when
creating the custom css file. This is because bootstrap has changed the default branch from &lt;cite&gt;master&lt;/cite&gt; to &lt;cite&gt;v4-dev&lt;/cite&gt;
so when you clone you&amp;#8217;ll get the &lt;cite&gt;v4-dev&lt;/cite&gt; branch instead of the &lt;cite&gt;master&lt;/cite&gt; one! To fix this, after you clone (check out
my 09/06/2016 update) do the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
cd bootstrap
git checkout master
&lt;/pre&gt;
&lt;p&gt;This should change the current branch to master and you should see the &lt;cite&gt;less&lt;/cite&gt; folder inside the &lt;cite&gt;bootstrap&lt;/cite&gt; folder. After that everything should work as&amp;nbsp;expected.&lt;/p&gt;
&lt;/div&gt;
</content><category term="css"></category><category term="css"></category><category term="design"></category><category term="boostrap-material-design"></category><category term="less"></category><category term="node.js"></category></entry><entry><title>Retrieving Gmail blockedÂ attachments</title><link href="https://spapas.github.io/2014/10/23/retrieve-gmail-blocked-attachments/" rel="alternate"></link><published>2014-10-23T14:20:00+03:00</published><updated>2014-10-23T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2014-10-23:/2014/10/23/retrieve-gmail-blocked-attachments/</id><summary type="html">&lt;p class="first last"&gt;A method to retrieve blocked attachments from your&amp;nbsp;Gmail&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Before services like Dropbox were widely available, some people (including me) were using
their Gmail account as a primitive backup solution: Compress your directory and send it to
your gmail. There. Backup&amp;nbsp;complete.&lt;/p&gt;
&lt;p&gt;However, nothing is so&amp;nbsp;easy&amp;#8230;&lt;/p&gt;
&lt;p&gt;Recently, I wanted to retrieve one of these backups, a .rar containing the complete
source code (since it was written in TeX) of my PhD thesis. The problem was that Gmail blocked the access to these attachments&amp;nbsp;saying&lt;/p&gt;
&lt;blockquote&gt;
Anti-virus warning - 1 attachment contains a virus or blocked file. Downloading this attachment is disabled.&lt;/blockquote&gt;
&lt;p&gt;probably because I had a number of .bat files inside that .rar archive to automate my work&amp;nbsp;:(&lt;/p&gt;
&lt;p&gt;Now what&amp;nbsp;?&lt;/p&gt;
&lt;p&gt;After searching the internet and not founding any solutions, I tried the options that gmail gives for each email. One
particular one cought my interest: &lt;em&gt;Show&amp;nbsp;original&lt;/em&gt;&lt;/p&gt;
&lt;img alt="Here it is!" src="/images/show_original.png" style="width: 780px;" /&gt;
&lt;p&gt;Clicking this option opened a text file with the original, &lt;span class="caps"&gt;MIME&lt;/span&gt; encoded message. The interesting thing of course&amp;nbsp;was&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
------=_NextPart_000_004F_01CA0AED.E63C2A30
Content-Type: application/octet-stream;
      name=&amp;quot;phdstuff.rar&amp;quot;
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
      filename=&amp;quot;phdstuff.rar&amp;quot;

UmFyIRoHAM+QcwAADQAAAAAAAAB0f3TAgCwANAMAAFQEAAACRbXCx8lr9TodMwwAIAAAAG5ld2Zp
bmFsLnR4dA3dEQzM082BF7sB+D3q6QPUNEfwG7vHQgNkiQDTkGvfhOE4mNltIJJlBFMOCQPzPeKD
...
&lt;/pre&gt;
&lt;p&gt;So the whole attachment was contained in that text file, encoded in base64! Now I just
needed to extract it from the email and convert it back to&amp;nbsp;binary.&lt;/p&gt;
&lt;blockquote&gt;
&lt;strong&gt;Important: Before going the python way, please check the 2 June 2015 update at the end of the article for an easier solution!&lt;/strong&gt;&lt;/blockquote&gt;
&lt;p&gt;This was very easy to do using Python - some people &lt;a class="reference external" href="http://stackoverflow.com/questions/4067937/getting-mail-attachment-to-python-file-object"&gt;had already asked the same thing on &lt;span class="caps"&gt;SO&lt;/span&gt;&lt;/a&gt;.
So here&amp;#8217;s a simple program that gets an email in text/mime format as input and dumps all&amp;nbsp;attachments:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;email&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Please enter a file to extract attachments from&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;email&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;message_from_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;pl&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_payload&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_filename&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt; &lt;span class="c1"&gt;# if it is an attachment&lt;/span&gt;
            &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_filename&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;pl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_payload&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Save this to a file named &lt;tt class="docutils literal"&gt;get_attachments.py&lt;/tt&gt; and, after saving the original message to a file
named &lt;tt class="docutils literal"&gt;0.txt&lt;/tt&gt; run &lt;tt class="docutils literal"&gt;python get_attachments.py 0.txt&lt;/tt&gt; and you&amp;#8217;ll see the attachments of your email in the same&amp;nbsp;folder!&lt;/p&gt;
&lt;blockquote&gt;
Disclaimer: I have to warn you that since Gmail claims that an attachment is &lt;em&gt;not safe&lt;/em&gt; it may be &lt;strong&gt;actually not safe&lt;/strong&gt;. So
you must be 100% sure that you know what you are doing before retrievening your email attachments like this.&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;: Stefan &lt;a class="reference external" href="https://gist.github.com/stefansundin/a99bbfb6cda873d14fd2"&gt;created an improved version&lt;/a&gt; of the attachment extractor which is also compatible with Python&amp;nbsp;3.4!&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update, 12 January 2015&lt;/strong&gt;: Ivana (at the comments section) proposed a different solution that may work
for some files: &lt;em&gt;Use a mobile Gmail client (I tested it with Android) and &amp;#8220;Save to Drive&amp;#8221; your attachment.
You&amp;#8217;ll then be able to download it from the Google Drive!&lt;/em&gt; I am not sure if this works for all attachments,
however it worked for the source of my PhD thesis! I&amp;#8217;m writing it may not work for all attachments because
when you download something from Google Drive it does a virus check so it may not allow you to download the
attachment and then  you&amp;#8217;ll still need to do it manually using the method below (however &lt;strong&gt;in that case you
must be even more cautious for the case the attachment actualyl contains a malicious file&lt;/strong&gt;).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update, 2 June 2015&lt;/strong&gt;: Commenter Sumit Chauhan (and Yuri Marx) proposed to change the extension
of the downloaded &lt;span class="caps"&gt;MIME&lt;/span&gt; text file (original message) to eml and open it with Outlook. I don&amp;#8217;t have
Outlook in my system, however I tried opening it with &lt;a class="reference external" href="https://www.mozilla.org/el/thunderbird/"&gt;Thunderbird&lt;/a&gt; and it worked!!! So please
try this solution before trying the pythonic way (especially if you&amp;#8217;re not familiar with&amp;nbsp;python).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update, 6 March 2016&lt;/strong&gt;: Commenter Alex (Alexandre Barfuhok) proposed another clever trick (involving making visible
the initially invisible &amp;#8220;Download to drive&amp;#8221; button) for retrieving gmail blocked attachments!
Read more about it &lt;a class="reference external" href="http://www.barfuhok.com/how-to-download-a-file-with-anti-virus-warning-on-gmail/"&gt;at his article&lt;/a&gt;!&lt;/p&gt;
</content><category term="python"></category><category term="gmail"></category><category term="python"></category><category term="security"></category><category term="google"></category></entry><entry><title>Django non-HTMLÂ responses</title><link href="https://spapas.github.io/2014/09/15/django-non-html-responses/" rel="alternate"></link><published>2014-09-15T14:20:00+03:00</published><updated>2014-09-15T14:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2014-09-15:/2014/09/15/django-non-html-responses/</id><summary type="html">&lt;p class="first last"&gt;Implementing non-&lt;span class="caps"&gt;HTML&lt;/span&gt; (for instance &lt;span class="caps"&gt;CSV&lt;/span&gt;, &lt;span class="caps"&gt;XSL&lt;/span&gt;, etc) responses with Django and Class Based&amp;nbsp;Views&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#how-are-cbvs-rendered" id="id2"&gt;How are CBVs&amp;nbsp;rendered&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#rendering-to-non-html" id="id3"&gt;Rendering to non-&lt;span class="caps"&gt;HTML&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-non-html-mixin" id="id4"&gt;A non-&lt;span class="caps"&gt;HTML&lt;/span&gt;&amp;nbsp;mixin&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-more-complex-example" id="id5"&gt;A more complex&amp;nbsp;example&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id6"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I have already written about the many advantages (&lt;span class="caps"&gt;DRY&lt;/span&gt;!) of using &lt;a class="reference external" href="https://spapas.github.io/2014/04/11/django-generic-formviews-for-objects/"&gt;CBVs in a previous article.&lt;/a&gt;
In this article I will present the correct (pythonic) way to allow a normal &lt;span class="caps"&gt;CBV&lt;/span&gt; to return non-&lt;span class="caps"&gt;HTML&lt;/span&gt; responses, like &lt;span class="caps"&gt;PDF&lt;/span&gt;, &lt;span class="caps"&gt;CSV&lt;/span&gt;, &lt;span class="caps"&gt;XSL&lt;/span&gt;&amp;nbsp;etc.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="how-are-cbvs-rendered"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;How are CBVs&amp;nbsp;rendered&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Before proceeding, we need to understand how CBVs are rendered. By walking through the
class hierarchy in the &lt;a class="reference external" href="http://ccbv.co.uk/"&gt;&lt;span class="caps"&gt;CBV&lt;/span&gt; inspector&lt;/a&gt;, we can see that
all the normal Django CBVs (DetailView, CreateView, TemplateView etc) are using a mixin
named &lt;a class="reference external" href="http://ccbv.co.uk/projects/Django/1.7/django.views.generic.base/TemplateResponseMixin/"&gt;TemplateResponseMixin&lt;/a&gt; which defines a method named &lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt;. This
is the method that is used for rendering the output of the Views. Let&amp;#8217;s take a look at
&lt;a class="reference external" href="http://ccbv.co.uk/projects/Django/1.7/django.views.generic.base/TemplateResponseMixin/"&gt;how it is defined&lt;/a&gt; (I&amp;#8217;ll remove the&amp;nbsp;comments):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TemplateResponseMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;template_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;
  &lt;span class="n"&gt;response_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TemplateResponse&lt;/span&gt;
  &lt;span class="n"&gt;content_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setdefault&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;content_type&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;response_class&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
          &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_template_names&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
          &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;
      &lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_template_names&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;template_name&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="n"&gt;ImproperlyConfigured&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
              &lt;span class="s2"&gt;&amp;quot;TemplateResponseMixin requires either a definition of &amp;quot;&lt;/span&gt;
              &lt;span class="s2"&gt;&amp;quot;&amp;#39;template_name&amp;#39; or an implementation of &amp;#39;get_template_names()&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;template_name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This method will try to find out which html template should be used to render the View
(using the  &lt;tt class="docutils literal"&gt;get_template_names&lt;/tt&gt; method and template_name attribute of the mixin) and
then render this view by instantiating an instance of the &lt;tt class="docutils literal"&gt;TemplateResponse&lt;/tt&gt; class
(as defined in the &lt;tt class="docutils literal"&gt;response_class&lt;/tt&gt; attribute)
and passing the request, template, context and other response_args to&amp;nbsp;it.&lt;/p&gt;
&lt;p&gt;The &lt;a class="reference external" href="https://github.com/django/django/blob/master/django/template/response.py"&gt;TemplateResponse&lt;/a&gt; class which is instantiated in the &lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt; method
inherits from a normal &lt;tt class="docutils literal"&gt;HttpResponse&lt;/tt&gt; and is used to render
the template passed to it as a&amp;nbsp;parameter.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="rendering-to-non-html"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Rendering to non-&lt;span class="caps"&gt;HTML&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;From the previous discussion we can conclude that if your non-&lt;span class="caps"&gt;HTML&lt;/span&gt; response &lt;em&gt;needs&lt;/em&gt;
a template then you just need to create a subclass of &lt;tt class="docutils literal"&gt;TemplateResponse&lt;/tt&gt; and
assign it to the &lt;tt class="docutils literal"&gt;response_class&lt;/tt&gt; attribute (and also change the &lt;tt class="docutils literal"&gt;content_type&lt;/tt&gt;
attribute). On the other hand, if your non-&lt;span class="caps"&gt;HTML&lt;/span&gt; respond does not need a template
to be rendered then you have to override &lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt; completely
(since the template parameter does not need to be passed now) and either define
a subclass of HttpResponse or do the rendering in the&amp;nbsp;render_to_response.&lt;/p&gt;
&lt;p&gt;Since almost always you won&amp;#8217;t need a template to create a non-&lt;span class="caps"&gt;HTML&lt;/span&gt; view and because
I believe that the solution is &lt;span class="caps"&gt;DRY&lt;/span&gt;-enough by implementing the rendering code to
the &lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt; method (&lt;em&gt;without&lt;/em&gt; subclassing &lt;tt class="docutils literal"&gt;HttpResponse&lt;/tt&gt;) I will
implement a mixin that does exactly&amp;nbsp;that.&lt;/p&gt;
&lt;p&gt;Subclassing &lt;tt class="docutils literal"&gt;HttpResponse&lt;/tt&gt; will not make our design more &lt;span class="caps"&gt;DRY&lt;/span&gt; because for every
subclass of &lt;tt class="docutils literal"&gt;HttpResponse&lt;/tt&gt; the &lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt; method would also need to
be modified (by subclassing &lt;tt class="docutils literal"&gt;TemplateResponseMixin) to instantiate the subclass of ``HttpResponse&lt;/tt&gt; with the correct parameters.
For instance, the existing &lt;tt class="docutils literal"&gt;TemplateResponseMixin&lt;/tt&gt; cannot be used if the subclass
of &lt;tt class="docutils literal"&gt;HttpResponse&lt;/tt&gt; does not take a template as a parameter (solutions like
passing None to the template parameter are signals of bad&amp;nbsp;design).&lt;/p&gt;
&lt;p&gt;In any case, changing just the &lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt; method using a Mixin is in my opinion the best solution
to the above problem.
A &lt;a class="reference external" href="http://stackoverflow.com/questions/533631/what-is-a-mixin-and-why-are-they-useful"&gt;Mixin&lt;/a&gt; is a simple class that can be used to extend other classes either by overriding functionality of the base class or
by adding extra features. Django CBVs use various &lt;a class="reference external" href="https://docs.djangoproject.com/en/dev/topics/class-based-views/mixins/"&gt;mixins&lt;/a&gt; to extend the base Views and add&amp;nbsp;functionality.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="a-non-html-mixin"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;A non-&lt;span class="caps"&gt;HTML&lt;/span&gt;&amp;nbsp;mixin&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;So, a basic skeleton for our mixin would be something like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;NonHtmlResponseMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text/plain&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Hello, world&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The previous mixin overrides the render_to_response method to just return the text &amp;#8220;Hello, world&amp;#8221;. For instance
we could define the following&amp;nbsp;class:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DummyTextResponseView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NonHtmlResponseMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TemplateView&lt;/span&gt;&lt;span class="p"&gt;,):&lt;/span&gt;
  &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;which can be added as a route to &lt;tt class="docutils literal"&gt;urls.py&lt;/tt&gt; (using the &lt;tt class="docutils literal"&gt;as_view&lt;/tt&gt; method) and will always return the &amp;#8220;Hello, world&amp;#8221;&amp;nbsp;text.&lt;/p&gt;
&lt;p&gt;Here&amp;#8217;s something more complicated: A Mixin that can be used along with a DetailView and will output the properties of the
object as&amp;nbsp;text:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TextPropertiesResponseMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text/plain; charset=utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;o&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_object&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
      &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_meta&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;
      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_meta&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;{0}: {1}&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="nb"&gt;unicode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;o&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__dict__&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and can be used like&amp;nbsp;this&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TextPropertiesDetailView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TextPropertiesResponseMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;FooDetailView&lt;/span&gt;&lt;span class="p"&gt;,):&lt;/span&gt;
  &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above mixin will use the get_object() method of the DetailView to get the object and then output
it as text. We can create similar mixins that will integrate with other types of CBVs, for instance
to export a ListView as an &lt;span class="caps"&gt;CSV&lt;/span&gt; or generate an png from a DetailView of an Image&amp;nbsp;file.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="a-more-complex-example"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;A more complex&amp;nbsp;example&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The previous examples all built upon an existing view (either a TemplateView, a DetailView or a ListView).
However, an existing view that will fit our requirements won&amp;#8217;t always be available. For instance,
sometimes I want to export data from my database using a raw &lt;span class="caps"&gt;SQL&lt;/span&gt; query. Also I&amp;#8217;d like to be able to easily
export this data as csv or&amp;nbsp;excel.&lt;/p&gt;
&lt;p&gt;First of all, we need to define a view that will inherit from &lt;tt class="docutils literal"&gt;View&lt;/tt&gt; and export the data as a &lt;span class="caps"&gt;CSV&lt;/span&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;unicodecsv&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;View&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CsvRawSqlExportView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;View&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;sql&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;select 1+1&amp;#39;&lt;/span&gt;
  &lt;span class="n"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;res&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
  &lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;generate_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetchall&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
              &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt;

      &lt;span class="n"&gt;cursor&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
      &lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;generator&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;generate_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cursor&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;generator&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;generator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text/plain; charset=utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-Disposition&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;attachment; filename=export.csv&amp;#39;&lt;/span&gt;
      &lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;unicodecsv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writerow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;generator&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
          &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;writerow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above View has three attributes:
* sql, which is a string with the raw sql that will be executed
* headers, which is an array with the names of each header of the resulting data
* params, which is an array with parameters that may need to be passed to the&amp;nbsp;query&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;get&lt;/tt&gt; method executes the query and passes the result to &lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt;
using a generator.  The &lt;tt class="docutils literal"&gt;render_to_response&lt;/tt&gt; method instantiates an HttpResponse
object with the correct attributes and writes the &lt;span class="caps"&gt;CSV&lt;/span&gt; to the response object using&amp;nbsp;unicodecsv.&lt;/p&gt;
&lt;p&gt;We can now quickly create a route that will export data from the users&amp;nbsp;table:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^raw_export_users/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CsvRawSqlExportView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;select id, username from auth_user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;raw_export_users&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If instead of &lt;span class="caps"&gt;CSV&lt;/span&gt; we wanted to export to &lt;span class="caps"&gt;XLS&lt;/span&gt; (using xlwt), we&amp;#8217;d just need to create a&amp;nbsp;Mixin:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;XlsRawSqlResponseMixin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render_to_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;generator&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;response_kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
      &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;application/ms-excel&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Content-Disposition&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;attachment; filename=export.xls&amp;#39;&lt;/span&gt;
      &lt;span class="n"&gt;wb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;xlwt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Workbook&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;ws&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;wb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_sheet&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;data&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
              &lt;span class="n"&gt;ws&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;generator&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
          &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;row&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
              &lt;span class="n"&gt;ws&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

      &lt;span class="n"&gt;wb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and create a View that inherits from &lt;tt class="docutils literal"&gt;CsvRawSqlExportView&lt;/tt&gt; and uses the above&amp;nbsp;mixin:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;XlsRawSqlExportView&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;XlsRawSqlResponseMixin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;CsvRawSqlExportView&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and route to that view to get the &lt;span class="caps"&gt;XLS&lt;/span&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^raw_export_users/$&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;views&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;XlsRawSqlExportView&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_view&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;sql&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;select id, username from auth_user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;username&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;raw_export_users&amp;#39;&lt;/span&gt;
&lt;span class="p"&gt;),&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using the above techniques we can define CBVs that will output their content in various content types
beyond &lt;span class="caps"&gt;HTML&lt;/span&gt;. This will help us write write clean and &lt;span class="caps"&gt;DRY&lt;/span&gt;&amp;nbsp;code.&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="python"></category><category term="cbv"></category><category term="class-based-views"></category></entry><entry><title>Implementing a simple, Heroku-hosted REST service using Flask andÂ mongoDB</title><link href="https://spapas.github.io/2014/06/30/rest-flask-mongodb-heroku/" rel="alternate"></link><published>2014-06-30T15:23:00+03:00</published><updated>2014-06-30T15:23:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2014-06-30:/2014/06/30/rest-flask-mongodb-heroku/</id><summary type="html">&lt;p class="first last"&gt;An implementation &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; discussion of a simple &lt;span class="caps"&gt;REST&lt;/span&gt; service with Flask that is hosted on Heroku and is using mongoDB for&amp;nbsp;persistance.&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#requirements" id="id2"&gt;Requirements&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#implementing-the-rest-service" id="id3"&gt;Implementing the &lt;span class="caps"&gt;REST&lt;/span&gt;&amp;nbsp;service&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#testing-it-locally" id="id4"&gt;Testing it&amp;nbsp;locally&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#deploying-to-heroku" id="id5"&gt;Deploying to&amp;nbsp;Heroku&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the following, I will describe how I used &lt;a class="reference external" href="http://flask.pocoo.org/"&gt;Flask&lt;/a&gt;, a very nice web &lt;em&gt;microframework&lt;/em&gt; for python along  with &lt;a class="reference external" href="http://www.mongodb.org/"&gt;mongoDB&lt;/a&gt;, the most
popular No-&lt;span class="caps"&gt;SQL&lt;/span&gt; database to implement a simple &lt;span class="caps"&gt;REST&lt;/span&gt; service that was hosted on &lt;a class="reference external" href="https://dashboard.heroku.com/apps"&gt;Heroku&lt;/a&gt;. This &lt;span class="caps"&gt;REST&lt;/span&gt; service would get readings from
a number of sensors from an Android&amp;nbsp;device.&lt;/p&gt;
&lt;p&gt;I chose Flask instead of Django mainly because the &lt;span class="caps"&gt;REST&lt;/span&gt; service that I needed to implement would be very simple and most of
the Django bells and whistles (&lt;span class="caps"&gt;ORM&lt;/span&gt;, auth, admin, etc) wouldn&amp;#8217;t be needed anyway. Also, Flask is much quicker to set-up than
Django since almost everything (views, urls, etc) can be put inside one python&amp;nbsp;module.&lt;/p&gt;
&lt;p&gt;Concerning the choice of a NoSQL persistance solution (mongoDB), I wanted to have a table (or collection as it is called in the
mongoDB world) of readings from the sensor. Each reading would just have a timestamp and various other
arbitrary data depending on the type of the reading, so saving it as a &lt;span class="caps"&gt;JSON&lt;/span&gt; document in a NoSQL database is a good&amp;nbsp;solution.&lt;/p&gt;
&lt;p&gt;Finally, all the above will be deployed to Heroku which offers some great services for deploying python code in the&amp;nbsp;cloud.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="requirements"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Requirements&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I propose creating a file named &lt;tt class="docutils literal"&gt;requirements.txt&lt;/tt&gt; that will host the required packages for your project, so you will be
able to setup your projects after creating a virtual environment with &lt;a class="reference external" href="http://virtualenv.readthedocs.org/en/latest/"&gt;virtualenv&lt;/a&gt; just by running &lt;tt class="docutils literal"&gt;pip install &lt;span class="pre"&gt;-r&lt;/span&gt; requirements.txt&lt;/tt&gt;.
Also, the requirements.txt is required for deploying python to&amp;nbsp;Heroku.&lt;/p&gt;
&lt;p&gt;So, for my case, the contents of requirements.txt are the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
Flask==0.10.1
Flask-PyMongo==0.3.0
Flask-RESTful==0.2.12
Jinja2==2.7.3
MarkupSafe==0.23
Werkzeug==0.9.6
aniso8601==0.82
gunicorn==19.0.0
itsdangerous==0.24
pymongo==2.7.1
pytz==2014.4
six==1.7.2
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Flask-PyMongo is a simple wrapper for Flask around pymongo which is the python mongoDB&amp;nbsp;driver.&lt;/li&gt;
&lt;li&gt;Flask-RESTful is a simple library for creating &lt;span class="caps"&gt;REST&lt;/span&gt; APIs - it needs aniso8601 and&amp;nbsp;pytz.&lt;/li&gt;
&lt;li&gt;Jinja2 is the template library for Flask (we won&amp;#8217;t use it but it is required by Flask installation) - it needs&amp;nbsp;MarkupSafe.&lt;/li&gt;
&lt;li&gt;Werkzeug is a &lt;span class="caps"&gt;WSGI&lt;/span&gt; utility library - required by&amp;nbsp;Flask&lt;/li&gt;
&lt;li&gt;gunicorn is a &lt;span class="caps"&gt;WSGI&lt;/span&gt; &lt;span class="caps"&gt;HTTP&lt;/span&gt; server - needed for deployment to&amp;nbsp;Heroku&lt;/li&gt;
&lt;li&gt;itsdangerous is used to sign data for usage in untrusted&amp;nbsp;environments&lt;/li&gt;
&lt;li&gt;six is the python 2/3 compatibility&amp;nbsp;layer&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="implementing-the-rest-service"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Implementing the &lt;span class="caps"&gt;REST&lt;/span&gt;&amp;nbsp;service&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Instead of using just one single file for our Flask web application, we will create a python module to contain it and a
file named &lt;tt class="docutils literal"&gt;runserver.py&lt;/tt&gt; that will start a local development server to test&amp;nbsp;it:&lt;/p&gt;
&lt;p&gt;So, in the same folder as the &lt;tt class="docutils literal"&gt;requirements.txt&lt;/tt&gt; create a folder named &lt;tt class="docutils literal"&gt;flask_rest_service&lt;/tt&gt; and in there put
two files: &lt;tt class="docutils literal"&gt;__init__.py&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;resources.py&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;__init__.py&lt;/tt&gt; initializes our Flask application, our mongoDB connection and our Flask-RESTful&amp;nbsp;api:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
import os
from flask import Flask
from flask.ext import restful
from flask.ext.pymongo import PyMongo
from flask import make_response
from bson.json_util import dumps

MONGO_URL = os.environ.get('MONGO_URL')
if not MONGO_URL:
    MONGO_URL = &amp;quot;mongodb://localhost:27017/rest&amp;quot;;

app = Flask(__name__)

app.config['MONGO_URI'] = MONGO_URL
mongo = PyMongo(app)

def output_json(obj, code, headers=None):
    resp = make_response(dumps(obj), code)
    resp.headers.extend(headers or {})
    return resp

DEFAULT_REPRESENTATIONS = {'application/json': output_json}
api = restful.Api(app)
api.representations = DEFAULT_REPRESENTATIONS

import flask_rest_service.resources
&lt;/pre&gt;
&lt;p&gt;So what happens here? After the imports, we check if we have a MONGO_URL environment variable. This is
how we set options in Heroku. If such option does not exist in the environment then we are in our
development environment so we set it to the localhost (we must have a running mongoDB installation in
our dev&amp;nbsp;environment).&lt;/p&gt;
&lt;p&gt;In the next lines, we initialize our Flask application and our mongoDB connection (pymongo
uses a &lt;tt class="docutils literal"&gt;MONGO_URI&lt;/tt&gt; configuration option to know the database &lt;span class="caps"&gt;URI&lt;/span&gt;).&lt;/p&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;output_json&lt;/tt&gt; is used to dump the &lt;span class="caps"&gt;BSON&lt;/span&gt; encoded mongoDB objects to &lt;span class="caps"&gt;JSON&lt;/span&gt; and was borrowed from
&lt;a class="reference external" href="http://blog.alienretro.com/using-mongodb-with-flask-restful/"&gt;alienretro&amp;#8217;s blog&lt;/a&gt; &amp;#8212; we initialize our restful &lt;span class="caps"&gt;REST&lt;/span&gt; &lt;span class="caps"&gt;API&lt;/span&gt; with this&amp;nbsp;function.&lt;/p&gt;
&lt;p&gt;Finally, we import the &lt;tt class="docutils literal"&gt;resources.py&lt;/tt&gt; module which actually defines our &lt;span class="caps"&gt;REST&lt;/span&gt;&amp;nbsp;resources.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
import json
from flask import request, abort
from flask.ext import restful
from flask.ext.restful import reqparse
from flask_rest_service import app, api, mongo
from bson.objectid import ObjectId

class ReadingList(restful.Resource):
    def __init__(self, *args, **kwargs):
        self.parser = reqparse.RequestParser()
        self.parser.add_argument('reading', type=str)
        super(ReadingList, self).__init__()

    def get(self):
        return  [x for x in mongo.db.readings.find()]

    def post(self):
        args = self.parser.parse_args()
        if not args['reading']:
            abort(400)

        jo = json.loads(args['reading'])
        reading_id =  mongo.db.readings.insert(jo)
        return mongo.db.readings.find_one({&amp;quot;_id&amp;quot;: reading_id})


class Reading(restful.Resource):
    def get(self, reading_id):
        return mongo.db.readings.find_one_or_404({&amp;quot;_id&amp;quot;: reading_id})

    def delete(self, reading_id):
        mongo.db.readings.find_one_or_404({&amp;quot;_id&amp;quot;: reading_id})
        mongo.db.readings.remove({&amp;quot;_id&amp;quot;: reading_id})
        return '', 204


class Root(restful.Resource):
    def get(self):
        return {
            'status': 'OK',
            'mongo': str(mongo.db),
        }

api.add_resource(Root, '/')
api.add_resource(ReadingList, '/readings/')
api.add_resource(Reading, '/readings/&amp;lt;ObjectId:reading_id&amp;gt;')
&lt;/pre&gt;
&lt;p&gt;Here we define three &lt;tt class="docutils literal"&gt;Resource&lt;/tt&gt; classes and add them to our previously defined &lt;tt class="docutils literal"&gt;api&lt;/tt&gt;: &lt;tt class="docutils literal"&gt;Root&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;Reading&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;ReadingList&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;Root&lt;/tt&gt; just returns a dictionary with an &lt;span class="caps"&gt;OK&lt;/span&gt; status and some info on our mongodb&amp;nbsp;connection.&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;Reading&lt;/tt&gt; has gets an ObjectId
(which is the mongodb primary key) as a parameter and depending on the &lt;span class="caps"&gt;HTTP&lt;/span&gt; operation, it returns the reading with that
id when receiving an &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; and deletes the reading with that id when receiving an &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;DELETE&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;ReadingList&lt;/tt&gt; will return all readings when receiving an &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;GET&lt;/span&gt;&lt;/tt&gt; and will create a new reading when
receiving an &lt;tt class="docutils literal"&gt;&lt;span class="caps"&gt;HTTP&lt;/span&gt; &lt;span class="caps"&gt;POST&lt;/span&gt;&lt;/tt&gt; The &lt;tt class="docutils literal"&gt;post&lt;/tt&gt; function uses the parser defined in &lt;tt class="docutils literal"&gt;__init__&lt;/tt&gt; which requires
a &lt;tt class="docutils literal"&gt;reading&lt;/tt&gt; parameter with the actual reading to be&amp;nbsp;inserted.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="testing-it-locally"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Testing it&amp;nbsp;locally&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In order to run the development server, you will need to install and start mongodb locally which is beyond the scope of this post. After that
create a file named &lt;tt class="docutils literal"&gt;runserver.py&lt;/tt&gt; in the same folder as with the &lt;tt class="docutils literal"&gt;requirements.txt&lt;/tt&gt;
and the &lt;tt class="docutils literal"&gt;flask_rest_service&lt;/tt&gt; folder. The contents of this file should&amp;nbsp;be:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
from flask_rest_service import app
app.run(debug=True)
&lt;/pre&gt;
&lt;p&gt;When you run this file with &lt;tt class="docutils literal"&gt;python runserver.py&lt;/tt&gt; you should be able top visit your rest service at &lt;a class="reference external" href="http://localhost:5000"&gt;http://localhost:5000&lt;/a&gt; and get
an &amp;#8220;&lt;span class="caps"&gt;OK&lt;/span&gt;&amp;#8221;&amp;nbsp;status.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="deploying-to-heroku"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Deploying to&amp;nbsp;Heroku&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To deploy to Heroku, you must create a &lt;tt class="docutils literal"&gt;Procfile&lt;/tt&gt; that contains the workers of your application. In our case, the
&lt;tt class="docutils literal"&gt;Procfile&lt;/tt&gt; should contain the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
web: gunicorn flask_rest_service:app
&lt;/pre&gt;
&lt;p&gt;Also, you should add a .gitignore file with the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
*.pyc
&lt;/pre&gt;
&lt;p&gt;Finally, to deploy your application to Heroku you can follow the instructions here: &lt;a class="reference external" href="https://devcenter.heroku.com/articles/getting-started-with-python"&gt;https://devcenter.heroku.com/articles/getting-started-with-python&lt;/a&gt;:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Initialize a git repository and commit&amp;nbsp;everything:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code literal-block"&gt;
git init
git add .
git commit -m
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Create a new Heroku application (after logging in to heroku with &lt;tt class="docutils literal"&gt;heroku login&lt;/tt&gt;) and set the MONGO_URL environment variable (of course you have to obtain ths MONGO_URL variable for your heroku envirotnment by adding a mongoDB&amp;nbsp;database):&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code literal-block"&gt;
heroku create
heroku config:set MONGO_URL=mongodb://user:pass&amp;#64;mongoprovider.com:27409/rest
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;And finally push your master branch to the heroku remote&amp;nbsp;repository:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code literal-block"&gt;
git push heroku master
&lt;/pre&gt;
&lt;p&gt;If everything went ok you should be able to start a worker for your application, check that the worker is running, and finally visit&amp;nbsp;it:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
heroku ps:scale web=1
heroku ps
heroku open
&lt;/pre&gt;
&lt;p&gt;If everything was ok you should see an status-&lt;span class="caps"&gt;OK&lt;/span&gt; &lt;span class="caps"&gt;JSON&lt;/span&gt;&amp;nbsp;!&lt;/p&gt;
&lt;/div&gt;
</content><category term="flask"></category><category term="flask"></category><category term="mongodb"></category><category term="heroku"></category><category term="python"></category><category term="rest"></category></entry><entry><title>Django generic FormViews forÂ objects</title><link href="https://spapas.github.io/2014/04/11/django-generic-formviews-for-objects/" rel="alternate"></link><published>2014-04-11T10:23:00+03:00</published><updated>2014-04-11T10:23:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2014-04-11:/2014/04/11/django-generic-formviews-for-objects/</id><summary type="html">&lt;p class="first last"&gt;An implementation &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; discussion of generic FormViews for acting on model&amp;nbsp;instances&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-quick-introduction-to-the-formview" id="id2"&gt;A quick introduction to the &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-quick-introduction-to-the-singleobjectmixin" id="id3"&gt;A quick introduction to the &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#being-generic-and-dry" id="id4"&gt;Being generic and &lt;span class="caps"&gt;DRY&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#being-more-generic-and-dry" id="id5"&gt;Being more generic and &lt;span class="caps"&gt;DRY&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#other-options" id="id6"&gt;Other&amp;nbsp;options&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We recently needed to create a number of views for changing the status of an Application model instance for our organization.
An Application model instance can be filled and then cancelled, submitted, acceptted etc - for each of these status changes a form should be
presented to the user. When the user submits the form the status of the Application will be&amp;nbsp;changed.&lt;/p&gt;
&lt;p&gt;To implement the above requirement we created a generic FormView that acts on the specific model instance. This
used two basic &lt;span class="caps"&gt;CBV&lt;/span&gt; components: The &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt; for the form manipulation and the &lt;tt class="docutils literal"&gt;SingleObjectMixing&lt;/tt&gt; for the
object&amp;nbsp;handling.&lt;/p&gt;
&lt;p&gt;Django &lt;a class="reference external" href="https://docs.djangoproject.com/en/1.6/topics/class-based-views/"&gt;Class Based Views&lt;/a&gt; (CBVs) can be used to create reusable Views using normal class inheritance. Most
people use the well-known &lt;tt class="docutils literal"&gt;CreateView&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;UpdateView&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;DetailView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;ListView&lt;/tt&gt;, however, as we
will see below, the &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt; will help us write &lt;span class="caps"&gt;DRY&lt;/span&gt;&amp;nbsp;code.&lt;/p&gt;
&lt;p&gt;I have to notice here that an invaluable tool to help you understanding CBVs is the &lt;a class="reference external" href="http://ccbv.co.uk/"&gt;&lt;span class="caps"&gt;CBV&lt;/span&gt; inspector&lt;/a&gt; which
has a nice web interface for browsing the &lt;span class="caps"&gt;CBV&lt;/span&gt; hierarchies, attributes and&amp;nbsp;methods.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="a-quick-introduction-to-the-formview"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;A quick introduction to the &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A simple &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt; can be defined like this (&lt;a class="reference external" href="http://ccbv.co.uk/projects/Django/1.6/django.views.generic.edit/FormView/"&gt;&lt;span class="caps"&gt;CBV&lt;/span&gt; FormView&lt;/a&gt;):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class MyFormView(FormView):
  form_class = forms.MyFormView
  template_name = 'my_template.html'
&lt;/pre&gt;
&lt;p&gt;The above can be used in urls.py like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
urlpatterns = patterns('',
  url(r'^my_formview/$', views.MyFormView.as_view() , name='my_formview' ),
&lt;/pre&gt;
&lt;p&gt;This will present a form to the user when he visits the &lt;tt class="docutils literal"&gt;my_formview&lt;/tt&gt;  url &amp;#8212; however this form won&amp;#8217;t do anything. To allow
the form to actually do something when it&amp;#8217;s been submitted we need to override the &lt;tt class="docutils literal"&gt;form_valid&lt;/tt&gt; method.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
def form_valid(self, form):
    value = form.cleaned_data['value']
    messages.info(self.request, &amp;quot;MyForm submitted with value {0}!&amp;quot;.format(value) )
    return HttpResponseRedirect( reverse('my_formview') )
&lt;/pre&gt;
&lt;p&gt;As you can see the submitted form is passed in the method and can be used to receive its &lt;tt class="docutils literal"&gt;cleaned_data&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt;
has various other options for instance a &lt;tt class="docutils literal"&gt;form_invalid&lt;/tt&gt; method, an &lt;tt class="docutils literal"&gt;initial&lt;/tt&gt; attribute to set the initial values for the form&amp;nbsp;etc.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="a-quick-introduction-to-the-singleobjectmixin"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;A quick introduction to the &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; adds a number of attributes &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; methods to a view that can be used for object manipulation. The
most important ones is the &lt;tt class="docutils literal"&gt;model&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;queryset&lt;/tt&gt; attributes and the &lt;tt class="docutils literal"&gt;get_queryset&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;get_object()&lt;/tt&gt;. To use
the &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; in your &lt;span class="caps"&gt;CBV&lt;/span&gt; just add it to the list of the classes to inherit from and define either the
&lt;tt class="docutils literal"&gt;model&lt;/tt&gt; or the &lt;tt class="docutils literal"&gt;queryset&lt;/tt&gt; attribute. After that you may pass a &lt;tt class="docutils literal"&gt;pk&lt;/tt&gt; parameter to your view and you will get an
&lt;tt class="docutils literal"&gt;object&lt;/tt&gt; context variable in the template with the selected&amp;nbsp;object!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="being-generic-and-dry"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Being generic and &lt;span class="caps"&gt;DRY&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We can more or less now understand how we should use &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt; to generate our
generic &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt; for acting on objects: Our &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt; should &lt;em&gt;get&lt;/em&gt; the object using the &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;
and change it when the form is submitted using the values from the form. A first implementation would be the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class GenericObjectFormView1(FormView, SingleObjectMixin):

    def form_valid(self, form):
        obj = self.get_object()
        obj.change_status(form)
        return HttpResponseRedirect( obj.get_absolute_url() )
&lt;/pre&gt;
&lt;p&gt;So our &lt;tt class="docutils literal"&gt;GenericObjectFormView1&lt;/tt&gt; class inherits from &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;. The only thing that we have
to assure is that the Model we want to act on needs to implement a &lt;tt class="docutils literal"&gt;change_status&lt;/tt&gt; method which gets the &lt;tt class="docutils literal"&gt;form&lt;/tt&gt; and
changes the status of that object based on its value. For instance, two implementations can be the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class CancelObjectFormView(GenericObjectFormView1):
    template_name = 'cancel.html'
    form_class = forms.CancelForm
    model = models.Application

class SubmitObjectFormView(GenericObjectFormView1):
    template_name = 'submit.html'
    form_class = forms.SubmitForm
    model = models.Application
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="being-more-generic-and-dry"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Being more generic and &lt;span class="caps"&gt;DRY&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The previous implementation has two&amp;nbsp;problems:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;What happens if the status of the object should not be changed even if the form &lt;em&gt;is&lt;/em&gt;&amp;nbsp;valid?&lt;/li&gt;
&lt;li&gt;We shouldn&amp;#8217;t need to create a new template for every new &lt;tt class="docutils literal"&gt;GenericObjectFormView&lt;/tt&gt; since all these templates will just output the object information, ask a question for the status change and output the&amp;nbsp;form.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let&amp;#8217;s write a new version of our GenericObjectFormView that actually resolves&amp;nbsp;these:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class GenericObjectFormView2(FormView, SingleObjectMixin):
    template_name = 'generic_formview.html'
    ok_message = ''
    not_ok_message = ''
    title = ''
    question =''

    def form_valid(self, form):
        obj = self.get_object()
        r = obj.change_status(form)
        if r:
            messages.info(self.request, self.yes_message)
        else:
            messages.info(self.request, self.not_ok_message)
        return HttpResponseRedirect( obj.get_absolute_url() )

    def get_context_data(self, **kwargs):
        context = super(GenericYesNoFormView2, self).get_context_data(**kwargs)
        context['title'] = self.title
        context['question'] = self.question
        return context
&lt;/pre&gt;
&lt;p&gt;The above adds an ok and not ok message which will be outputed if the status can or cannot be changed. To accomplish this,
the &lt;tt class="docutils literal"&gt;change_status&lt;/tt&gt; method should now return a boolean value to mark if the action was ok or not. Also, a generic template
will now be used. This template has two placeholders: One for the title of the page (&lt;tt class="docutils literal"&gt;title&lt;/tt&gt; attribute) and one for the
question asked to the user (&lt;tt class="docutils literal"&gt;question&lt;/tt&gt; attribute). Now we can use it like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class CancelObjectFormView(GenericObjectFormView2):
    form_class = forms.CancelForm
    model = models.Application
    ok_message = 'Cancel success!'
    not_ok_message = 'Not able to cancel!'
    title = 'Cancel an object'
    question = 'Do you want to cancel this object?'

class SubmitObjectFormView(GenericObjectFormView2):
    form_class = forms.SubmitForm
    model = models.Application
    ok_message = 'Submit  ok'
    not_ok_message = 'Cannot submit!'
    title = 'Submit an object'
    question ='Do you want to submit this object?'
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="other-options"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id6"&gt;Other&amp;nbsp;options&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;We&amp;#8217;ve just got a glimpse of how we can use CBVs to increase the DRYness of our Django applications. There are various
extra things that we can add to our &lt;tt class="docutils literal"&gt;GenericObjectFormView2&lt;/tt&gt; as attributes which will be defined by inheriting
classes. Some ideas is to check if the current user actually has access to modify the object (hint: override the
&lt;tt class="docutils literal"&gt;get_object&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;SingleObjectMixin&lt;/tt&gt;) or render the form diffirently depending on the current user (hint:
override the &lt;tt class="docutils literal"&gt;get_form_kwargs&lt;/tt&gt; method of &lt;tt class="docutils literal"&gt;FormView&lt;/tt&gt;).&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="python"></category><category term="cbv"></category><category term="class-based-views"></category></entry><entry><title>A WagtailÂ tutorial</title><link href="https://spapas.github.io/2014/02/13/wagtail-tutorial/" rel="alternate"></link><published>2014-02-13T21:20:00+02:00</published><updated>2014-02-13T21:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2014-02-13:/2014/02/13/wagtail-tutorial/</id><summary type="html">&lt;p&gt;This is a from scratch tutorial for creating a wagtail based&amp;nbsp;Blog.&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://wagtail.io"&gt;Wagtail&lt;/a&gt; is a new Open Source &lt;a href="https://www.djangoproject.com"&gt;Django&lt;/a&gt;-based &lt;span class="caps"&gt;CMS&lt;/span&gt;. In this 20 minute tutorial we will see how you can create a blog from scratch using Wagtail. If you want to see some more examples of usage please take a look at the &lt;a href="https://github.com/torchbox/wagtaildemo"&gt;wagtaildemo&lt;/a&gt; GitHub&amp;nbsp;project.&lt;/p&gt;
&lt;p&gt;To follow this tutorial you will need to have &lt;a href="http://python.org/"&gt;Python&lt;/a&gt; 2.7 installed with a working version of &lt;a href="https://pypi.python.org/pypi/pip"&gt;pip&lt;/a&gt; and &lt;a href="https://pypi.python.org/pypi/virtualenv"&gt;virtualenv&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;: The result of this tutorial has been deployed to &lt;a href="https://www.heroku.com/"&gt;Heroku&lt;/a&gt;: &lt;a href="http://gentle-refuge-2590.herokuapp.com/"&gt;http://gentle-refuge-2590.herokuapp.com/&lt;/a&gt; - you may visit the &lt;a href="http://gentle-refuge-2590.herokuapp.com/admin/"&gt;admin site&lt;/a&gt; and login with root / 123 to play with Wagtail! Please don&amp;#8217;t do anything naughty !!! Also, notice that &lt;a href="https://devcenter.heroku.com/articles/dynos#isolation-and-security"&gt;because of how Heroku works&lt;/a&gt; you won&amp;#8217;t be able to upload&amp;nbsp;anything.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Update 08/09/2015: This tutorial has been written during the first days of Wagtail, when documentation and tutorials about it were sparce; right now it should be considered by all accounts obsolete and &lt;em&gt;not&lt;/em&gt; be followed! Instead, you should read the official (and very well written) tutorial @ http://docs.wagtail.io/en/latest/getting_started/tutorial.html in the official Wagtail&amp;nbsp;documentation!&lt;/strong&gt;&lt;/p&gt;
&lt;h2&gt;Installing the wagtail&amp;nbsp;dependencies&lt;/h2&gt;
&lt;p&gt;It is recomended to create a new virtual environment that will host the wagtail tutorial. After you have changed to the virtual environment you will need to installl the Wagtail requirements. Create a file named &lt;code&gt;requirements.txt&lt;/code&gt; containing the&amp;nbsp;following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Django==1.6.2
South==1.0.0
django-compressor==1.4
django-modelcluster==0.3
-e git://github.com/torchbox/wagtail.git#egg=wagtail
django-taggit==0.11.2
django-libsass==0.2
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;and run
&lt;code&gt;pip install -r requirements.txt&lt;/code&gt;.  If you use Microsoft Windows you &lt;em&gt;will&lt;/em&gt; experience problems with Pillow and lxml. Please download the 
installation executables from https://pypi.python.org/pypi/Pillow/2.3.0 and https://pypi.python.org/pypi/lxml/3.3.1, install 
them using &lt;code&gt;easy_install Pillow-2.3.0.x-py2.7.exe&lt;/code&gt; and &lt;code&gt;easy_install lxml-3.3.1.x-py2.7.exe&lt;/code&gt; (from inside your virtual environment) 
and then install the other requirements. Also please use the latest version of Wagtail (hosted on github) because it has some changes from 
the pypi (so &lt;em&gt;don&amp;#8217;t&lt;/em&gt; do a &lt;code&gt;pip install wagtail&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Warning:&lt;/strong&gt; Unfortuanately, no official binaries for libsass (which is a django-libsass requirement) are (yet) available for Windows. I
have compiled a version for win32 and python 2.7 (which I use) using the &lt;a href="http://www.confusedbycode.com/articles/compiling-python-modules.html"&gt;instructions found here&lt;/a&gt;. You can download this version 
&lt;a href="https://spapas.github.io/images/libsass-0.3.0-cp27-none-win32.whl"&gt;as a wheel package&lt;/a&gt;. Notice that because libsass was compiled with &lt;span class="caps"&gt;VC&lt;/span&gt; Express 2013
you should also install the &lt;a href="http://www.microsoft.com/en-us/download/details.aspx?id=40784"&gt;Visual C++ 2013 redistributable&lt;/a&gt; package from&amp;nbsp;Microsoft.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Please use it at your own risk&amp;nbsp;!!!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;To install &lt;a href="http://pythonwheels.com/"&gt;wheels&lt;/a&gt; you have to use a version of pip &amp;gt;= 1.4 (so do an &lt;code&gt;easy_install -U pip&lt;/code&gt; from your
virtual environment if you have a previous version) and then you can just do a normal &lt;code&gt;pip install libsass-0.3.0-cp27-none-win32.whl&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Warning no2:&lt;/strong&gt; More unfortuanately, there seem to be &lt;a href="https://github.com/torchbox/wagtail/issues/133"&gt;a number of issues&lt;/a&gt; with how libsass handles &lt;code&gt;@import&lt;/code&gt; statements
in Windows. Until this is fixed, Windows users are recommened to use the command line (Ruby) sass compiler. To use it, please
install Ruby in your system and then install sass with &lt;code&gt;gem install sass -v "&amp;gt;=3.3.0alpha" --pre&lt;/code&gt;. After that, in the &lt;code&gt;COMPRESS_PRECOMPILERS&lt;/code&gt; 
setting of your &lt;code&gt;settings.py&lt;/code&gt; (discussed in the next section), change the line &lt;code&gt;('text/x-scss', 'django_libsass.SassCompiler'),&lt;/code&gt; to 
&lt;code&gt;('text/x-scss', 'sass --scss  {infile} {outfile}'),&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Creating and configuring your&amp;nbsp;project&lt;/h2&gt;
&lt;p&gt;Wagtail has to &amp;#8220;live&amp;#8221; inside a normal Django project so you now may create a new Django project by&amp;nbsp;issuing:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python &amp;lt;PATH_OF_YOUR_VIRTUAL_ENV&amp;gt;/scripts/django-admin.py startproject wagtailtutorial
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;If you use Unix you can just run &lt;code&gt;django-admin.py&lt;/code&gt; etc however if you try to do the same in windows you
will find out that windows tries to run the .py file with the python executable that is assigned through
explorer (which of course is your main python installation) and &lt;em&gt;not&lt;/em&gt; through your path! That&amp;#8217;s why
all our commands will be in the form &lt;code&gt;python script.py&lt;/code&gt; to make sure that Windows picks the python
executable from your path (which, if you&amp;#8217;re inside the virtual enviroment will be the correct&amp;nbsp;one).&lt;/p&gt;
&lt;p&gt;Inside the &lt;code&gt;wagtailtutorial&lt;/code&gt; folder you will see a file named &lt;code&gt;manage.py&lt;/code&gt; and another folder named &lt;code&gt;wagtailtutorial&lt;/code&gt;. Inside this &lt;code&gt;wagtailtutorial&lt;/code&gt; folder you will find &lt;code&gt;settings.py&lt;/code&gt; and &lt;code&gt;urls.py&lt;/code&gt; which need to be&amp;nbsp;changed.&lt;/p&gt;
&lt;p&gt;Starting with &lt;code&gt;urls.py&lt;/code&gt;, remove everything and change it like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf.urls&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf.urls.static&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;static&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.views.generic.base&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;RedirectView&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;admin&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os.path&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailcore&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtail_urls&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailadmin&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtailadmin_urls&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailimages&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtailimages_urls&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailembeds&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtailembeds_urls&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtaildocs&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;admin_urls&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtaildocs_admin_urls&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtaildocs&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtaildocs_urls&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailsnippets&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtailsnippets_urls&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailsearch.urls&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;frontend&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtailsearch_frontend_urls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;admin&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtailsearch_admin_urls&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailusers&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtailusers_urls&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailredirects&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtailredirects_urls&lt;/span&gt;

&lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;autodiscover&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="c1"&gt;# Signal handlers&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailsearch&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;register_signal_handlers&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;wagtailsearch_register_signal_handlers&lt;/span&gt;
&lt;span class="n"&gt;wagtailsearch_register_signal_handlers&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;patterns&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^django-admin/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;admin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;site&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;

    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^admin/images/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtailimages_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^admin/embeds/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtailembeds_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^admin/documents/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtaildocs_admin_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^admin/snippets/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtailsnippets_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^admin/search/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtailsearch_admin_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^admin/users/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtailusers_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^admin/redirects/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtailredirects_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^admin/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtailadmin_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^search/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtailsearch_frontend_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^documents/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtaildocs_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;

    &lt;span class="c1"&gt;# For anything not caught by a more specific rule above, hand over to&lt;/span&gt;
    &lt;span class="c1"&gt;# Wagtail&amp;#39;s serving mechanism&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;wagtail_urls&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.contrib.staticfiles.urls&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;staticfiles_urlpatterns&lt;/span&gt;

    &lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;staticfiles_urlpatterns&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;# tell gunicorn where static files are in dev mode&lt;/span&gt;
    &lt;span class="n"&gt;urlpatterns&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;static&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MEDIA_URL&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;images/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;document_root&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MEDIA_ROOT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;images&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You can se that there is a signal handler when a searchable thing is added or changed to handle indexing for search, normal django admin is mapped under /django-admin since /admin is use for Wagtail (of course you may map Wagtail wherever you&amp;#8217;d like), inclusion of various wagtail related urls and finally a Wagtail handling everything else. Finally there are some handlers for media and static&amp;nbsp;files.&lt;/p&gt;
&lt;p&gt;After that please change your &lt;code&gt;settings.py&lt;/code&gt; like&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Django settings for wagtailtutorial project.&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

&lt;span class="n"&gt;PROJECT_ROOT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dirname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__file__&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;..&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;..&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;DEBUG&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;TEMPLATE_DEBUG&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;DEBUG&lt;/span&gt;

&lt;span class="n"&gt;ADMINS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;MANAGERS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ADMINS&lt;/span&gt;

&lt;span class="n"&gt;DATABASES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;ENGINE&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django.db.backends.sqlite3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;NAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;PROJECT_ROOT&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/wagtailtutorial.db&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;USER&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;PASSWORD&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;HOST&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# Set to empty string for localhost.&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;PORT&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="c1"&gt;# Set to empty string for default.&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;CONN_MAX_AGE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;600&lt;/span&gt;  &lt;span class="c1"&gt;# number of seconds database connections should persist for&lt;/span&gt;
&lt;span class="n"&gt;ALLOWED_HOSTS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="n"&gt;TIME_ZONE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Europe/London&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;LANGUAGE_CODE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;en-gb&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;SITE_ID&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;USE_I18N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;USE_L10N&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;
&lt;span class="n"&gt;USE_TZ&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;
&lt;span class="n"&gt;MEDIA_ROOT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PROJECT_ROOT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;media&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;MEDIA_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/media/&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;STATIC_ROOT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PROJECT_ROOT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;static&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;STATIC_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/static/&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;STATICFILES_DIRS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;STATICFILES_FINDERS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.staticfiles.finders.FileSystemFinder&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.staticfiles.finders.AppDirectoriesFinder&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;compressor.finders.CompressorFinder&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;SECRET_KEY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;wq21wtjo3@d_qfjvd-#td!&lt;/span&gt;&lt;span class="si"&gt;%7g&lt;/span&gt;&lt;span class="s1"&gt;fy2updj2z+nev^k$iy%=m4_tr&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;TEMPLATE_LOADERS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.template.loaders.filesystem.Loader&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.template.loaders.app_directories.Loader&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;MIDDLEWARE_CLASSES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.middleware.common.CommonMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.sessions.middleware.SessionMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.middleware.csrf.CsrfViewMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.auth.middleware.AuthenticationMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.messages.middleware.MessageMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.middleware.clickjacking.XFrameOptionsMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtailcore.middleware.SiteMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtailredirects.middleware.RedirectMiddleware&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.conf&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;global_settings&lt;/span&gt;
&lt;span class="n"&gt;TEMPLATE_CONTEXT_PROCESSORS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;global_settings&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TEMPLATE_CONTEXT_PROCESSORS&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.core.context_processors.request&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;ROOT_URLCONF&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;wagtailtutorial.urls&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;WSGI_APPLICATION&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;wagtailtutorial.wsgi.application&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;TEMPLATE_DIRS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;INSTALLED_APPS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.auth&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.contenttypes&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.sessions&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="c1"&gt;# &amp;#39;django.contrib.sites&amp;#39;,  # Wagtail uses its own site management logic&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.messages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.staticfiles&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;

    &lt;span class="s1"&gt;&amp;#39;south&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;compressor&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;taggit&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;modelcluster&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;django.contrib.admin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;

    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtailcore&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtailadmin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtaildocs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtailsnippets&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtailusers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtailimages&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtailembeds&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtailsearch&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;wagtail.wagtailredirects&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;

    &lt;span class="s1"&gt;&amp;#39;tutorial&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;EMAIL_SUBJECT_PREFIX&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;[wagtailtutorial] &amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;INTERNAL_IPS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;127.0.0.1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;10.0.2.2&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;COMPRESS_PRECOMPILERS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text/x-scss&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django_libsass.SassCompiler&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Auth settings&lt;/span&gt;
&lt;span class="n"&gt;LOGIN_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django.contrib.auth.views.login&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;LOGIN_REDIRECT_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;wagtailadmin_home&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;LOGGING&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;disable_existing_loggers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;filters&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;require_debug_false&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;()&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django.utils.log.RequireDebugFalse&amp;#39;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;handlers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;mail_admins&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;level&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ERROR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;filters&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;require_debug_false&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;class&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;django.utils.log.AdminEmailHandler&amp;#39;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;loggers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;django.request&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;handlers&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;mail_admins&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;level&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ERROR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="s1"&gt;&amp;#39;propagate&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="c1"&gt;# WAGTAIL SETTINGS&lt;/span&gt;
&lt;span class="n"&gt;WAGTAIL_SITE_NAME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;wagtailtutorial&amp;#39;&lt;/span&gt;

&lt;span class="c1"&gt;# Override the search results template for wagtailsearch&lt;/span&gt;
&lt;span class="n"&gt;WAGTAILSEARCH_RESULTS_TEMPLATE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;tutorial/search_results.html&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;WAGTAILSEARCH_RESULTS_TEMPLATE_AJAX&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;tutorial/includes/search_listing.html&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;WAGTAILSEARCH_ES_INDEX&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;wagtailtutorial&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The most important thing to notice is that  the &lt;code&gt;INSTALLED_APPS&lt;/code&gt; contains the usual apps from django.*, &lt;a href="http://south.aeracode.org/"&gt;south&lt;/a&gt; for database migrations, &lt;a href="https://github.com/django-compressor/django-compressor"&gt;django-compressor&lt;/a&gt; to support compressing static files (and automatic translating from less to css), &lt;a href="https://github.com/alex/django-taggit"&gt;django-taggit&lt;/a&gt; to add support for tags, and &lt;a href="https://github.com/torchbox/django-modelcluster/"&gt;django-modelcluster&lt;/a&gt; which adds support from clusters (groups) of models. It also contains the wagtail.* applications and the tutorial application which is where we will create our blog. Also there are two Wagtail related middleware (one to add a site attribute to each request and one to hand redirects), configuring django-compressor to use &lt;code&gt;django_libsass&lt;/code&gt; to compile &lt;code&gt;less&lt;/code&gt; files, and some other, not so important Wagtail&amp;nbsp;settings.&lt;/p&gt;
&lt;p&gt;So let&amp;#8217;s create the missing tutorial application by&amp;nbsp;issuing:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py startapp tutorial
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now we&amp;#8217;ll have a &lt;code&gt;tutorial&lt;/code&gt; folder waiting to define our blog structure inside the &lt;code&gt;wagtailtutorial&lt;/code&gt; folder!&lt;/p&gt;
&lt;h2&gt;Checking to see if everything&amp;nbsp;works&lt;/h2&gt;
&lt;p&gt;Before continuing with our blog creation let&amp;#8217;s make sure that everything works, first of all by generating the database&amp;nbsp;schema:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py syncdb
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;In the superuser question answer yes and add a superuser. Then you can run the migrations - however because there are some problems with the way SQLite3 runs migrations it is recommended to run the migrations in two&amp;nbsp;steps:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py migrate &lt;span class="m"&gt;0001&lt;/span&gt; --all
python manage.py migrate
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Finally, you now may try&amp;nbsp;a&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python manage.py runserver
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;and visit &lt;code&gt;http://127.0.0.1:8000&lt;/code&gt;. If everything worked fine you will get&amp;nbsp;a&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Welcome to your new Wagtail&amp;nbsp;site!&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;page &amp;#8212; congratulations&amp;nbsp;!&lt;/p&gt;
&lt;p&gt;The homepage is rather simple (for now!) but you may already navigate to http://127.0.0.1:8000/admin and from there, login to Wagtail admin with the superuser you created earlier. 
Now you may start experiencing Wagtail&amp;nbsp;! &lt;/p&gt;
&lt;p&gt;&lt;img alt="Wagtail admin index" src="https://spapas.github.io/images/wagtail-index.png"&gt;&lt;/p&gt;
&lt;h2&gt;Exploring Wagtail&amp;nbsp;admin&lt;/h2&gt;
&lt;p&gt;When you login to Wagtail admin you will see a menu at the left with the&amp;nbsp;options:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Explorer is used to actually manage the content of your&amp;nbsp;site&lt;/li&gt;
&lt;li&gt;Search is used for searching through your&amp;nbsp;content&lt;/li&gt;
&lt;li&gt;Images is used to manage your&amp;nbsp;images&lt;/li&gt;
&lt;li&gt;Documents is used to manage your&amp;nbsp;Documents&lt;/li&gt;
&lt;li&gt;Snippets is used for side bars&amp;nbsp;etc&lt;/li&gt;
&lt;li&gt;Users is used for User&amp;nbsp;management&lt;/li&gt;
&lt;li&gt;Redirects is used to redirect to a specific&amp;nbsp;page&lt;/li&gt;
&lt;li&gt;Editors picks is used to promote search&amp;nbsp;results&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Of the previous, the one needing more explanation is Explorer: Clicking it you will see that a label named &amp;#8220;Welcome to your Wagtail site!&amp;#8221; will open. This is the root Page of your site. If you click at it you will go to the actions of this page. The actions you can do here is:
 - Add Child Page
 - Edit
 - View Live
 - Move
 - Delete
 -&amp;nbsp;Unpublish&lt;/p&gt;
&lt;p&gt;The Pages (and more generally the Content) of Wagtail are Django Models that are saved through a Tree hierarchy. However, if you click &amp;#8220;Add Child Page&amp;#8221; you won&amp;#8217;t be able to add anything because you must create your own Page types (we will see how it is done in the next&amp;nbsp;section). &lt;/p&gt;
&lt;p&gt;When you click edit you will be able to edit the parts of the page (each part is a normal Field of the model). Also, you will see that the form is split into two tabs: Content and Promote. In the Content for instance you will see that the &amp;#8220;Welcome to your Wagtail site!&amp;#8221; has only a &amp;#8220;Title&amp;#8221; CharField. These are the fields that will be available to all Pages since &amp;#8220;Welcome to your Wagtail site!&amp;#8221; has a class of &lt;code&gt;Page&lt;/code&gt; from which every other page should inherit. After you finish editing a page you may save it as a draft, publish, sent it for moderation (if you don&amp;#8217;t have the rights to publish it)&amp;nbsp;etc.&lt;/p&gt;
&lt;h2&gt;Creating our&amp;nbsp;blog&lt;/h2&gt;
&lt;p&gt;Each of our Page types is a normal Django Model which inherits from &lt;code&gt;Page&lt;/code&gt;. Let&amp;#8217;s suppose that our posts should contain a title, a body and a created date. Add the following to &lt;code&gt;tutorials/models.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailcore.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Page&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailcore.fields&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;RichTextField&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailadmin.edit_handlers&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;FieldPanel&lt;/span&gt;    

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BlogPage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RichTextField&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Post date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;search_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Blog Page&amp;quot;&lt;/span&gt;

    &lt;span class="n"&gt;indexed_fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;body&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;BlogPage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;FieldPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;classname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;full title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;FieldPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;FieldPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;body&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;classname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;full&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;and run &lt;code&gt;python manage.py syncdb&lt;/code&gt; to create the &lt;code&gt;tutorial_blogpage&lt;/code&gt; table. &lt;/p&gt;
&lt;p&gt;Now, if you visit again the /admin and click on the &amp;#8220;Add Child Page&amp;#8221; action of &amp;#8220;Welcome to your new Wagtail Site!&amp;#8221; you will see the &amp;#8220;Blog Page&amp;#8221; page and after you click it you will be able to see a form with the Fields you defined &lt;em&gt;and&lt;/em&gt; title(title, body, date). The title is a field inherited from Page, along with the fields  in the Promote&amp;nbsp;tab. &lt;/p&gt;
&lt;p&gt;In our declaration of BlogPage we added three &lt;code&gt;FieldPanel&lt;/code&gt;s on its content_panes. A &lt;code&gt;FieldPanel&lt;/code&gt; is a special edit handler for each Field. That is why when you try to edit the body you will see a rich text toolbar that enables you to not only format text but also embed images, documents and even oembed links. If you hadn&amp;#8217;t included the &lt;code&gt;FieldPanel('body', classname="full")&lt;/code&gt; then you wouldn&amp;#8217;t see the rich text&amp;nbsp;editor.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Editing pages in Wagtail" src="https://spapas.github.io/images/wagtail-edit-page.png"&gt;&lt;/p&gt;
&lt;p&gt;So now we can add as many posts as we&amp;nbsp;like! &lt;/p&gt;
&lt;p&gt;The time has come to take a look at our fine blog post: After we publish our page we click to the view live action&amp;nbsp;and&amp;#8230; &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;TemplateDoesNotExist at&amp;nbsp;/hello-world/&lt;/p&gt;
&lt;p&gt;tutorial/blog_page.html&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;:(&lt;/p&gt;
&lt;p&gt;A template seems to be missing &amp;#8212; actually we have totally forgotten about the presentation of our blog &amp;#8212; we&amp;#8217;ll talk about this in the next section&amp;nbsp;!&lt;/p&gt;
&lt;p&gt;However, before going there we should also create an Index page type collecting our&amp;nbsp;posts. &lt;/p&gt;
&lt;p&gt;For this, we will change our &lt;code&gt;models.py&lt;/code&gt; to&amp;nbsp;this:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;django.db&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailcore.models&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Orderable&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailcore.fields&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;RichTextField&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wagtail.wagtailadmin.edit_handlers&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;FieldPanel&lt;/span&gt;  &lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;MultiFieldPanel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;InlinePanel&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PageChooserPanel&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;modelcluster.fields&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ParentalKey&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BlogPage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;RichTextField&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DateField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Post date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;indexed_fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;body&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;search_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Blog Page&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;BlogPage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;FieldPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;classname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;full title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;FieldPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;FieldPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;body&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;classname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;full&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LinkFields&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Model&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;link_page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ForeignKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="s1"&gt;&amp;#39;wagtailcore.Page&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;null&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;blank&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="n"&gt;related_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;+&amp;#39;&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="n"&gt;PageChooserPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;link_page&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;abstract&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;RelatedLink&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LinkFields&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;help_text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Link title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
        &lt;span class="n"&gt;FieldPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
        &lt;span class="n"&gt;MultiFieldPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LinkFields&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;panels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Link&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Meta&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;abstract&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;True&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BlogIndexPageRelatedLink&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Orderable&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;RelatedLink&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ParentalKey&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tutorial.BlogIndexPage&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;related_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;related_links&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BlogIndexPage&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;intro&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;models&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CharField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;indexed_fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;body&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;search_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Blog Index Page&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;BlogIndexPage&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_panels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="n"&gt;FieldPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;classname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;full title&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;FieldPanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;intro&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;classname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;full&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
    &lt;span class="n"&gt;InlinePanel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BlogIndexPage&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;related_links&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;label&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Related links&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;    
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The above adds a way to put &lt;code&gt;related_links&lt;/code&gt; to a &lt;code&gt;BlogIndexPage&lt;/code&gt; &amp;#8212; these related_links are the &lt;code&gt;BlogPage&lt;/code&gt;s that actually belong to the blog - so now, we can add a blog index page and add all our blog posts to&amp;nbsp;it!&lt;/p&gt;
&lt;p&gt;Now that we&amp;#8217;ve created the BlogPage and BlogIndexPage pages it&amp;#8217;s time to take a look at how we will actually display our&amp;nbsp;blog&amp;#8230;&lt;/p&gt;
&lt;h2&gt;Creating templates for &lt;em&gt;Page&lt;/em&gt;s&lt;/h2&gt;
&lt;p&gt;A normal Django template can be used to display each page type. Wagtail either generates automatically (by seperating underscors with capital letters in camelcase for instance BlogIndexPage -&amp;gt; blog_index_page) or you can use the template class attribute. Let&amp;#8217;s add a &lt;code&gt;templates&lt;/code&gt; foler within the &lt;code&gt;tutorial&lt;/code&gt; foler and add another folder named &lt;code&gt;tutorial&lt;/code&gt; inside &lt;code&gt;templates&lt;/code&gt; and ten add a file named &lt;code&gt;blog_index_page.html&lt;/code&gt; to &lt;code&gt;templates&lt;/code&gt; with the following content (you must have the following hierarchy &lt;code&gt;wagtailtutorial/tutorial/templates/tutorial/blog_index_page.html&lt;/code&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ self.title }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        Intro: {{ self.intro }}
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;hr&lt;/span&gt; &lt;span class="p"&gt;/&amp;gt;&lt;/span&gt;
        {% for rl in self.related_links.all %}
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rl.title }}: &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;{{ rl.link_page.url }}&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ rl.link_page }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        {% endfor %}
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So self is the context name of the  BlogPageIndex instance that is used to render this page. Beyond that, it&amp;#8217;s normal&amp;nbsp;django.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Rendering the Blog Index" src="https://spapas.github.io/images/wagtail-index-template.png"&gt;&lt;/p&gt;
&lt;p&gt;Now you can view your Blog Index &amp;#8212; however before clicking on a link to also view your posts add the template for your &lt;code&gt;BlogPost&lt;/code&gt; (&lt;code&gt;tutorial/blog_page.html&lt;/code&gt;):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;{% load rich_text %}
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;{{ self.title }}&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;h1&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        Date: {{ self.date }}
        {{ self.body | richtext }}
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;body&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;html&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;    
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The extra thing here is the &lt;code&gt;richtext&lt;/code&gt; filter which renders a &lt;code&gt;RichTextField&lt;/code&gt; correctly. Of course the above templates are just examples - check &lt;code&gt;wagtaildemo&lt;/code&gt; for a much better template&amp;nbsp;design.&lt;/p&gt;
&lt;p&gt;Woo-hoo &amp;#8212; now I can totally start blogging !!!&amp;nbsp;\o/&lt;/p&gt;
&lt;p&gt;&amp;#8230;&lt;/p&gt;
&lt;p&gt;&amp;#8230;&lt;/p&gt;
&lt;p&gt;But &amp;#8230; when I go to 127.0.0.1:8000 it displays the ugly &amp;#8220;Welcome to your new Wagtail site!&amp;#8221;. I don&amp;#8217;t want to see that any more&amp;nbsp;!!!&lt;/p&gt;
&lt;p&gt;No problemo - check the next section of the tutorial&amp;nbsp;:)&lt;/p&gt;
&lt;h2&gt;Changing your home&amp;nbsp;page&lt;/h2&gt;
&lt;p&gt;Wagtail uses the concept of &lt;em&gt;sites&lt;/em&gt; to define groups of pages hosted in the &lt;em&gt;same&lt;/em&gt; server. To make more clear what site is, you have to use the good old django admin which can be found at &lt;code&gt;http://127.0.0.1:8000/django-admin/&lt;/code&gt;. Check the localhost[default] site entry: You will see that each site has a name, a root page (currently the &amp;#8220;Welcome to your new Wagtail site!&amp;#8221;) and an is_default check. So,  change the root page of the localhost site to your BlogIndexPage and go to &lt;code&gt;http://127.0.0.1:8000/&lt;/code&gt; &amp;#8230; Yes ! The blog is alive&amp;nbsp;:)&lt;/p&gt;
&lt;h2&gt;Where to go from&amp;nbsp;here&lt;/h2&gt;
&lt;p&gt;You are now ready to start adding more pages to your blog, adding functionality to it (don&amp;#8217;t forget that everything is just Django models and templates so you can
change it at will), or even creating a completely different kind of site by adding other Page types. For a more complete site with lots of examples please check 
&lt;a href="https://github.com/torchbox/wagtaildemo"&gt;wagtaildemo&lt;/a&gt;. There is
no complete documentation yet however you&amp;nbsp;can &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Use the source&amp;nbsp;Luke!&lt;/p&gt;
&lt;/blockquote&gt;</content><category term="wagtail"></category><category term="wagtail"></category><category term="python"></category><category term="django"></category></entry><entry><title>Django dynamicÂ forms</title><link href="https://spapas.github.io/2013/12/24/django-dynamic-forms/" rel="alternate"></link><published>2013-12-24T14:20:00+02:00</published><updated>2013-12-24T14:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2013-12-24:/2013/12/24/django-dynamic-forms/</id><summary type="html">&lt;p class="first last"&gt;Creating dynamic (user generated) forms in&amp;nbsp;django&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#describing-a-django-form-in-json" id="id2"&gt;Describing a django form in &lt;span class="caps"&gt;JSON&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#creating-the-form-fields" id="id3"&gt;Creating the form&amp;nbsp;fields&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#creating-the-actual-form" id="id4"&gt;Creating the actual&amp;nbsp;form&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-the-dynamic-form" id="id5"&gt;Using the dynamic&amp;nbsp;form&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To define a form in django, a developer has to create a class which extends
&lt;tt class="docutils literal"&gt;django.forms.Form&lt;/tt&gt;
and has  a number of attributes extending from &lt;tt class="docutils literal"&gt;django.forms.Field&lt;/tt&gt;. This makes
it very easy for the developer to create static forms, but creating
dynamic forms whose fields can be changed depending on the data contributed by the
users of the application is not so&amp;nbsp;obvious.&lt;/p&gt;
&lt;p&gt;Of course, some people may argue that they can do whatever
they want just by spitting html input tags to their templates, however this totally violates
&lt;span class="caps"&gt;DRY&lt;/span&gt; and any serious django developer would prefer to write &lt;a class="reference external" href="http://thedailywtf.com/Articles/A_Case_of_the_MUMPS.aspx"&gt;&lt;span class="caps"&gt;MUMPS&lt;/span&gt;&lt;/a&gt; than creating
html&amp;nbsp;dynamically.&lt;/p&gt;
&lt;p&gt;The implementation I will present here had been developed for an old project: In that
project there was a number of services which could be edited dynamically by the
moderators. For each service, the moderators would generate a questionnaire to
get input from the users which would be defined  using &lt;span class="caps"&gt;JSON&lt;/span&gt;. When the users needed
to submit information for each service, a dynamic django form would be generated
from this &lt;span class="caps"&gt;JSON&lt;/span&gt; and the answers would be saved to no-&lt;span class="caps"&gt;SQL&lt;/span&gt; database like&amp;nbsp;MongoDB.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="describing-a-django-form-in-json"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Describing a django form in &lt;span class="caps"&gt;JSON&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A &lt;span class="caps"&gt;JSON&lt;/span&gt; described django form is just an array of field &lt;span class="caps"&gt;JSON&lt;/span&gt; objects. Each field
object  has three required attributes: name which is the keyword of the field, label which is
how the label of the field and type which is the type of the input of that field. The
supported types are text, textarea, integer, radio, select, checkbox. Now, depending
on the type of the field, there could be also some more required attributes, for instace
text has a max_length attribute and select has a choices attribute (which is an array
of name/value objects). Also there are two optional attributes,
required with a default value of False and help_text with a default value of&amp;nbsp;&amp;#8221;.&lt;/p&gt;
&lt;p&gt;As you can understand these map one by one to the corresponding attributes of the
actual django form fields. An example containing a complete &lt;span class="caps"&gt;JSON&lt;/span&gt; described form
is the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
[
    {
        &amp;quot;name&amp;quot;: &amp;quot;firstname&amp;quot;,
        &amp;quot;label&amp;quot;: &amp;quot;First Name&amp;quot;,
        &amp;quot;type&amp;quot;: &amp;quot;text&amp;quot;,
        &amp;quot;max_length&amp;quot;: 25,
        &amp;quot;required&amp;quot;: 1
    },
    {
        &amp;quot;name&amp;quot;: &amp;quot;lastname&amp;quot;,
        &amp;quot;label&amp;quot;: &amp;quot;Last Name&amp;quot;,
        &amp;quot;type&amp;quot;: &amp;quot;text&amp;quot;,
        &amp;quot;max_length&amp;quot;: 25,
        &amp;quot;required&amp;quot;: 1
    },
    {
        &amp;quot;name&amp;quot;: &amp;quot;smallcv&amp;quot;,
        &amp;quot;label&amp;quot;: &amp;quot;Small CV&amp;quot;,
        &amp;quot;type&amp;quot;: &amp;quot;textarea&amp;quot;,
        &amp;quot;help_text&amp;quot;: &amp;quot;Please insert a small CV&amp;quot;
    },
    {
        &amp;quot;name&amp;quot;: &amp;quot;age&amp;quot;,
        &amp;quot;label&amp;quot;: &amp;quot;Age&amp;quot;,
        &amp;quot;type&amp;quot;: &amp;quot;integer&amp;quot;,
        &amp;quot;max_value&amp;quot;: 200,
        &amp;quot;min_value&amp;quot;: 0
    },
    {
        &amp;quot;name&amp;quot;: &amp;quot;marital_status&amp;quot;,
        &amp;quot;label&amp;quot;: &amp;quot;Marital Status&amp;quot;,
        &amp;quot;type&amp;quot;: &amp;quot;radio&amp;quot;,
        &amp;quot;choices&amp;quot;: [
            {&amp;quot;name&amp;quot;: &amp;quot;Single&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;single&amp;quot;},
            {&amp;quot;name&amp;quot;: &amp;quot;Married&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;married&amp;quot;},
            {&amp;quot;name&amp;quot;: &amp;quot;Divorced&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;divorced&amp;quot;},
            {&amp;quot;name&amp;quot;: &amp;quot;Widower&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;widower&amp;quot;}
        ]
    },
    {
        &amp;quot;name&amp;quot;: &amp;quot;occupation&amp;quot;,
        &amp;quot;label&amp;quot;: &amp;quot;Occupation&amp;quot;,
        &amp;quot;type&amp;quot;: &amp;quot;select&amp;quot;,
        &amp;quot;choices&amp;quot;: [
            {&amp;quot;name&amp;quot;: &amp;quot;Farmer&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;farmer&amp;quot;},
            {&amp;quot;name&amp;quot;: &amp;quot;Engineer&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;engineer&amp;quot;},
            {&amp;quot;name&amp;quot;: &amp;quot;Teacher&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;teacher&amp;quot;},
            {&amp;quot;name&amp;quot;: &amp;quot;Office Clerk&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;office_clerk&amp;quot;},
            {&amp;quot;name&amp;quot;: &amp;quot;Merchant&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;merchant&amp;quot;},
            {&amp;quot;name&amp;quot;: &amp;quot;Unemployed&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;unemployed&amp;quot;},
            {&amp;quot;name&amp;quot;: &amp;quot;Retired&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;retired&amp;quot;},
            {&amp;quot;name&amp;quot;: &amp;quot;Other&amp;quot;, &amp;quot;value&amp;quot;:&amp;quot;other&amp;quot;}
        ]
    },
    {
        &amp;quot;name&amp;quot;: &amp;quot;internet&amp;quot;,
        &amp;quot;label&amp;quot;: &amp;quot;Internet Access&amp;quot;,
        &amp;quot;type&amp;quot;: &amp;quot;checkbox&amp;quot;
    }
]
&lt;/pre&gt;
&lt;p&gt;The above &lt;span class="caps"&gt;JSON&lt;/span&gt; string can be easily converted to an array of dictionaries with the following&amp;nbsp;code:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
import json
fields=json.loads(json_fields)
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="creating-the-form-fields"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Creating the form&amp;nbsp;fields&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The most import part in the django dynamic form creation is to convert the above array
of field-describing dictionaries to actual objects of type &lt;tt class="docutils literal"&gt;django.forms.Field&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;To help with that I implemented a class named &lt;tt class="docutils literal"&gt;FieldHandler&lt;/tt&gt; which gets an
array of field dictionaries and after initialization will have an attribute named &lt;tt class="docutils literal"&gt;formfields&lt;/tt&gt; which
will be a dictionary with keys the names of each field an values the corresponding &lt;tt class="docutils literal"&gt;django.forms.Field&lt;/tt&gt; objects. The implementation is as&amp;nbsp;follows:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
import django.forms

class FieldHandler():
    formfields = {}
    def __init__(self, fields):
        for field in fields:
            options = self.get_options(field)
            f = getattr(self, &amp;quot;create_field_for_&amp;quot;+field['type'] )(field, options)
            self.formfields[field['name']] = f

    def get_options(self, field):
        options = {}
        options['label'] = field['label']
        options['help_text'] = field.get(&amp;quot;help_text&amp;quot;, None)
        options['required'] = bool(field.get(&amp;quot;required&amp;quot;, 0) )
        return options

    def create_field_for_text(self, field, options):
        options['max_length'] = int(field.get(&amp;quot;max_length&amp;quot;, &amp;quot;20&amp;quot;) )
        return django.forms.CharField(**options)

    def create_field_for_textarea(self, field, options):
        options['max_length'] = int(field.get(&amp;quot;max_value&amp;quot;, &amp;quot;9999&amp;quot;) )
        return django.forms.CharField(widget=django.forms.Textarea, **options)

    def create_field_for_integer(self, field, options):
        options['max_value'] = int(field.get(&amp;quot;max_value&amp;quot;, &amp;quot;999999999&amp;quot;) )
        options['min_value'] = int(field.get(&amp;quot;min_value&amp;quot;, &amp;quot;-999999999&amp;quot;) )
        return django.forms.IntegerField(**options)

    def create_field_for_radio(self, field, options):
        options['choices'] = [ (c['value'], c['name'] ) for c in field['choices'] ]
        return django.forms.ChoiceField(widget=django.forms.RadioSelect,   **options)

    def create_field_for_select(self, field, options):
        options['choices']  = [ (c['value'], c['name'] ) for c in field['choices'] ]
        return django.forms.ChoiceField(  **options)

    def create_field_for_checkbox(self, field, options):
        return django.forms.BooleanField(widget=django.forms.CheckboxInput, **options)
&lt;/pre&gt;
&lt;p&gt;As can be seen, in the &lt;tt class="docutils literal"&gt;__init__&lt;/tt&gt; method, the &lt;tt class="docutils literal"&gt;get_options&lt;/tt&gt; method is called first which
returns a dictionary with the common options (label, help_text, required). After that,
depending on the type of each field the correct method will be generated with
&lt;tt class="docutils literal"&gt;getattr(self, &lt;span class="pre"&gt;&amp;quot;create_field_for_&amp;quot;+field['type']&lt;/span&gt; )&lt;/tt&gt; (so if type is text this
will return a reference to the create_field_for_text method) and then called passing
the field dictinary and the options returned from &lt;tt class="docutils literal"&gt;get_options&lt;/tt&gt;. Each one of
the &lt;tt class="docutils literal"&gt;create_field_for_xxx&lt;/tt&gt; methods will extract the required (or optional)
attributes for the specific field type, update options and initialize the correct Field passing
the options as kwargs. Finally the formfields attribute will be updated with the name
and Field&amp;nbsp;object.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="creating-the-actual-form"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Creating the actual&amp;nbsp;form&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To create the actual dynamic &lt;tt class="docutils literal"&gt;django.forms.Form&lt;/tt&gt; I used the function &lt;tt class="docutils literal"&gt;get_form&lt;/tt&gt;
which receives a string with the json description, parses it to a python array,
creates the array of fields with the help of &lt;tt class="docutils literal"&gt;FieldHandler&lt;/tt&gt; and then generates
the &lt;tt class="docutils literal"&gt;Form&lt;/tt&gt; class with &lt;tt class="docutils literal"&gt;type&lt;/tt&gt; passing it &lt;tt class="docutils literal"&gt;django.forms.Form&lt;/tt&gt; as a parent
and the array of &lt;tt class="docutils literal"&gt;django.forms.Field&lt;/tt&gt; from &lt;tt class="docutils literal"&gt;FieldHandler&lt;/tt&gt; as&amp;nbsp;attributes:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
def get_form(jstr):
    fields=json.loads(jstr)
    fh = FieldHandler(fields)
    return type('DynaForm', (django.forms.Form,), fh.formfields )
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="using-the-dynamic-form"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Using the dynamic&amp;nbsp;form&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The result of &lt;tt class="docutils literal"&gt;get_form&lt;/tt&gt; can be used as a normal form class. As an&amp;nbsp;example:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
import dynaform

def dform(request):
    json_form = get_json_form_from_somewhere()
    form_class = dynaform.get_form(json_form)
    data = {}
    if request.method == 'POST':
        form = form_class(request.POST)
        if form.is_valid():
            data = form.cleaned_data
    else:
        form = form_class()

    return render_to_response( &amp;quot;dform.html&amp;quot;, {
        'form': form,  'data': data,
    }, RequestContext(request) )
&lt;/pre&gt;
&lt;p&gt;So, we have to get our &lt;span class="caps"&gt;JSON&lt;/span&gt; form description from somewhere (for instance
a field in a model) and then generate the form class with &lt;tt class="docutils literal"&gt;get_form&lt;/tt&gt;.
After that we follow the normal procedure of checking if the &lt;tt class="docutils literal"&gt;request.method&lt;/tt&gt;
is &lt;span class="caps"&gt;POST&lt;/span&gt; so we pass the &lt;span class="caps"&gt;POST&lt;/span&gt; data to the form and check if it is value or
we just create an empty form. As a result we just pass the data that was
read from the form to the view for&amp;nbsp;presentation.&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="python"></category><category term="forms"></category></entry><entry><title>Django authorityÂ data</title><link href="https://spapas.github.io/2013/11/05/django-authoritiy-data/" rel="alternate"></link><published>2013-11-05T14:20:00+02:00</published><updated>2013-11-05T14:20:00+02:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2013-11-05:/2013/11/05/django-authoritiy-data/</id><summary type="html">&lt;p class="first last"&gt;An implementation &lt;span class="amp"&gt;&amp;amp;&lt;/span&gt; discussion of authority data for&amp;nbsp;Django&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#defining-authorities" id="id2"&gt;Defining authorities&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#using-groups" id="id3"&gt;Using&amp;nbsp;groups&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#by-storing-the-authority-to-the-session" id="id4"&gt;By storing the authority to the&amp;nbsp;session&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#by-using-a-custom-user-profile" id="id5"&gt;By using a Custom User&amp;nbsp;Profile&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#getting-the-authority-of-the-user-has-to-be-dry" id="id6"&gt;Getting the authority of the user has to be &lt;span class="caps"&gt;DRY&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#adding-authority-data" id="id7"&gt;Adding authority&amp;nbsp;data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id8"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One common requirement in an organization is to separate users in authorities (meaning departments / units / branches etc)
and each authority have its own data. So users belonging to the &amp;#8220;Athens Branch&amp;#8221; won&amp;#8217;t be able to
edit data submitted from users of the &amp;#8220;Thessaloniki&amp;nbsp;Branch&amp;#8221;.&lt;/p&gt;
&lt;p&gt;This is a special case of the more general row-level-security in which each instance of a domain object will
have an &lt;span class="caps"&gt;ACL&lt;/span&gt;. Row-level-security would need a many-to-many relation between object instances and authorities, something
that would be overkill in our&amp;nbsp;case.&lt;/p&gt;
&lt;p&gt;Authority data is also a more general case of the user-data meaning that each user can have access
to data that he inserts in the system. Implementing user-data is easy using the techniques we will present&amp;nbsp;below.&lt;/p&gt;
&lt;p&gt;We have to notice that the django permissions do not support our requirements since they define security for all instances of a&amp;nbsp;model.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="defining-authorities"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Defining&amp;nbsp;authorities&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In order to have custom authorities I propose first of all to add an Authority model that would define the authority. Even if
your authorities only have a name I believe that adding the Authority model would be beneficial.
Now, there are many ways to separate normal django users (&lt;tt class="docutils literal"&gt;django.contrib.auth.models.User&lt;/tt&gt;) to&amp;nbsp;authorities:&lt;/p&gt;
&lt;div class="section" id="using-groups"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id3"&gt;Using&amp;nbsp;groups&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Just define a &lt;tt class="docutils literal"&gt;django.contrib.auth.models.Group&lt;/tt&gt; for each authority and add the users to the groups you want using the django-admin.
Your Authority model would have an one-to-one relation with the &lt;tt class="docutils literal"&gt;django.contrib.auth.models.Group&lt;/tt&gt; so you will be able to find out the other
information of the authority (since django groups only have&amp;nbsp;names).&lt;/p&gt;
&lt;p&gt;Now you can just get the groups for the user and find out his authorities. This could lead to problems when users belong to django groups
that are not related to authorities so you must filter these out (for instance by checking which groups actually have a corresponding&amp;nbsp;Authority).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="by-storing-the-authority-to-the-session"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id4"&gt;By storing the authority to the&amp;nbsp;session&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;When the user logs in you can add an attribute to the session that would save the authority of the user. To do that, you should define
a custom middleware that checks to see if there is an authority attribute to the session and if not it will do whatever it needs to find it and set it.
An example is&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class CustomAuthorityMiddleware:
  def process_request(self, request):
    if not request.session.get('authority'):
      authority = get_the_authority(request.user)
      request.session['authority']=authority
&lt;/pre&gt;
&lt;p&gt;This way, whenever you want to find out the authority of the user you just check the&amp;nbsp;session.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="by-using-a-custom-user-profile"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id5"&gt;By using a Custom User&amp;nbsp;Profile&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Just create a &lt;a class="reference external" href="https://docs.djangoproject.com/en/dev/topics/auth/customizing/#extending-the-existing-user-model"&gt;django user profile&lt;/a&gt; and add to it a &lt;tt class="docutils literal"&gt;ForeignKey&lt;/tt&gt; to your Authority&amp;nbsp;model:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class Profile(models.Model):
  user = models.OneToOneField('django.auth.User')
  authority = models.ForeignKey('authorities.Authority', blank=True, null=True )

class Authority(models.Model):
  id = models.IntegerField(primary_key = True)
  name = models.CharField(max_length=64, )
  auth_type = models.CharField(max_length=16, )
&lt;/pre&gt;
&lt;p&gt;You can get the authority of the user through &lt;tt class="docutils literal"&gt;request.user.profile.authority&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="getting-the-authority-of-the-user-has-to-be-dry"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;Getting the authority of the user has to be &lt;span class="caps"&gt;DRY&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Whatever method you use to define the authorities of your users you have to remember that it is very
important to define somewhere a function that will return the authority (or authorities) of a
user. You need to define a function even in the simple case in which your function would just return &lt;tt class="docutils literal"&gt;request.user.profile.authority&lt;/tt&gt;.
This will greatly help you when you wish to add some logic to this, for instance &amp;#8220;quickly disable users belonging to Authority X
or temporary move users from Authority Y to authority&amp;nbsp;Z&amp;#8221;.&lt;/p&gt;
&lt;p&gt;Let us suppose that you have defined a &lt;tt class="docutils literal"&gt;get_user_authority&lt;/tt&gt; function. Also, you need to define a &lt;tt class="docutils literal"&gt;has_access&lt;/tt&gt; function
that would decide if a users/request has access to a particular object. This also needs to be &lt;span class="caps"&gt;DRY&lt;/span&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="adding-authority-data"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id7"&gt;Adding authority&amp;nbsp;data&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To define authority data you have to add a field to your model that would define its authority, for instance like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class AuthorityData(models.Model):
  authority = models.ForeignKey('authorities.Authority', editable=False,)
&lt;/pre&gt;
&lt;p&gt;This field should not be editable (at least by your end users) because they shouldn&amp;#8217;t be able to change the authority of the data they&amp;nbsp;insert.&lt;/p&gt;
&lt;p&gt;If you want to have user-data then just add a &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;models.ForeignKey('django.auth.User',&lt;/span&gt; editable=False)&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;Now, your Create and Update Class Based Views have to pass the request to your forms and also your Detail and Update &lt;span class="caps"&gt;CBV&lt;/span&gt; should allow only getting
objects that belong to the authority of the&amp;nbsp;user:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class AuthorityDataCreateView(CreateView):
  model=models.AuthorityData

  def get_form_kwargs(self):
      kwargs = super(AuthorityDataCreateView, self).get_form_kwargs()
      kwargs.update({'request': self.request})
      return kwargs

class AuthorityDataDetailView(DetailView):
  def get_object(self, queryset=None):
      obj = super(AuthorityDataDetailView, self).get_object(queryset)
      if if not user_has_access(obj, self.request):
          raise Http404(u&amp;quot;Access Denied&amp;quot;)
      return obj

class AuthorityDataUpdateView(UpdateView):
  model=models.AuthorityData

  def get_form_kwargs(self):
      kwargs = super(AuthorityDataUpdateView, self).get_form_kwargs()
      kwargs.update({'request': self.request})
      return kwargs

  def get_object(self, queryset=None):
      obj = super(AuthorityDataUpdateView, self).get_object(queryset)
      if if not user_has_access(obj, self.request):
          raise Http404(u&amp;quot;Access Denied&amp;quot;)
      return obj
&lt;/pre&gt;
&lt;p&gt;Your ModelForm can now use the request to get the Authority and set it (don&amp;#8217;t forget
that you should not use &lt;tt class="docutils literal"&gt;Meta.exclude&lt;/tt&gt; but instead use &lt;tt class="docutils literal"&gt;Meta.include&lt;/tt&gt;!):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class AuthorityDataModelForm(forms.ModelForm):
    class Meta:
      model = models.AuthorityData
      exclude = ('authority',)

    def __init__(self, *args, **kwargs):
      self.request = kwargs.pop('request', None)
      super(ActionModelForm, self).__init__(*args, **kwargs)


    def save(self, force_insert=False, force_update=False, commit=True):
      obj = super(AuthorityDataModelForm, self).save(commit=False)
      if obj:
          obj.authority = get_user_authority(self.request)
          obj.save()
      return obj
&lt;/pre&gt;
&lt;p&gt;The previous work fine for Create/Detail/Update CBVs but not for ListsViews. List views querysets
and in general all queries to the object have to be filtered through&amp;nbsp;authority.&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
class AuthorityDataListView(ListView):
  def get_queryset(self):
    queryset = super(AuthorityDataModelForm, self).get_queryset()
    return queryset.filter(authority = get_user_authority(request))
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Using the above techniques we can define authority (or just user) data. Your AuthorityData should
have a &lt;tt class="docutils literal"&gt;ForeignKey&lt;/tt&gt; to your Authority  and you have configure your queries, ModelForms and CBVs
to use that. If you have more than one models that belong to an authority and want to stay &lt;span class="caps"&gt;DRY&lt;/span&gt; then you&amp;#8217;d need
to define all the above as &lt;a class="reference external" href="https://docs.djangoproject.com/en/dev/topics/class-based-views/mixins/"&gt;mixins&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
</content><category term="django"></category><category term="django"></category><category term="python"></category><category term="security"></category></entry><entry><title>Using custom authorities with spring-security LDAPÂ authentication</title><link href="https://spapas.github.io/2013/10/14/spring-ldap-custom-authorities/" rel="alternate"></link><published>2013-10-14T08:55:00+03:00</published><updated>2013-10-14T08:55:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2013-10-14:/2013/10/14/spring-ldap-custom-authorities/</id><summary type="html">&lt;p class="first last"&gt;Configuring spring-security for logging in through &lt;span class="caps"&gt;LDAP&lt;/span&gt; but retrieving the user&amp;#8217;s authorities from a custom (non-ldap)&amp;nbsp;source.&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id3"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#a-basic-spring-security-setup" id="id4"&gt;A basic spring security&amp;nbsp;setup&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#spring-security-ldap-with-custom-authorities" id="id5"&gt;Spring security &lt;span class="caps"&gt;LDAP&lt;/span&gt; with custom authorities&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#contextsource" id="id6"&gt;contextSource&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#usersearch" id="id7"&gt;userSearch&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#ldapauthprovider" id="id8"&gt;ldapAuthProvider&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#customldapauthoritiespopulator" id="id9"&gt;CustomLdapAuthoritiesPopulator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#example" id="id10"&gt;Example&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#conclusion" id="id11"&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One very useful component of the &lt;a class="reference external" href="http://spring.io/"&gt;spring&lt;/a&gt; java framework is &lt;a class="reference external" href="http://projects.spring.io/spring-security/"&gt;spring-security&lt;/a&gt; since it allows consistent usage of various security providers for
authentication and authorization. Although I&amp;#8217;ve found a great number of basic spring-security tutorials on the internet, I wasn&amp;#8217;t able to find a complete solution for my own&amp;nbsp;requirements:&lt;/p&gt;
&lt;p&gt;Logging in with &lt;span class="caps"&gt;LDAP&lt;/span&gt; but configuring the authorities &lt;a class="footnote-reference" href="#id2" id="id1"&gt;[*]&lt;/a&gt; of the logged in user with the help of a custom method and not through &lt;span class="caps"&gt;LDAP&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;I think that the above is a common requirement in many organizations: There is a central &lt;span class="caps"&gt;LDAP&lt;/span&gt; repository in which the usernames and passwords of the users are stored, but the groups of the users are not stored there. Or maybe the groups that are actually stored in the &lt;span class="caps"&gt;LDAP&lt;/span&gt; cannot be transformed easily to application specific groups for each&amp;nbsp;application.&lt;/p&gt;
&lt;p&gt;You may find the working spring project that uses ldap and a custom groups populator here: &lt;a class="reference external" href="https://github.com/spapas/SpringLdapCustomAuthorities/"&gt;https://github.com/spapas/SpringLdapCustomAuthorities/&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="a-basic-spring-security-setup"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;A basic spring security&amp;nbsp;setup&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;I&amp;#8217;ve created a very basic setup for spring-security for a spring-mvc project. Please take a look here for a more thorough explanation of a simple spring-security project &lt;a class="reference external" href="http://www.mkyong.com/spring-security/spring-security-hello-world-example/"&gt;http://www.mkyong.com/spring-security/spring-security-hello-world-example/&lt;/a&gt; and here &lt;a class="reference external" href="http://www.codeproject.com/Articles/253901/Getting-Started-Spring-Security"&gt;http://www.codeproject.com/Articles/253901/Getting-Started-Spring-Security&lt;/a&gt; for a great explanation of the various spring-security&amp;nbsp;classes.&lt;/p&gt;
&lt;p&gt;In my setup there is a controller that defines two mappings, the &amp;#8220;/&amp;#8221; which is the homepage that has a link to the &amp;#8220;/enter&amp;#8221; and the &amp;#8220;/enter&amp;#8221; which is an internal page in which only authorized users have access. When the user clicks on &amp;#8220;enter&amp;#8221; he will be represented with a login form first. If the use logs in successfully, the enter.jsp will list the username and the authorities of the logged in user through the following spring-security&amp;nbsp;tags:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;&amp;lt;%@&lt;/span&gt; &lt;span class="n"&gt;taglib&lt;/span&gt; &lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sec&amp;quot;&lt;/span&gt; &lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.springframework.org/security/tags&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;%&amp;gt;&lt;/span&gt;
[...]
Username: &lt;span class="nt"&gt;&amp;lt;sec:authentication&lt;/span&gt; &lt;span class="na"&gt;property=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;principal.username&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&amp;lt;br&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
Authorities: &lt;span class="nt"&gt;&amp;lt;sec:authentication&lt;/span&gt; &lt;span class="na"&gt;property=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;principal.authorities&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&amp;lt;br&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The authentication provider is an in memory service in which the username, password and authorities of each user are defined in the &lt;span class="caps"&gt;XML&lt;/span&gt;. So this is a simple spring-security example that can be found in a number of places on the internet. The security rules, login form and the authentication provider are configured with the following &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;security-config.xml&lt;/span&gt;&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;beans:beans&lt;/span&gt; &lt;span class="na"&gt;xmlns=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.springframework.org/schema/security&amp;quot;&lt;/span&gt;
   &lt;span class="na"&gt;xmlns:beans=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.springframework.org/schema/beans&amp;quot;&lt;/span&gt;
   &lt;span class="na"&gt;xmlns:xsi=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;&lt;/span&gt;
   &lt;span class="na"&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.springframework.org/schema/beans&lt;/span&gt;
&lt;span class="s"&gt;                   http://www.springframework.org/schema/beans/spring-beans-3.1.xsd&lt;/span&gt;
&lt;span class="s"&gt;                   http://www.springframework.org/schema/security&lt;/span&gt;
&lt;span class="s"&gt;                   http://www.springframework.org/schema/security/spring-security-3.1.xsd&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;

   &lt;span class="nt"&gt;&amp;lt;http&lt;/span&gt; &lt;span class="na"&gt;pattern=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/static/**&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;security=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;none&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;

   &lt;span class="nt"&gt;&amp;lt;http&lt;/span&gt; &lt;span class="na"&gt;use-expressions=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
       &lt;span class="nt"&gt;&amp;lt;intercept-url&lt;/span&gt; &lt;span class="na"&gt;pattern=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;access=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;permitAll&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
       &lt;span class="nt"&gt;&amp;lt;intercept-url&lt;/span&gt; &lt;span class="na"&gt;pattern=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/enter&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;access=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;hasRole(&amp;#39;user&amp;#39;)&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
       &lt;span class="nt"&gt;&amp;lt;intercept-url&lt;/span&gt; &lt;span class="na"&gt;pattern=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/**&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;access=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;denyAll&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
       &lt;span class="nt"&gt;&amp;lt;form-login&lt;/span&gt; &lt;span class="na"&gt;default-target-url=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
       &lt;span class="nt"&gt;&amp;lt;logout&lt;/span&gt;  &lt;span class="na"&gt;logout-success-url=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="nt"&gt;&amp;lt;/http&amp;gt;&lt;/span&gt;

   &lt;span class="nt"&gt;&amp;lt;authentication-manager&amp;gt;&lt;/span&gt;
       &lt;span class="nt"&gt;&amp;lt;authentication-provider&amp;gt;&lt;/span&gt;
           &lt;span class="nt"&gt;&amp;lt;user-service&amp;gt;&lt;/span&gt;
               &lt;span class="nt"&gt;&amp;lt;user&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;spapas&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;password=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;123&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;authorities=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;admin, user, nonldap&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
               &lt;span class="nt"&gt;&amp;lt;user&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;serafeim&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;password=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;123&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;authorities=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;user&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
           &lt;span class="nt"&gt;&amp;lt;/user-service&amp;gt;&lt;/span&gt;
       &lt;span class="nt"&gt;&amp;lt;/authentication-provider&amp;gt;&lt;/span&gt;
   &lt;span class="nt"&gt;&amp;lt;/authentication-manager&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;/beans:beans&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When we run this application and go to the /enter, we will get the following&amp;nbsp;output:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Username:&amp;nbsp;spapas&lt;/p&gt;
&lt;p&gt;Authorities: [admin, nonldap,&amp;nbsp;user]&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;div class="section" id="spring-security-ldap-with-custom-authorities"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id5"&gt;Spring security &lt;span class="caps"&gt;LDAP&lt;/span&gt; with custom&amp;nbsp;authorities&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The previous application can be modified to login through &lt;span class="caps"&gt;LDAP&lt;/span&gt; and get the authorities from a custom class. The main differences are in the &lt;tt class="docutils literal"&gt;pom.xml&lt;/tt&gt; which adsd the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;spring-security-ldap&lt;/span&gt;&lt;/tt&gt; dependency, the addition of a &lt;tt class="docutils literal"&gt;CustomLdapAuthoritiesPopulator.java&lt;/tt&gt; which does the actual mapping of username to authority and various changes to the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;security-config.xml&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;As you will see we had to define our security beans mainly using spring beans and not using the various elements from security namespace like &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;ldap-server&amp;gt;&lt;/span&gt;&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;ldap-authentication-provder&amp;gt;&lt;/span&gt;&lt;/tt&gt;. For a good tutorial on using these elements and ldap in spring security in general check these out: &lt;a class="reference external" href="http://docs.spring.io/spring-security/site/docs/3.1.x/reference/ldap.html"&gt;http://docs.spring.io/spring-security/site/docs/3.1.x/reference/ldap.html&lt;/a&gt; and &lt;a class="reference external" href="http://krams915.blogspot.gr/2011/01/spring-security-mvc-using-ldap.html"&gt;http://krams915.blogspot.gr/2011/01/spring-security-mvc-using-ldap.html&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;beans:beans&lt;/span&gt; &lt;span class="na"&gt;xmlns=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.springframework.org/schema/security&amp;quot;&lt;/span&gt;
   &lt;span class="na"&gt;xmlns:beans=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.springframework.org/schema/beans&amp;quot;&lt;/span&gt;
   &lt;span class="na"&gt;xmlns:xsi=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.w3.org/2001/XMLSchema-instance&amp;quot;&lt;/span&gt;
   &lt;span class="na"&gt;xsi:schemaLocation=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;http://www.springframework.org/schema/beans&lt;/span&gt;
&lt;span class="s"&gt;                   http://www.springframework.org/schema/beans/spring-beans-3.1.xsd&lt;/span&gt;
&lt;span class="s"&gt;                   http://www.springframework.org/schema/security&lt;/span&gt;
&lt;span class="s"&gt;                   http://www.springframework.org/schema/security/spring-security-3.1.xsd&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;

   &lt;span class="nt"&gt;&amp;lt;http&lt;/span&gt; &lt;span class="na"&gt;pattern=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/static/**&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;security=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;none&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;

   &lt;span class="nt"&gt;&amp;lt;http&lt;/span&gt; &lt;span class="na"&gt;use-expressions=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;true&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;intercept-url&lt;/span&gt; &lt;span class="na"&gt;pattern=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;access=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;permitAll&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;intercept-url&lt;/span&gt; &lt;span class="na"&gt;pattern=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/enter&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;access=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;hasRole(&amp;#39;user&amp;#39;)&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;intercept-url&lt;/span&gt; &lt;span class="na"&gt;pattern=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/**&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;access=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;denyAll&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;form-login&lt;/span&gt; &lt;span class="na"&gt;default-target-url=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;logout&lt;/span&gt;  &lt;span class="na"&gt;logout-success-url=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="nt"&gt;&amp;lt;/http&amp;gt;&lt;/span&gt;

   &lt;span class="nt"&gt;&amp;lt;beans:bean&lt;/span&gt; &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;contextSource&amp;quot;&lt;/span&gt;
         &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;org.springframework.security.ldap.DefaultSpringSecurityContextSource&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;beans:constructor-arg&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;ldap://login.serafeim.gr:389/dc=serafeim,dc=gr&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;beans:property&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;anonymousReadOnly&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="nt"&gt;&amp;lt;/beans:bean&amp;gt;&lt;/span&gt;

   &lt;span class="nt"&gt;&amp;lt;beans:bean&lt;/span&gt;
         &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;userSearch&amp;quot;&lt;/span&gt;
         &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;org.springframework.security.ldap.search.FilterBasedLdapUserSearch&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;beans:constructor-arg&lt;/span&gt; &lt;span class="na"&gt;index=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;0&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;beans:constructor-arg&lt;/span&gt; &lt;span class="na"&gt;index=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;value=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;(uid={0})&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;beans:constructor-arg&lt;/span&gt; &lt;span class="na"&gt;index=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;2&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;ref=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;contextSource&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="nt"&gt;&amp;lt;/beans:bean&amp;gt;&lt;/span&gt;

   &lt;span class="nt"&gt;&amp;lt;beans:bean&lt;/span&gt;
         &lt;span class="na"&gt;id=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;ldapAuthProvider&amp;quot;&lt;/span&gt;
         &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;org.springframework.security.ldap.authentication.LdapAuthenticationProvider&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;beans:constructor-arg&amp;gt;&lt;/span&gt;
       &lt;span class="nt"&gt;&amp;lt;beans:bean&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;org.springframework.security.ldap.authentication.BindAuthenticator&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;
         &lt;span class="nt"&gt;&amp;lt;beans:constructor-arg&lt;/span&gt; &lt;span class="na"&gt;ref=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;contextSource&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
         &lt;span class="nt"&gt;&amp;lt;beans:property&lt;/span&gt; &lt;span class="na"&gt;name=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;userSearch&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;ref=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;userSearch&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
         &lt;span class="c"&gt;&amp;lt;!--&lt;/span&gt;
&lt;span class="c"&gt;         &amp;lt;beans:property name=&amp;quot;userDnPatterns&amp;quot;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;           &amp;lt;beans:list&amp;gt;&amp;lt;beans:value&amp;gt;uid={0},ou=People&amp;lt;/beans:value&amp;gt;&amp;lt;/beans:list&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;         &amp;lt;/beans:property&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;         --&amp;gt;&lt;/span&gt;
       &lt;span class="nt"&gt;&amp;lt;/beans:bean&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;/beans:constructor-arg&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;beans:constructor-arg&amp;gt;&lt;/span&gt;
       &lt;span class="nt"&gt;&amp;lt;beans:bean&lt;/span&gt; &lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;gr.serafeim.springldapcustom.CustomLdapAuthoritiesPopulator&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;/beans:constructor-arg&amp;gt;&lt;/span&gt;
   &lt;span class="nt"&gt;&amp;lt;/beans:bean&amp;gt;&lt;/span&gt;

   &lt;span class="nt"&gt;&amp;lt;authentication-manager&amp;gt;&lt;/span&gt;
     &lt;span class="nt"&gt;&amp;lt;authentication-provider&lt;/span&gt; &lt;span class="na"&gt;ref=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;ldapAuthProvider&amp;quot;&lt;/span&gt; &lt;span class="nt"&gt;/&amp;gt;&lt;/span&gt;
   &lt;span class="nt"&gt;&amp;lt;/authentication-manager&amp;gt;&lt;/span&gt;

&lt;span class="nt"&gt;&amp;lt;/beans:beans&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So, in the above configuration we&amp;#8217;ve defined three spring beans: &lt;tt class="docutils literal"&gt;contextSource&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;userSearch&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;ldapAuthProvider&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;authentication-manager&amp;gt;&lt;/span&gt;&lt;/tt&gt; element uses the &lt;tt class="docutils literal"&gt;ldapAuthProvider&lt;/tt&gt; as an authentication provider. Below we will explain these&amp;nbsp;beans:&lt;/p&gt;
&lt;div class="section" id="contextsource"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;contextSource&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The contextSource bean defines the actual &lt;span class="caps"&gt;LDAP&lt;/span&gt; server that we are going to connect to. It has the class &lt;tt class="docutils literal"&gt;o.s.s.ldap.DefaultSpringSecurityContextSource&lt;/tt&gt;. This will need to be passed to other beans that would need to connect to the server for a number of operations. We pass to it the url of our &lt;span class="caps"&gt;LDAP&lt;/span&gt; server and set its &lt;tt class="docutils literal"&gt;anonymousReadOnly&lt;/tt&gt; property to true. The &lt;tt class="docutils literal"&gt;anonymousReadOnly&lt;/tt&gt; defines if we can anonymously connect to our &lt;span class="caps"&gt;LDAP&lt;/span&gt; server in order to perform the search operation below. If we cannot connect anonymously then we have to set its &lt;tt class="docutils literal"&gt;userDn&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;password&lt;/tt&gt; properties.&lt;/p&gt;
&lt;p&gt;A very interesting question is if the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;ldap-server&amp;gt;&lt;/span&gt;&lt;/tt&gt; element of the spring security namespace is related to &lt;tt class="docutils literal"&gt;the o.s.s.ldap.DefaultSpringSecurityContextSource&lt;/tt&gt; like our &lt;tt class="docutils literal"&gt;contextSource&lt;/tt&gt;. To find out, we need to check the &lt;tt class="docutils literal"&gt;o.s.s.config.SecurityNamespaceHandler&lt;/tt&gt; class of the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;spring-security-config.jar&lt;/span&gt;&lt;/tt&gt;. In there we see the &lt;tt class="docutils literal"&gt;loadParsers&lt;/tt&gt; method which has the line: &lt;tt class="docutils literal"&gt;parsers.put(Elements.LDAP_SERVER, new &lt;span class="pre"&gt;LdapServerBeanDefinitionParser());&lt;/span&gt;&lt;/tt&gt;. The constant &lt;tt class="docutils literal"&gt;o.s.s.config.Elements.LDAP_SERVER&lt;/tt&gt; has the value of &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;quot;ldap-server&amp;quot;&lt;/span&gt;&lt;/tt&gt; as expected, so we need to see what does the class &lt;tt class="docutils literal"&gt;o.s.s.config.ldap.LdapServerBeanDefinitionParser&lt;/tt&gt; do. This class has a parse() method that receives the xml that was used to instantiate the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;ldap-server&amp;gt;&lt;/span&gt;&lt;/tt&gt; element and, depending an on the actualy configuration, instantiates a bean of the class &lt;tt class="docutils literal"&gt;o.s.s.ldap.DefaultSpringSecurityContextSource&lt;/tt&gt; with an id of &lt;tt class="docutils literal"&gt;o.s.s.securityContextSource&lt;/tt&gt; that will be used by the other elements in the security namespace&amp;nbsp;!&lt;/p&gt;
&lt;p&gt;This actually solves another question I had concerning the following&amp;nbsp;error:&lt;/p&gt;
&lt;blockquote&gt;
No bean named &amp;#8216;org.springframework.security.authenticationManager&amp;#8217; is defined: Did you forget to add a gobal &amp;lt;authentication-manager&amp;gt; element to your configuration (with child &amp;lt;authentication-provider&amp;gt;  elements)? Alternatively you can use the authentication-manager-ref attribute on your &amp;lt;http&amp;gt; and &amp;lt;global-method-security&amp;gt; elements.&lt;/blockquote&gt;
&lt;p&gt;What happens is that when spring-security-configuration encounters an &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;authentication-manager&amp;gt;&lt;/span&gt;&lt;/tt&gt; it will instantiate a bean named &lt;tt class="docutils literal"&gt;o.s.s.authenticationManager&lt;/tt&gt;  having the class
&lt;tt class="docutils literal"&gt;o.s.s.authentication.ProviderManager&lt;/tt&gt; and will create and pass to it a &lt;tt class="docutils literal"&gt;providers&lt;/tt&gt; list with all the authentication providers that are defined inside the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;authentication-manager&amp;gt;&lt;/span&gt;&lt;/tt&gt; element with &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;authentication-provider&amp;gt;&lt;/span&gt;&lt;/tt&gt; nodes. So, if you encounter the above error, the problem is that for some reason your &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;&amp;lt;authentication-manager&amp;gt;&lt;/span&gt;&lt;/tt&gt; is not configured correctly, so no &lt;tt class="docutils literal"&gt;o.s.s.authenticatioManager&lt;/tt&gt; bean is&amp;nbsp;created!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="usersearch"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;userSearch&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;userSearch&lt;/tt&gt; bean is needed if we don&amp;#8217;t know exactly where our users are stored in the &lt;span class="caps"&gt;LDAP&lt;/span&gt; directory so we will use this bean as a search filter. If we do know our user tree then we won&amp;#8217;t need this bean at all as will be explained later. It has the class &lt;tt class="docutils literal"&gt;o.s.s.ldap.search.FilterBasedLdapUserSearch&lt;/tt&gt; and gets three constructor parameters: &lt;tt class="docutils literal"&gt;searchBase&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;searchFilter&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;contextSource&lt;/tt&gt;. The &lt;tt class="docutils literal"&gt;searchBase&lt;/tt&gt; is from where in the &lt;span class="caps"&gt;LDAP&lt;/span&gt; tree to start searching (empty in our case), the &lt;tt class="docutils literal"&gt;searchFilter&lt;/tt&gt; defines where is the username (uid in our case) and the &lt;tt class="docutils literal"&gt;contextSource&lt;/tt&gt; has been defined&amp;nbsp;before.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ldapauthprovider"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id8"&gt;ldapAuthProvider&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;This is the actual &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;authentication-provider&lt;/span&gt;&lt;/tt&gt; that the spring-security &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;authentication-manager&lt;/span&gt;&lt;/tt&gt; is going to use. It is an instance of class &lt;tt class="docutils literal"&gt;o.s.s.ldap.authentication.LdapAuthenticationProvider&lt;/tt&gt; which has two main properties: An &lt;tt class="docutils literal"&gt;o.s.s.ldap.authentication.LdapAuthenticator&lt;/tt&gt; implementation and an &lt;tt class="docutils literal"&gt;o.s.s.ldap.userdetails.LdapAuthoritiesPopulator&lt;/tt&gt; implementation. The first interface defines an &lt;tt class="docutils literal"&gt;authenticate&lt;/tt&gt; method and is used to actually authenticate the user with the &lt;span class="caps"&gt;LDAP&lt;/span&gt; server. The second interface defines a &lt;tt class="docutils literal"&gt;getGrantedAuthorities&lt;/tt&gt; which returns the roles for the authenticated user. The LdapAuthoritiesPopulator parameter is actually optional (so we can use &lt;span class="caps"&gt;LDAP&lt;/span&gt; to authenticate only the users) and we can provide our own implementation to have custom authorities for our application. That is exactly what we&amp;#8217;ve done&amp;nbsp;here.&lt;/p&gt;
&lt;p&gt;The two arguments used to initialize the ldapAuthProvoder are one instance of &lt;tt class="docutils literal"&gt;o.s.s.ldap.authentication.BindAuthenticator&lt;/tt&gt; which is a simple authenticator that tries to bind with the given credentials to the &lt;span class="caps"&gt;LDAP&lt;/span&gt; server to check the credentials and one instance of a custom class named &lt;tt class="docutils literal"&gt;g.s.s.CustomLdapAuthoritiesPopulator&lt;/tt&gt; which is the actual implementation of the custom roles provider. The &lt;tt class="docutils literal"&gt;BindAuthenticator&lt;/tt&gt; gets the &lt;tt class="docutils literal"&gt;contextSource&lt;/tt&gt; as a constructor parameter and its &lt;tt class="docutils literal"&gt;userSearch&lt;/tt&gt; property is set with the &lt;tt class="docutils literal"&gt;userSearch&lt;/tt&gt; bean defined previously. If we instead knew the actual place of the users, we could use the commented out &lt;tt class="docutils literal"&gt;userDnPatterns&lt;/tt&gt; property which takes a list of possible places in the &lt;span class="caps"&gt;LDAP&lt;/span&gt; catalog which will be checked for the&amp;nbsp;username.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="customldapauthoritiespopulator"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id9"&gt;CustomLdapAuthoritiesPopulator&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;CustomLdapAuthoritiesPopulator&lt;/tt&gt; just needs to implement the &lt;tt class="docutils literal"&gt;LdapAuthoritiesPopulator&lt;/tt&gt; interface. Here&amp;#8217;s our&amp;nbsp;implmentation:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;package&lt;/span&gt; &lt;span class="nn"&gt;gr.serafeim.springldapcustom&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;java.util.Collection&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;java.util.HashSet&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.ldap.core.DirContextOperations&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.security.core.GrantedAuthority&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.security.core.authority.SimpleGrantedAuthority&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.security.ldap.userdetails.LdapAuthoritiesPopulator&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;org.springframework.stereotype.Component&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;

&lt;span class="nd"&gt;@Component&lt;/span&gt;
&lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="kd"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;CustomLdapAuthoritiesPopulator&lt;/span&gt; &lt;span class="kd"&gt;implements&lt;/span&gt; &lt;span class="n"&gt;LdapAuthoritiesPopulator&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
       &lt;span class="nd"&gt;@Override&lt;/span&gt;
       &lt;span class="kd"&gt;public&lt;/span&gt; &lt;span class="n"&gt;Collection&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;?&lt;/span&gt; &lt;span class="kd"&gt;extends&lt;/span&gt; &lt;span class="n"&gt;GrantedAuthority&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="nf"&gt;getGrantedAuthorities&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;
                       &lt;span class="n"&gt;DirContextOperations&lt;/span&gt; &lt;span class="n"&gt;userData&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="n"&gt;String&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
               &lt;span class="n"&gt;Collection&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;GrantedAuthority&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;gas&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;HashSet&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;GrantedAuthority&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;();&lt;/span&gt;
               &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;equals&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;spapas&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;))&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
                       &lt;span class="n"&gt;gas&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;SimpleGrantedAuthority&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;admin&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
               &lt;span class="o"&gt;}&lt;/span&gt;
               &lt;span class="n"&gt;gas&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;add&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt; &lt;span class="n"&gt;SimpleGrantedAuthority&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;user&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;));&lt;/span&gt;
               &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;gas&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
       &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;tt class="docutils literal"&gt;getGrantedAuthorities&lt;/tt&gt; just checks the username and add another role if it is a specific one. Of course here we would autowire our user roles repository and query the database to get the roles of the user, however I&amp;#8217;m not going to do that for the case of&amp;nbsp;simplicity.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="example"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id10"&gt;Example&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;When we run this application and go to the /enter, after logging in with our &lt;span class="caps"&gt;LDAP&lt;/span&gt; credentials as spapas, we will get the following&amp;nbsp;output:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Username:&amp;nbsp;spapas&lt;/p&gt;
&lt;p&gt;Authorities: [admin,&amp;nbsp;user]&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id11"&gt;Conclusion&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In the previous a complete example of configuring a custom authorities populator was represented. Using this configuration we can login through the &lt;span class="caps"&gt;LDAP&lt;/span&gt; server of our organization but use application specific roles for our logged-in&amp;nbsp;users.&lt;/p&gt;
&lt;!-- font-size: 0.5em;
vertical-align: top; --&gt;
&lt;table class="docutils footnote" frame="void" id="id2" rules="none"&gt;
&lt;colgroup&gt;&lt;col class="label" /&gt;&lt;col /&gt;&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td class="label"&gt;&lt;a class="fn-backref" href="#id1"&gt;[*]&lt;/a&gt;&lt;/td&gt;&lt;td&gt;Which is how spring calls the groups/roles the user belongs to&lt;/td&gt;&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</content><category term="spring"></category><category term="spring"></category><category term="spring-security"></category><category term="java"></category><category term="ldap"></category><category term="authentication"></category></entry><entry><title>gitÂ branches</title><link href="https://spapas.github.io/2013/10/08/git-branches/" rel="alternate"></link><published>2013-10-08T13:20:00+03:00</published><updated>2013-10-08T13:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2013-10-08:/2013/10/08/git-branches/</id><summary type="html">&lt;p class="first last"&gt;Experiments and answers for git&amp;nbsp;branching&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#creating-a-new-git-repository" id="id2"&gt;Creating a new git&amp;nbsp;repository&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#branching" id="id3"&gt;Branching&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#remote-branches" id="id4"&gt;Remote&amp;nbsp;branches&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A &lt;a class="reference external" href="http://git-scm.com/book/en/Git-Branching-What-a-Branch-Is"&gt;branch&lt;/a&gt; is a very interesting git feature. With this you may have more than one &lt;em&gt;branches&lt;/em&gt; in the same repository. The main
usage of this feature would be to create different versions of your source code to parallel test development of different features.
When the development of each of these features has been finished then the different versions would need to be combined (or merged) to a
single version. Of course, merging is not always the result of branching - some branches may exist indefinitely or other may just  be
deleted without&amp;nbsp;merging.&lt;/p&gt;
&lt;p&gt;I will try to experiment with it and comment on the&amp;nbsp;results.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="creating-a-new-git-repository"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Creating a new git&amp;nbsp;repository&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Let&amp;#8217;s start by creating a new git&amp;nbsp;repository:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\&amp;gt;mkdir testgit
D:\&amp;gt;cd testgit
D:\testgit&amp;gt;echo contents 11 &amp;gt; file1.txt
D:\testgit&amp;gt;echo contents 222 &amp;gt; file2.txt
D:\testgit&amp;gt;echo 3333 &amp;gt; file2.txt
D:\testgit&amp;gt;copy con file3.txt
line 1 of file 3

line 3 of file 3

test

line 7 of file 3
^Z
       1 files copied.

D:\testgit&amp;gt;git init
Initialized empty Git repository in D:/testgit/.git/
D:\testgit&amp;gt;git add .
D:\testgit&amp;gt;git commit -m Initial
[master (root-commit) 96ca9af] Initial
 3 files changed, 9 insertions(+)
 create mode 100644 file1.txt
 create mode 100644 file2.txt
 create mode 100644 file3.txt
&lt;/pre&gt;
&lt;p&gt;To see the branch we are in we can use the &lt;tt class="docutils literal"&gt;git branch&lt;/tt&gt; command. Also &lt;tt class="docutils literal"&gt;git status&lt;/tt&gt; outputs the current&amp;nbsp;branch:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git status
# On branch master
nothing to commit, working directory clean
D:\testgit&amp;gt;git branch
* master
&lt;/pre&gt;
&lt;p&gt;So, it seems that when we create a new repository, a &amp;#8220;master&amp;#8221; branch is&amp;nbsp;created.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="branching"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Branching&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Lets create a new branch and change our working branch to&amp;nbsp;it:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git branch slave
D:\testgit&amp;gt;git branch
* master
  slave
D:\testgit&amp;gt;git checkout slave
Switched to branch 'slave'
D:\testgit&amp;gt;git branch
  master
* slave
&lt;/pre&gt;
&lt;p&gt;We can see that now the slave branch is the current one. Let&amp;#8217;s do some changes and add commit them to the slave&amp;nbsp;branch:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git branch
  master
* slave
D:\testgit&amp;gt;echo new file1 contents &amp;gt; file1.txt
D:\testgit&amp;gt;git commit -m &amp;quot;Slave modification&amp;quot;
[slave b6083ad] Slave modification
 1 file changed, 1 insertion(+), 1 deletion(-)
D:\testgit&amp;gt;git checkout master
Switched to branch 'master'
D:\testgit&amp;gt;more file1.txt
contents 11
D:\testgit&amp;gt;git checkout slave
Switched to branch 'slave'
D:\testgit&amp;gt;more file1.txt
new file1 contents
&lt;/pre&gt;
&lt;p&gt;So the contents of file1.txt in the branch master is &lt;tt class="docutils literal"&gt;contents 11&lt;/tt&gt; while the contents of the same file
in the branch slave is &lt;tt class="docutils literal"&gt;new file1 contents&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;An interested behaviour is what happens with uncommit changes when changing branches. Let&amp;#8217;s try deleting a&amp;nbsp;file:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;del file2.txt
D:\testgit&amp;gt;git status
# On branch master
# Changes not staged for commit:
#   (use &amp;quot;git add/rm &amp;lt;file&amp;gt;...&amp;quot; to update what will be committed)
#   (use &amp;quot;git checkout -- &amp;lt;file&amp;gt;...&amp;quot; to discard changes in working directory)
#
#       deleted:    file2.txt
#
no changes added to commit (use &amp;quot;git add&amp;quot; and/or &amp;quot;git commit -a&amp;quot;)
D:\testgit&amp;gt;git checkout slave
D       file2.txt
Switched to branch 'slave'
D:\testgit&amp;gt;git status
# On branch slave
# Changes not staged for commit:
#   (use &amp;quot;git add/rm &amp;lt;file&amp;gt;...&amp;quot; to update what will be committed)
#   (use &amp;quot;git checkout -- &amp;lt;file&amp;gt;...&amp;quot; to discard changes in working directory)
#
#       deleted:    file2.txt
#
no changes added to commit (use &amp;quot;git add&amp;quot; and/or &amp;quot;git commit -a&amp;quot;)
D:\testgit&amp;gt;git add -A
D:\testgit&amp;gt;git status
# On branch slave
# Changes to be committed:
#   (use &amp;quot;git reset HEAD &amp;lt;file&amp;gt;...&amp;quot; to unstage)
#
#       deleted:    file2.txt
#
D:\testgit&amp;gt;git checkout master
D       file2.txt
Switched to branch 'master'
D:\testgit&amp;gt;git status
# On branch master
# Changes to be committed:
#   (use &amp;quot;git reset HEAD &amp;lt;file&amp;gt;...&amp;quot; to unstage)
#
#       deleted:    file2.txt
#
&lt;/pre&gt;
&lt;p&gt;So, our changes are not correlated with a branch until we commit them! Let&amp;#8217;s commit them to the master repository and confirm&amp;nbsp;that:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git commit -m &amp;quot;Deleted file2.txt&amp;quot;
[master 6f8749d] Deleted file2.txt
 1 file changed, 1 deletion(-)
 delete mode 100644 file2.txt
D:\testgit&amp;gt;git status
# On branch master
nothing to commit, working directory clean
D:\testgit&amp;gt;dir file2.txt
[...]
File not found
D:\testgit&amp;gt;git checkout slave
Switched to branch 'slave'
D:\testgit&amp;gt;git status
# On branch slave
nothing to commit, working directory clean
D:\testgit&amp;gt;dir file2.txt
[...]
08/10/2013  05:59 pm                15 file2.txt
&lt;/pre&gt;
&lt;p&gt;This is interesting&amp;#8230; Let&amp;#8217;s try modifying the file2.txt (which does not exist to the master&amp;nbsp;branch):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git branch
  master
* slave
D:\testgit&amp;gt;echo new file2 contents &amp;gt; file2.txt
D:\testgit&amp;gt;git add .
D:\testgit&amp;gt;git status
# On branch slave
# Changes to be committed:
#   (use &amp;quot;git reset HEAD &amp;lt;file&amp;gt;...&amp;quot; to unstage)
#
#       modified:   file2.txt
#
D:\testgit&amp;gt;git checkout master
error: Your local changes to the following files would be overwritten by checkout:
       file2.txt
Please, commit your changes or stash them before you can switch branches.
Aborting
&lt;/pre&gt;
&lt;p&gt;We won&amp;#8217;t be able to change the current branch until we commit the conflicting&amp;nbsp;change:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git commit -m &amp;quot;Modified file2&amp;quot;
[slave b5af832] Modified file2
 1 file changed, 1 insertion(+), 1 deletion(-)
D:\testgit&amp;gt;git checkout master
Switched to branch 'master'
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="remote-branches"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Remote&amp;nbsp;branches&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;For each local repository you can define a number of remote repositories, or &lt;a class="reference external" href="http://git-scm.com/book/en/Git-Basics-Working-with-Remotes"&gt;remotes&lt;/a&gt; as git calls them.
When you clone a repository from github.com, your local repository will have one remote, named origin. We will
try to add the same remote by hand. Let&amp;#8217;s suppose that we have created a repository in github.com named
testgit. After that we wil&amp;nbsp;issue:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git remote
D:\testgit&amp;gt;git remote add origin https://github.com/spapas/testgit.git
D:\testgit&amp;gt;git remote
origin
&lt;/pre&gt;
&lt;p&gt;So no we have one remote named origin that is linked with &lt;a class="reference external" href="https://github.com/spapas/testgit.git"&gt;https://github.com/spapas/testgit.git&lt;/a&gt;. Let&amp;#8217;s try to push our master
branch to the origin&amp;nbsp;remote:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git push origin master
Username for 'https://github.com': spapas
Password for 'https://spapas&amp;#64;github.com':
Counting objects: 7, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (5/5), done.
Writing objects: 100% (7/7), 531 bytes, done.
Total 7 (delta 1), reused 0 (delta 0)
To https://github.com/spapas/testgit.git
 * [new branch]      master -&amp;gt; master
D:\testgit&amp;gt;git branch -r
  master
* slave
  remote/origin/master
&lt;/pre&gt;
&lt;p&gt;We see now that we have &lt;em&gt;three&lt;/em&gt; branches. Two local (master slave) and one remote (origin/master).  We will also add the slave remote&amp;nbsp;(origin/slave):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git branch -r
  origin/master
  origin/slave
&lt;/pre&gt;
&lt;p&gt;Let&amp;#8217;s do a change to our local repository and then push them to the&amp;nbsp;remote:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;notepad file3.txt
D:\testgit&amp;gt;git add .
D:\testgit&amp;gt;git status
# On branch slave
# Changes to be committed:
#   (use &amp;quot;git reset HEAD &amp;lt;file&amp;gt;...&amp;quot; to unstage)
#
#       modified:   file3.txt
#
D:\testgit&amp;gt;git commit -m &amp;quot;Changed file3.txt&amp;quot;
[slave ce3b7b9] Changed file3.txt
 1 file changed, 1 insertion(+), 1 deletion(-)
D:\testgit&amp;gt;git push origin slave
Username for 'https://github.com': spapas
Password for 'https://spapas&amp;#64;github.com':
Counting objects: 5, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 299 bytes, done.
Total 3 (delta 1), reused 0 (delta 0)
To https://github.com/spapas/testgit.git
   b5af832..ce3b7b9  slave -&amp;gt; slave
&lt;/pre&gt;
&lt;p&gt;Everything works as expected. The final thing to test is to try checking out a remote&amp;nbsp;branch:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git checkout master
Switched to branch 'master'
D:\testgit&amp;gt;echo new new file1 &amp;gt; file1.txt
D:\testgit&amp;gt;more file1.txt
 new new file1
D:\testgit&amp;gt;git checkout origin/master
M       file1.txt
Note: checking out 'origin/master'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -b with the checkout command again. Example:

  git checkout -b new_branch_name

HEAD is now at 6f8749d... Deleted file2.txt
D:\testgit&amp;gt;git status
# Not currently on any branch.
# Changes not staged for commit:
#   (use &amp;quot;git add &amp;lt;file&amp;gt;...&amp;quot; to update what will be committed)
#   (use &amp;quot;git checkout -- &amp;lt;file&amp;gt;...&amp;quot; to discard changes in working directory)
#
#       modified:   file1.txt
#
no changes added to commit (use &amp;quot;git add&amp;quot; and/or &amp;quot;git commit -a&amp;quot;)
D:\testgit&amp;gt;more file1.txt
new new file1
&lt;/pre&gt;
&lt;p&gt;So, it seems that  when we check out the remote branch, we won&amp;#8217;t have any local branches, however the change we did to the file1.txt
is transfered just like when switching from one local repository to another. We can then add the changes and&amp;nbsp;commit:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git add .
D:\testgit&amp;gt;git commit
[detached HEAD 506674c] foo
 1 file changed, 1 insertion(+), 1 deletion(-)
 D:\testgit&amp;gt;git status
# Not currently on any branch.
nothing to commit, working directory clean
D:\testgit&amp;gt;git branch
* (no branch)
  master
  slave
&lt;/pre&gt;
&lt;p&gt;So we are working with an unnamed branch! We have to name it to be able to work without&amp;nbsp;problems:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
D:\testgit&amp;gt;git checkout -b named_branch
Switched to a new branch 'named_branch'
D:\testgit&amp;gt;git branch
  master
* named_branch
  slave
&lt;/pre&gt;
&lt;p&gt;Finally we may push again the named_branch to our remote&amp;nbsp;origin.&lt;/p&gt;
&lt;/div&gt;
</content><category term="git"></category><category term="git"></category><category term="github"></category><category term="branching"></category></entry><entry><title>Using pelican to generate static sites onÂ windows</title><link href="https://spapas.github.io/2013/10/07/pelican-static-windows/" rel="alternate"></link><published>2013-10-07T10:20:00+03:00</published><updated>2013-10-07T10:20:00+03:00</updated><author><name>Serafeim Papastefanos</name></author><id>tag:spapas.github.io,2013-10-07:/2013/10/07/pelican-static-windows/</id><summary type="html">&lt;p class="first last"&gt;A quick and dirty tutorial for generating a static site with pelican on Windows and hosting it to github.io as&amp;nbsp;username.github.io.&lt;/p&gt;
</summary><content type="html">&lt;div class="contents topic" id="contents"&gt;
&lt;p class="topic-title first"&gt;Contents&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="#introduction" id="id1"&gt;Introduction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#installing-pelican-and-generating-a-skeleton-for-your-site" id="id2"&gt;Installing pelican and generating a skeleton for your&amp;nbsp;site&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#modifying-pelican-tools-for-windows" id="id3"&gt;Modifying pelican tools for&amp;nbsp;windows&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#configuration-of-your-skeleton-site" id="id4"&gt;Configuration of your skeleton site&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="#settings" id="id5"&gt;Settings&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#themes" id="id6"&gt;Themes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#plugins" id="id7"&gt;Plugins&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#hosting-in-github-pages" id="id8"&gt;Hosting in github&amp;nbsp;pages&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="#publishing-changes" id="id9"&gt;Publishing&amp;nbsp;changes&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="introduction"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id1"&gt;Introduction&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;&lt;a class="reference external" href="http://docs.getpelican.com/en/3.3.0/"&gt;Pelican&lt;/a&gt; is a great static site generator. A static site generator is a tool that users a number of input files to
generate a complete html site. No database or server side scripting is needed for the resulting site, that&amp;#8217;s why
many such sites are hosted on &lt;a class="reference external" href="http://pages.github.com/"&gt;github pages&lt;/a&gt; (more on this&amp;nbsp;later).&lt;/p&gt;
&lt;p&gt;The input contains a number of html templates, css styles and the actual content of the site which most of the time is written in a
&lt;a class="reference external" href="http://en.wikipedia.org/wiki/Lightweight_markup_language"&gt;lightweight markup language&lt;/a&gt; like &lt;a class="reference external" href="http://docutils.sourceforge.net/rst.html"&gt;reStructuredText&lt;/a&gt; or &lt;a class="reference external" href="http://daringfireball.net/projects/markdown/"&gt;Markdown&lt;/a&gt;. The static site generator will generate the static pages by
inserting the content in the appropriate places in the&amp;nbsp;templates.&lt;/p&gt;
&lt;p&gt;In the following sections we will describe the installation of pelican on Windows
and the creation of the spapas.github.io&amp;nbsp;site.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="installing-pelican-and-generating-a-skeleton-for-your-site"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id2"&gt;Installing pelican and generating a skeleton for your&amp;nbsp;site&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The official pelican quickstart can be found in &lt;a class="reference external" href="http://docs.getpelican.com/en/latest/getting_started.html"&gt;http://docs.getpelican.com/en/latest/getting_started.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;To install pelican just&amp;nbsp;enter:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
&amp;gt;pip install pelican
&lt;/pre&gt;
&lt;p&gt;After installing pelican, I propose creating a parent directory that will
contain all your pelican sites, along with extra themes and plugins like&amp;nbsp;this:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
pelican/
  âââ pelican-themes
  âââ other-pelican-theme
  âââ spapas.github.io
  âââ other-sites
&lt;/pre&gt;
&lt;p&gt;After creating the pelican directory just go in it with a command line and run the &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;pelican-quickstart&lt;/span&gt;&lt;/tt&gt; command.
It will ask you a number of questions, take a look at how I did answer&amp;nbsp;these:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
pelican&amp;gt;pelican-quickstart
Welcome to pelican-quickstart v3.2.2.

This script will help you create a new Pelican-based website.

Please answer the following questions so this script can generate the files
needed by Pelican.


&amp;gt; Where do you want to create your new web site? [.] spapas.github.io
&amp;gt; What will be the title of this web site? Test github.io
&amp;gt; Who will be the author of this web site? Serafeim
&amp;gt; What will be the default language of this web site? [en]
&amp;gt; Do you want to specify a URL prefix? e.g., http://example.com   (Y/n)
&amp;gt; What is your URL prefix? (see above example; no trailing slash) http://spapas.github.io
&amp;gt; Do you want to enable article pagination? (Y/n)
&amp;gt; How many articles per page do you want? [10]
&amp;gt; Do you want to generate a Makefile to easily manage your website? (Y/n) n
&amp;gt; Do you want an auto-reload &amp;amp; simpleHTTP script to assist with theme and site development? (Y/n) n
Done. Your new project is available at C:\progr\py\pelican\spapas.github.io
&lt;/pre&gt;
&lt;p&gt;After that, you will have a pelican/spapas.github.io folder that will contain the following&amp;nbsp;content:&lt;/p&gt;
&lt;pre class="literal-block"&gt;
spapas.github.io/
  âââ content
  âââ output
  âââ pelicanconf.py
  âââ publishconf.py
&lt;/pre&gt;
&lt;p&gt;The content folder will contain your content (rst or markdown), the output will contain the generated html after you run pelican for your site.
The &lt;tt class="docutils literal"&gt;pelicanconf.py&lt;/tt&gt; will have a number of options for the generation of the development version of your site while the &lt;tt class="docutils literal"&gt;publishconf.py&lt;/tt&gt; will override some of the options
of &lt;tt class="docutils literal"&gt;pelicanconf.py&lt;/tt&gt; before generating the production version of your site that will actually be uploaded to github&amp;nbsp;pages.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="modifying-pelican-tools-for-windows"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id3"&gt;Modifying pelican tools for&amp;nbsp;windows&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Pelican uses a Makefile and a unix shell script to generate the static html files and start an http server for development.
Because I prefer to use windows, I answered no to the questions of generating these when pelican-quickstarte asked me.
Instead I have included the following files inside the spapas.github.io&amp;nbsp;directory:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;pelrun.bat&lt;/tt&gt;, to generate the content for your debug site in the output&amp;nbsp;directory:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code literal-block"&gt;
pelican content --debug --autoreload  --output output --settings pelicanconf.py
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;pelserve.bat&lt;/tt&gt;, to localy serve the generated debug&amp;nbsp;site:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code literal-block"&gt;
pushd output
python -m pelican.server
popd
&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;tt class="docutils literal"&gt;pelpub.bat&lt;/tt&gt;, to generate the production site in the output&amp;nbsp;directory:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="code literal-block"&gt;
pelican content --output output --settings publishconf.py
&lt;/pre&gt;
&lt;p&gt;Now, when you want to develop your site locally,&amp;nbsp;enter:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
spapas.github.io&amp;gt;start pelrun.bat
spapas.github.io&amp;gt;start pelserv.bat
&lt;/pre&gt;
&lt;p&gt;If everything was ok until now, you can visit &lt;a class="reference external" href="http://127.0.0.1:8000"&gt;http://127.0.0.1:8000&lt;/a&gt; and will get the following&amp;nbsp;output:&lt;/p&gt;
&lt;img alt="all ok!" src="/images/site1.png" style="width: 780px;" /&gt;
&lt;p&gt;Because of the -r option that is used in &lt;tt class="docutils literal"&gt;pelrun.bat&lt;/tt&gt; whenever you do a change (for instance when you add an rst file in the content directory)
it will be discovered and the output will be changed&amp;nbsp;immediately!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="configuration-of-your-skeleton-site"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id4"&gt;Configuration of your skeleton&amp;nbsp;site&lt;/a&gt;&lt;/h2&gt;
&lt;div class="section" id="settings"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id5"&gt;Settings&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;There is a number of settings that you may configure in your site. The pelican settings reference can be found here: &lt;a class="reference external" href="http://docs.getpelican.com/en/latest/settings.html"&gt;http://docs.getpelican.com/en/latest/settings.html&lt;/a&gt;.
The pelicanconf.py and publishconf.py for this site can be found&amp;nbsp;here:&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://github.com/spapas/spapas.github.io/blob/source/pelicanconf.py"&gt;https://github.com/spapas/spapas.github.io/blob/source/pelicanconf.py&lt;/a&gt;
&lt;a class="reference external" href="https://github.com/spapas/spapas.github.io/blob/source/publishconf.py"&gt;https://github.com/spapas/spapas.github.io/blob/source/publishconf.py&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The most important difference is the RELATIVE_URLS directive which must be True to the debug and False to the&amp;nbsp;production.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="themes"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id6"&gt;Themes&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Beyond the default pelican theme, you can use configure pelican to use various other themes. To enable them, go to your pelican parent directory and clone the pelican-themes github&amp;nbsp;repository:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
pelican&amp;gt;git clone https://github.com/getpelican/pelican-themes.git
&lt;/pre&gt;
&lt;p&gt;After that, you may select your theme from&amp;nbsp;pelicanconf.py:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
THEME = &amp;quot;../pelican-themes/theme-name&amp;quot;
&lt;/pre&gt;
&lt;p&gt;In my configuration, I am using the Octopress Theme for Pelican, which you may get from here &lt;a class="reference external" href="https://github.com/duilio/pelican-octopress-theme"&gt;https://github.com/duilio/pelican-octopress-theme&lt;/a&gt;. Just clone it to your
pelican directory and refer to it as&amp;nbsp;above.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="plugins"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="#id7"&gt;Plugins&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Pelican has a number of plugins. To enable them, go to your pelican parent directory and clone the pelican-plugins github&amp;nbsp;repository:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
pelican&amp;gt;git clone https://github.com/getpelican/pelican-plugins.git
&lt;/pre&gt;
&lt;p&gt;After that, you may add the following two lines to your&amp;nbsp;pelicanconf.py:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
PLUGIN_PATH = '../pelican-plugins'
PLUGINS = ['a-plugin']
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="hosting-in-github-pages"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id8"&gt;Hosting in github&amp;nbsp;pages&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;To host your static site in github pages you must first of all create a repository named
username.github.io (for instance spapas.github.io) from&amp;nbsp;github.&lt;/p&gt;
&lt;p&gt;Then, generate your production&amp;nbsp;output:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
spapas.github.io&amp;gt;pelpub.bat
&lt;/pre&gt;
&lt;p&gt;Finally, go to your output directory, create a git repository, add everything and push it to your&amp;nbsp;repository:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
spapas.github.io\output&amp;gt;git init
spapas.github.io\output&amp;gt;git add .
spapas.github.io\output&amp;gt;git commit -m Initial
spapas.github.io\output&amp;gt;git remote add origin https://github.com/spapas/spapas.github.io.git
spapas.github.io\output&amp;gt;git push origin master --force
&lt;/pre&gt;
&lt;p&gt;The &amp;#8212;force is to overwrite any previous versions - you don&amp;#8217;t care about version control on your output (but you want it on your&amp;nbsp;source).&lt;/p&gt;
&lt;p&gt;You can now visit &lt;a class="reference external" href="http://username.github.io"&gt;http://username.github.io&lt;/a&gt; and see your statically generated site&amp;nbsp;!&lt;/p&gt;
&lt;p&gt;Don&amp;#8217;t forget to add your source to the version control! To do that, add a .gitignore file in your pelican/username.github.io direcory
containing the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
output
&lt;/pre&gt;
&lt;p&gt;The above file will ignore the contents of the output directory from version control. After that, do the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
spapas.github.io&amp;gt;git init
spapas.github.io&amp;gt;git add .
spapas.github.io&amp;gt;git commit -m Initial
spapas.github.io&amp;gt;git branch -m master source
spapas.github.io&amp;gt;git remote add origin https://github.com/spapas/spapas.github.io.git
spapas.github.io&amp;gt;git push origin source
&lt;/pre&gt;
&lt;p&gt;The above will rename the master branch to source, will attach the origin remote to &lt;a class="reference external" href="https://github.com/spapas/spapas.github.io.git"&gt;https://github.com/spapas/spapas.github.io.git&lt;/a&gt; and will push the source
branch to it. Now you will have two branches in your username.github.io repository. One
named origin/master that will be your actual site and will be displayed through &lt;a class="reference external" href="http://username.github.io"&gt;http://username.github.io&lt;/a&gt; and one named origin/source that will contain the source of your&amp;nbsp;site.&lt;/p&gt;
&lt;p&gt;To learn more about branches and remotes you may check out &lt;a class="reference external" href="https://spapas.github.io/2013/10/08/git-branches/"&gt;the git branches article&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="publishing-changes"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="#id9"&gt;Publishing&amp;nbsp;changes&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Whenever you need to publish a new article or do changes to an existing one, you need to do the&amp;nbsp;following:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Run pelpub.bat to create the new&amp;nbsp;output&lt;/li&gt;
&lt;li&gt;Add/commit and push changes from your pelican site(source) folder to the source&amp;nbsp;remote&lt;/li&gt;
&lt;li&gt;Add/commit and push changes from your output folder to the master&amp;nbsp;remote&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To help with this, here&amp;#8217;s a ghdeploy.bat file that does all the&amp;nbsp;above:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
call pelpub.bat
git add -A
git commit -m &amp;quot;Deploying changes&amp;quot;
git push origin source
pushd output
git add -A
git commit -m &amp;quot;Deploying changes&amp;quot;
git push origin master
popd
&lt;/pre&gt;
&lt;p&gt;If you&amp;#8217;ve followed this far, by running &lt;tt class="docutils literal"&gt;pelpub.bat&lt;/tt&gt; you&amp;#8217;ll need to enter your github repository credentials (twice) and then
everything (source and master) will be deployed! To make things even better, I propose to use &lt;a class="reference external" href="https://help.github.com/articles/generating-ssh-keys/"&gt;ssh based authentication&lt;/a&gt;
to your github account and add new remote names to your source and master by running the&amp;nbsp;following:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;
git remote add origin2 git&amp;#64;github.com:spapas/spapas.github.io.git
&lt;/pre&gt;
&lt;p&gt;to your pelican site and the output directories. After you change ghdeploy.bat to use &lt;tt class="docutils literal"&gt;origin2&lt;/tt&gt; instead of &lt;tt class="docutils literal"&gt;origin&lt;/tt&gt; you&amp;#8217;ll be
able to deploy everything with just running it without entering any&amp;nbsp;credentials!&lt;/p&gt;
&lt;/div&gt;
</content><category term="pelican"></category><category term="static-html"></category><category term="github.io"></category><category term="github"></category><category term="pelican"></category><category term="windows"></category><category term="python"></category><category term="github-pages"></category><category term="rst"></category></entry></feed>