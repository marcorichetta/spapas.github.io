<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

  <head>
    <meta charset="utf-8">
    <meta name="google-site-verification" content="5_8DTmIiEq4gFvNAfxAD6TsGOgrMAjp8lQFQvfA6zZc" />
    <title>Automatically create a category table in Postgresql by extracting unique table values &mdash; /var/</title>
    <meta name="author" content="Serafeim Papastefanos">






    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="https://spapas.github.io/favicon.png" rel="icon">

    <link href="https://spapas.github.io/theme/css/main.css" media="screen, projection" rel="stylesheet"
      type="text/css">

    <link href="https://spapas.github.io/theme/css/extra_style.css" media="screen, projection" rel="stylesheet"
      type="text/css">

    <link href="https://fonts.googleapis.com/css?family=Fira+Mono|Fira+Sans:400,700&amp;subset=greek" rel="stylesheet">


    <script data-ad-client="pub-7673322832689008" async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  </head>

<body>
  <header role="banner"><hgroup>
  <h1><a href="https://spapas.github.io/">/var/</a></h1>
    <h2>Various programming stuff</h2>
</hgroup></header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
</ul>


<ul class="main-navigation">
      <li >
        <a href="https://spapas.github.io/category/android.html">Android</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/css.html">Css</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/django.html">Django</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/elixir.html">Elixir</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/flask.html">Flask</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/git.html">Git</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/html.html">Html</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/javascript.html">Javascript</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/pelican.html">Pelican</a>
      </li>
      <li class="active">
        <a href="https://spapas.github.io/category/postgresql.html">Postgresql</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/python.html">Python</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/spring.html">Spring</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/unix.html">Unix</a>
      </li>
      <li >
        <a href="https://spapas.github.io/category/wagtail.html">Wagtail</a>
      </li>
</ul></nav>
  <div id="main">
    <div id="content">
<div>
  <article class="hentry" role="article">
<header>
      <h1 class="entry-title">Automatically create a category table in Postgresql by extracting unique table values</h1>
    <p class="meta">
<time datetime="2017-07-04T09:05:00+03:00" pubdate>Τρι 04 Ιούλιος 2017</time>    </p>
</header>

<div class="entry-content"><p>Recently I was given an <span class="caps">SQL</span> table containing some useful data. The problem with that table was that it was was non-properly normalized but was completely flat,
i.e all its columns contained varchar values while, some of them should have instead contained foreign keys to other tables. Here&#8217;s an example of how this
table looked&nbsp;like:</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="25%" />
<col width="28%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head" colspan="4">Parts</th>
</tr>
<tr><th class="head"><span class="caps">ID</span></th>
<th class="head">Serial</th>
<th class="head">Category</th>
<th class="head">Manufacturer</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>1</td>
<td>423431</td>
<td>Monitor</td>
<td><span class="caps">LG</span></td>
</tr>
<tr><td>2</td>
<td>534552</td>
<td>Monitor</td>
<td><span class="caps">LG</span></td>
</tr>
<tr><td>3</td>
<td>435634</td>
<td>Printer</td>
<td><span class="caps">HP</span></td>
</tr>
<tr><td>4</td>
<td>534234</td>
<td>Printer</td>
<td>Samsung</td>
</tr>
<tr><td>5</td>
<td>234212</td>
<td>Monitor</td>
<td>Samsung</td>
</tr>
<tr><td>6</td>
<td>123123</td>
<td>Monitor</td>
<td><span class="caps">LG</span></td>
</tr>
</tbody>
</table>
<p>The normalized version of this table should have been instead like&nbsp;this:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="23%" />
<col width="28%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head" colspan="4">Parts</th>
</tr>
<tr><th class="head"><span class="caps">ID</span></th>
<th class="head">Serial</th>
<th class="head">Category_id</th>
<th class="head">Manufacturer_id</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>1</td>
<td>423431</td>
<td>1</td>
<td>1</td>
</tr>
<tr><td>2</td>
<td>534552</td>
<td>1</td>
<td>1</td>
</tr>
<tr><td>3</td>
<td>435634</td>
<td>2</td>
<td>2</td>
</tr>
<tr><td>4</td>
<td>534234</td>
<td>2</td>
<td>3</td>
</tr>
<tr><td>5</td>
<td>234212</td>
<td>1</td>
<td>3</td>
</tr>
<tr><td>6</td>
<td>123123</td>
<td>1</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>with the following extra tables that contain the category values with proper foreign&nbsp;keys:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head" colspan="2">Category</th>
</tr>
<tr><th class="head"><span class="caps">ID</span></th>
<th class="head">Name</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>1</td>
<td>Monitor</td>
</tr>
<tr><td>2</td>
<td>Printer</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head" colspan="2">Manufacturer</th>
</tr>
<tr><th class="head"><span class="caps">ID</span></th>
<th class="head">Name</th>
</tr>
</thead>
<tbody valign="top">
<tr><td>1</td>
<td>Monitor</td>
</tr>
<tr><td>2</td>
<td>Printer</td>
</tr>
</tbody>
</table>
<p>The normalized version should be used instead of the flat one <a class="reference external" href="http://www.imdb.com/title/tt0057012/quotes?item=qt0454452">for reasons which at this moment must be all too obvious</a>.</p>
<p>Having such non-normalized tables is also a common problem I experience with Django: When creating a model
I usually define some <tt class="docutils literal">CharField</tt>  with pre-defined <tt class="docutils literal">choices</tt> which &#8220;will never change&#8221;. Sometime during the
development (if I am lucky) or when the project is live for years I will be informed that the choices need not
only to be changed but must be changed by the users of the site without the need to change the source code! Or
that the choices/categories have properties (beyond their name) that need to be defined and used in the project. Both
of these cases mean that these categories need to be extracted from simple strings to full Django models (i.e get
normalized in their own&nbsp;table)!</p>
<p>In this post I will present a function written in <span class="caps">PL</span>/pgsql that will automatically normalize a column from a
flat table like the previous. Specifically, using the previous example,
if you have a table named <tt class="docutils literal">part</tt> that has a non-normalized
column named <tt class="docutils literal">category</tt> then when you call <tt class="docutils literal">select <span class="pre">export_relation('part',</span> 'category')</tt> the following
will&nbsp;happen:</p>
<ul class="simple">
<li>A new table named <tt class="docutils literal">part_category</tt> will be created. This table will contain two columns <tt class="docutils literal">id</tt> and <tt class="docutils literal">name</tt>, with <tt class="docutils literal">id</tt> being the primary key and <tt class="docutils literal">name</tt> having a unique constraint. If the table exists it will be dropped and&nbsp;re-ccreated</li>
<li>A new column named <tt class="docutils literal">category_id</tt> will be added to <tt class="docutils literal">part</tt>. This column will be a foreign key to the new table <tt class="docutils literal">part_category</tt>.</li>
<li><dl class="first docutils">
<dt>For each unique value <tt class="docutils literal">v</tt> of <tt class="docutils literal">category</tt>:</dt>
<dd><ul class="first last">
<li>Insert a new record in <tt class="docutils literal">part_category</tt> with <tt class="docutils literal">v</tt> in the <tt class="docutils literal">name</tt> field of the table and save the inserted id to <tt class="docutils literal">current_id</tt></li>
<li>Set <tt class="docutils literal">current_id</tt> to <tt class="docutils literal">category_id</tt>  to all rows of <tt class="docutils literal">part</tt> where <tt class="docutils literal">category</tt> has the value of <tt class="docutils literal">v</tt></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>Before diving in to the <span class="caps">PL</span>/pgSQL script that does the above changes to the table I&#8217;d like to notice that I am
not very experienced with <span class="caps">PL</span>/pgSQL since I rarerly use it
(I actually avoid writing code in the database) however, because the case I described is ideal for using a database script
I&#8217;ve bitten the bullet and implemented&nbsp;it.</p>
<p>Beyond it&#8217;s actual functionality, this script can be used as a reference/cookbook for common <span class="caps">PL</span>/pgSQL&nbsp;tasks:</p>
<ul class="simple">
<li>Create/define a <span class="caps">PL</span>/pgSQL function (stored&nbsp;procedure)</li>
<li>Declare&nbsp;variables</li>
<li>Assign values to&nbsp;variables</li>
<li>Execute <span class="caps">SQL</span> commands with variable defined table / column&nbsp;names</li>
<li>Log process in <span class="caps">PL</span>/pgSQL</li>
<li>Executing code&nbsp;conditionally</li>
<li>Loop through the rows of a&nbsp;query</li>
<li>Save the primary key of an inserted&nbsp;row</li>
</ul>
<p>The script works however I feel that more experienced <span class="caps">PL</span>/pgSQL developers would write things different - if you have any
proposals please comment out and I&#8217;ll be happy to incorporate them to the&nbsp;script.</p>
<p>Now, let&#8217;s now take a look at the actual&nbsp;script:</p>
<div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">FUNCTION</span> <span class="n">export_relation</span><span class="p">(</span><span class="n">table_name</span> <span class="nb">varchar</span><span class="p">,</span> <span class="n">column_name</span> <span class="nb">varchar</span><span class="p">)</span>
<span class="k">RETURNS</span> <span class="nb">void</span> <span class="k">AS</span> <span class="s">$$</span>
<span class="k">DECLARE</span>
    <span class="n">val</span> <span class="nb">varchar</span><span class="p">;</span>
    <span class="n">res</span> <span class="nb">boolean</span><span class="p">;</span>
    <span class="n">new_table_name</span> <span class="nb">varchar</span><span class="p">;</span>
    <span class="n">new_column_name</span> <span class="nb">varchar</span><span class="p">;</span>
    <span class="n">current_id</span> <span class="nb">int</span><span class="p">;</span>
<span class="k">BEGIN</span>
    <span class="n">new_table_name</span> <span class="o">:=</span> <span class="n">table_name</span> <span class="o">||</span> <span class="s1">&#39;_&#39;</span> <span class="o">||</span> <span class="n">column_name</span><span class="p">;</span>
    <span class="n">new_column_name</span> <span class="o">:=</span> <span class="n">column_name</span> <span class="o">||</span> <span class="s1">&#39;_id&#39;</span> <span class="p">;</span>

    <span class="k">execute</span> <span class="n">format</span> <span class="p">(</span><span class="s1">&#39;drop table if exists %s cascade&#39;</span><span class="p">,</span> <span class="n">new_table_name</span><span class="p">);</span>
    <span class="k">execute</span> <span class="n">format</span> <span class="p">(</span><span class="s1">&#39;CREATE TABLE %s (id serial NOT NULL, name character varying(255) NOT NULL, CONSTRAINT %s_pkey PRIMARY KEY (id), CONSTRAINT %s_unique UNIQUE (name))WITH ( OIDS=FALSE)&#39;</span><span class="p">,</span>
        <span class="n">new_table_name</span><span class="p">,</span> <span class="n">new_table_name</span><span class="p">,</span> <span class="n">new_table_name</span>
    <span class="p">);</span>

    <span class="k">execute</span> <span class="n">format</span><span class="p">(</span><span class="s1">&#39;select exists(SELECT column_name  FROM information_schema.columns WHERE table_name=&#39;&#39;%s&#39;&#39; and column_name=&#39;&#39;%s&#39;&#39;) as x&#39;</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">new_column_name</span><span class="p">)</span> <span class="k">into</span> <span class="n">res</span><span class="p">;</span>
    <span class="k">if</span> <span class="n">res</span> <span class="k">is</span> <span class="k">false</span> <span class="k">then</span>
        <span class="k">raise</span> <span class="k">notice</span> <span class="s1">&#39;Creating colum&#39;</span><span class="p">;</span>
        <span class="k">execute</span> <span class="n">format</span> <span class="p">(</span><span class="s1">&#39;ALTER TABLE %s ADD COLUMN %s integer null&#39;</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">new_column_name</span><span class="p">);</span>
        <span class="k">execute</span> <span class="n">format</span> <span class="p">(</span><span class="s1">&#39;ALTER TABLE %s ADD CONSTRAINT fk_%s FOREIGN KEY (%s) REFERENCES %s(id)&#39;</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">new_column_name</span><span class="p">,</span> <span class="n">new_column_name</span><span class="p">,</span> <span class="n">new_table_name</span><span class="p">);</span>
    <span class="k">end</span> <span class="k">if</span> <span class="p">;</span>

    <span class="k">for</span> <span class="n">val</span> <span class="k">IN</span> <span class="k">execute</span> <span class="n">format</span> <span class="p">(</span><span class="s1">&#39;select %s from %s group by(%s)&#39;</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">column_name</span><span class="p">)</span> <span class="k">LOOP</span>
        <span class="k">RAISE</span> <span class="k">NOTICE</span> <span class="s1">&#39;Inserting new value %s ...&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">;</span>
        <span class="k">execute</span> <span class="n">format</span> <span class="p">(</span><span class="s1">&#39;insert into  %s(name) values (&#39;&#39;%s&#39;&#39;) returning id&#39;</span><span class="p">,</span> <span class="n">new_table_name</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">into</span> <span class="n">current_id</span><span class="p">;</span>
        <span class="k">raise</span> <span class="k">notice</span> <span class="s1">&#39;Created ID %&#39;</span><span class="p">,</span> <span class="n">current_id</span><span class="p">;</span>
        <span class="k">execute</span> <span class="n">format</span> <span class="p">(</span><span class="s1">&#39;update %s set %s = %s where %s = &#39;&#39;%s&#39;&#39;&#39;</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">new_column_name</span><span class="p">,</span><span class="n">current_id</span> <span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">val</span> <span class="p">);</span>
    <span class="k">END</span> <span class="k">LOOP</span><span class="p">;</span>

    <span class="cm">/* Uncomment this if you want to drop the flat column</span>
<span class="cm">    raise notice &#39;Dropping colmn&#39;;</span>
<span class="cm">    execute format (&#39;alter table %s drop column %s&#39;, table_name, column_name);</span>
<span class="cm">    */</span>

<span class="k">END</span><span class="p">;</span>
<span class="s">$$</span> <span class="k">LANGUAGE</span> <span class="n">plpgsql</span><span class="p">;</span>
</pre></div>
<p>The first line creates or updates the script. You can just copy over this script to an <span class="caps">SQL</span> window and run it as many times as you like (making changes
between runs) and the script will be always updated. The function that is created is actually a procedure since it returns <tt class="docutils literal">void</tt> and takes two parameters.
The <tt class="docutils literal"><span class="caps">DECLARE</span></tt> section that follows contains all the variables that are used in the&nbsp;script:</p>
<ul class="simple">
<li><tt class="docutils literal">val</tt> is the current value of the category when looping through their&nbsp;values</li>
<li><tt class="docutils literal">res</tt> is a boolean variable used for a&nbsp;conditional</li>
<li><tt class="docutils literal">new_table_name</tt> is the name of the table that will be&nbsp;created</li>
<li><tt class="docutils literal">new_column_name</tt> is the name of the column that will be added to the old&nbsp;table</li>
<li><tt class="docutils literal">current_id</tt> is the id of the last inserted value in the new&nbsp;table</li>
</ul>
<p>After the <tt class="docutils literal"><span class="caps">BEGIN</span></tt> the actual procedure starts: First the values of <tt class="docutils literal">new_table_name</tt> and <tt class="docutils literal">new_column_name</tt> are initialized to be used throughout the code and
then the new table is dropped (if exists) and re-created. Noticce the <tt class="docutils literal">execute format (parameter)</tt> function that executes the <span class="caps">SQL</span> contained in the parameter which
is a string and is constructed using the variables we&#8217;ve defined. The next line checks if the old table has the new column (i.e category_id) and saves
the result in the <tt class="docutils literal">res</tt> variable to check if the new column exists and if not add it to the old&nbsp;table.</p>
<p>A loop enumerating all unique values of the category column of the old table is then executed. Notice that <tt class="docutils literal">val</tt> will contain a single value since the <span class="caps">SQL</span> that is executed
will return a single column (that&#8217;s why it is declared as varchar). If we returned more than one column from the select the val could be declared as <tt class="docutils literal">record</tt> and access its
properties through dot notation (<tt class="docutils literal">val.prop1</tt> etc). The value is inserted to the newly created table using a <tt class="docutils literal">insert into table values () returning id</tt> <span class="caps">SQL</span> syntax
(so that the new id will be returned - this is an insert/select hybrid command) and saved to the <tt class="docutils literal">current_id</tt> variable. The <tt class="docutils literal">current_id</tt> variable then is used to update
the new column that was added to the old table with the proper foreign key&nbsp;value.</p>
<p>Notice that I&#8217;ve a commented out code in the end - if you want you can uncomment it and the old (flat) column will be dropped - so in my examply the <tt class="docutils literal">category</tt> column will be
removed since I will have <tt class="docutils literal">category_id</tt> to find out the name of each category. I recommend to uncomment this and actually drop the column since when you have both <tt class="docutils literal">category</tt>
and <tt class="docutils literal">category_id</tt> the values of these two columns are going to get out of sync and since you&#8217;ll have duplicate information your table will be even more non-normalized. You can
of course keep the column to make sure that the script works as you want since if the column is not dropped you can easily return to the previous state of the database by
removeing the new table and&nbsp;column.</p>
<p>To call it just run <tt class="docutils literal">select <span class="pre">export_relation('part',</span> 'category')</tt> and you should see some debug info in the messages tab. When the script is finished you&#8217;ll have the
<tt class="docutils literal">part_category</tt> table and <tt class="docutils literal">category_id</tt> column in the <tt class="docutils literal">part</tt> table.</p>
</div>
    <footer>
<p class="meta">
  <span class="byline author vcard">
    Posted by <span class="fn">
        Serafeim Papastefanos
    </span>
  </span>
<time datetime="2017-07-04T09:05:00+03:00" pubdate>Τρι 04 Ιούλιος 2017</time>  <span class="categories">
    <a class='category' href='https://spapas.github.io/category/postgresql.html'>postgresql</a>
  </span>
  <span class="categories">
    <a class="category" href="https://spapas.github.io/tag/postgresql.html">postgresql</a>,    <a class="category" href="https://spapas.github.io/tag/plpgsql.html">plpgsql</a>  </span>
</p><div class="sharing">
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="https://spapas.github.io/2017/07/04/postgresql-auto-create-category-column/" data-via="" data-counturl="https://spapas.github.io/2017/07/04/postgresql-auto-create-category-column/" >Tweet</a>
</div>    </footer>
  </article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div>
  </section>
</div>
<aside class="sidebar">
  <section>
  <br />
  <a href='/feeds/all.atom.xml'>Atom</a> 
  |
  <a href='/feeds/all.rss.xml'>RSS</a> 
  </section>
  
  <section>
    <h1>Subscribe</h1>
    Do you want to get notified via email when I post new content?
    <style>.subscribe-button {
    /* margin: 10px !important; */
    padding: 10px !important;
    background-color: black;
    display: inline-block;
    color: white !important;
    text-decoration: none;    
    
    line-height: 36px !important;
    height: 37px !important;
    text-decoration: none !important;
    display: inline-block !important;
    color: #ffffff !important;
    background-color: #000000 !important;
    border-radius: 3px !important;
    border: 1px solid transparent !important;
    padding: 1px 9px !important;
    font-size: 23px !important;
    letter-spacing: 0.6px !important;
    box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;
    -webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;
    margin: 0 auto !important;
    font-family: 'Cookie', cursive !important;
    -webkit-box-sizing: border-box !important;
    box-sizing: border-box !important;
    -o-transition: 0.3s all linear !important;
    -webkit-transition: 0.3s all linear !important;
    -moz-transition: 0.3s all linear !important;
    -ms-transition: 0.3s all linear !important;
    transition: 0.3s all linear !important;
    
    }</style>
<a class='subscribe-button' target="_blank" href="http://eepurl.com/dxI3PP">Click here to subscribe!</a>
  </section>
  
  <style>.bmc-button img{width: 27px !important;margin-bottom: 3px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-block !important;color:#ffffff !important;background-color:#000000 !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 1px 9px !important;font-size: 23px !important;letter-spacing:0.6px !important;;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Cookie', cursive !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#ffffff !important;}</style><link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet">
  
  
  <section>
    <h1>Recent Posts</h1>
    <ul id="recent_posts">
      <li class="post">
          <a href="https://spapas.github.io/2019/10/17/declarative-ecto-query-sorting/">Declarative Ecto query sorting</a>
      </li>
      <li class="post">
          <a href="https://spapas.github.io/2019/10/03/html-form-submit-php/">How to properly handle an HTML form</a>
      </li>
      <li class="post">
          <a href="https://spapas.github.io/2019/07/25/declarative-ecto-query-filters/">Declarative Ecto query filters</a>
      </li>
      <li class="post">
          <a href="https://spapas.github.io/2019/06/04/phoenix-form-select2-ajax/">Phoenix forms integration with select2 and ajax</a>
      </li>
      <li class="post">
          <a href="https://spapas.github.io/2019/04/05/android-custom-filter-adapter/">How to create a custom filtered adapter in Android</a>
      </li>
    </ul>
  </section>
  <section>
      
    <h1>Categories</h1>
    <ul id="recent_posts">
        <li><a href="https://spapas.github.io/category/android.html">android</a></li>
        <li><a href="https://spapas.github.io/category/css.html">css</a></li>
        <li><a href="https://spapas.github.io/category/django.html">django</a></li>
        <li><a href="https://spapas.github.io/category/elixir.html">elixir</a></li>
        <li><a href="https://spapas.github.io/category/flask.html">flask</a></li>
        <li><a href="https://spapas.github.io/category/git.html">git</a></li>
        <li><a href="https://spapas.github.io/category/html.html">html</a></li>
        <li><a href="https://spapas.github.io/category/javascript.html">javascript</a></li>
        <li><a href="https://spapas.github.io/category/pelican.html">pelican</a></li>
        <li><a href="https://spapas.github.io/category/postgresql.html">postgresql</a></li>
        <li><a href="https://spapas.github.io/category/python.html">python</a></li>
        <li><a href="https://spapas.github.io/category/spring.html">spring</a></li>
        <li><a href="https://spapas.github.io/category/unix.html">unix</a></li>
        <li><a href="https://spapas.github.io/category/wagtail.html">wagtail</a></li>
    </ul>
  </section>
 

  <section>
  <h1>Tags</h1>
    <a href="https://spapas.github.io/tag/less.html">less</a>,    <a href="https://spapas.github.io/tag/rest.html">rest</a>,    <a href="https://spapas.github.io/tag/query.html">query</a>,    <a href="https://spapas.github.io/tag/ecto.html">ecto</a>,    <a href="https://spapas.github.io/tag/tables.html">tables</a>,    <a href="https://spapas.github.io/tag/pivot_table.html">pivot_table</a>,    <a href="https://spapas.github.io/tag/console.html">console</a>,    <a href="https://spapas.github.io/tag/async.html">async</a>,    <a href="https://spapas.github.io/tag/django-rq.html">django-rq</a>,    <a href="https://spapas.github.io/tag/github-pages.html">github-pages</a>,    <a href="https://spapas.github.io/tag/forms.html">forms</a>,    <a href="https://spapas.github.io/tag/yaml.html">yaml</a>,    <a href="https://spapas.github.io/tag/404.html">404</a>,    <a href="https://spapas.github.io/tag/ldap.html">ldap</a>,    <a href="https://spapas.github.io/tag/immutable.html">immutable</a>,    <a href="https://spapas.github.io/tag/initd.html">init.d</a>,    <a href="https://spapas.github.io/tag/youtube-dl.html">youtube-dl</a>,    <a href="https://spapas.github.io/tag/python.html">python</a>,    <a href="https://spapas.github.io/tag/django-extensions.html">django-extensions</a>,    <a href="https://spapas.github.io/tag/class-based-views.html">class-based-views</a>,    <a href="https://spapas.github.io/tag/scipy.html">scipy</a>,    <a href="https://spapas.github.io/tag/grid.html">grid</a>,    <a href="https://spapas.github.io/tag/ag-grid.html">ag-grid</a>,    <a href="https://spapas.github.io/tag/du.html">du</a>,    <a href="https://spapas.github.io/tag/watchify.html">watchify</a>,    <a href="https://spapas.github.io/tag/settings.html">settings</a>,    <a href="https://spapas.github.io/tag/flux.html">flux</a>,    <a href="https://spapas.github.io/tag/fixeddatatable.html">FixedDataTable</a>,    <a href="https://spapas.github.io/tag/queries.html">queries</a>,    <a href="https://spapas.github.io/tag/debug.html">debug</a>,    <a href="https://spapas.github.io/tag/imgur.html">imgur</a>,    <a href="https://spapas.github.io/tag/security.html">security</a>,    <a href="https://spapas.github.io/tag/npm.html">npm</a>,    <a href="https://spapas.github.io/tag/hyperapp.html">hyperapp</a>,    <a href="https://spapas.github.io/tag/spring.html">spring</a>,    <a href="https://spapas.github.io/tag/react-redux.html">react-redux</a>,    <a href="https://spapas.github.io/tag/cron.html">cron</a>,    <a href="https://spapas.github.io/tag/babelify.html">babelify</a>,    <a href="https://spapas.github.io/tag/design.html">design</a>,    <a href="https://spapas.github.io/tag/tutorial.html">tutorial</a>,    <a href="https://spapas.github.io/tag/gmail.html">gmail</a>,    <a href="https://spapas.github.io/tag/reportlab.html">reportlab</a>,    <a href="https://spapas.github.io/tag/rq.html">rq</a>,    <a href="https://spapas.github.io/tag/redis.html">redis</a>,    <a href="https://spapas.github.io/tag/python-3.html">python-3</a>,    <a href="https://spapas.github.io/tag/research.html">research</a>,    <a href="https://spapas.github.io/tag/werkzeug.html">werkzeug</a>,    <a href="https://spapas.github.io/tag/jobs.html">jobs</a>,    <a href="https://spapas.github.io/tag/redux-thunk.html">redux-thunk</a>,    <a href="https://spapas.github.io/tag/disk-usage.html">disk-usage</a>,    <a href="https://spapas.github.io/tag/javascript.html">javascript</a>,    <a href="https://spapas.github.io/tag/component.html">component</a>,    <a href="https://spapas.github.io/tag/ajax.html">ajax</a>,    <a href="https://spapas.github.io/tag/elixir.html">elixir</a>,    <a href="https://spapas.github.io/tag/ipython.html">ipython</a>,    <a href="https://spapas.github.io/tag/uglify.html">uglify</a>,    <a href="https://spapas.github.io/tag/configuration.html">configuration</a>,    <a href="https://spapas.github.io/tag/properties.html">properties</a>,    <a href="https://spapas.github.io/tag/bash.html">bash</a>,    <a href="https://spapas.github.io/tag/es6.html">es6</a>,    <a href="https://spapas.github.io/tag/spring-boot.html">spring-boot</a>,    <a href="https://spapas.github.io/tag/postgresql.html">postgresql</a>,    <a href="https://spapas.github.io/tag/kotlin.html">kotlin</a>,    <a href="https://spapas.github.io/tag/adapter.html">adapter</a>,    <a href="https://spapas.github.io/tag/filter.html">filter</a>,    <a href="https://spapas.github.io/tag/flask.html">flask</a>,    <a href="https://spapas.github.io/tag/notebook.html">notebook</a>,    <a href="https://spapas.github.io/tag/static-html.html">static-html</a>,    <a href="https://spapas.github.io/tag/pdf.html">pdf</a>,    <a href="https://spapas.github.io/tag/react-notification.html">react-notification</a>,    <a href="https://spapas.github.io/tag/pelican.html">pelican</a>,    <a href="https://spapas.github.io/tag/tasks.html">tasks</a>,    <a href="https://spapas.github.io/tag/nodejs.html">node.js</a>,    <a href="https://spapas.github.io/tag/unix.html">unix</a>,    <a href="https://spapas.github.io/tag/google.html">google</a>,    <a href="https://spapas.github.io/tag/linux.html">linux</a>,    <a href="https://spapas.github.io/tag/pivot.html">pivot</a>,    <a href="https://spapas.github.io/tag/auditing.html">auditing</a>,    <a href="https://spapas.github.io/tag/git.html">git</a>,    <a href="https://spapas.github.io/tag/java.html">java</a>,    <a href="https://spapas.github.io/tag/introduction.html">introduction</a>,    <a href="https://spapas.github.io/tag/pusher.html">pusher</a>,    <a href="https://spapas.github.io/tag/fixed-data-tables.html">fixed-data-tables</a>,    <a href="https://spapas.github.io/tag/heroku.html">heroku</a>,    <a href="https://spapas.github.io/tag/xhtml2pdf.html">xhtml2pdf</a>,    <a href="https://spapas.github.io/tag/numpy.html">numpy</a>,    <a href="https://spapas.github.io/tag/form.html">form</a>,    <a href="https://spapas.github.io/tag/django-rest-auth.html">django-rest-auth</a>,    <a href="https://spapas.github.io/tag/wagtail.html">wagtail</a>,    <a href="https://spapas.github.io/tag/rst.html">rst</a>,    <a href="https://spapas.github.io/tag/python-2.html">python-2</a>,    <a href="https://spapas.github.io/tag/ffmpeg.html">ffmpeg</a>,    <a href="https://spapas.github.io/tag/middleware.html">middleware</a>,    <a href="https://spapas.github.io/tag/profiles.html">profiles</a>,    <a href="https://spapas.github.io/tag/spring-security.html">spring-security</a>,    <a href="https://spapas.github.io/tag/githubio.html">github.io</a>,    <a href="https://spapas.github.io/tag/error.html">error</a>,    <a href="https://spapas.github.io/tag/asynchronous.html">asynchronous</a>,    <a href="https://spapas.github.io/tag/react-router-redux.html">react-router-redux</a>,    <a href="https://spapas.github.io/tag/select2.html">select2</a>,    <a href="https://spapas.github.io/tag/history.html">history</a>,    <a href="https://spapas.github.io/tag/django-rest-framework.html">django-rest-framework</a>,    <a href="https://spapas.github.io/tag/redux-form.html">redux-form</a>,    <a href="https://spapas.github.io/tag/cbv.html">cbv</a>,    <a href="https://spapas.github.io/tag/scheduling.html">scheduling</a>,    <a href="https://spapas.github.io/tag/plpgsql.html">plpgsql</a>,    <a href="https://spapas.github.io/tag/boilerplate.html">boilerplate</a>,    <a href="https://spapas.github.io/tag/generic.html">generic</a>,    <a href="https://spapas.github.io/tag/babel.html">babel</a>,    <a href="https://spapas.github.io/tag/authentication.html">authentication</a>,    <a href="https://spapas.github.io/tag/html.html">html</a>,    <a href="https://spapas.github.io/tag/android.html">android</a>,    <a href="https://spapas.github.io/tag/pandas.html">pandas</a>,    <a href="https://spapas.github.io/tag/css.html">css</a>,    <a href="https://spapas.github.io/tag/node.html">node</a>,    <a href="https://spapas.github.io/tag/phoenix.html">phoenix</a>,    <a href="https://spapas.github.io/tag/deploy.html">deploy</a>,    <a href="https://spapas.github.io/tag/mongodb.html">mongodb</a>,    <a href="https://spapas.github.io/tag/react.html">react</a>,    <a href="https://spapas.github.io/tag/autocompelte.html">autocompelte</a>,    <a href="https://spapas.github.io/tag/declarative.html">declarative</a>,    <a href="https://spapas.github.io/tag/php.html">php</a>,    <a href="https://spapas.github.io/tag/browserify.html">browserify</a>,    <a href="https://spapas.github.io/tag/branching.html">branching</a>,    <a href="https://spapas.github.io/tag/github.html">github</a>,    <a href="https://spapas.github.io/tag/jupyter.html">jupyter</a>,    <a href="https://spapas.github.io/tag/windows.html">windows</a>,    <a href="https://spapas.github.io/tag/youtube.html">youtube</a>,    <a href="https://spapas.github.io/tag/django.html">django</a>,    <a href="https://spapas.github.io/tag/q.html">q</a>,    <a href="https://spapas.github.io/tag/react-router.html">react-router</a>,    <a href="https://spapas.github.io/tag/redux.html">redux</a>,    <a href="https://spapas.github.io/tag/boostrap-material-design.html">boostrap-material-design</a>  </section>
  
  <section>
  <h1>Yearly archives</h1>
    <a href="https://spapas.github.io/posts/2013/">2013</a>,    <a href="https://spapas.github.io/posts/2014/">2014</a>,    <a href="https://spapas.github.io/posts/2015/">2015</a>,    <a href="https://spapas.github.io/posts/2016/">2016</a>,    <a href="https://spapas.github.io/posts/2017/">2017</a>,    <a href="https://spapas.github.io/posts/2018/">2018</a>,    <a href="https://spapas.github.io/posts/2019/">2019</a>  </section>



  <section>
    <h1>GitHub Repos</h1>
    <ul id="gh_repos">
      <li class="loading">Status updating...</li>
    </ul>
      <a href="https://github.com/spapas">@spapas</a> on GitHub
    <script  src="//code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script type="text/javascript">
      $(function(){
          if (!window.jXHR){
              var jxhr = document.createElement('script');
              jxhr.type = 'text/javascript';
              jxhr.src = 'https://spapas.github.io/theme/js/jXHR.js';
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(jxhr, s);
          }

          github.showRepos({
              user: 'spapas',
              count: 5,
              skip_forks: true,
              target: '#gh_repos'
          });
      });
    </script>
    <script src="https://spapas.github.io/theme/js/github.js" type="text/javascript"> </script>
  </section>


  <section>
    <a href="https://twitter.com/_serafeim_?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @_serafeim_</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  </section>

</aside>    </div>
  </div>
  <footer role="contentinfo"><p>
    Copyright &copy;  2013&ndash;2019 Serafeim Papastefanos &mdash;
  <span class="credit">Powered by <a href="http://getpelican.com">Pelican</a></span>
</p></footer>
  <script src="https://spapas.github.io/theme/js/modernizr-2.0.js"></script>
  <script src="https://spapas.github.io/theme/js/ender.js"></script>
  <script src="https://spapas.github.io/theme/js/octopress.js" type="text/javascript"></script>
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44750952-1', 'auto');

    ga('send', 'pageview');
    </script>
  <script type="text/javascript">
    var disqus_shortname = 'spapas-github-io';
    var disqus_identifier = '/2017/07/04/postgresql-auto-create-category-column/';
    var disqus_url = 'https://spapas.github.io/2017/07/04/postgresql-auto-create-category-column/';
    var disqus_title = 'Automatically create a category table in Postgresql by extracting unique table&nbsp;values';
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = "//" + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
  </script>
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>
</body>

</html>